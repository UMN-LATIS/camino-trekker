var dE=Object.defineProperty,pE=Object.defineProperties;var fE=Object.getOwnPropertyDescriptors;var ev=Object.getOwnPropertySymbols;var mE=Object.prototype.hasOwnProperty,gE=Object.prototype.propertyIsEnumerable;var tv=(r,o,l)=>o in r?dE(r,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[o]=l,Dm=(r,o)=>{for(var l in o||(o={}))mE.call(o,l)&&tv(r,l,o[l]);if(ev)for(var l of ev(o))gE.call(o,l)&&tv(r,l,o[l]);return r},iv=(r,o)=>pE(r,fE(o));function Jg(r,o){const l=Object.create(null),h=r.split(",");for(let g=0;g<h.length;g++)l[h[g]]=!0;return o?g=>!!l[g.toLowerCase()]:g=>!!l[g]}const _E="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",yE=Jg(_E);function _1(r){return!!r||r===""}function Qg(r){if(Kt(r)){const o={};for(let l=0;l<r.length;l++){const h=r[l],g=En(h)?bE(h):Qg(h);if(g)for(const y in g)o[y]=g[y]}return o}else{if(En(r))return r;if(Sn(r))return r}}const vE=/;(?![^(]*\))/g,xE=/:(.+)/;function bE(r){const o={};return r.split(vE).forEach(l=>{if(l){const h=l.split(xE);h.length>1&&(o[h[0].trim()]=h[1].trim())}}),o}function e_(r){let o="";if(En(r))o=r;else if(Kt(r))for(let l=0;l<r.length;l++){const h=e_(r[l]);h&&(o+=h+" ")}else if(Sn(r))for(const l in r)r[l]&&(o+=l+" ");return o.trim()}const VL=r=>En(r)?r:r==null?"":Kt(r)||Sn(r)&&(r.toString===b1||!_i(r.toString))?JSON.stringify(r,y1,2):String(r),y1=(r,o)=>o&&o.__v_isRef?y1(r,o.value):Ec(o)?{[`Map(${o.size})`]:[...o.entries()].reduce((l,[h,g])=>(l[`${h} =>`]=g,l),{})}:v1(o)?{[`Set(${o.size})`]:[...o.values()]}:Sn(o)&&!Kt(o)&&!w1(o)?String(o):o,Xi={},Tc=[],xo=()=>{},wE=()=>!1,TE=/^on[^a-z]/,Fp=r=>TE.test(r),t_=r=>r.startsWith("onUpdate:"),Wn=Object.assign,i_=(r,o)=>{const l=r.indexOf(o);l>-1&&r.splice(l,1)},EE=Object.prototype.hasOwnProperty,zi=(r,o)=>EE.call(r,o),Kt=Array.isArray,Ec=r=>Np(r)==="[object Map]",v1=r=>Np(r)==="[object Set]",_i=r=>typeof r=="function",En=r=>typeof r=="string",n_=r=>typeof r=="symbol",Sn=r=>r!==null&&typeof r=="object",x1=r=>Sn(r)&&_i(r.then)&&_i(r.catch),b1=Object.prototype.toString,Np=r=>b1.call(r),SE=r=>Np(r).slice(8,-1),w1=r=>Np(r)==="[object Object]",r_=r=>En(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,dp=Jg(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Up=r=>{const o=Object.create(null);return l=>o[l]||(o[l]=r(l))},CE=/-(\w)/g,Yo=Up(r=>r.replace(CE,(o,l)=>l?l.toUpperCase():"")),AE=/\B([A-Z])/g,Dc=Up(r=>r.replace(AE,"-$1").toLowerCase()),jp=Up(r=>r.charAt(0).toUpperCase()+r.slice(1)),Lm=Up(r=>r?`on${jp(r)}`:""),uh=(r,o)=>!Object.is(r,o),Rm=(r,o)=>{for(let l=0;l<r.length;l++)r[l](o)},wp=(r,o,l)=>{Object.defineProperty(r,o,{configurable:!0,enumerable:!1,value:l})},T1=r=>{const o=parseFloat(r);return isNaN(o)?r:o};let nv;const ME=()=>nv||(nv=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let eo;class IE{constructor(o=!1){this.active=!0,this.effects=[],this.cleanups=[],!o&&eo&&(this.parent=eo,this.index=(eo.scopes||(eo.scopes=[])).push(this)-1)}run(o){if(this.active)try{return eo=this,o()}finally{eo=this.parent}}on(){eo=this}off(){eo=this.parent}stop(o){if(this.active){let l,h;for(l=0,h=this.effects.length;l<h;l++)this.effects[l].stop();for(l=0,h=this.cleanups.length;l<h;l++)this.cleanups[l]();if(this.scopes)for(l=0,h=this.scopes.length;l<h;l++)this.scopes[l].stop(!0);if(this.parent&&!o){const g=this.parent.scopes.pop();g&&g!==this&&(this.parent.scopes[this.index]=g,g.index=this.index)}this.active=!1}}}function kE(r,o=eo){o&&o.active&&o.effects.push(r)}function zE(){return eo}function PE(r){eo&&eo.cleanups.push(r)}const o_=r=>{const o=new Set(r);return o.w=0,o.n=0,o},E1=r=>(r.w&aa)>0,S1=r=>(r.n&aa)>0,DE=({deps:r})=>{if(r.length)for(let o=0;o<r.length;o++)r[o].w|=aa},LE=r=>{const{deps:o}=r;if(o.length){let l=0;for(let h=0;h<o.length;h++){const g=o[h];E1(g)&&!S1(g)?g.delete(r):o[l++]=g,g.w&=~aa,g.n&=~aa}o.length=l}},mg=new WeakMap;let Hu=0,aa=1;const gg=30;let Xo;const el=Symbol(""),_g=Symbol("");class s_{constructor(o,l=null,h){this.fn=o,this.scheduler=l,this.active=!0,this.deps=[],this.parent=void 0,kE(this,h)}run(){if(!this.active)return this.fn();let o=Xo,l=oa;for(;o;){if(o===this)return;o=o.parent}try{return this.parent=Xo,Xo=this,oa=!0,aa=1<<++Hu,Hu<=gg?DE(this):rv(this),this.fn()}finally{Hu<=gg&&LE(this),aa=1<<--Hu,Xo=this.parent,oa=l,this.parent=void 0}}stop(){this.active&&(rv(this),this.onStop&&this.onStop(),this.active=!1)}}function rv(r){const{deps:o}=r;if(o.length){for(let l=0;l<o.length;l++)o[l].delete(r);o.length=0}}let oa=!0;const C1=[];function Lc(){C1.push(oa),oa=!1}function Rc(){const r=C1.pop();oa=r===void 0?!0:r}function Nr(r,o,l){if(oa&&Xo){let h=mg.get(r);h||mg.set(r,h=new Map);let g=h.get(l);g||h.set(l,g=o_()),A1(g)}}function A1(r,o){let l=!1;Hu<=gg?S1(r)||(r.n|=aa,l=!E1(r)):l=!r.has(Xo),l&&(r.add(Xo),Xo.deps.push(r))}function ms(r,o,l,h,g,y){const E=mg.get(r);if(!E)return;let s=[];if(o==="clear")s=[...E.values()];else if(l==="length"&&Kt(r))E.forEach((C,k)=>{(k==="length"||k>=h)&&s.push(C)});else switch(l!==void 0&&s.push(E.get(l)),o){case"add":Kt(r)?r_(l)&&s.push(E.get("length")):(s.push(E.get(el)),Ec(r)&&s.push(E.get(_g)));break;case"delete":Kt(r)||(s.push(E.get(el)),Ec(r)&&s.push(E.get(_g)));break;case"set":Ec(r)&&s.push(E.get(el));break}if(s.length===1)s[0]&&yg(s[0]);else{const C=[];for(const k of s)k&&C.push(...k);yg(o_(C))}}function yg(r,o){for(const l of Kt(r)?r:[...r])(l!==Xo||l.allowRecurse)&&(l.scheduler?l.scheduler():l.run())}const RE=Jg("__proto__,__v_isRef,__isVue"),M1=new Set(Object.getOwnPropertyNames(Symbol).map(r=>Symbol[r]).filter(n_)),OE=a_(),BE=a_(!1,!0),FE=a_(!0),ov=NE();function NE(){const r={};return["includes","indexOf","lastIndexOf"].forEach(o=>{r[o]=function(...l){const h=Oi(this);for(let y=0,E=this.length;y<E;y++)Nr(h,"get",y+"");const g=h[o](...l);return g===-1||g===!1?h[o](...l.map(Oi)):g}}),["push","pop","shift","unshift","splice"].forEach(o=>{r[o]=function(...l){Lc();const h=Oi(this)[o].apply(this,l);return Rc(),h}}),r}function a_(r=!1,o=!1){return function(h,g,y){if(g==="__v_isReactive")return!r;if(g==="__v_isReadonly")return r;if(g==="__v_isShallow")return o;if(g==="__v_raw"&&y===(r?o?tS:D1:o?P1:z1).get(h))return h;const E=Kt(h);if(!r&&E&&zi(ov,g))return Reflect.get(ov,g,y);const s=Reflect.get(h,g,y);return(n_(g)?M1.has(g):RE(g))||(r||Nr(h,"get",g),o)?s:Nn(s)?!E||!r_(g)?s.value:s:Sn(s)?r?L1(s):bo(s):s}}const UE=I1(),jE=I1(!0);function I1(r=!1){return function(l,h,g,y){let E=l[h];if(hh(E)&&Nn(E)&&!Nn(g))return!1;if(!r&&!hh(g)&&(R1(g)||(g=Oi(g),E=Oi(E)),!Kt(l)&&Nn(E)&&!Nn(g)))return E.value=g,!0;const s=Kt(l)&&r_(h)?Number(h)<l.length:zi(l,h),C=Reflect.set(l,h,g,y);return l===Oi(y)&&(s?uh(g,E)&&ms(l,"set",h,g):ms(l,"add",h,g)),C}}function VE(r,o){const l=zi(r,o);r[o];const h=Reflect.deleteProperty(r,o);return h&&l&&ms(r,"delete",o,void 0),h}function $E(r,o){const l=Reflect.has(r,o);return(!n_(o)||!M1.has(o))&&Nr(r,"has",o),l}function GE(r){return Nr(r,"iterate",Kt(r)?"length":el),Reflect.ownKeys(r)}const k1={get:OE,set:UE,deleteProperty:VE,has:$E,ownKeys:GE},qE={get:FE,set(r,o){return!0},deleteProperty(r,o){return!0}},ZE=Wn({},k1,{get:BE,set:jE}),l_=r=>r,Vp=r=>Reflect.getPrototypeOf(r);function Xd(r,o,l=!1,h=!1){r=r.__v_raw;const g=Oi(r),y=Oi(o);o!==y&&!l&&Nr(g,"get",o),!l&&Nr(g,"get",y);const{has:E}=Vp(g),s=h?l_:l?h_:dh;if(E.call(g,o))return s(r.get(o));if(E.call(g,y))return s(r.get(y));r!==g&&r.get(o)}function Kd(r,o=!1){const l=this.__v_raw,h=Oi(l),g=Oi(r);return r!==g&&!o&&Nr(h,"has",r),!o&&Nr(h,"has",g),r===g?l.has(r):l.has(r)||l.has(g)}function Yd(r,o=!1){return r=r.__v_raw,!o&&Nr(Oi(r),"iterate",el),Reflect.get(r,"size",r)}function sv(r){r=Oi(r);const o=Oi(this);return Vp(o).has.call(o,r)||(o.add(r),ms(o,"add",r,r)),this}function av(r,o){o=Oi(o);const l=Oi(this),{has:h,get:g}=Vp(l);let y=h.call(l,r);y||(r=Oi(r),y=h.call(l,r));const E=g.call(l,r);return l.set(r,o),y?uh(o,E)&&ms(l,"set",r,o):ms(l,"add",r,o),this}function lv(r){const o=Oi(this),{has:l,get:h}=Vp(o);let g=l.call(o,r);g||(r=Oi(r),g=l.call(o,r)),h&&h.call(o,r);const y=o.delete(r);return g&&ms(o,"delete",r,void 0),y}function cv(){const r=Oi(this),o=r.size!==0,l=r.clear();return o&&ms(r,"clear",void 0,void 0),l}function Jd(r,o){return function(h,g){const y=this,E=y.__v_raw,s=Oi(E),C=o?l_:r?h_:dh;return!r&&Nr(s,"iterate",el),E.forEach((k,M)=>h.call(g,C(k),C(M),y))}}function Qd(r,o,l){return function(...h){const g=this.__v_raw,y=Oi(g),E=Ec(y),s=r==="entries"||r===Symbol.iterator&&E,C=r==="keys"&&E,k=g[r](...h),M=l?l_:o?h_:dh;return!o&&Nr(y,"iterate",C?_g:el),{next(){const{value:D,done:R}=k.next();return R?{value:D,done:R}:{value:s?[M(D[0]),M(D[1])]:M(D),done:R}},[Symbol.iterator](){return this}}}}function Ws(r){return function(...o){return r==="delete"?!1:this}}function WE(){const r={get(y){return Xd(this,y)},get size(){return Yd(this)},has:Kd,add:sv,set:av,delete:lv,clear:cv,forEach:Jd(!1,!1)},o={get(y){return Xd(this,y,!1,!0)},get size(){return Yd(this)},has:Kd,add:sv,set:av,delete:lv,clear:cv,forEach:Jd(!1,!0)},l={get(y){return Xd(this,y,!0)},get size(){return Yd(this,!0)},has(y){return Kd.call(this,y,!0)},add:Ws("add"),set:Ws("set"),delete:Ws("delete"),clear:Ws("clear"),forEach:Jd(!0,!1)},h={get(y){return Xd(this,y,!0,!0)},get size(){return Yd(this,!0)},has(y){return Kd.call(this,y,!0)},add:Ws("add"),set:Ws("set"),delete:Ws("delete"),clear:Ws("clear"),forEach:Jd(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(y=>{r[y]=Qd(y,!1,!1),l[y]=Qd(y,!0,!1),o[y]=Qd(y,!1,!0),h[y]=Qd(y,!0,!0)}),[r,l,o,h]}const[HE,XE,KE,YE]=WE();function c_(r,o){const l=o?r?YE:KE:r?XE:HE;return(h,g,y)=>g==="__v_isReactive"?!r:g==="__v_isReadonly"?r:g==="__v_raw"?h:Reflect.get(zi(l,g)&&g in h?l:h,g,y)}const JE={get:c_(!1,!1)},QE={get:c_(!1,!0)},eS={get:c_(!0,!1)},z1=new WeakMap,P1=new WeakMap,D1=new WeakMap,tS=new WeakMap;function iS(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function nS(r){return r.__v_skip||!Object.isExtensible(r)?0:iS(SE(r))}function bo(r){return hh(r)?r:u_(r,!1,k1,JE,z1)}function rS(r){return u_(r,!1,ZE,QE,P1)}function L1(r){return u_(r,!0,qE,eS,D1)}function u_(r,o,l,h,g){if(!Sn(r)||r.__v_raw&&!(o&&r.__v_isReactive))return r;const y=g.get(r);if(y)return y;const E=nS(r);if(E===0)return r;const s=new Proxy(r,E===2?h:l);return g.set(r,s),s}function Sc(r){return hh(r)?Sc(r.__v_raw):!!(r&&r.__v_isReactive)}function hh(r){return!!(r&&r.__v_isReadonly)}function R1(r){return!!(r&&r.__v_isShallow)}function O1(r){return Sc(r)||hh(r)}function Oi(r){const o=r&&r.__v_raw;return o?Oi(o):r}function B1(r){return wp(r,"__v_skip",!0),r}const dh=r=>Sn(r)?bo(r):r,h_=r=>Sn(r)?L1(r):r;function F1(r){oa&&Xo&&(r=Oi(r),A1(r.dep||(r.dep=o_())))}function N1(r,o){r=Oi(r),r.dep&&yg(r.dep)}function Nn(r){return!!(r&&r.__v_isRef===!0)}function wn(r){return U1(r,!1)}function oS(r){return U1(r,!0)}function U1(r,o){return Nn(r)?r:new sS(r,o)}class sS{constructor(o,l){this.__v_isShallow=l,this.dep=void 0,this.__v_isRef=!0,this._rawValue=l?o:Oi(o),this._value=l?o:dh(o)}get value(){return F1(this),this._value}set value(o){o=this.__v_isShallow?o:Oi(o),uh(o,this._rawValue)&&(this._rawValue=o,this._value=this.__v_isShallow?o:dh(o),N1(this))}}function ps(r){return Nn(r)?r.value:r}const aS={get:(r,o,l)=>ps(Reflect.get(r,o,l)),set:(r,o,l,h)=>{const g=r[o];return Nn(g)&&!Nn(l)?(g.value=l,!0):Reflect.set(r,o,l,h)}};function j1(r){return Sc(r)?r:new Proxy(r,aS)}function $L(r){const o=Kt(r)?new Array(r.length):{};for(const l in r)o[l]=cS(r,l);return o}class lS{constructor(o,l,h){this._object=o,this._key=l,this._defaultValue=h,this.__v_isRef=!0}get value(){const o=this._object[this._key];return o===void 0?this._defaultValue:o}set value(o){this._object[this._key]=o}}function cS(r,o,l){const h=r[o];return Nn(h)?h:new lS(r,o,l)}class uS{constructor(o,l,h,g){this._setter=l,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new s_(o,()=>{this._dirty||(this._dirty=!0,N1(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!g,this.__v_isReadonly=h}get value(){const o=Oi(this);return F1(o),(o._dirty||!o._cacheable)&&(o._dirty=!1,o._value=o.effect.run()),o._value}set value(o){this._setter(o)}}function hS(r,o,l=!1){let h,g;const y=_i(r);return y?(h=r,g=xo):(h=r.get,g=r.set),new uS(h,g,y||!g,l)}Promise.resolve();function sa(r,o,l,h){let g;try{g=h?r(...h):r()}catch(y){$p(y,o,l)}return g}function io(r,o,l,h){if(_i(r)){const y=sa(r,o,l,h);return y&&x1(y)&&y.catch(E=>{$p(E,o,l)}),y}const g=[];for(let y=0;y<r.length;y++)g.push(io(r[y],o,l,h));return g}function $p(r,o,l,h=!0){const g=o?o.vnode:null;if(o){let y=o.parent;const E=o.proxy,s=l;for(;y;){const k=y.ec;if(k){for(let M=0;M<k.length;M++)if(k[M](r,E,s)===!1)return}y=y.parent}const C=o.appContext.config.errorHandler;if(C){sa(C,null,10,[r,E,s]);return}}dS(r,l,g,h)}function dS(r,o,l,h=!0){console.error(r)}let Tp=!1,vg=!1;const Br=[];let ds=0;const Ju=[];let Xu=null,yc=0;const Qu=[];let Qs=null,vc=0;const V1=Promise.resolve();let d_=null,xg=null;function ph(r){const o=d_||V1;return r?o.then(this?r.bind(this):r):o}function pS(r){let o=ds+1,l=Br.length;for(;o<l;){const h=o+l>>>1;fh(Br[h])<r?o=h+1:l=h}return o}function $1(r){(!Br.length||!Br.includes(r,Tp&&r.allowRecurse?ds+1:ds))&&r!==xg&&(r.id==null?Br.push(r):Br.splice(pS(r.id),0,r),G1())}function G1(){!Tp&&!vg&&(vg=!0,d_=V1.then(W1))}function fS(r){const o=Br.indexOf(r);o>ds&&Br.splice(o,1)}function q1(r,o,l,h){Kt(r)?l.push(...r):(!o||!o.includes(r,r.allowRecurse?h+1:h))&&l.push(r),G1()}function mS(r){q1(r,Xu,Ju,yc)}function gS(r){q1(r,Qs,Qu,vc)}function p_(r,o=null){if(Ju.length){for(xg=o,Xu=[...new Set(Ju)],Ju.length=0,yc=0;yc<Xu.length;yc++)Xu[yc]();Xu=null,yc=0,xg=null,p_(r,o)}}function Z1(r){if(Qu.length){const o=[...new Set(Qu)];if(Qu.length=0,Qs){Qs.push(...o);return}for(Qs=o,Qs.sort((l,h)=>fh(l)-fh(h)),vc=0;vc<Qs.length;vc++)Qs[vc]();Qs=null,vc=0}}const fh=r=>r.id==null?1/0:r.id;function W1(r){vg=!1,Tp=!0,p_(r),Br.sort((l,h)=>fh(l)-fh(h));const o=xo;try{for(ds=0;ds<Br.length;ds++){const l=Br[ds];l&&l.active!==!1&&sa(l,null,14)}}finally{ds=0,Br.length=0,Z1(),Tp=!1,d_=null,(Br.length||Ju.length||Qu.length)&&W1(r)}}function _S(r,o,...l){const h=r.vnode.props||Xi;let g=l;const y=o.startsWith("update:"),E=y&&o.slice(7);if(E&&E in h){const M=`${E==="modelValue"?"model":E}Modifiers`,{number:D,trim:R}=h[M]||Xi;R?g=l.map(U=>U.trim()):D&&(g=l.map(T1))}let s,C=h[s=Lm(o)]||h[s=Lm(Yo(o))];!C&&y&&(C=h[s=Lm(Dc(o))]),C&&io(C,r,6,g);const k=h[s+"Once"];if(k){if(!r.emitted)r.emitted={};else if(r.emitted[s])return;r.emitted[s]=!0,io(k,r,6,g)}}function H1(r,o,l=!1){const h=o.emitsCache,g=h.get(r);if(g!==void 0)return g;const y=r.emits;let E={},s=!1;if(!_i(r)){const C=k=>{const M=H1(k,o,!0);M&&(s=!0,Wn(E,M))};!l&&o.mixins.length&&o.mixins.forEach(C),r.extends&&C(r.extends),r.mixins&&r.mixins.forEach(C)}return!y&&!s?(h.set(r,null),null):(Kt(y)?y.forEach(C=>E[C]=null):Wn(E,y),h.set(r,E),E)}function f_(r,o){return!r||!Fp(o)?!1:(o=o.slice(2).replace(/Once$/,""),zi(r,o[0].toLowerCase()+o.slice(1))||zi(r,Dc(o))||zi(r,o))}let to=null,Gp=null;function Ep(r){const o=to;return to=r,Gp=r&&r.type.__scopeId||null,o}function GL(r){Gp=r}function qL(){Gp=null}function yS(r,o=to,l){if(!o||r._n)return r;const h=(...g)=>{h._d&&bv(-1);const y=Ep(o),E=r(...g);return Ep(y),h._d&&bv(1),E};return h._n=!0,h._c=!0,h._d=!0,h}function Om(r){const{type:o,vnode:l,proxy:h,withProxy:g,props:y,propsOptions:[E],slots:s,attrs:C,emit:k,render:M,renderCache:D,data:R,setupState:U,ctx:ge,inheritAttrs:Ee}=r;let be,we;const De=Ep(r);try{if(l.shapeFlag&4){const Ue=g||h;be=Ho(M.call(Ue,Ue,D,y,U,R,ge)),we=C}else{const Ue=o;be=Ho(Ue.length>1?Ue(y,{attrs:C,slots:s,emit:k}):Ue(y,null)),we=o.props?C:vS(C)}}catch(Ue){th.length=0,$p(Ue,r,1),be=Bt(To)}let Xe=be;if(we&&Ee!==!1){const Ue=Object.keys(we),{shapeFlag:st}=Xe;Ue.length&&st&7&&(E&&Ue.some(t_)&&(we=xS(we,E)),Xe=Cc(Xe,we))}return l.dirs&&(Xe.dirs=Xe.dirs?Xe.dirs.concat(l.dirs):l.dirs),l.transition&&(Xe.transition=l.transition),be=Xe,Ep(De),be}const vS=r=>{let o;for(const l in r)(l==="class"||l==="style"||Fp(l))&&((o||(o={}))[l]=r[l]);return o},xS=(r,o)=>{const l={};for(const h in r)(!t_(h)||!(h.slice(9)in o))&&(l[h]=r[h]);return l};function bS(r,o,l){const{props:h,children:g,component:y}=r,{props:E,children:s,patchFlag:C}=o,k=y.emitsOptions;if(o.dirs||o.transition)return!0;if(l&&C>=0){if(C&1024)return!0;if(C&16)return h?uv(h,E,k):!!E;if(C&8){const M=o.dynamicProps;for(let D=0;D<M.length;D++){const R=M[D];if(E[R]!==h[R]&&!f_(k,R))return!0}}}else return(g||s)&&(!s||!s.$stable)?!0:h===E?!1:h?E?uv(h,E,k):!0:!!E;return!1}function uv(r,o,l){const h=Object.keys(o);if(h.length!==Object.keys(r).length)return!0;for(let g=0;g<h.length;g++){const y=h[g];if(o[y]!==r[y]&&!f_(l,y))return!0}return!1}function wS({vnode:r,parent:o},l){for(;o&&o.subTree===r;)(r=o.vnode).el=l,o=o.parent}const TS=r=>r.__isSuspense;function ES(r,o){o&&o.pendingBranch?Kt(r)?o.effects.push(...r):o.effects.push(r):gS(r)}function pp(r,o){if(Fn){let l=Fn.provides;const h=Fn.parent&&Fn.parent.provides;h===l&&(l=Fn.provides=Object.create(h)),l[r]=o}}function Ko(r,o,l=!1){const h=Fn||to;if(h){const g=h.parent==null?h.vnode.appContext&&h.vnode.appContext.provides:h.parent.provides;if(g&&r in g)return g[r];if(arguments.length>1)return l&&_i(o)?o.call(h.proxy):o}}function SS(r,o){return m_(r,null,{flush:"post"})}const hv={};function wo(r,o,l){return m_(r,o,l)}function m_(r,o,{immediate:l,deep:h,flush:g,onTrack:y,onTrigger:E}=Xi){const s=Fn;let C,k=!1,M=!1;if(Nn(r)?(C=()=>r.value,k=R1(r)):Sc(r)?(C=()=>r,h=!0):Kt(r)?(M=!0,k=r.some(Sc),C=()=>r.map(we=>{if(Nn(we))return we.value;if(Sc(we))return wc(we);if(_i(we))return sa(we,s,2)})):_i(r)?o?C=()=>sa(r,s,2):C=()=>{if(!(s&&s.isUnmounted))return D&&D(),io(r,s,3,[R])}:C=xo,o&&h){const we=C;C=()=>wc(we())}let D,R=we=>{D=be.onStop=()=>{sa(we,s,4)}};if(gh)return R=xo,o?l&&io(o,s,3,[C(),M?[]:void 0,R]):C(),xo;let U=M?[]:hv;const ge=()=>{if(!!be.active)if(o){const we=be.run();(h||k||(M?we.some((De,Xe)=>uh(De,U[Xe])):uh(we,U)))&&(D&&D(),io(o,s,3,[we,U===hv?void 0:U,R]),U=we)}else be.run()};ge.allowRecurse=!!o;let Ee;g==="sync"?Ee=ge:g==="post"?Ee=()=>Tr(ge,s&&s.suspense):Ee=()=>{!s||s.isMounted?mS(ge):ge()};const be=new s_(C,Ee);return o?l?ge():U=be.run():g==="post"?Tr(be.run.bind(be),s&&s.suspense):be.run(),()=>{be.stop(),s&&s.scope&&i_(s.scope.effects,be)}}function CS(r,o,l){const h=this.proxy,g=En(r)?r.includes(".")?X1(h,r):()=>h[r]:r.bind(h,h);let y;_i(o)?y=o:(y=o.handler,l=o);const E=Fn;Ac(this);const s=m_(g,y.bind(h),l);return E?Ac(E):il(),s}function X1(r,o){const l=o.split(".");return()=>{let h=r;for(let g=0;g<l.length&&h;g++)h=h[l[g]];return h}}function wc(r,o){if(!Sn(r)||r.__v_skip||(o=o||new Set,o.has(r)))return r;if(o.add(r),Nn(r))wc(r.value,o);else if(Kt(r))for(let l=0;l<r.length;l++)wc(r[l],o);else if(v1(r)||Ec(r))r.forEach(l=>{wc(l,o)});else if(w1(r))for(const l in r)wc(r[l],o);return r}function AS(){const r={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Oc(()=>{r.isMounted=!0}),bh(()=>{r.isUnmounting=!0}),r}const Qr=[Function,Array],MS={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Qr,onEnter:Qr,onAfterEnter:Qr,onEnterCancelled:Qr,onBeforeLeave:Qr,onLeave:Qr,onAfterLeave:Qr,onLeaveCancelled:Qr,onBeforeAppear:Qr,onAppear:Qr,onAfterAppear:Qr,onAppearCancelled:Qr},setup(r,{slots:o}){const l=_b(),h=AS();let g;return()=>{const y=o.default&&J1(o.default(),!0);if(!y||!y.length)return;const E=Oi(r),{mode:s}=E,C=y[0];if(h.isLeaving)return Bm(C);const k=dv(C);if(!k)return Bm(C);const M=bg(k,E,h,l);wg(k,M);const D=l.subTree,R=D&&dv(D);let U=!1;const{getTransitionKey:ge}=k.type;if(ge){const Ee=ge();g===void 0?g=Ee:Ee!==g&&(g=Ee,U=!0)}if(R&&R.type!==To&&(!Ja(k,R)||U)){const Ee=bg(R,E,h,l);if(wg(R,Ee),s==="out-in")return h.isLeaving=!0,Ee.afterLeave=()=>{h.isLeaving=!1,l.update()},Bm(C);s==="in-out"&&k.type!==To&&(Ee.delayLeave=(be,we,De)=>{const Xe=Y1(h,R);Xe[String(R.key)]=R,be._leaveCb=()=>{we(),be._leaveCb=void 0,delete M.delayedLeave},M.delayedLeave=De})}return C}}},K1=MS;function Y1(r,o){const{leavingVNodes:l}=r;let h=l.get(o.type);return h||(h=Object.create(null),l.set(o.type,h)),h}function bg(r,o,l,h){const{appear:g,mode:y,persisted:E=!1,onBeforeEnter:s,onEnter:C,onAfterEnter:k,onEnterCancelled:M,onBeforeLeave:D,onLeave:R,onAfterLeave:U,onLeaveCancelled:ge,onBeforeAppear:Ee,onAppear:be,onAfterAppear:we,onAppearCancelled:De}=o,Xe=String(r.key),Ue=Y1(l,r),st=(lt,It)=>{lt&&io(lt,h,9,It)},ut={mode:y,persisted:E,beforeEnter(lt){let It=s;if(!l.isMounted)if(g)It=Ee||s;else return;lt._leaveCb&&lt._leaveCb(!0);const Ft=Ue[Xe];Ft&&Ja(r,Ft)&&Ft.el._leaveCb&&Ft.el._leaveCb(),st(It,[lt])},enter(lt){let It=C,Ft=k,Ct=M;if(!l.isMounted)if(g)It=be||C,Ft=we||k,Ct=De||M;else return;let Tt=!1;const ot=lt._enterCb=Nt=>{Tt||(Tt=!0,Nt?st(Ct,[lt]):st(Ft,[lt]),ut.delayedLeave&&ut.delayedLeave(),lt._enterCb=void 0)};It?(It(lt,ot),It.length<=1&&ot()):ot()},leave(lt,It){const Ft=String(r.key);if(lt._enterCb&&lt._enterCb(!0),l.isUnmounting)return It();st(D,[lt]);let Ct=!1;const Tt=lt._leaveCb=ot=>{Ct||(Ct=!0,It(),ot?st(ge,[lt]):st(U,[lt]),lt._leaveCb=void 0,Ue[Ft]===r&&delete Ue[Ft])};Ue[Ft]=r,R?(R(lt,Tt),R.length<=1&&Tt()):Tt()},clone(lt){return bg(lt,o,l,h)}};return ut}function Bm(r){if(qp(r))return r=Cc(r),r.children=null,r}function dv(r){return qp(r)?r.children?r.children[0]:void 0:r}function wg(r,o){r.shapeFlag&6&&r.component?wg(r.component.subTree,o):r.shapeFlag&128?(r.ssContent.transition=o.clone(r.ssContent),r.ssFallback.transition=o.clone(r.ssFallback)):r.transition=o}function J1(r,o=!1){let l=[],h=0;for(let g=0;g<r.length;g++){const y=r[g];y.type===Or?(y.patchFlag&128&&h++,l=l.concat(J1(y.children,o))):(o||y.type!==To)&&l.push(y)}if(h>1)for(let g=0;g<l.length;g++)l[g].patchFlag=-2;return l}function xh(r){return _i(r)?{setup:r,name:r.name}:r}const Tg=r=>!!r.type.__asyncLoader,qp=r=>r.type.__isKeepAlive;function IS(r,o){Q1(r,"a",o)}function kS(r,o){Q1(r,"da",o)}function Q1(r,o,l=Fn){const h=r.__wdc||(r.__wdc=()=>{let g=l;for(;g;){if(g.isDeactivated)return;g=g.parent}return r()});if(Zp(o,h,l),l){let g=l.parent;for(;g&&g.parent;)qp(g.parent.vnode)&&zS(h,o,l,g),g=g.parent}}function zS(r,o,l,h){const g=Zp(o,r,h,!0);__(()=>{i_(h[o],g)},l)}function Zp(r,o,l=Fn,h=!1){if(l){const g=l[r]||(l[r]=[]),y=o.__weh||(o.__weh=(...E)=>{if(l.isUnmounted)return;Lc(),Ac(l);const s=io(o,l,r,E);return il(),Rc(),s});return h?g.unshift(y):g.push(y),y}}const ys=r=>(o,l=Fn)=>(!gh||r==="sp")&&Zp(r,o,l),PS=ys("bm"),Oc=ys("m"),eb=ys("bu"),g_=ys("u"),bh=ys("bum"),__=ys("um"),DS=ys("sp"),LS=ys("rtg"),RS=ys("rtc");function OS(r,o=Fn){Zp("ec",r,o)}let Eg=!0;function BS(r){const o=ib(r),l=r.proxy,h=r.ctx;Eg=!1,o.beforeCreate&&pv(o.beforeCreate,r,"bc");const{data:g,computed:y,methods:E,watch:s,provide:C,inject:k,created:M,beforeMount:D,mounted:R,beforeUpdate:U,updated:ge,activated:Ee,deactivated:be,beforeDestroy:we,beforeUnmount:De,destroyed:Xe,unmounted:Ue,render:st,renderTracked:ut,renderTriggered:lt,errorCaptured:It,serverPrefetch:Ft,expose:Ct,inheritAttrs:Tt,components:ot,directives:Nt,filters:Ai}=o;if(k&&FS(k,h,null,r.appContext.config.unwrapInjectedRef),E)for(const qt in E){const ei=E[qt];_i(ei)&&(h[qt]=ei.bind(l))}if(g){const qt=g.call(l,l);Sn(qt)&&(r.data=bo(qt))}if(Eg=!0,y)for(const qt in y){const ei=y[qt],Si=_i(ei)?ei.bind(l,l):_i(ei.get)?ei.get.bind(l,l):xo,Qi=!_i(ei)&&_i(ei.set)?ei.set.bind(l):xo,Et=hr({get:Si,set:Qi});Object.defineProperty(h,qt,{enumerable:!0,configurable:!0,get:()=>Et.value,set:en=>Et.value=en})}if(s)for(const qt in s)tb(s[qt],h,l,qt);if(C){const qt=_i(C)?C.call(l):C;Reflect.ownKeys(qt).forEach(ei=>{pp(ei,qt[ei])})}M&&pv(M,r,"c");function ri(qt,ei){Kt(ei)?ei.forEach(Si=>qt(Si.bind(l))):ei&&qt(ei.bind(l))}if(ri(PS,D),ri(Oc,R),ri(eb,U),ri(g_,ge),ri(IS,Ee),ri(kS,be),ri(OS,It),ri(RS,ut),ri(LS,lt),ri(bh,De),ri(__,Ue),ri(DS,Ft),Kt(Ct))if(Ct.length){const qt=r.exposed||(r.exposed={});Ct.forEach(ei=>{Object.defineProperty(qt,ei,{get:()=>l[ei],set:Si=>l[ei]=Si})})}else r.exposed||(r.exposed={});st&&r.render===xo&&(r.render=st),Tt!=null&&(r.inheritAttrs=Tt),ot&&(r.components=ot),Nt&&(r.directives=Nt)}function FS(r,o,l=xo,h=!1){Kt(r)&&(r=Sg(r));for(const g in r){const y=r[g];let E;Sn(y)?"default"in y?E=Ko(y.from||g,y.default,!0):E=Ko(y.from||g):E=Ko(y),Nn(E)&&h?Object.defineProperty(o,g,{enumerable:!0,configurable:!0,get:()=>E.value,set:s=>E.value=s}):o[g]=E}}function pv(r,o,l){io(Kt(r)?r.map(h=>h.bind(o.proxy)):r.bind(o.proxy),o,l)}function tb(r,o,l,h){const g=h.includes(".")?X1(l,h):()=>l[h];if(En(r)){const y=o[r];_i(y)&&wo(g,y)}else if(_i(r))wo(g,r.bind(l));else if(Sn(r))if(Kt(r))r.forEach(y=>tb(y,o,l,h));else{const y=_i(r.handler)?r.handler.bind(l):o[r.handler];_i(y)&&wo(g,y,r)}}function ib(r){const o=r.type,{mixins:l,extends:h}=o,{mixins:g,optionsCache:y,config:{optionMergeStrategies:E}}=r.appContext,s=y.get(o);let C;return s?C=s:!g.length&&!l&&!h?C=o:(C={},g.length&&g.forEach(k=>Sp(C,k,E,!0)),Sp(C,o,E)),y.set(o,C),C}function Sp(r,o,l,h=!1){const{mixins:g,extends:y}=o;y&&Sp(r,y,l,!0),g&&g.forEach(E=>Sp(r,E,l,!0));for(const E in o)if(!(h&&E==="expose")){const s=NS[E]||l&&l[E];r[E]=s?s(r[E],o[E]):o[E]}return r}const NS={data:fv,props:Ya,emits:Ya,methods:Ya,computed:Ya,beforeCreate:cr,created:cr,beforeMount:cr,mounted:cr,beforeUpdate:cr,updated:cr,beforeDestroy:cr,beforeUnmount:cr,destroyed:cr,unmounted:cr,activated:cr,deactivated:cr,errorCaptured:cr,serverPrefetch:cr,components:Ya,directives:Ya,watch:jS,provide:fv,inject:US};function fv(r,o){return o?r?function(){return Wn(_i(r)?r.call(this,this):r,_i(o)?o.call(this,this):o)}:o:r}function US(r,o){return Ya(Sg(r),Sg(o))}function Sg(r){if(Kt(r)){const o={};for(let l=0;l<r.length;l++)o[r[l]]=r[l];return o}return r}function cr(r,o){return r?[...new Set([].concat(r,o))]:o}function Ya(r,o){return r?Wn(Wn(Object.create(null),r),o):o}function jS(r,o){if(!r)return o;if(!o)return r;const l=Wn(Object.create(null),r);for(const h in o)l[h]=cr(r[h],o[h]);return l}function VS(r,o,l,h=!1){const g={},y={};wp(y,Wp,1),r.propsDefaults=Object.create(null),nb(r,o,g,y);for(const E in r.propsOptions[0])E in g||(g[E]=void 0);l?r.props=h?g:rS(g):r.type.props?r.props=g:r.props=y,r.attrs=y}function $S(r,o,l,h){const{props:g,attrs:y,vnode:{patchFlag:E}}=r,s=Oi(g),[C]=r.propsOptions;let k=!1;if((h||E>0)&&!(E&16)){if(E&8){const M=r.vnode.dynamicProps;for(let D=0;D<M.length;D++){let R=M[D];const U=o[R];if(C)if(zi(y,R))U!==y[R]&&(y[R]=U,k=!0);else{const ge=Yo(R);g[ge]=Cg(C,s,ge,U,r,!1)}else U!==y[R]&&(y[R]=U,k=!0)}}}else{nb(r,o,g,y)&&(k=!0);let M;for(const D in s)(!o||!zi(o,D)&&((M=Dc(D))===D||!zi(o,M)))&&(C?l&&(l[D]!==void 0||l[M]!==void 0)&&(g[D]=Cg(C,s,D,void 0,r,!0)):delete g[D]);if(y!==s)for(const D in y)(!o||!zi(o,D)&&!0)&&(delete y[D],k=!0)}k&&ms(r,"set","$attrs")}function nb(r,o,l,h){const[g,y]=r.propsOptions;let E=!1,s;if(o)for(let C in o){if(dp(C))continue;const k=o[C];let M;g&&zi(g,M=Yo(C))?!y||!y.includes(M)?l[M]=k:(s||(s={}))[M]=k:f_(r.emitsOptions,C)||(!(C in h)||k!==h[C])&&(h[C]=k,E=!0)}if(y){const C=Oi(l),k=s||Xi;for(let M=0;M<y.length;M++){const D=y[M];l[D]=Cg(g,C,D,k[D],r,!zi(k,D))}}return E}function Cg(r,o,l,h,g,y){const E=r[l];if(E!=null){const s=zi(E,"default");if(s&&h===void 0){const C=E.default;if(E.type!==Function&&_i(C)){const{propsDefaults:k}=g;l in k?h=k[l]:(Ac(g),h=k[l]=C.call(null,o),il())}else h=C}E[0]&&(y&&!s?h=!1:E[1]&&(h===""||h===Dc(l))&&(h=!0))}return h}function rb(r,o,l=!1){const h=o.propsCache,g=h.get(r);if(g)return g;const y=r.props,E={},s=[];let C=!1;if(!_i(r)){const M=D=>{C=!0;const[R,U]=rb(D,o,!0);Wn(E,R),U&&s.push(...U)};!l&&o.mixins.length&&o.mixins.forEach(M),r.extends&&M(r.extends),r.mixins&&r.mixins.forEach(M)}if(!y&&!C)return h.set(r,Tc),Tc;if(Kt(y))for(let M=0;M<y.length;M++){const D=Yo(y[M]);mv(D)&&(E[D]=Xi)}else if(y)for(const M in y){const D=Yo(M);if(mv(D)){const R=y[M],U=E[D]=Kt(R)||_i(R)?{type:R}:R;if(U){const ge=yv(Boolean,U.type),Ee=yv(String,U.type);U[0]=ge>-1,U[1]=Ee<0||ge<Ee,(ge>-1||zi(U,"default"))&&s.push(D)}}}const k=[E,s];return h.set(r,k),k}function mv(r){return r[0]!=="$"}function gv(r){const o=r&&r.toString().match(/^\s*function (\w+)/);return o?o[1]:r===null?"null":""}function _v(r,o){return gv(r)===gv(o)}function yv(r,o){return Kt(o)?o.findIndex(l=>_v(l,r)):_i(o)&&_v(o,r)?0:-1}const ob=r=>r[0]==="_"||r==="$stable",y_=r=>Kt(r)?r.map(Ho):[Ho(r)],GS=(r,o,l)=>{const h=yS((...g)=>y_(o(...g)),l);return h._c=!1,h},sb=(r,o,l)=>{const h=r._ctx;for(const g in r){if(ob(g))continue;const y=r[g];if(_i(y))o[g]=GS(g,y,h);else if(y!=null){const E=y_(y);o[g]=()=>E}}},ab=(r,o)=>{const l=y_(o);r.slots.default=()=>l},qS=(r,o)=>{if(r.vnode.shapeFlag&32){const l=o._;l?(r.slots=Oi(o),wp(o,"_",l)):sb(o,r.slots={})}else r.slots={},o&&ab(r,o);wp(r.slots,Wp,1)},ZS=(r,o,l)=>{const{vnode:h,slots:g}=r;let y=!0,E=Xi;if(h.shapeFlag&32){const s=o._;s?l&&s===1?y=!1:(Wn(g,o),!l&&s===1&&delete g._):(y=!o.$stable,sb(o,g)),E=o}else o&&(ab(r,o),E={default:1});if(y)for(const s in g)!ob(s)&&!(s in E)&&delete g[s]};function qa(r,o,l,h){const g=r.dirs,y=o&&o.dirs;for(let E=0;E<g.length;E++){const s=g[E];y&&(s.oldValue=y[E].value);let C=s.dir[h];C&&(Lc(),io(C,l,8,[r.el,s,r,o]),Rc())}}function lb(){return{app:null,config:{isNativeTag:wE,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let WS=0;function HS(r,o){return function(h,g=null){g!=null&&!Sn(g)&&(g=null);const y=lb(),E=new Set;let s=!1;const C=y.app={_uid:WS++,_component:h,_props:g,_container:null,_context:y,_instance:null,version:_C,get config(){return y.config},set config(k){},use(k,...M){return E.has(k)||(k&&_i(k.install)?(E.add(k),k.install(C,...M)):_i(k)&&(E.add(k),k(C,...M))),C},mixin(k){return y.mixins.includes(k)||y.mixins.push(k),C},component(k,M){return M?(y.components[k]=M,C):y.components[k]},directive(k,M){return M?(y.directives[k]=M,C):y.directives[k]},mount(k,M,D){if(!s){const R=Bt(h,g);return R.appContext=y,M&&o?o(R,k):r(R,k,D),s=!0,C._container=k,k.__vue_app__=C,T_(R.component)||R.component.proxy}},unmount(){s&&(r(null,C._container),delete C._container.__vue_app__)},provide(k,M){return y.provides[k]=M,C}};return C}}function Ag(r,o,l,h,g=!1){if(Kt(r)){r.forEach((R,U)=>Ag(R,o&&(Kt(o)?o[U]:o),l,h,g));return}if(Tg(h)&&!g)return;const y=h.shapeFlag&4?T_(h.component)||h.component.proxy:h.el,E=g?null:y,{i:s,r:C}=r,k=o&&o.r,M=s.refs===Xi?s.refs={}:s.refs,D=s.setupState;if(k!=null&&k!==C&&(En(k)?(M[k]=null,zi(D,k)&&(D[k]=null)):Nn(k)&&(k.value=null)),_i(C))sa(C,s,12,[E,M]);else{const R=En(C),U=Nn(C);if(R||U){const ge=()=>{if(r.f){const Ee=R?M[C]:C.value;g?Kt(Ee)&&i_(Ee,y):Kt(Ee)?Ee.includes(y)||Ee.push(y):R?M[C]=[y]:(C.value=[y],r.k&&(M[r.k]=C.value))}else R?(M[C]=E,zi(D,C)&&(D[C]=E)):Nn(C)&&(C.value=E,r.k&&(M[r.k]=E))};E?(ge.id=-1,Tr(ge,l)):ge()}}}const Tr=ES;function XS(r){return KS(r)}function KS(r,o){const l=ME();l.__VUE__=!0;const{insert:h,remove:g,patchProp:y,createElement:E,createText:s,createComment:C,setText:k,setElementText:M,parentNode:D,nextSibling:R,setScopeId:U=xo,cloneNode:ge,insertStaticContent:Ee}=r,be=(te,ae,Ce,Ie=null,Ve=null,Ke=null,ht=!1,Ne=null,tt=!!ae.dynamicChildren)=>{if(te===ae)return;te&&!Ja(te,ae)&&(Ie=At(te),ti(te,Ve,Ke,!0),te=null),ae.patchFlag===-2&&(tt=!1,ae.dynamicChildren=null);const{type:Ze,ref:Mt,shapeFlag:wt}=ae;switch(Ze){case b_:we(te,ae,Ce,Ie);break;case To:De(te,ae,Ce,Ie);break;case fp:te==null&&Xe(ae,Ce,Ie,ht);break;case Or:Nt(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt);break;default:wt&1?ut(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt):wt&6?Ai(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt):(wt&64||wt&128)&&Ze.process(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt,pi)}Mt!=null&&Ve&&Ag(Mt,te&&te.ref,Ke,ae||te,!ae)},we=(te,ae,Ce,Ie)=>{if(te==null)h(ae.el=s(ae.children),Ce,Ie);else{const Ve=ae.el=te.el;ae.children!==te.children&&k(Ve,ae.children)}},De=(te,ae,Ce,Ie)=>{te==null?h(ae.el=C(ae.children||""),Ce,Ie):ae.el=te.el},Xe=(te,ae,Ce,Ie)=>{[te.el,te.anchor]=Ee(te.children,ae,Ce,Ie,te.el,te.anchor)},Ue=({el:te,anchor:ae},Ce,Ie)=>{let Ve;for(;te&&te!==ae;)Ve=R(te),h(te,Ce,Ie),te=Ve;h(ae,Ce,Ie)},st=({el:te,anchor:ae})=>{let Ce;for(;te&&te!==ae;)Ce=R(te),g(te),te=Ce;g(ae)},ut=(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt)=>{ht=ht||ae.type==="svg",te==null?lt(ae,Ce,Ie,Ve,Ke,ht,Ne,tt):Ct(te,ae,Ve,Ke,ht,Ne,tt)},lt=(te,ae,Ce,Ie,Ve,Ke,ht,Ne)=>{let tt,Ze;const{type:Mt,props:wt,shapeFlag:dt,transition:Lt,patchFlag:Zt,dirs:hi}=te;if(te.el&&ge!==void 0&&Zt===-1)tt=te.el=ge(te.el);else{if(tt=te.el=E(te.type,Ke,wt&&wt.is,wt),dt&8?M(tt,te.children):dt&16&&Ft(te.children,tt,null,Ie,Ve,Ke&&Mt!=="foreignObject",ht,Ne),hi&&qa(te,null,Ie,"created"),wt){for(const oi in wt)oi!=="value"&&!dp(oi)&&y(tt,oi,null,wt[oi],Ke,te.children,Ie,Ve,rt);"value"in wt&&y(tt,"value",null,wt.value),(Ze=wt.onVnodeBeforeMount)&&Zo(Ze,Ie,te)}It(tt,te,te.scopeId,ht,Ie)}hi&&qa(te,null,Ie,"beforeMount");const Wt=(!Ve||Ve&&!Ve.pendingBranch)&&Lt&&!Lt.persisted;Wt&&Lt.beforeEnter(tt),h(tt,ae,Ce),((Ze=wt&&wt.onVnodeMounted)||Wt||hi)&&Tr(()=>{Ze&&Zo(Ze,Ie,te),Wt&&Lt.enter(tt),hi&&qa(te,null,Ie,"mounted")},Ve)},It=(te,ae,Ce,Ie,Ve)=>{if(Ce&&U(te,Ce),Ie)for(let Ke=0;Ke<Ie.length;Ke++)U(te,Ie[Ke]);if(Ve){let Ke=Ve.subTree;if(ae===Ke){const ht=Ve.vnode;It(te,ht,ht.scopeId,ht.slotScopeIds,Ve.parent)}}},Ft=(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt=0)=>{for(let Ze=tt;Ze<te.length;Ze++){const Mt=te[Ze]=Ne?ta(te[Ze]):Ho(te[Ze]);be(null,Mt,ae,Ce,Ie,Ve,Ke,ht,Ne)}},Ct=(te,ae,Ce,Ie,Ve,Ke,ht)=>{const Ne=ae.el=te.el;let{patchFlag:tt,dynamicChildren:Ze,dirs:Mt}=ae;tt|=te.patchFlag&16;const wt=te.props||Xi,dt=ae.props||Xi;let Lt;Ce&&Za(Ce,!1),(Lt=dt.onVnodeBeforeUpdate)&&Zo(Lt,Ce,ae,te),Mt&&qa(ae,te,Ce,"beforeUpdate"),Ce&&Za(Ce,!0);const Zt=Ve&&ae.type!=="foreignObject";if(Ze?Tt(te.dynamicChildren,Ze,Ne,Ce,Ie,Zt,Ke):ht||Si(te,ae,Ne,null,Ce,Ie,Zt,Ke,!1),tt>0){if(tt&16)ot(Ne,ae,wt,dt,Ce,Ie,Ve);else if(tt&2&&wt.class!==dt.class&&y(Ne,"class",null,dt.class,Ve),tt&4&&y(Ne,"style",wt.style,dt.style,Ve),tt&8){const hi=ae.dynamicProps;for(let Wt=0;Wt<hi.length;Wt++){const oi=hi[Wt],Ki=wt[oi],Cn=dt[oi];(Cn!==Ki||oi==="value")&&y(Ne,oi,Ki,Cn,Ve,te.children,Ce,Ie,rt)}}tt&1&&te.children!==ae.children&&M(Ne,ae.children)}else!ht&&Ze==null&&ot(Ne,ae,wt,dt,Ce,Ie,Ve);((Lt=dt.onVnodeUpdated)||Mt)&&Tr(()=>{Lt&&Zo(Lt,Ce,ae,te),Mt&&qa(ae,te,Ce,"updated")},Ie)},Tt=(te,ae,Ce,Ie,Ve,Ke,ht)=>{for(let Ne=0;Ne<ae.length;Ne++){const tt=te[Ne],Ze=ae[Ne],Mt=tt.el&&(tt.type===Or||!Ja(tt,Ze)||tt.shapeFlag&70)?D(tt.el):Ce;be(tt,Ze,Mt,null,Ie,Ve,Ke,ht,!0)}},ot=(te,ae,Ce,Ie,Ve,Ke,ht)=>{if(Ce!==Ie){for(const Ne in Ie){if(dp(Ne))continue;const tt=Ie[Ne],Ze=Ce[Ne];tt!==Ze&&Ne!=="value"&&y(te,Ne,Ze,tt,ht,ae.children,Ve,Ke,rt)}if(Ce!==Xi)for(const Ne in Ce)!dp(Ne)&&!(Ne in Ie)&&y(te,Ne,Ce[Ne],null,ht,ae.children,Ve,Ke,rt);"value"in Ie&&y(te,"value",Ce.value,Ie.value)}},Nt=(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt)=>{const Ze=ae.el=te?te.el:s(""),Mt=ae.anchor=te?te.anchor:s("");let{patchFlag:wt,dynamicChildren:dt,slotScopeIds:Lt}=ae;Lt&&(Ne=Ne?Ne.concat(Lt):Lt),te==null?(h(Ze,Ce,Ie),h(Mt,Ce,Ie),Ft(ae.children,Ce,Mt,Ve,Ke,ht,Ne,tt)):wt>0&&wt&64&&dt&&te.dynamicChildren?(Tt(te.dynamicChildren,dt,Ce,Ve,Ke,ht,Ne),(ae.key!=null||Ve&&ae===Ve.subTree)&&v_(te,ae,!0)):Si(te,ae,Ce,Mt,Ve,Ke,ht,Ne,tt)},Ai=(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt)=>{ae.slotScopeIds=Ne,te==null?ae.shapeFlag&512?Ve.ctx.activate(ae,Ce,Ie,ht,tt):Zi(ae,Ce,Ie,Ve,Ke,ht,tt):ri(te,ae,tt)},Zi=(te,ae,Ce,Ie,Ve,Ke,ht)=>{const Ne=te.component=uC(te,Ie,Ve);if(qp(te)&&(Ne.ctx.renderer=pi),hC(Ne),Ne.asyncDep){if(Ve&&Ve.registerDep(Ne,qt),!te.el){const tt=Ne.subTree=Bt(To);De(null,tt,ae,Ce)}return}qt(Ne,te,ae,Ce,Ve,Ke,ht)},ri=(te,ae,Ce)=>{const Ie=ae.component=te.component;if(bS(te,ae,Ce))if(Ie.asyncDep&&!Ie.asyncResolved){ei(Ie,ae,Ce);return}else Ie.next=ae,fS(Ie.update),Ie.update();else ae.component=te.component,ae.el=te.el,Ie.vnode=ae},qt=(te,ae,Ce,Ie,Ve,Ke,ht)=>{const Ne=()=>{if(te.isMounted){let{next:Mt,bu:wt,u:dt,parent:Lt,vnode:Zt}=te,hi=Mt,Wt;Za(te,!1),Mt?(Mt.el=Zt.el,ei(te,Mt,ht)):Mt=Zt,wt&&Rm(wt),(Wt=Mt.props&&Mt.props.onVnodeBeforeUpdate)&&Zo(Wt,Lt,Mt,Zt),Za(te,!0);const oi=Om(te),Ki=te.subTree;te.subTree=oi,be(Ki,oi,D(Ki.el),At(Ki),te,Ve,Ke),Mt.el=oi.el,hi===null&&wS(te,oi.el),dt&&Tr(dt,Ve),(Wt=Mt.props&&Mt.props.onVnodeUpdated)&&Tr(()=>Zo(Wt,Lt,Mt,Zt),Ve)}else{let Mt;const{el:wt,props:dt}=ae,{bm:Lt,m:Zt,parent:hi}=te,Wt=Tg(ae);if(Za(te,!1),Lt&&Rm(Lt),!Wt&&(Mt=dt&&dt.onVnodeBeforeMount)&&Zo(Mt,hi,ae),Za(te,!0),wt&&We){const oi=()=>{te.subTree=Om(te),We(wt,te.subTree,te,Ve,null)};Wt?ae.type.__asyncLoader().then(()=>!te.isUnmounted&&oi()):oi()}else{const oi=te.subTree=Om(te);be(null,oi,Ce,Ie,te,Ve,Ke),ae.el=oi.el}if(Zt&&Tr(Zt,Ve),!Wt&&(Mt=dt&&dt.onVnodeMounted)){const oi=ae;Tr(()=>Zo(Mt,hi,oi),Ve)}ae.shapeFlag&256&&te.a&&Tr(te.a,Ve),te.isMounted=!0,ae=Ce=Ie=null}},tt=te.effect=new s_(Ne,()=>$1(te.update),te.scope),Ze=te.update=tt.run.bind(tt);Ze.id=te.uid,Za(te,!0),Ze()},ei=(te,ae,Ce)=>{ae.component=te;const Ie=te.vnode.props;te.vnode=ae,te.next=null,$S(te,ae.props,Ie,Ce),ZS(te,ae.children,Ce),Lc(),p_(void 0,te.update),Rc()},Si=(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt=!1)=>{const Ze=te&&te.children,Mt=te?te.shapeFlag:0,wt=ae.children,{patchFlag:dt,shapeFlag:Lt}=ae;if(dt>0){if(dt&128){Et(Ze,wt,Ce,Ie,Ve,Ke,ht,Ne,tt);return}else if(dt&256){Qi(Ze,wt,Ce,Ie,Ve,Ke,ht,Ne,tt);return}}Lt&8?(Mt&16&&rt(Ze,Ve,Ke),wt!==Ze&&M(Ce,wt)):Mt&16?Lt&16?Et(Ze,wt,Ce,Ie,Ve,Ke,ht,Ne,tt):rt(Ze,Ve,Ke,!0):(Mt&8&&M(Ce,""),Lt&16&&Ft(wt,Ce,Ie,Ve,Ke,ht,Ne,tt))},Qi=(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt)=>{te=te||Tc,ae=ae||Tc;const Ze=te.length,Mt=ae.length,wt=Math.min(Ze,Mt);let dt;for(dt=0;dt<wt;dt++){const Lt=ae[dt]=tt?ta(ae[dt]):Ho(ae[dt]);be(te[dt],Lt,Ce,null,Ve,Ke,ht,Ne,tt)}Ze>Mt?rt(te,Ve,Ke,!0,!1,wt):Ft(ae,Ce,Ie,Ve,Ke,ht,Ne,tt,wt)},Et=(te,ae,Ce,Ie,Ve,Ke,ht,Ne,tt)=>{let Ze=0;const Mt=ae.length;let wt=te.length-1,dt=Mt-1;for(;Ze<=wt&&Ze<=dt;){const Lt=te[Ze],Zt=ae[Ze]=tt?ta(ae[Ze]):Ho(ae[Ze]);if(Ja(Lt,Zt))be(Lt,Zt,Ce,null,Ve,Ke,ht,Ne,tt);else break;Ze++}for(;Ze<=wt&&Ze<=dt;){const Lt=te[wt],Zt=ae[dt]=tt?ta(ae[dt]):Ho(ae[dt]);if(Ja(Lt,Zt))be(Lt,Zt,Ce,null,Ve,Ke,ht,Ne,tt);else break;wt--,dt--}if(Ze>wt){if(Ze<=dt){const Lt=dt+1,Zt=Lt<Mt?ae[Lt].el:Ie;for(;Ze<=dt;)be(null,ae[Ze]=tt?ta(ae[Ze]):Ho(ae[Ze]),Ce,Zt,Ve,Ke,ht,Ne,tt),Ze++}}else if(Ze>dt)for(;Ze<=wt;)ti(te[Ze],Ve,Ke,!0),Ze++;else{const Lt=Ze,Zt=Ze,hi=new Map;for(Ze=Zt;Ze<=dt;Ze++){const Ni=ae[Ze]=tt?ta(ae[Ze]):Ho(ae[Ze]);Ni.key!=null&&hi.set(Ni.key,Ze)}let Wt,oi=0;const Ki=dt-Zt+1;let Cn=!1,fn=0;const Hn=new Array(Ki);for(Ze=0;Ze<Ki;Ze++)Hn[Ze]=0;for(Ze=Lt;Ze<=wt;Ze++){const Ni=te[Ze];if(oi>=Ki){ti(Ni,Ve,Ke,!0);continue}let Yt;if(Ni.key!=null)Yt=hi.get(Ni.key);else for(Wt=Zt;Wt<=dt;Wt++)if(Hn[Wt-Zt]===0&&Ja(Ni,ae[Wt])){Yt=Wt;break}Yt===void 0?ti(Ni,Ve,Ke,!0):(Hn[Yt-Zt]=Ze+1,Yt>=fn?fn=Yt:Cn=!0,be(Ni,ae[Yt],Ce,null,Ve,Ke,ht,Ne,tt),oi++)}const An=Cn?YS(Hn):Tc;for(Wt=An.length-1,Ze=Ki-1;Ze>=0;Ze--){const Ni=Zt+Ze,Yt=ae[Ni],Mn=Ni+1<Mt?ae[Ni+1].el:Ie;Hn[Ze]===0?be(null,Yt,Ce,Mn,Ve,Ke,ht,Ne,tt):Cn&&(Wt<0||Ze!==An[Wt]?en(Yt,Ce,Mn,2):Wt--)}}},en=(te,ae,Ce,Ie,Ve=null)=>{const{el:Ke,type:ht,transition:Ne,children:tt,shapeFlag:Ze}=te;if(Ze&6){en(te.component.subTree,ae,Ce,Ie);return}if(Ze&128){te.suspense.move(ae,Ce,Ie);return}if(Ze&64){ht.move(te,ae,Ce,pi);return}if(ht===Or){h(Ke,ae,Ce);for(let wt=0;wt<tt.length;wt++)en(tt[wt],ae,Ce,Ie);h(te.anchor,ae,Ce);return}if(ht===fp){Ue(te,ae,Ce);return}if(Ie!==2&&Ze&1&&Ne)if(Ie===0)Ne.beforeEnter(Ke),h(Ke,ae,Ce),Tr(()=>Ne.enter(Ke),Ve);else{const{leave:wt,delayLeave:dt,afterLeave:Lt}=Ne,Zt=()=>h(Ke,ae,Ce),hi=()=>{wt(Ke,()=>{Zt(),Lt&&Lt()})};dt?dt(Ke,Zt,hi):hi()}else h(Ke,ae,Ce)},ti=(te,ae,Ce,Ie=!1,Ve=!1)=>{const{type:Ke,props:ht,ref:Ne,children:tt,dynamicChildren:Ze,shapeFlag:Mt,patchFlag:wt,dirs:dt}=te;if(Ne!=null&&Ag(Ne,null,Ce,te,!0),Mt&256){ae.ctx.deactivate(te);return}const Lt=Mt&1&&dt,Zt=!Tg(te);let hi;if(Zt&&(hi=ht&&ht.onVnodeBeforeUnmount)&&Zo(hi,ae,te),Mt&6)yt(te.component,Ce,Ie);else{if(Mt&128){te.suspense.unmount(Ce,Ie);return}Lt&&qa(te,null,ae,"beforeUnmount"),Mt&64?te.type.remove(te,ae,Ce,Ve,pi,Ie):Ze&&(Ke!==Or||wt>0&&wt&64)?rt(Ze,ae,Ce,!1,!0):(Ke===Or&&wt&384||!Ve&&Mt&16)&&rt(tt,ae,Ce),Ie&&Dn(te)}(Zt&&(hi=ht&&ht.onVnodeUnmounted)||Lt)&&Tr(()=>{hi&&Zo(hi,ae,te),Lt&&qa(te,null,ae,"unmounted")},Ce)},Dn=te=>{const{type:ae,el:Ce,anchor:Ie,transition:Ve}=te;if(ae===Or){Be(Ce,Ie);return}if(ae===fp){st(te);return}const Ke=()=>{g(Ce),Ve&&!Ve.persisted&&Ve.afterLeave&&Ve.afterLeave()};if(te.shapeFlag&1&&Ve&&!Ve.persisted){const{leave:ht,delayLeave:Ne}=Ve,tt=()=>ht(Ce,Ke);Ne?Ne(te.el,Ke,tt):tt()}else Ke()},Be=(te,ae)=>{let Ce;for(;te!==ae;)Ce=R(te),g(te),te=Ce;g(ae)},yt=(te,ae,Ce)=>{const{bum:Ie,scope:Ve,update:Ke,subTree:ht,um:Ne}=te;Ie&&Rm(Ie),Ve.stop(),Ke&&(Ke.active=!1,ti(ht,te,ae,Ce)),Ne&&Tr(Ne,ae),Tr(()=>{te.isUnmounted=!0},ae),ae&&ae.pendingBranch&&!ae.isUnmounted&&te.asyncDep&&!te.asyncResolved&&te.suspenseId===ae.pendingId&&(ae.deps--,ae.deps===0&&ae.resolve())},rt=(te,ae,Ce,Ie=!1,Ve=!1,Ke=0)=>{for(let ht=Ke;ht<te.length;ht++)ti(te[ht],ae,Ce,Ie,Ve)},At=te=>te.shapeFlag&6?At(te.component.subTree):te.shapeFlag&128?te.suspense.next():R(te.anchor||te.el),ui=(te,ae,Ce)=>{te==null?ae._vnode&&ti(ae._vnode,null,null,!0):be(ae._vnode||null,te,ae,null,null,null,Ce),Z1(),ae._vnode=te},pi={p:be,um:ti,m:en,r:Dn,mt:Zi,mc:Ft,pc:Si,pbc:Tt,n:At,o:r};let Le,We;return o&&([Le,We]=o(pi)),{render:ui,hydrate:Le,createApp:HS(ui,Le)}}function Za({effect:r,update:o},l){r.allowRecurse=o.allowRecurse=l}function v_(r,o,l=!1){const h=r.children,g=o.children;if(Kt(h)&&Kt(g))for(let y=0;y<h.length;y++){const E=h[y];let s=g[y];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=g[y]=ta(g[y]),s.el=E.el),l||v_(E,s))}}function YS(r){const o=r.slice(),l=[0];let h,g,y,E,s;const C=r.length;for(h=0;h<C;h++){const k=r[h];if(k!==0){if(g=l[l.length-1],r[g]<k){o[h]=g,l.push(h);continue}for(y=0,E=l.length-1;y<E;)s=y+E>>1,r[l[s]]<k?y=s+1:E=s;k<r[l[y]]&&(y>0&&(o[h]=l[y-1]),l[y]=h)}}for(y=l.length,E=l[y-1];y-- >0;)l[y]=E,E=o[E];return l}const JS=r=>r.__isTeleport,eh=r=>r&&(r.disabled||r.disabled===""),vv=r=>typeof SVGElement!="undefined"&&r instanceof SVGElement,Mg=(r,o)=>{const l=r&&r.to;return En(l)?o?o(l):null:l},QS={__isTeleport:!0,process(r,o,l,h,g,y,E,s,C,k){const{mc:M,pc:D,pbc:R,o:{insert:U,querySelector:ge,createText:Ee,createComment:be}}=k,we=eh(o.props);let{shapeFlag:De,children:Xe,dynamicChildren:Ue}=o;if(r==null){const st=o.el=Ee(""),ut=o.anchor=Ee("");U(st,l,h),U(ut,l,h);const lt=o.target=Mg(o.props,ge),It=o.targetAnchor=Ee("");lt&&(U(It,lt),E=E||vv(lt));const Ft=(Ct,Tt)=>{De&16&&M(Xe,Ct,Tt,g,y,E,s,C)};we?Ft(l,ut):lt&&Ft(lt,It)}else{o.el=r.el;const st=o.anchor=r.anchor,ut=o.target=r.target,lt=o.targetAnchor=r.targetAnchor,It=eh(r.props),Ft=It?l:ut,Ct=It?st:lt;if(E=E||vv(ut),Ue?(R(r.dynamicChildren,Ue,Ft,g,y,E,s),v_(r,o,!0)):C||D(r,o,Ft,Ct,g,y,E,s,!1),we)It||ep(o,l,st,k,1);else if((o.props&&o.props.to)!==(r.props&&r.props.to)){const Tt=o.target=Mg(o.props,ge);Tt&&ep(o,Tt,null,k,0)}else It&&ep(o,ut,lt,k,1)}},remove(r,o,l,h,{um:g,o:{remove:y}},E){const{shapeFlag:s,children:C,anchor:k,targetAnchor:M,target:D,props:R}=r;if(D&&y(M),(E||!eh(R))&&(y(k),s&16))for(let U=0;U<C.length;U++){const ge=C[U];g(ge,o,l,!0,!!ge.dynamicChildren)}},move:ep,hydrate:eC};function ep(r,o,l,{o:{insert:h},m:g},y=2){y===0&&h(r.targetAnchor,o,l);const{el:E,anchor:s,shapeFlag:C,children:k,props:M}=r,D=y===2;if(D&&h(E,o,l),(!D||eh(M))&&C&16)for(let R=0;R<k.length;R++)g(k[R],o,l,2);D&&h(s,o,l)}function eC(r,o,l,h,g,y,{o:{nextSibling:E,parentNode:s,querySelector:C}},k){const M=o.target=Mg(o.props,C);if(M){const D=M._lpa||M.firstChild;o.shapeFlag&16&&(eh(o.props)?(o.anchor=k(E(r),o,s(r),l,h,g,y),o.targetAnchor=D):(o.anchor=E(r),o.targetAnchor=k(D,o,M,l,h,g,y)),M._lpa=o.targetAnchor&&E(o.targetAnchor))}return o.anchor&&E(o.anchor)}const tC=QS,x_="components";function ZL(r,o){return ub(x_,r,!0,o)||r}const cb=Symbol();function WL(r){return En(r)?ub(x_,r,!1)||r:r||cb}function ub(r,o,l=!0,h=!1){const g=to||Fn;if(g){const y=g.type;if(r===x_){const s=mC(y);if(s&&(s===o||s===Yo(o)||s===jp(Yo(o))))return y}const E=xv(g[r]||y[r],o)||xv(g.appContext[r],o);return!E&&h?y:E}}function xv(r,o){return r&&(r[o]||r[Yo(o)]||r[jp(Yo(o))])}const Or=Symbol(void 0),b_=Symbol(void 0),To=Symbol(void 0),fp=Symbol(void 0),th=[];let tl=null;function hb(r=!1){th.push(tl=r?null:[])}function iC(){th.pop(),tl=th[th.length-1]||null}let Cp=1;function bv(r){Cp+=r}function db(r){return r.dynamicChildren=Cp>0?tl||Tc:null,iC(),Cp>0&&tl&&tl.push(r),r}function HL(r,o,l,h,g,y){return db(mb(r,o,l,h,g,y,!0))}function pb(r,o,l,h,g){return db(Bt(r,o,l,h,g,!0))}function mh(r){return r?r.__v_isVNode===!0:!1}function Ja(r,o){return r.type===o.type&&r.key===o.key}const Wp="__vInternal",fb=({key:r})=>r!=null?r:null,mp=({ref:r,ref_key:o,ref_for:l})=>r!=null?En(r)||Nn(r)||_i(r)?{i:to,r,k:o,f:!!l}:r:null;function mb(r,o=null,l=null,h=0,g=null,y=r===Or?0:1,E=!1,s=!1){const C={__v_isVNode:!0,__v_skip:!0,type:r,props:o,key:o&&fb(o),ref:o&&mp(o),scopeId:Gp,slotScopeIds:null,children:l,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:y,patchFlag:h,dynamicProps:g,dynamicChildren:null,appContext:null};return s?(w_(C,l),y&128&&r.normalize(C)):l&&(C.shapeFlag|=En(l)?8:16),Cp>0&&!E&&tl&&(C.patchFlag>0||y&6)&&C.patchFlag!==32&&tl.push(C),C}const Bt=nC;function nC(r,o=null,l=null,h=0,g=null,y=!1){if((!r||r===cb)&&(r=To),mh(r)){const s=Cc(r,o,!0);return l&&w_(s,l),s}if(gC(r)&&(r=r.__vccOpts),o){o=rC(o);let{class:s,style:C}=o;s&&!En(s)&&(o.class=e_(s)),Sn(C)&&(O1(C)&&!Kt(C)&&(C=Wn({},C)),o.style=Qg(C))}const E=En(r)?1:TS(r)?128:JS(r)?64:Sn(r)?4:_i(r)?2:0;return mb(r,o,l,h,g,E,y,!0)}function rC(r){return r?O1(r)||Wp in r?Wn({},r):r:null}function Cc(r,o,l=!1){const{props:h,ref:g,patchFlag:y,children:E}=r,s=o?sC(h||{},o):h;return{__v_isVNode:!0,__v_skip:!0,type:r.type,props:s,key:s&&fb(s),ref:o&&o.ref?l&&g?Kt(g)?g.concat(mp(o)):[g,mp(o)]:mp(o):g,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:E,target:r.target,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:o&&r.type!==Or?y===-1?16:y|16:y,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:r.transition,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Cc(r.ssContent),ssFallback:r.ssFallback&&Cc(r.ssFallback),el:r.el,anchor:r.anchor}}function oC(r=" ",o=0){return Bt(b_,null,r,o)}function XL(r="",o=!1){return o?(hb(),pb(To,null,r)):Bt(To,null,r)}function Ho(r){return r==null||typeof r=="boolean"?Bt(To):Kt(r)?Bt(Or,null,r.slice()):typeof r=="object"?ta(r):Bt(b_,null,String(r))}function ta(r){return r.el===null||r.memo?r:Cc(r)}function w_(r,o){let l=0;const{shapeFlag:h}=r;if(o==null)o=null;else if(Kt(o))l=16;else if(typeof o=="object")if(h&65){const g=o.default;g&&(g._c&&(g._d=!1),w_(r,g()),g._c&&(g._d=!0));return}else{l=32;const g=o._;!g&&!(Wp in o)?o._ctx=to:g===3&&to&&(to.slots._===1?o._=1:(o._=2,r.patchFlag|=1024))}else _i(o)?(o={default:o,_ctx:to},l=32):(o=String(o),h&64?(l=16,o=[oC(o)]):l=8);r.children=o,r.shapeFlag|=l}function sC(...r){const o={};for(let l=0;l<r.length;l++){const h=r[l];for(const g in h)if(g==="class")o.class!==h.class&&(o.class=e_([o.class,h.class]));else if(g==="style")o.style=Qg([o.style,h.style]);else if(Fp(g)){const y=o[g],E=h[g];E&&y!==E&&!(Kt(y)&&y.includes(E))&&(o[g]=y?[].concat(y,E):E)}else g!==""&&(o[g]=h[g])}return o}function Zo(r,o,l,h=null){io(r,o,7,[l,h])}function KL(r,o,l,h){let g;const y=l&&l[h];if(Kt(r)||En(r)){g=new Array(r.length);for(let E=0,s=r.length;E<s;E++)g[E]=o(r[E],E,void 0,y&&y[E])}else if(typeof r=="number"){g=new Array(r);for(let E=0;E<r;E++)g[E]=o(E+1,E,void 0,y&&y[E])}else if(Sn(r))if(r[Symbol.iterator])g=Array.from(r,(E,s)=>o(E,s,void 0,y&&y[s]));else{const E=Object.keys(r);g=new Array(E.length);for(let s=0,C=E.length;s<C;s++){const k=E[s];g[s]=o(r[k],k,s,y&&y[s])}}else g=[];return l&&(l[h]=g),g}function YL(r,o,l={},h,g){if(to.isCE)return Bt("slot",o==="default"?null:{name:o},h&&h());let y=r[o];y&&y._c&&(y._d=!1),hb();const E=y&&gb(y(l)),s=pb(Or,{key:l.key||`_${o}`},E||(h?h():[]),E&&r._===1?64:-2);return!g&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),y&&y._c&&(y._d=!0),s}function gb(r){return r.some(o=>mh(o)?!(o.type===To||o.type===Or&&!gb(o.children)):!0)?r:null}const Ig=r=>r?yb(r)?T_(r)||r.proxy:Ig(r.parent):null,Ap=Wn(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>Ig(r.parent),$root:r=>Ig(r.root),$emit:r=>r.emit,$options:r=>ib(r),$forceUpdate:r=>()=>$1(r.update),$nextTick:r=>ph.bind(r.proxy),$watch:r=>CS.bind(r)}),aC={get({_:r},o){const{ctx:l,setupState:h,data:g,props:y,accessCache:E,type:s,appContext:C}=r;let k;if(o[0]!=="$"){const U=E[o];if(U!==void 0)switch(U){case 1:return h[o];case 2:return g[o];case 4:return l[o];case 3:return y[o]}else{if(h!==Xi&&zi(h,o))return E[o]=1,h[o];if(g!==Xi&&zi(g,o))return E[o]=2,g[o];if((k=r.propsOptions[0])&&zi(k,o))return E[o]=3,y[o];if(l!==Xi&&zi(l,o))return E[o]=4,l[o];Eg&&(E[o]=0)}}const M=Ap[o];let D,R;if(M)return o==="$attrs"&&Nr(r,"get",o),M(r);if((D=s.__cssModules)&&(D=D[o]))return D;if(l!==Xi&&zi(l,o))return E[o]=4,l[o];if(R=C.config.globalProperties,zi(R,o))return R[o]},set({_:r},o,l){const{data:h,setupState:g,ctx:y}=r;return g!==Xi&&zi(g,o)?(g[o]=l,!0):h!==Xi&&zi(h,o)?(h[o]=l,!0):zi(r.props,o)||o[0]==="$"&&o.slice(1)in r?!1:(y[o]=l,!0)},has({_:{data:r,setupState:o,accessCache:l,ctx:h,appContext:g,propsOptions:y}},E){let s;return!!l[E]||r!==Xi&&zi(r,E)||o!==Xi&&zi(o,E)||(s=y[0])&&zi(s,E)||zi(h,E)||zi(Ap,E)||zi(g.config.globalProperties,E)},defineProperty(r,o,l){return l.get!=null?this.set(r,o,l.get(),null):l.value!=null&&this.set(r,o,l.value,null),Reflect.defineProperty(r,o,l)}},lC=lb();let cC=0;function uC(r,o,l){const h=r.type,g=(o?o.appContext:r.appContext)||lC,y={uid:cC++,vnode:r,type:h,parent:o,appContext:g,root:null,next:null,subTree:null,effect:null,update:null,scope:new IE(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:o?o.provides:Object.create(g.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:rb(h,g),emitsOptions:H1(h,g),emit:null,emitted:null,propsDefaults:Xi,inheritAttrs:h.inheritAttrs,ctx:Xi,data:Xi,props:Xi,attrs:Xi,slots:Xi,refs:Xi,setupState:Xi,setupContext:null,suspense:l,suspenseId:l?l.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return y.ctx={_:y},y.root=o?o.root:y,y.emit=_S.bind(null,y),r.ce&&r.ce(y),y}let Fn=null;const _b=()=>Fn||to,Ac=r=>{Fn=r,r.scope.on()},il=()=>{Fn&&Fn.scope.off(),Fn=null};function yb(r){return r.vnode.shapeFlag&4}let gh=!1;function hC(r,o=!1){gh=o;const{props:l,children:h}=r.vnode,g=yb(r);VS(r,l,g,o),qS(r,h);const y=g?dC(r,o):void 0;return gh=!1,y}function dC(r,o){const l=r.type;r.accessCache=Object.create(null),r.proxy=B1(new Proxy(r.ctx,aC));const{setup:h}=l;if(h){const g=r.setupContext=h.length>1?fC(r):null;Ac(r),Lc();const y=sa(h,r,0,[r.props,g]);if(Rc(),il(),x1(y)){if(y.then(il,il),o)return y.then(E=>{wv(r,E,o)}).catch(E=>{$p(E,r,0)});r.asyncDep=y}else wv(r,y,o)}else vb(r,o)}function wv(r,o,l){_i(o)?r.type.__ssrInlineRender?r.ssrRender=o:r.render=o:Sn(o)&&(r.setupState=j1(o)),vb(r,l)}let Tv;function vb(r,o,l){const h=r.type;if(!r.render){if(!o&&Tv&&!h.render){const g=h.template;if(g){const{isCustomElement:y,compilerOptions:E}=r.appContext.config,{delimiters:s,compilerOptions:C}=h,k=Wn(Wn({isCustomElement:y,delimiters:s},E),C);h.render=Tv(g,k)}}r.render=h.render||xo}Ac(r),Lc(),BS(r),Rc(),il()}function pC(r){return new Proxy(r.attrs,{get(o,l){return Nr(r,"get","$attrs"),o[l]}})}function fC(r){const o=h=>{r.exposed=h||{}};let l;return{get attrs(){return l||(l=pC(r))},slots:r.slots,emit:r.emit,expose:o}}function T_(r){if(r.exposed)return r.exposeProxy||(r.exposeProxy=new Proxy(j1(B1(r.exposed)),{get(o,l){if(l in o)return o[l];if(l in Ap)return Ap[l](r)}}))}function mC(r){return _i(r)&&r.displayName||r.name}function gC(r){return _i(r)&&"__vccOpts"in r}const hr=(r,o)=>hS(r,o,gh);function Er(r,o,l){const h=arguments.length;return h===2?Sn(o)&&!Kt(o)?mh(o)?Bt(r,null,[o]):Bt(r,o):Bt(r,null,o):(h>3?l=Array.prototype.slice.call(arguments,2):h===3&&mh(l)&&(l=[l]),Bt(r,o,l))}const _C="3.2.31",yC="http://www.w3.org/2000/svg",Qa=typeof document!="undefined"?document:null,Ev=Qa&&Qa.createElement("template"),vC={insert:(r,o,l)=>{o.insertBefore(r,l||null)},remove:r=>{const o=r.parentNode;o&&o.removeChild(r)},createElement:(r,o,l,h)=>{const g=o?Qa.createElementNS(yC,r):Qa.createElement(r,l?{is:l}:void 0);return r==="select"&&h&&h.multiple!=null&&g.setAttribute("multiple",h.multiple),g},createText:r=>Qa.createTextNode(r),createComment:r=>Qa.createComment(r),setText:(r,o)=>{r.nodeValue=o},setElementText:(r,o)=>{r.textContent=o},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>Qa.querySelector(r),setScopeId(r,o){r.setAttribute(o,"")},cloneNode(r){const o=r.cloneNode(!0);return"_value"in r&&(o._value=r._value),o},insertStaticContent(r,o,l,h,g,y){const E=l?l.previousSibling:o.lastChild;if(g&&(g===y||g.nextSibling))for(;o.insertBefore(g.cloneNode(!0),l),!(g===y||!(g=g.nextSibling)););else{Ev.innerHTML=h?`<svg>${r}</svg>`:r;const s=Ev.content;if(h){const C=s.firstChild;for(;C.firstChild;)s.appendChild(C.firstChild);s.removeChild(C)}o.insertBefore(s,l)}return[E?E.nextSibling:o.firstChild,l?l.previousSibling:o.lastChild]}};function xC(r,o,l){const h=r._vtc;h&&(o=(o?[o,...h]:[...h]).join(" ")),o==null?r.removeAttribute("class"):l?r.setAttribute("class",o):r.className=o}function bC(r,o,l){const h=r.style,g=En(l);if(l&&!g){for(const y in l)kg(h,y,l[y]);if(o&&!En(o))for(const y in o)l[y]==null&&kg(h,y,"")}else{const y=h.display;g?o!==l&&(h.cssText=l):o&&r.removeAttribute("style"),"_vod"in r&&(h.display=y)}}const Sv=/\s*!important$/;function kg(r,o,l){if(Kt(l))l.forEach(h=>kg(r,o,h));else if(o.startsWith("--"))r.setProperty(o,l);else{const h=wC(r,o);Sv.test(l)?r.setProperty(Dc(h),l.replace(Sv,""),"important"):r[h]=l}}const Cv=["Webkit","Moz","ms"],Fm={};function wC(r,o){const l=Fm[o];if(l)return l;let h=Yo(o);if(h!=="filter"&&h in r)return Fm[o]=h;h=jp(h);for(let g=0;g<Cv.length;g++){const y=Cv[g]+h;if(y in r)return Fm[o]=y}return o}const Av="http://www.w3.org/1999/xlink";function TC(r,o,l,h,g){if(h&&o.startsWith("xlink:"))l==null?r.removeAttributeNS(Av,o.slice(6,o.length)):r.setAttributeNS(Av,o,l);else{const y=yE(o);l==null||y&&!_1(l)?r.removeAttribute(o):r.setAttribute(o,y?"":l)}}function EC(r,o,l,h,g,y,E){if(o==="innerHTML"||o==="textContent"){h&&E(h,g,y),r[o]=l==null?"":l;return}if(o==="value"&&r.tagName!=="PROGRESS"&&!r.tagName.includes("-")){r._value=l;const s=l==null?"":l;(r.value!==s||r.tagName==="OPTION")&&(r.value=s),l==null&&r.removeAttribute(o);return}if(l===""||l==null){const s=typeof r[o];if(s==="boolean"){r[o]=_1(l);return}else if(l==null&&s==="string"){r[o]="",r.removeAttribute(o);return}else if(s==="number"){try{r[o]=0}catch{}r.removeAttribute(o);return}}try{r[o]=l}catch{}}let Mp=Date.now,xb=!1;if(typeof window!="undefined"){Mp()>document.createEvent("Event").timeStamp&&(Mp=()=>performance.now());const r=navigator.userAgent.match(/firefox\/(\d+)/i);xb=!!(r&&Number(r[1])<=53)}let zg=0;const SC=Promise.resolve(),CC=()=>{zg=0},AC=()=>zg||(SC.then(CC),zg=Mp());function MC(r,o,l,h){r.addEventListener(o,l,h)}function IC(r,o,l,h){r.removeEventListener(o,l,h)}function kC(r,o,l,h,g=null){const y=r._vei||(r._vei={}),E=y[o];if(h&&E)E.value=h;else{const[s,C]=zC(o);if(h){const k=y[o]=PC(h,g);MC(r,s,k,C)}else E&&(IC(r,s,E,C),y[o]=void 0)}}const Mv=/(?:Once|Passive|Capture)$/;function zC(r){let o;if(Mv.test(r)){o={};let l;for(;l=r.match(Mv);)r=r.slice(0,r.length-l[0].length),o[l[0].toLowerCase()]=!0}return[Dc(r.slice(2)),o]}function PC(r,o){const l=h=>{const g=h.timeStamp||Mp();(xb||g>=l.attached-1)&&io(DC(h,l.value),o,5,[h])};return l.value=r,l.attached=AC(),l}function DC(r,o){if(Kt(o)){const l=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{l.call(r),r._stopped=!0},o.map(h=>g=>!g._stopped&&h&&h(g))}else return o}const Iv=/^on[a-z]/,LC=(r,o,l,h,g=!1,y,E,s,C)=>{o==="class"?xC(r,h,g):o==="style"?bC(r,l,h):Fp(o)?t_(o)||kC(r,o,l,h,E):(o[0]==="."?(o=o.slice(1),!0):o[0]==="^"?(o=o.slice(1),!1):RC(r,o,h,g))?EC(r,o,h,y,E,s,C):(o==="true-value"?r._trueValue=h:o==="false-value"&&(r._falseValue=h),TC(r,o,h,g))};function RC(r,o,l,h){return h?!!(o==="innerHTML"||o==="textContent"||o in r&&Iv.test(o)&&_i(l)):o==="spellcheck"||o==="draggable"||o==="form"||o==="list"&&r.tagName==="INPUT"||o==="type"&&r.tagName==="TEXTAREA"||Iv.test(o)&&En(l)?!1:o in r}function JL(r){const o=_b();if(!o)return;const l=()=>Pg(o.subTree,r(o.proxy));SS(l),Oc(()=>{const h=new MutationObserver(l);h.observe(o.subTree.el.parentNode,{childList:!0}),__(()=>h.disconnect())})}function Pg(r,o){if(r.shapeFlag&128){const l=r.suspense;r=l.activeBranch,l.pendingBranch&&!l.isHydrating&&l.effects.push(()=>{Pg(l.activeBranch,o)})}for(;r.component;)r=r.component.subTree;if(r.shapeFlag&1&&r.el)kv(r.el,o);else if(r.type===Or)r.children.forEach(l=>Pg(l,o));else if(r.type===fp){let{el:l,anchor:h}=r;for(;l&&(kv(l,o),l!==h);)l=l.nextSibling}}function kv(r,o){if(r.nodeType===1){const l=r.style;for(const h in o)l.setProperty(`--${h}`,o[h])}}const Hs="transition",Vu="animation",ih=(r,{slots:o})=>Er(K1,OC(r),o);ih.displayName="Transition";const bb={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};ih.props=Wn({},K1.props,bb);const Wa=(r,o=[])=>{Kt(r)?r.forEach(l=>l(...o)):r&&r(...o)},zv=r=>r?Kt(r)?r.some(o=>o.length>1):r.length>1:!1;function OC(r){const o={};for(const ot in r)ot in bb||(o[ot]=r[ot]);if(r.css===!1)return o;const{name:l="v",type:h,duration:g,enterFromClass:y=`${l}-enter-from`,enterActiveClass:E=`${l}-enter-active`,enterToClass:s=`${l}-enter-to`,appearFromClass:C=y,appearActiveClass:k=E,appearToClass:M=s,leaveFromClass:D=`${l}-leave-from`,leaveActiveClass:R=`${l}-leave-active`,leaveToClass:U=`${l}-leave-to`}=r,ge=BC(g),Ee=ge&&ge[0],be=ge&&ge[1],{onBeforeEnter:we,onEnter:De,onEnterCancelled:Xe,onLeave:Ue,onLeaveCancelled:st,onBeforeAppear:ut=we,onAppear:lt=De,onAppearCancelled:It=Xe}=o,Ft=(ot,Nt,Ai)=>{hc(ot,Nt?M:s),hc(ot,Nt?k:E),Ai&&Ai()},Ct=(ot,Nt)=>{hc(ot,U),hc(ot,R),Nt&&Nt()},Tt=ot=>(Nt,Ai)=>{const Zi=ot?lt:De,ri=()=>Ft(Nt,ot,Ai);Wa(Zi,[Nt,ri]),Pv(()=>{hc(Nt,ot?C:y),Xs(Nt,ot?M:s),zv(Zi)||Dv(Nt,h,Ee,ri)})};return Wn(o,{onBeforeEnter(ot){Wa(we,[ot]),Xs(ot,y),Xs(ot,E)},onBeforeAppear(ot){Wa(ut,[ot]),Xs(ot,C),Xs(ot,k)},onEnter:Tt(!1),onAppear:Tt(!0),onLeave(ot,Nt){const Ai=()=>Ct(ot,Nt);Xs(ot,D),UC(),Xs(ot,R),Pv(()=>{hc(ot,D),Xs(ot,U),zv(Ue)||Dv(ot,h,be,Ai)}),Wa(Ue,[ot,Ai])},onEnterCancelled(ot){Ft(ot,!1),Wa(Xe,[ot])},onAppearCancelled(ot){Ft(ot,!0),Wa(It,[ot])},onLeaveCancelled(ot){Ct(ot),Wa(st,[ot])}})}function BC(r){if(r==null)return null;if(Sn(r))return[Nm(r.enter),Nm(r.leave)];{const o=Nm(r);return[o,o]}}function Nm(r){return T1(r)}function Xs(r,o){o.split(/\s+/).forEach(l=>l&&r.classList.add(l)),(r._vtc||(r._vtc=new Set)).add(o)}function hc(r,o){o.split(/\s+/).forEach(h=>h&&r.classList.remove(h));const{_vtc:l}=r;l&&(l.delete(o),l.size||(r._vtc=void 0))}function Pv(r){requestAnimationFrame(()=>{requestAnimationFrame(r)})}let FC=0;function Dv(r,o,l,h){const g=r._endId=++FC,y=()=>{g===r._endId&&h()};if(l)return setTimeout(y,l);const{type:E,timeout:s,propCount:C}=NC(r,o);if(!E)return h();const k=E+"end";let M=0;const D=()=>{r.removeEventListener(k,R),y()},R=U=>{U.target===r&&++M>=C&&D()};setTimeout(()=>{M<C&&D()},s+1),r.addEventListener(k,R)}function NC(r,o){const l=window.getComputedStyle(r),h=ge=>(l[ge]||"").split(", "),g=h(Hs+"Delay"),y=h(Hs+"Duration"),E=Lv(g,y),s=h(Vu+"Delay"),C=h(Vu+"Duration"),k=Lv(s,C);let M=null,D=0,R=0;o===Hs?E>0&&(M=Hs,D=E,R=y.length):o===Vu?k>0&&(M=Vu,D=k,R=C.length):(D=Math.max(E,k),M=D>0?E>k?Hs:Vu:null,R=M?M===Hs?y.length:C.length:0);const U=M===Hs&&/\b(transform|all)(,|$)/.test(l[Hs+"Property"]);return{type:M,timeout:D,propCount:R,hasTransform:U}}function Lv(r,o){for(;r.length<o.length;)r=r.concat(r);return Math.max(...o.map((l,h)=>Rv(l)+Rv(r[h])))}function Rv(r){return Number(r.slice(0,-1).replace(",","."))*1e3}function UC(){return document.body.offsetHeight}const jC=["ctrl","shift","alt","meta"],VC={stop:r=>r.stopPropagation(),prevent:r=>r.preventDefault(),self:r=>r.target!==r.currentTarget,ctrl:r=>!r.ctrlKey,shift:r=>!r.shiftKey,alt:r=>!r.altKey,meta:r=>!r.metaKey,left:r=>"button"in r&&r.button!==0,middle:r=>"button"in r&&r.button!==1,right:r=>"button"in r&&r.button!==2,exact:(r,o)=>jC.some(l=>r[`${l}Key`]&&!o.includes(l))},$C=(r,o)=>(l,...h)=>{for(let g=0;g<o.length;g++){const y=VC[o[g]];if(y&&y(l,o))return}return r(l,...h)},GC=Wn({patchProp:LC},vC);let Ov;function qC(){return Ov||(Ov=XS(GC))}const QL=(...r)=>{const o=qC().createApp(...r),{mount:l}=o;return o.mount=h=>{const g=ZC(h);if(!g)return;const y=o._component;!_i(y)&&!y.render&&!y.template&&(y.template=g.innerHTML),g.innerHTML="";const E=l(g,!1,g instanceof SVGElement);return g instanceof Element&&(g.removeAttribute("v-cloak"),g.setAttribute("data-v-app","")),E},o};function ZC(r){return En(r)?document.querySelector(r):r}function WC(){return wb().__VUE_DEVTOOLS_GLOBAL_HOOK__}function wb(){return typeof navigator!="undefined"&&typeof window!="undefined"?window:typeof global!="undefined"?global:{}}const HC=typeof Proxy=="function",XC="devtools-plugin:setup",KC="plugin:settings:set";class YC{constructor(o,l){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=o,this.hook=l;const h={};if(o.settings)for(const E in o.settings){const s=o.settings[E];h[E]=s.defaultValue}const g=`__vue-devtools-plugin-settings__${o.id}`;let y=Object.assign({},h);try{const E=localStorage.getItem(g),s=JSON.parse(E);Object.assign(y,s)}catch{}this.fallbacks={getSettings(){return y},setSettings(E){try{localStorage.setItem(g,JSON.stringify(E))}catch{}y=E}},l&&l.on(KC,(E,s)=>{E===this.plugin.id&&this.fallbacks.setSettings(s)}),this.proxiedOn=new Proxy({},{get:(E,s)=>this.target?this.target.on[s]:(...C)=>{this.onQueue.push({method:s,args:C})}}),this.proxiedTarget=new Proxy({},{get:(E,s)=>this.target?this.target[s]:s==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(s)?(...C)=>(this.targetQueue.push({method:s,args:C,resolve:()=>{}}),this.fallbacks[s](...C)):(...C)=>new Promise(k=>{this.targetQueue.push({method:s,args:C,resolve:k})})})}async setRealTarget(o){this.target=o;for(const l of this.onQueue)this.target.on[l.method](...l.args);for(const l of this.targetQueue)l.resolve(await this.target[l.method](...l.args))}}function JC(r,o){const l=r,h=wb(),g=WC(),y=HC&&l.enableEarlyProxy;if(g&&(h.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!y))g.emit(XC,r,o);else{const E=y?new YC(l,g):null;(h.__VUE_DEVTOOLS_PLUGINS__=h.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:l,setupFn:o,proxy:E}),E&&o(E.proxiedTarget)}}/*!
  * vue-router v4.0.12
  * (c) 2021 Eduardo San Martin Morote
  * @license MIT
  */const Tb=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Bc=r=>Tb?Symbol(r):"_vr_"+r,QC=Bc("rvlm"),Bv=Bc("rvd"),Hp=Bc("r"),Eb=Bc("rl"),Dg=Bc("rvl"),xc=typeof window!="undefined";function eA(r){return r.__esModule||Tb&&r[Symbol.toStringTag]==="Module"}const Gi=Object.assign;function Um(r,o){const l={};for(const h in o){const g=o[h];l[h]=Array.isArray(g)?g.map(r):r(g)}return l}const nh=()=>{},tA=/\/$/,iA=r=>r.replace(tA,"");function jm(r,o,l="/"){let h,g={},y="",E="";const s=o.indexOf("?"),C=o.indexOf("#",s>-1?s:0);return s>-1&&(h=o.slice(0,s),y=o.slice(s+1,C>-1?C:o.length),g=r(y)),C>-1&&(h=h||o.slice(0,C),E=o.slice(C,o.length)),h=sA(h!=null?h:o,l),{fullPath:h+(y&&"?")+y+E,path:h,query:g,hash:E}}function nA(r,o){const l=o.query?r(o.query):"";return o.path+(l&&"?")+l+(o.hash||"")}function Fv(r,o){return!o||!r.toLowerCase().startsWith(o.toLowerCase())?r:r.slice(o.length)||"/"}function rA(r,o,l){const h=o.matched.length-1,g=l.matched.length-1;return h>-1&&h===g&&Mc(o.matched[h],l.matched[g])&&Sb(o.params,l.params)&&r(o.query)===r(l.query)&&o.hash===l.hash}function Mc(r,o){return(r.aliasOf||r)===(o.aliasOf||o)}function Sb(r,o){if(Object.keys(r).length!==Object.keys(o).length)return!1;for(const l in r)if(!oA(r[l],o[l]))return!1;return!0}function oA(r,o){return Array.isArray(r)?Nv(r,o):Array.isArray(o)?Nv(o,r):r===o}function Nv(r,o){return Array.isArray(o)?r.length===o.length&&r.every((l,h)=>l===o[h]):r.length===1&&r[0]===o}function sA(r,o){if(r.startsWith("/"))return r;if(!r)return o;const l=o.split("/"),h=r.split("/");let g=l.length-1,y,E;for(y=0;y<h.length;y++)if(E=h[y],!(g===1||E==="."))if(E==="..")g--;else break;return l.slice(0,g).join("/")+"/"+h.slice(y-(y===h.length?1:0)).join("/")}var _h;(function(r){r.pop="pop",r.push="push"})(_h||(_h={}));var rh;(function(r){r.back="back",r.forward="forward",r.unknown=""})(rh||(rh={}));function aA(r){if(!r)if(xc){const o=document.querySelector("base");r=o&&o.getAttribute("href")||"/",r=r.replace(/^\w+:\/\/[^\/]+/,"")}else r="/";return r[0]!=="/"&&r[0]!=="#"&&(r="/"+r),iA(r)}const lA=/^[^#]+#/;function cA(r,o){return r.replace(lA,"#")+o}function uA(r,o){const l=document.documentElement.getBoundingClientRect(),h=r.getBoundingClientRect();return{behavior:o.behavior,left:h.left-l.left-(o.left||0),top:h.top-l.top-(o.top||0)}}const Xp=()=>({left:window.pageXOffset,top:window.pageYOffset});function hA(r){let o;if("el"in r){const l=r.el,h=typeof l=="string"&&l.startsWith("#"),g=typeof l=="string"?h?document.getElementById(l.slice(1)):document.querySelector(l):l;if(!g)return;o=uA(g,r)}else o=r;"scrollBehavior"in document.documentElement.style?window.scrollTo(o):window.scrollTo(o.left!=null?o.left:window.pageXOffset,o.top!=null?o.top:window.pageYOffset)}function Uv(r,o){return(history.state?history.state.position-o:-1)+r}const Lg=new Map;function dA(r,o){Lg.set(r,o)}function pA(r){const o=Lg.get(r);return Lg.delete(r),o}let fA=()=>location.protocol+"//"+location.host;function Cb(r,o){const{pathname:l,search:h,hash:g}=o,y=r.indexOf("#");if(y>-1){let s=g.includes(r.slice(y))?r.slice(y).length:1,C=g.slice(s);return C[0]!=="/"&&(C="/"+C),Fv(C,"")}return Fv(l,r)+h+g}function mA(r,o,l,h){let g=[],y=[],E=null;const s=({state:R})=>{const U=Cb(r,location),ge=l.value,Ee=o.value;let be=0;if(R){if(l.value=U,o.value=R,E&&E===ge){E=null;return}be=Ee?R.position-Ee.position:0}else h(U);g.forEach(we=>{we(l.value,ge,{delta:be,type:_h.pop,direction:be?be>0?rh.forward:rh.back:rh.unknown})})};function C(){E=l.value}function k(R){g.push(R);const U=()=>{const ge=g.indexOf(R);ge>-1&&g.splice(ge,1)};return y.push(U),U}function M(){const{history:R}=window;!R.state||R.replaceState(Gi({},R.state,{scroll:Xp()}),"")}function D(){for(const R of y)R();y=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",M)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",M),{pauseListeners:C,listen:k,destroy:D}}function jv(r,o,l,h=!1,g=!1){return{back:r,current:o,forward:l,replaced:h,position:window.history.length,scroll:g?Xp():null}}function gA(r){const{history:o,location:l}=window,h={value:Cb(r,l)},g={value:o.state};g.value||y(h.value,{back:null,current:h.value,forward:null,position:o.length-1,replaced:!0,scroll:null},!0);function y(C,k,M){const D=r.indexOf("#"),R=D>-1?(l.host&&document.querySelector("base")?r:r.slice(D))+C:fA()+r+C;try{o[M?"replaceState":"pushState"](k,"",R),g.value=k}catch(U){console.error(U),l[M?"replace":"assign"](R)}}function E(C,k){const M=Gi({},o.state,jv(g.value.back,C,g.value.forward,!0),k,{position:g.value.position});y(C,M,!0),h.value=C}function s(C,k){const M=Gi({},g.value,o.state,{forward:C,scroll:Xp()});y(M.current,M,!0);const D=Gi({},jv(h.value,C,null),{position:M.position+1},k);y(C,D,!1),h.value=C}return{location:h,state:g,push:s,replace:E}}function e5(r){r=aA(r);const o=gA(r),l=mA(r,o.state,o.location,o.replace);function h(y,E=!0){E||l.pauseListeners(),history.go(y)}const g=Gi({location:"",base:r,go:h,createHref:cA.bind(null,r)},o,l);return Object.defineProperty(g,"location",{enumerable:!0,get:()=>o.location.value}),Object.defineProperty(g,"state",{enumerable:!0,get:()=>o.state.value}),g}function _A(r){return typeof r=="string"||r&&typeof r=="object"}function Ab(r){return typeof r=="string"||typeof r=="symbol"}const Ks={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Mb=Bc("nf");var Vv;(function(r){r[r.aborted=4]="aborted",r[r.cancelled=8]="cancelled",r[r.duplicated=16]="duplicated"})(Vv||(Vv={}));function Ic(r,o){return Gi(new Error,{type:r,[Mb]:!0},o)}function Ha(r,o){return r instanceof Error&&Mb in r&&(o==null||!!(r.type&o))}const $v="[^/]+?",yA={sensitive:!1,strict:!1,start:!0,end:!0},vA=/[.+*?^${}()[\]/\\]/g;function xA(r,o){const l=Gi({},yA,o),h=[];let g=l.start?"^":"";const y=[];for(const k of r){const M=k.length?[]:[90];l.strict&&!k.length&&(g+="/");for(let D=0;D<k.length;D++){const R=k[D];let U=40+(l.sensitive?.25:0);if(R.type===0)D||(g+="/"),g+=R.value.replace(vA,"\\$&"),U+=40;else if(R.type===1){const{value:ge,repeatable:Ee,optional:be,regexp:we}=R;y.push({name:ge,repeatable:Ee,optional:be});const De=we||$v;if(De!==$v){U+=10;try{new RegExp(`(${De})`)}catch(Ue){throw new Error(`Invalid custom RegExp for param "${ge}" (${De}): `+Ue.message)}}let Xe=Ee?`((?:${De})(?:/(?:${De}))*)`:`(${De})`;D||(Xe=be&&k.length<2?`(?:/${Xe})`:"/"+Xe),be&&(Xe+="?"),g+=Xe,U+=20,be&&(U+=-8),Ee&&(U+=-20),De===".*"&&(U+=-50)}M.push(U)}h.push(M)}if(l.strict&&l.end){const k=h.length-1;h[k][h[k].length-1]+=.7000000000000001}l.strict||(g+="/?"),l.end?g+="$":l.strict&&(g+="(?:/|$)");const E=new RegExp(g,l.sensitive?"":"i");function s(k){const M=k.match(E),D={};if(!M)return null;for(let R=1;R<M.length;R++){const U=M[R]||"",ge=y[R-1];D[ge.name]=U&&ge.repeatable?U.split("/"):U}return D}function C(k){let M="",D=!1;for(const R of r){(!D||!M.endsWith("/"))&&(M+="/"),D=!1;for(const U of R)if(U.type===0)M+=U.value;else if(U.type===1){const{value:ge,repeatable:Ee,optional:be}=U,we=ge in k?k[ge]:"";if(Array.isArray(we)&&!Ee)throw new Error(`Provided param "${ge}" is an array but it is not repeatable (* or + modifiers)`);const De=Array.isArray(we)?we.join("/"):we;if(!De)if(be)R.length<2&&(M.endsWith("/")?M=M.slice(0,-1):D=!0);else throw new Error(`Missing required param "${ge}"`);M+=De}}return M}return{re:E,score:h,keys:y,parse:s,stringify:C}}function bA(r,o){let l=0;for(;l<r.length&&l<o.length;){const h=o[l]-r[l];if(h)return h;l++}return r.length<o.length?r.length===1&&r[0]===40+40?-1:1:r.length>o.length?o.length===1&&o[0]===40+40?1:-1:0}function wA(r,o){let l=0;const h=r.score,g=o.score;for(;l<h.length&&l<g.length;){const y=bA(h[l],g[l]);if(y)return y;l++}return g.length-h.length}const TA={type:0,value:""},EA=/[a-zA-Z0-9_]/;function SA(r){if(!r)return[[]];if(r==="/")return[[TA]];if(!r.startsWith("/"))throw new Error(`Invalid path "${r}"`);function o(U){throw new Error(`ERR (${l})/"${k}": ${U}`)}let l=0,h=l;const g=[];let y;function E(){y&&g.push(y),y=[]}let s=0,C,k="",M="";function D(){!k||(l===0?y.push({type:0,value:k}):l===1||l===2||l===3?(y.length>1&&(C==="*"||C==="+")&&o(`A repeatable param (${k}) must be alone in its segment. eg: '/:ids+.`),y.push({type:1,value:k,regexp:M,repeatable:C==="*"||C==="+",optional:C==="*"||C==="?"})):o("Invalid state to consume buffer"),k="")}function R(){k+=C}for(;s<r.length;){if(C=r[s++],C==="\\"&&l!==2){h=l,l=4;continue}switch(l){case 0:C==="/"?(k&&D(),E()):C===":"?(D(),l=1):R();break;case 4:R(),l=h;break;case 1:C==="("?l=2:EA.test(C)?R():(D(),l=0,C!=="*"&&C!=="?"&&C!=="+"&&s--);break;case 2:C===")"?M[M.length-1]=="\\"?M=M.slice(0,-1)+C:l=3:M+=C;break;case 3:D(),l=0,C!=="*"&&C!=="?"&&C!=="+"&&s--,M="";break;default:o("Unknown state");break}}return l===2&&o(`Unfinished custom RegExp for param "${k}"`),D(),E(),g}function CA(r,o,l){const h=xA(SA(r.path),l),g=Gi(h,{record:r,parent:o,children:[],alias:[]});return o&&!g.record.aliasOf==!o.record.aliasOf&&o.children.push(g),g}function AA(r,o){const l=[],h=new Map;o=qv({strict:!1,end:!0,sensitive:!1},o);function g(M){return h.get(M)}function y(M,D,R){const U=!R,ge=IA(M);ge.aliasOf=R&&R.record;const Ee=qv(o,M),be=[ge];if("alias"in M){const Xe=typeof M.alias=="string"?[M.alias]:M.alias;for(const Ue of Xe)be.push(Gi({},ge,{components:R?R.record.components:ge.components,path:Ue,aliasOf:R?R.record:ge}))}let we,De;for(const Xe of be){const{path:Ue}=Xe;if(D&&Ue[0]!=="/"){const st=D.record.path,ut=st[st.length-1]==="/"?"":"/";Xe.path=D.record.path+(Ue&&ut+Ue)}if(we=CA(Xe,D,Ee),R?R.alias.push(we):(De=De||we,De!==we&&De.alias.push(we),U&&M.name&&!Gv(we)&&E(M.name)),"children"in ge){const st=ge.children;for(let ut=0;ut<st.length;ut++)y(st[ut],we,R&&R.children[ut])}R=R||we,C(we)}return De?()=>{E(De)}:nh}function E(M){if(Ab(M)){const D=h.get(M);D&&(h.delete(M),l.splice(l.indexOf(D),1),D.children.forEach(E),D.alias.forEach(E))}else{const D=l.indexOf(M);D>-1&&(l.splice(D,1),M.record.name&&h.delete(M.record.name),M.children.forEach(E),M.alias.forEach(E))}}function s(){return l}function C(M){let D=0;for(;D<l.length&&wA(M,l[D])>=0;)D++;l.splice(D,0,M),M.record.name&&!Gv(M)&&h.set(M.record.name,M)}function k(M,D){let R,U={},ge,Ee;if("name"in M&&M.name){if(R=h.get(M.name),!R)throw Ic(1,{location:M});Ee=R.record.name,U=Gi(MA(D.params,R.keys.filter(De=>!De.optional).map(De=>De.name)),M.params),ge=R.stringify(U)}else if("path"in M)ge=M.path,R=l.find(De=>De.re.test(ge)),R&&(U=R.parse(ge),Ee=R.record.name);else{if(R=D.name?h.get(D.name):l.find(De=>De.re.test(D.path)),!R)throw Ic(1,{location:M,currentLocation:D});Ee=R.record.name,U=Gi({},D.params,M.params),ge=R.stringify(U)}const be=[];let we=R;for(;we;)be.unshift(we.record),we=we.parent;return{name:Ee,path:ge,params:U,matched:be,meta:zA(be)}}return r.forEach(M=>y(M)),{addRoute:y,resolve:k,removeRoute:E,getRoutes:s,getRecordMatcher:g}}function MA(r,o){const l={};for(const h of o)h in r&&(l[h]=r[h]);return l}function IA(r){return{path:r.path,redirect:r.redirect,name:r.name,meta:r.meta||{},aliasOf:void 0,beforeEnter:r.beforeEnter,props:kA(r),children:r.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in r?r.components||{}:{default:r.component}}}function kA(r){const o={},l=r.props||!1;if("component"in r)o.default=l;else for(const h in r.components)o[h]=typeof l=="boolean"?l:l[h];return o}function Gv(r){for(;r;){if(r.record.aliasOf)return!0;r=r.parent}return!1}function zA(r){return r.reduce((o,l)=>Gi(o,l.meta),{})}function qv(r,o){const l={};for(const h in r)l[h]=h in o?o[h]:r[h];return l}const Ib=/#/g,PA=/&/g,DA=/\//g,LA=/=/g,RA=/\?/g,kb=/\+/g,OA=/%5B/g,BA=/%5D/g,zb=/%5E/g,FA=/%60/g,Pb=/%7B/g,NA=/%7C/g,Db=/%7D/g,UA=/%20/g;function E_(r){return encodeURI(""+r).replace(NA,"|").replace(OA,"[").replace(BA,"]")}function jA(r){return E_(r).replace(Pb,"{").replace(Db,"}").replace(zb,"^")}function Rg(r){return E_(r).replace(kb,"%2B").replace(UA,"+").replace(Ib,"%23").replace(PA,"%26").replace(FA,"`").replace(Pb,"{").replace(Db,"}").replace(zb,"^")}function VA(r){return Rg(r).replace(LA,"%3D")}function $A(r){return E_(r).replace(Ib,"%23").replace(RA,"%3F")}function GA(r){return r==null?"":$A(r).replace(DA,"%2F")}function Ip(r){try{return decodeURIComponent(""+r)}catch{}return""+r}function qA(r){const o={};if(r===""||r==="?")return o;const h=(r[0]==="?"?r.slice(1):r).split("&");for(let g=0;g<h.length;++g){const y=h[g].replace(kb," "),E=y.indexOf("="),s=Ip(E<0?y:y.slice(0,E)),C=E<0?null:Ip(y.slice(E+1));if(s in o){let k=o[s];Array.isArray(k)||(k=o[s]=[k]),k.push(C)}else o[s]=C}return o}function Zv(r){let o="";for(let l in r){const h=r[l];if(l=VA(l),h==null){h!==void 0&&(o+=(o.length?"&":"")+l);continue}(Array.isArray(h)?h.map(y=>y&&Rg(y)):[h&&Rg(h)]).forEach(y=>{y!==void 0&&(o+=(o.length?"&":"")+l,y!=null&&(o+="="+y))})}return o}function ZA(r){const o={};for(const l in r){const h=r[l];h!==void 0&&(o[l]=Array.isArray(h)?h.map(g=>g==null?null:""+g):h==null?h:""+h)}return o}function $u(){let r=[];function o(h){return r.push(h),()=>{const g=r.indexOf(h);g>-1&&r.splice(g,1)}}function l(){r=[]}return{add:o,list:()=>r,reset:l}}function ia(r,o,l,h,g){const y=h&&(h.enterCallbacks[g]=h.enterCallbacks[g]||[]);return()=>new Promise((E,s)=>{const C=D=>{D===!1?s(Ic(4,{from:l,to:o})):D instanceof Error?s(D):_A(D)?s(Ic(2,{from:o,to:D})):(y&&h.enterCallbacks[g]===y&&typeof D=="function"&&y.push(D),E())},k=r.call(h&&h.instances[g],o,l,C);let M=Promise.resolve(k);r.length<3&&(M=M.then(C)),M.catch(D=>s(D))})}function Vm(r,o,l,h){const g=[];for(const y of r)for(const E in y.components){let s=y.components[E];if(!(o!=="beforeRouteEnter"&&!y.instances[E]))if(WA(s)){const k=(s.__vccOpts||s)[o];k&&g.push(ia(k,l,h,y,E))}else{let C=s();g.push(()=>C.then(k=>{if(!k)return Promise.reject(new Error(`Couldn't resolve component "${E}" at "${y.path}"`));const M=eA(k)?k.default:k;y.components[E]=M;const R=(M.__vccOpts||M)[o];return R&&ia(R,l,h,y,E)()}))}}return g}function WA(r){return typeof r=="object"||"displayName"in r||"props"in r||"__vccOpts"in r}function Wv(r){const o=Ko(Hp),l=Ko(Eb),h=hr(()=>o.resolve(ps(r.to))),g=hr(()=>{const{matched:C}=h.value,{length:k}=C,M=C[k-1],D=l.matched;if(!M||!D.length)return-1;const R=D.findIndex(Mc.bind(null,M));if(R>-1)return R;const U=Hv(C[k-2]);return k>1&&Hv(M)===U&&D[D.length-1].path!==U?D.findIndex(Mc.bind(null,C[k-2])):R}),y=hr(()=>g.value>-1&&YA(l.params,h.value.params)),E=hr(()=>g.value>-1&&g.value===l.matched.length-1&&Sb(l.params,h.value.params));function s(C={}){return KA(C)?o[ps(r.replace)?"replace":"push"](ps(r.to)).catch(nh):Promise.resolve()}return{route:h,href:hr(()=>h.value.href),isActive:y,isExactActive:E,navigate:s}}const HA=xh({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Wv,setup(r,{slots:o}){const l=bo(Wv(r)),{options:h}=Ko(Hp),g=hr(()=>({[Xv(r.activeClass,h.linkActiveClass,"router-link-active")]:l.isActive,[Xv(r.exactActiveClass,h.linkExactActiveClass,"router-link-exact-active")]:l.isExactActive}));return()=>{const y=o.default&&o.default(l);return r.custom?y:Er("a",{"aria-current":l.isExactActive?r.ariaCurrentValue:null,href:l.href,onClick:l.navigate,class:g.value},y)}}}),XA=HA;function KA(r){if(!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)&&!r.defaultPrevented&&!(r.button!==void 0&&r.button!==0)){if(r.currentTarget&&r.currentTarget.getAttribute){const o=r.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(o))return}return r.preventDefault&&r.preventDefault(),!0}}function YA(r,o){for(const l in o){const h=o[l],g=r[l];if(typeof h=="string"){if(h!==g)return!1}else if(!Array.isArray(g)||g.length!==h.length||h.some((y,E)=>y!==g[E]))return!1}return!0}function Hv(r){return r?r.aliasOf?r.aliasOf.path:r.path:""}const Xv=(r,o,l)=>r!=null?r:o!=null?o:l,JA=xh({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(r,{attrs:o,slots:l}){const h=Ko(Dg),g=hr(()=>r.route||h.value),y=Ko(Bv,0),E=hr(()=>g.value.matched[y]);pp(Bv,y+1),pp(QC,E),pp(Dg,g);const s=wn();return wo(()=>[s.value,E.value,r.name],([C,k,M],[D,R,U])=>{k&&(k.instances[M]=C,R&&R!==k&&C&&C===D&&(k.leaveGuards.size||(k.leaveGuards=R.leaveGuards),k.updateGuards.size||(k.updateGuards=R.updateGuards))),C&&k&&(!R||!Mc(k,R)||!D)&&(k.enterCallbacks[M]||[]).forEach(ge=>ge(C))},{flush:"post"}),()=>{const C=g.value,k=E.value,M=k&&k.components[r.name],D=r.name;if(!M)return Kv(l.default,{Component:M,route:C});const R=k.props[r.name],U=R?R===!0?C.params:typeof R=="function"?R(C):R:null,Ee=Er(M,Gi({},U,o,{onVnodeUnmounted:be=>{be.component.isUnmounted&&(k.instances[D]=null)},ref:s}));return Kv(l.default,{Component:Ee,route:C})||Ee}}});function Kv(r,o){if(!r)return null;const l=r(o);return l.length===1?l[0]:l}const QA=JA;function t5(r){const o=AA(r.routes,r),l=r.parseQuery||qA,h=r.stringifyQuery||Zv,g=r.history,y=$u(),E=$u(),s=$u(),C=oS(Ks);let k=Ks;xc&&r.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const M=Um.bind(null,Be=>""+Be),D=Um.bind(null,GA),R=Um.bind(null,Ip);function U(Be,yt){let rt,At;return Ab(Be)?(rt=o.getRecordMatcher(Be),At=yt):At=Be,o.addRoute(At,rt)}function ge(Be){const yt=o.getRecordMatcher(Be);yt&&o.removeRoute(yt)}function Ee(){return o.getRoutes().map(Be=>Be.record)}function be(Be){return!!o.getRecordMatcher(Be)}function we(Be,yt){if(yt=Gi({},yt||C.value),typeof Be=="string"){const We=jm(l,Be,yt.path),te=o.resolve({path:We.path},yt),ae=g.createHref(We.fullPath);return Gi(We,te,{params:R(te.params),hash:Ip(We.hash),redirectedFrom:void 0,href:ae})}let rt;if("path"in Be)rt=Gi({},Be,{path:jm(l,Be.path,yt.path).path});else{const We=Gi({},Be.params);for(const te in We)We[te]==null&&delete We[te];rt=Gi({},Be,{params:D(Be.params)}),yt.params=D(yt.params)}const At=o.resolve(rt,yt),ui=Be.hash||"";At.params=M(R(At.params));const pi=nA(h,Gi({},Be,{hash:jA(ui),path:At.path})),Le=g.createHref(pi);return Gi({fullPath:pi,hash:ui,query:h===Zv?ZA(Be.query):Be.query||{}},At,{redirectedFrom:void 0,href:Le})}function De(Be){return typeof Be=="string"?jm(l,Be,C.value.path):Gi({},Be)}function Xe(Be,yt){if(k!==Be)return Ic(8,{from:yt,to:Be})}function Ue(Be){return lt(Be)}function st(Be){return Ue(Gi(De(Be),{replace:!0}))}function ut(Be){const yt=Be.matched[Be.matched.length-1];if(yt&&yt.redirect){const{redirect:rt}=yt;let At=typeof rt=="function"?rt(Be):rt;return typeof At=="string"&&(At=At.includes("?")||At.includes("#")?At=De(At):{path:At},At.params={}),Gi({query:Be.query,hash:Be.hash,params:Be.params},At)}}function lt(Be,yt){const rt=k=we(Be),At=C.value,ui=Be.state,pi=Be.force,Le=Be.replace===!0,We=ut(rt);if(We)return lt(Gi(De(We),{state:ui,force:pi,replace:Le}),yt||rt);const te=rt;te.redirectedFrom=yt;let ae;return!pi&&rA(h,At,rt)&&(ae=Ic(16,{to:te,from:At}),Qi(At,At,!0,!1)),(ae?Promise.resolve(ae):Ft(te,At)).catch(Ce=>Ha(Ce)?Ce:qt(Ce,te,At)).then(Ce=>{if(Ce){if(Ha(Ce,2))return lt(Gi(De(Ce.to),{state:ui,force:pi,replace:Le}),yt||te)}else Ce=Tt(te,At,!0,Le,ui);return Ct(te,At,Ce),Ce})}function It(Be,yt){const rt=Xe(Be,yt);return rt?Promise.reject(rt):Promise.resolve()}function Ft(Be,yt){let rt;const[At,ui,pi]=eM(Be,yt);rt=Vm(At.reverse(),"beforeRouteLeave",Be,yt);for(const We of At)We.leaveGuards.forEach(te=>{rt.push(ia(te,Be,yt))});const Le=It.bind(null,Be,yt);return rt.push(Le),dc(rt).then(()=>{rt=[];for(const We of y.list())rt.push(ia(We,Be,yt));return rt.push(Le),dc(rt)}).then(()=>{rt=Vm(ui,"beforeRouteUpdate",Be,yt);for(const We of ui)We.updateGuards.forEach(te=>{rt.push(ia(te,Be,yt))});return rt.push(Le),dc(rt)}).then(()=>{rt=[];for(const We of Be.matched)if(We.beforeEnter&&!yt.matched.includes(We))if(Array.isArray(We.beforeEnter))for(const te of We.beforeEnter)rt.push(ia(te,Be,yt));else rt.push(ia(We.beforeEnter,Be,yt));return rt.push(Le),dc(rt)}).then(()=>(Be.matched.forEach(We=>We.enterCallbacks={}),rt=Vm(pi,"beforeRouteEnter",Be,yt),rt.push(Le),dc(rt))).then(()=>{rt=[];for(const We of E.list())rt.push(ia(We,Be,yt));return rt.push(Le),dc(rt)}).catch(We=>Ha(We,8)?We:Promise.reject(We))}function Ct(Be,yt,rt){for(const At of s.list())At(Be,yt,rt)}function Tt(Be,yt,rt,At,ui){const pi=Xe(Be,yt);if(pi)return pi;const Le=yt===Ks,We=xc?history.state:{};rt&&(At||Le?g.replace(Be.fullPath,Gi({scroll:Le&&We&&We.scroll},ui)):g.push(Be.fullPath,ui)),C.value=Be,Qi(Be,yt,rt,Le),Si()}let ot;function Nt(){ot=g.listen((Be,yt,rt)=>{const At=we(Be),ui=ut(At);if(ui){lt(Gi(ui,{replace:!0}),At).catch(nh);return}k=At;const pi=C.value;xc&&dA(Uv(pi.fullPath,rt.delta),Xp()),Ft(At,pi).catch(Le=>Ha(Le,12)?Le:Ha(Le,2)?(lt(Le.to,At).then(We=>{Ha(We,20)&&!rt.delta&&rt.type===_h.pop&&g.go(-1,!1)}).catch(nh),Promise.reject()):(rt.delta&&g.go(-rt.delta,!1),qt(Le,At,pi))).then(Le=>{Le=Le||Tt(At,pi,!1),Le&&(rt.delta?g.go(-rt.delta,!1):rt.type===_h.pop&&Ha(Le,20)&&g.go(-1,!1)),Ct(At,pi,Le)}).catch(nh)})}let Ai=$u(),Zi=$u(),ri;function qt(Be,yt,rt){Si(Be);const At=Zi.list();return At.length?At.forEach(ui=>ui(Be,yt,rt)):console.error(Be),Promise.reject(Be)}function ei(){return ri&&C.value!==Ks?Promise.resolve():new Promise((Be,yt)=>{Ai.add([Be,yt])})}function Si(Be){ri||(ri=!0,Nt(),Ai.list().forEach(([yt,rt])=>Be?rt(Be):yt()),Ai.reset())}function Qi(Be,yt,rt,At){const{scrollBehavior:ui}=r;if(!xc||!ui)return Promise.resolve();const pi=!rt&&pA(Uv(Be.fullPath,0))||(At||!rt)&&history.state&&history.state.scroll||null;return ph().then(()=>ui(Be,yt,pi)).then(Le=>Le&&hA(Le)).catch(Le=>qt(Le,Be,yt))}const Et=Be=>g.go(Be);let en;const ti=new Set;return{currentRoute:C,addRoute:U,removeRoute:ge,hasRoute:be,getRoutes:Ee,resolve:we,options:r,push:Ue,replace:st,go:Et,back:()=>Et(-1),forward:()=>Et(1),beforeEach:y.add,beforeResolve:E.add,afterEach:s.add,onError:Zi.add,isReady:ei,install(Be){const yt=this;Be.component("RouterLink",XA),Be.component("RouterView",QA),Be.config.globalProperties.$router=yt,Object.defineProperty(Be.config.globalProperties,"$route",{enumerable:!0,get:()=>ps(C)}),xc&&!en&&C.value===Ks&&(en=!0,Ue(g.location).catch(ui=>{}));const rt={};for(const ui in Ks)rt[ui]=hr(()=>C.value[ui]);Be.provide(Hp,yt),Be.provide(Eb,bo(rt)),Be.provide(Dg,C);const At=Be.unmount;ti.add(Be),Be.unmount=function(){ti.delete(Be),ti.size<1&&(k=Ks,ot&&ot(),C.value=Ks,en=!1,ri=!1),At()}}}}function dc(r){return r.reduce((o,l)=>o.then(()=>l()),Promise.resolve())}function eM(r,o){const l=[],h=[],g=[],y=Math.max(o.matched.length,r.matched.length);for(let E=0;E<y;E++){const s=o.matched[E];s&&(r.matched.find(k=>Mc(k,s))?h.push(s):l.push(s));const C=r.matched[E];C&&(o.matched.find(k=>Mc(k,C))||g.push(C))}return[l,h,g]}function i5(){return Ko(Hp)}var Ku=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},S_={exports:{}},Lb=function(o,l){return function(){for(var g=new Array(arguments.length),y=0;y<g.length;y++)g[y]=arguments[y];return o.apply(l,g)}},tM=Lb,ol=Object.prototype.toString;function C_(r){return ol.call(r)==="[object Array]"}function Og(r){return typeof r=="undefined"}function iM(r){return r!==null&&!Og(r)&&r.constructor!==null&&!Og(r.constructor)&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function nM(r){return ol.call(r)==="[object ArrayBuffer]"}function rM(r){return typeof FormData!="undefined"&&r instanceof FormData}function oM(r){var o;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?o=ArrayBuffer.isView(r):o=r&&r.buffer&&r.buffer instanceof ArrayBuffer,o}function sM(r){return typeof r=="string"}function aM(r){return typeof r=="number"}function Rb(r){return r!==null&&typeof r=="object"}function gp(r){if(ol.call(r)!=="[object Object]")return!1;var o=Object.getPrototypeOf(r);return o===null||o===Object.prototype}function lM(r){return ol.call(r)==="[object Date]"}function cM(r){return ol.call(r)==="[object File]"}function uM(r){return ol.call(r)==="[object Blob]"}function Ob(r){return ol.call(r)==="[object Function]"}function hM(r){return Rb(r)&&Ob(r.pipe)}function dM(r){return typeof URLSearchParams!="undefined"&&r instanceof URLSearchParams}function pM(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function fM(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function A_(r,o){if(!(r===null||typeof r=="undefined"))if(typeof r!="object"&&(r=[r]),C_(r))for(var l=0,h=r.length;l<h;l++)o.call(null,r[l],l,r);else for(var g in r)Object.prototype.hasOwnProperty.call(r,g)&&o.call(null,r[g],g,r)}function Bg(){var r={};function o(g,y){gp(r[y])&&gp(g)?r[y]=Bg(r[y],g):gp(g)?r[y]=Bg({},g):C_(g)?r[y]=g.slice():r[y]=g}for(var l=0,h=arguments.length;l<h;l++)A_(arguments[l],o);return r}function mM(r,o,l){return A_(o,function(g,y){l&&typeof g=="function"?r[y]=tM(g,l):r[y]=g}),r}function gM(r){return r.charCodeAt(0)===65279&&(r=r.slice(1)),r}var Ur={isArray:C_,isArrayBuffer:nM,isBuffer:iM,isFormData:rM,isArrayBufferView:oM,isString:sM,isNumber:aM,isObject:Rb,isPlainObject:gp,isUndefined:Og,isDate:lM,isFile:cM,isBlob:uM,isFunction:Ob,isStream:hM,isURLSearchParams:dM,isStandardBrowserEnv:fM,forEach:A_,merge:Bg,extend:mM,trim:pM,stripBOM:gM},pc=Ur;function Yv(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Bb=function(o,l,h){if(!l)return o;var g;if(h)g=h(l);else if(pc.isURLSearchParams(l))g=l.toString();else{var y=[];pc.forEach(l,function(C,k){C===null||typeof C=="undefined"||(pc.isArray(C)?k=k+"[]":C=[C],pc.forEach(C,function(D){pc.isDate(D)?D=D.toISOString():pc.isObject(D)&&(D=JSON.stringify(D)),y.push(Yv(k)+"="+Yv(D))}))}),g=y.join("&")}if(g){var E=o.indexOf("#");E!==-1&&(o=o.slice(0,E)),o+=(o.indexOf("?")===-1?"?":"&")+g}return o},_M=Ur;function Kp(){this.handlers=[]}Kp.prototype.use=function(o,l,h){return this.handlers.push({fulfilled:o,rejected:l,synchronous:h?h.synchronous:!1,runWhen:h?h.runWhen:null}),this.handlers.length-1};Kp.prototype.eject=function(o){this.handlers[o]&&(this.handlers[o]=null)};Kp.prototype.forEach=function(o){_M.forEach(this.handlers,function(h){h!==null&&o(h)})};var yM=Kp,vM=Ur,xM=function(o,l){vM.forEach(o,function(g,y){y!==l&&y.toUpperCase()===l.toUpperCase()&&(o[l]=g,delete o[y])})},Fb=function(o,l,h,g,y){return o.config=l,h&&(o.code=h),o.request=g,o.response=y,o.isAxiosError=!0,o.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},o},bM=Fb,Nb=function(o,l,h,g,y){var E=new Error(o);return bM(E,l,h,g,y)},wM=Nb,TM=function(o,l,h){var g=h.config.validateStatus;!h.status||!g||g(h.status)?o(h):l(wM("Request failed with status code "+h.status,h.config,null,h.request,h))},tp=Ur,EM=tp.isStandardBrowserEnv()?function(){return{write:function(l,h,g,y,E,s){var C=[];C.push(l+"="+encodeURIComponent(h)),tp.isNumber(g)&&C.push("expires="+new Date(g).toGMTString()),tp.isString(y)&&C.push("path="+y),tp.isString(E)&&C.push("domain="+E),s===!0&&C.push("secure"),document.cookie=C.join("; ")},read:function(l){var h=document.cookie.match(new RegExp("(^|;\\s*)("+l+")=([^;]*)"));return h?decodeURIComponent(h[3]):null},remove:function(l){this.write(l,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),SM=function(o){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(o)},CM=function(o,l){return l?o.replace(/\/+$/,"")+"/"+l.replace(/^\/+/,""):o},AM=SM,MM=CM,IM=function(o,l){return o&&!AM(l)?MM(o,l):l},$m=Ur,kM=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],zM=function(o){var l={},h,g,y;return o&&$m.forEach(o.split(`
`),function(s){if(y=s.indexOf(":"),h=$m.trim(s.substr(0,y)).toLowerCase(),g=$m.trim(s.substr(y+1)),h){if(l[h]&&kM.indexOf(h)>=0)return;h==="set-cookie"?l[h]=(l[h]?l[h]:[]).concat([g]):l[h]=l[h]?l[h]+", "+g:g}}),l},Jv=Ur,PM=Jv.isStandardBrowserEnv()?function(){var o=/(msie|trident)/i.test(navigator.userAgent),l=document.createElement("a"),h;function g(y){var E=y;return o&&(l.setAttribute("href",E),E=l.href),l.setAttribute("href",E),{href:l.href,protocol:l.protocol?l.protocol.replace(/:$/,""):"",host:l.host,search:l.search?l.search.replace(/^\?/,""):"",hash:l.hash?l.hash.replace(/^#/,""):"",hostname:l.hostname,port:l.port,pathname:l.pathname.charAt(0)==="/"?l.pathname:"/"+l.pathname}}return h=g(window.location.href),function(E){var s=Jv.isString(E)?g(E):E;return s.protocol===h.protocol&&s.host===h.host}}():function(){return function(){return!0}}();function M_(r){this.message=r}M_.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};M_.prototype.__CANCEL__=!0;var Yp=M_,ip=Ur,DM=TM,LM=EM,RM=Bb,OM=IM,BM=zM,FM=PM,Gm=Nb,NM=Qp,UM=Yp,Qv=function(o){return new Promise(function(h,g){var y=o.data,E=o.headers,s=o.responseType,C;function k(){o.cancelToken&&o.cancelToken.unsubscribe(C),o.signal&&o.signal.removeEventListener("abort",C)}ip.isFormData(y)&&delete E["Content-Type"];var M=new XMLHttpRequest;if(o.auth){var D=o.auth.username||"",R=o.auth.password?unescape(encodeURIComponent(o.auth.password)):"";E.Authorization="Basic "+btoa(D+":"+R)}var U=OM(o.baseURL,o.url);M.open(o.method.toUpperCase(),RM(U,o.params,o.paramsSerializer),!0),M.timeout=o.timeout;function ge(){if(!!M){var be="getAllResponseHeaders"in M?BM(M.getAllResponseHeaders()):null,we=!s||s==="text"||s==="json"?M.responseText:M.response,De={data:we,status:M.status,statusText:M.statusText,headers:be,config:o,request:M};DM(function(Ue){h(Ue),k()},function(Ue){g(Ue),k()},De),M=null}}if("onloadend"in M?M.onloadend=ge:M.onreadystatechange=function(){!M||M.readyState!==4||M.status===0&&!(M.responseURL&&M.responseURL.indexOf("file:")===0)||setTimeout(ge)},M.onabort=function(){!M||(g(Gm("Request aborted",o,"ECONNABORTED",M)),M=null)},M.onerror=function(){g(Gm("Network Error",o,null,M)),M=null},M.ontimeout=function(){var we=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded",De=o.transitional||NM.transitional;o.timeoutErrorMessage&&(we=o.timeoutErrorMessage),g(Gm(we,o,De.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",M)),M=null},ip.isStandardBrowserEnv()){var Ee=(o.withCredentials||FM(U))&&o.xsrfCookieName?LM.read(o.xsrfCookieName):void 0;Ee&&(E[o.xsrfHeaderName]=Ee)}"setRequestHeader"in M&&ip.forEach(E,function(we,De){typeof y=="undefined"&&De.toLowerCase()==="content-type"?delete E[De]:M.setRequestHeader(De,we)}),ip.isUndefined(o.withCredentials)||(M.withCredentials=!!o.withCredentials),s&&s!=="json"&&(M.responseType=o.responseType),typeof o.onDownloadProgress=="function"&&M.addEventListener("progress",o.onDownloadProgress),typeof o.onUploadProgress=="function"&&M.upload&&M.upload.addEventListener("progress",o.onUploadProgress),(o.cancelToken||o.signal)&&(C=function(be){!M||(g(!be||be&&be.type?new UM("canceled"):be),M.abort(),M=null)},o.cancelToken&&o.cancelToken.subscribe(C),o.signal&&(o.signal.aborted?C():o.signal.addEventListener("abort",C))),y||(y=null),M.send(y)})},Zn=Ur,ex=xM,jM=Fb,VM={"Content-Type":"application/x-www-form-urlencoded"};function tx(r,o){!Zn.isUndefined(r)&&Zn.isUndefined(r["Content-Type"])&&(r["Content-Type"]=o)}function $M(){var r;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(r=Qv),r}function GM(r,o,l){if(Zn.isString(r))try{return(o||JSON.parse)(r),Zn.trim(r)}catch(h){if(h.name!=="SyntaxError")throw h}return(l||JSON.stringify)(r)}var Jp={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:$M(),transformRequest:[function(o,l){return ex(l,"Accept"),ex(l,"Content-Type"),Zn.isFormData(o)||Zn.isArrayBuffer(o)||Zn.isBuffer(o)||Zn.isStream(o)||Zn.isFile(o)||Zn.isBlob(o)?o:Zn.isArrayBufferView(o)?o.buffer:Zn.isURLSearchParams(o)?(tx(l,"application/x-www-form-urlencoded;charset=utf-8"),o.toString()):Zn.isObject(o)||l&&l["Content-Type"]==="application/json"?(tx(l,"application/json"),GM(o)):o}],transformResponse:[function(o){var l=this.transitional||Jp.transitional,h=l&&l.silentJSONParsing,g=l&&l.forcedJSONParsing,y=!h&&this.responseType==="json";if(y||g&&Zn.isString(o)&&o.length)try{return JSON.parse(o)}catch(E){if(y)throw E.name==="SyntaxError"?jM(E,this,"E_JSON_PARSE"):E}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Zn.forEach(["delete","get","head"],function(o){Jp.headers[o]={}});Zn.forEach(["post","put","patch"],function(o){Jp.headers[o]=Zn.merge(VM)});var Qp=Jp,qM=Ur,ZM=Qp,WM=function(o,l,h){var g=this||ZM;return qM.forEach(h,function(E){o=E.call(g,o,l)}),o},Ub=function(o){return!!(o&&o.__CANCEL__)},ix=Ur,qm=WM,HM=Ub,XM=Qp,KM=Yp;function Zm(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new KM("canceled")}var YM=function(o){Zm(o),o.headers=o.headers||{},o.data=qm.call(o,o.data,o.headers,o.transformRequest),o.headers=ix.merge(o.headers.common||{},o.headers[o.method]||{},o.headers),ix.forEach(["delete","get","head","post","put","patch","common"],function(g){delete o.headers[g]});var l=o.adapter||XM.adapter;return l(o).then(function(g){return Zm(o),g.data=qm.call(o,g.data,g.headers,o.transformResponse),g},function(g){return HM(g)||(Zm(o),g&&g.response&&(g.response.data=qm.call(o,g.response.data,g.response.headers,o.transformResponse))),Promise.reject(g)})},Lr=Ur,jb=function(o,l){l=l||{};var h={};function g(M,D){return Lr.isPlainObject(M)&&Lr.isPlainObject(D)?Lr.merge(M,D):Lr.isPlainObject(D)?Lr.merge({},D):Lr.isArray(D)?D.slice():D}function y(M){if(Lr.isUndefined(l[M])){if(!Lr.isUndefined(o[M]))return g(void 0,o[M])}else return g(o[M],l[M])}function E(M){if(!Lr.isUndefined(l[M]))return g(void 0,l[M])}function s(M){if(Lr.isUndefined(l[M])){if(!Lr.isUndefined(o[M]))return g(void 0,o[M])}else return g(void 0,l[M])}function C(M){if(M in l)return g(o[M],l[M]);if(M in o)return g(void 0,o[M])}var k={url:E,method:E,data:E,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:C};return Lr.forEach(Object.keys(o).concat(Object.keys(l)),function(D){var R=k[D]||y,U=R(D);Lr.isUndefined(U)&&R!==C||(h[D]=U)}),h},Vb={version:"0.24.0"},JM=Vb.version,I_={};["object","boolean","number","function","string","symbol"].forEach(function(r,o){I_[r]=function(h){return typeof h===r||"a"+(o<1?"n ":" ")+r}});var nx={};I_.transitional=function(o,l,h){function g(y,E){return"[Axios v"+JM+"] Transitional option '"+y+"'"+E+(h?". "+h:"")}return function(y,E,s){if(o===!1)throw new Error(g(E," has been removed"+(l?" in "+l:"")));return l&&!nx[E]&&(nx[E]=!0,console.warn(g(E," has been deprecated since v"+l+" and will be removed in the near future"))),o?o(y,E,s):!0}};function QM(r,o,l){if(typeof r!="object")throw new TypeError("options must be an object");for(var h=Object.keys(r),g=h.length;g-- >0;){var y=h[g],E=o[y];if(E){var s=r[y],C=s===void 0||E(s,y,r);if(C!==!0)throw new TypeError("option "+y+" must be "+C);continue}if(l!==!0)throw Error("Unknown option "+y)}}var eI={assertOptions:QM,validators:I_},$b=Ur,tI=Bb,rx=yM,ox=YM,ef=jb,Gb=eI,fc=Gb.validators;function wh(r){this.defaults=r,this.interceptors={request:new rx,response:new rx}}wh.prototype.request=function(o){typeof o=="string"?(o=arguments[1]||{},o.url=arguments[0]):o=o||{},o=ef(this.defaults,o),o.method?o.method=o.method.toLowerCase():this.defaults.method?o.method=this.defaults.method.toLowerCase():o.method="get";var l=o.transitional;l!==void 0&&Gb.assertOptions(l,{silentJSONParsing:fc.transitional(fc.boolean),forcedJSONParsing:fc.transitional(fc.boolean),clarifyTimeoutError:fc.transitional(fc.boolean)},!1);var h=[],g=!0;this.interceptors.request.forEach(function(R){typeof R.runWhen=="function"&&R.runWhen(o)===!1||(g=g&&R.synchronous,h.unshift(R.fulfilled,R.rejected))});var y=[];this.interceptors.response.forEach(function(R){y.push(R.fulfilled,R.rejected)});var E;if(!g){var s=[ox,void 0];for(Array.prototype.unshift.apply(s,h),s=s.concat(y),E=Promise.resolve(o);s.length;)E=E.then(s.shift(),s.shift());return E}for(var C=o;h.length;){var k=h.shift(),M=h.shift();try{C=k(C)}catch(D){M(D);break}}try{E=ox(C)}catch(D){return Promise.reject(D)}for(;y.length;)E=E.then(y.shift(),y.shift());return E};wh.prototype.getUri=function(o){return o=ef(this.defaults,o),tI(o.url,o.params,o.paramsSerializer).replace(/^\?/,"")};$b.forEach(["delete","get","head","options"],function(o){wh.prototype[o]=function(l,h){return this.request(ef(h||{},{method:o,url:l,data:(h||{}).data}))}});$b.forEach(["post","put","patch"],function(o){wh.prototype[o]=function(l,h,g){return this.request(ef(g||{},{method:o,url:l,data:h}))}});var iI=wh,nI=Yp;function kc(r){if(typeof r!="function")throw new TypeError("executor must be a function.");var o;this.promise=new Promise(function(g){o=g});var l=this;this.promise.then(function(h){if(!!l._listeners){var g,y=l._listeners.length;for(g=0;g<y;g++)l._listeners[g](h);l._listeners=null}}),this.promise.then=function(h){var g,y=new Promise(function(E){l.subscribe(E),g=E}).then(h);return y.cancel=function(){l.unsubscribe(g)},y},r(function(g){l.reason||(l.reason=new nI(g),o(l.reason))})}kc.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};kc.prototype.subscribe=function(o){if(this.reason){o(this.reason);return}this._listeners?this._listeners.push(o):this._listeners=[o]};kc.prototype.unsubscribe=function(o){if(!!this._listeners){var l=this._listeners.indexOf(o);l!==-1&&this._listeners.splice(l,1)}};kc.source=function(){var o,l=new kc(function(g){o=g});return{token:l,cancel:o}};var rI=kc,oI=function(o){return function(h){return o.apply(null,h)}},sI=function(o){return typeof o=="object"&&o.isAxiosError===!0},sx=Ur,aI=Lb,_p=iI,lI=jb,cI=Qp;function qb(r){var o=new _p(r),l=aI(_p.prototype.request,o);return sx.extend(l,_p.prototype,o),sx.extend(l,o),l.create=function(g){return qb(lI(r,g))},l}var Qo=qb(cI);Qo.Axios=_p;Qo.Cancel=Yp;Qo.CancelToken=rI;Qo.isCancel=Ub;Qo.VERSION=Vb.version;Qo.all=function(o){return Promise.all(o)};Qo.spread=oI;Qo.isAxiosError=sI;S_.exports=Qo;S_.exports.default=Qo;var n5=S_.exports;/*!
 * vuex v4.0.2
 * (c) 2021 Evan You
 * @license MIT
 */var Zb="store";function r5(r){return r===void 0&&(r=null),Ko(r!==null?r:Zb)}function uI(r,o){return r.filter(o)[0]}function Fg(r,o){if(o===void 0&&(o=[]),r===null||typeof r!="object")return r;var l=uI(o,function(g){return g.original===r});if(l)return l.copy;var h=Array.isArray(r)?[]:{};return o.push({original:r,copy:h}),Object.keys(r).forEach(function(g){h[g]=Fg(r[g],o)}),h}function Fc(r,o){Object.keys(r).forEach(function(l){return o(r[l],l)})}function hI(r){return r!==null&&typeof r=="object"}function dI(r){return r&&typeof r.then=="function"}function pI(r,o){return function(){return r(o)}}function Wb(r,o,l){return o.indexOf(r)<0&&(l&&l.prepend?o.unshift(r):o.push(r)),function(){var h=o.indexOf(r);h>-1&&o.splice(h,1)}}function Hb(r,o){r._actions=Object.create(null),r._mutations=Object.create(null),r._wrappedGetters=Object.create(null),r._modulesNamespaceMap=Object.create(null);var l=r.state;tf(r,l,[],r._modules.root,!0),k_(r,l,o)}function k_(r,o,l){var h=r._state;r.getters={},r._makeLocalGettersCache=Object.create(null);var g=r._wrappedGetters,y={};Fc(g,function(E,s){y[s]=pI(E,r),Object.defineProperty(r.getters,s,{get:function(){return y[s]()},enumerable:!0})}),r._state=bo({data:o}),r.strict&&yI(r),h&&l&&r._withCommit(function(){h.data=null})}function tf(r,o,l,h,g){var y=!l.length,E=r._modules.getNamespace(l);if(h.namespaced&&(r._modulesNamespaceMap[E],r._modulesNamespaceMap[E]=h),!y&&!g){var s=z_(o,l.slice(0,-1)),C=l[l.length-1];r._withCommit(function(){s[C]=h.state})}var k=h.context=fI(r,E,l);h.forEachMutation(function(M,D){var R=E+D;mI(r,R,M,k)}),h.forEachAction(function(M,D){var R=M.root?D:E+D,U=M.handler||M;gI(r,R,U,k)}),h.forEachGetter(function(M,D){var R=E+D;_I(r,R,M,k)}),h.forEachChild(function(M,D){tf(r,o,l.concat(D),M,g)})}function fI(r,o,l){var h=o==="",g={dispatch:h?r.dispatch:function(y,E,s){var C=kp(y,E,s),k=C.payload,M=C.options,D=C.type;return(!M||!M.root)&&(D=o+D),r.dispatch(D,k)},commit:h?r.commit:function(y,E,s){var C=kp(y,E,s),k=C.payload,M=C.options,D=C.type;(!M||!M.root)&&(D=o+D),r.commit(D,k,M)}};return Object.defineProperties(g,{getters:{get:h?function(){return r.getters}:function(){return Xb(r,o)}},state:{get:function(){return z_(r.state,l)}}}),g}function Xb(r,o){if(!r._makeLocalGettersCache[o]){var l={},h=o.length;Object.keys(r.getters).forEach(function(g){if(g.slice(0,h)===o){var y=g.slice(h);Object.defineProperty(l,y,{get:function(){return r.getters[g]},enumerable:!0})}}),r._makeLocalGettersCache[o]=l}return r._makeLocalGettersCache[o]}function mI(r,o,l,h){var g=r._mutations[o]||(r._mutations[o]=[]);g.push(function(E){l.call(r,h.state,E)})}function gI(r,o,l,h){var g=r._actions[o]||(r._actions[o]=[]);g.push(function(E){var s=l.call(r,{dispatch:h.dispatch,commit:h.commit,getters:h.getters,state:h.state,rootGetters:r.getters,rootState:r.state},E);return dI(s)||(s=Promise.resolve(s)),r._devtoolHook?s.catch(function(C){throw r._devtoolHook.emit("vuex:error",C),C}):s})}function _I(r,o,l,h){r._wrappedGetters[o]||(r._wrappedGetters[o]=function(y){return l(h.state,h.getters,y.state,y.getters)})}function yI(r){wo(function(){return r._state.data},function(){},{deep:!0,flush:"sync"})}function z_(r,o){return o.reduce(function(l,h){return l[h]},r)}function kp(r,o,l){return hI(r)&&r.type&&(l=o,o=r,r=r.type),{type:r,payload:o,options:l}}var vI="vuex bindings",ax="vuex:mutations",Wm="vuex:actions",mc="vuex",xI=0;function bI(r,o){JC({id:"org.vuejs.vuex",app:r,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[vI]},function(l){l.addTimelineLayer({id:ax,label:"Vuex Mutations",color:lx}),l.addTimelineLayer({id:Wm,label:"Vuex Actions",color:lx}),l.addInspector({id:mc,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),l.on.getInspectorTree(function(h){if(h.app===r&&h.inspectorId===mc)if(h.filter){var g=[];Qb(g,o._modules.root,h.filter,""),h.rootNodes=g}else h.rootNodes=[Jb(o._modules.root,"")]}),l.on.getInspectorState(function(h){if(h.app===r&&h.inspectorId===mc){var g=h.nodeId;Xb(o,g),h.state=EI(CI(o._modules,g),g==="root"?o.getters:o._makeLocalGettersCache,g)}}),l.on.editInspectorState(function(h){if(h.app===r&&h.inspectorId===mc){var g=h.nodeId,y=h.path;g!=="root"&&(y=g.split("/").filter(Boolean).concat(y)),o._withCommit(function(){h.set(o._state.data,y,h.state.value)})}}),o.subscribe(function(h,g){var y={};h.payload&&(y.payload=h.payload),y.state=g,l.notifyComponentUpdate(),l.sendInspectorTree(mc),l.sendInspectorState(mc),l.addTimelineEvent({layerId:ax,event:{time:Date.now(),title:h.type,data:y}})}),o.subscribeAction({before:function(h,g){var y={};h.payload&&(y.payload=h.payload),h._id=xI++,h._time=Date.now(),y.state=g,l.addTimelineEvent({layerId:Wm,event:{time:h._time,title:h.type,groupId:h._id,subtitle:"start",data:y}})},after:function(h,g){var y={},E=Date.now()-h._time;y.duration={_custom:{type:"duration",display:E+"ms",tooltip:"Action duration",value:E}},h.payload&&(y.payload=h.payload),y.state=g,l.addTimelineEvent({layerId:Wm,event:{time:Date.now(),title:h.type,groupId:h._id,subtitle:"end",data:y}})}})})}var lx=8702998,wI=6710886,TI=16777215,Kb={label:"namespaced",textColor:TI,backgroundColor:wI};function Yb(r){return r&&r!=="root"?r.split("/").slice(-2,-1)[0]:"Root"}function Jb(r,o){return{id:o||"root",label:Yb(o),tags:r.namespaced?[Kb]:[],children:Object.keys(r._children).map(function(l){return Jb(r._children[l],o+l+"/")})}}function Qb(r,o,l,h){h.includes(l)&&r.push({id:h||"root",label:h.endsWith("/")?h.slice(0,h.length-1):h||"Root",tags:o.namespaced?[Kb]:[]}),Object.keys(o._children).forEach(function(g){Qb(r,o._children[g],l,h+g+"/")})}function EI(r,o,l){o=l==="root"?o:o[l];var h=Object.keys(o),g={state:Object.keys(r.state).map(function(E){return{key:E,editable:!0,value:r.state[E]}})};if(h.length){var y=SI(o);g.getters=Object.keys(y).map(function(E){return{key:E.endsWith("/")?Yb(E):E,editable:!1,value:Ng(function(){return y[E]})}})}return g}function SI(r){var o={};return Object.keys(r).forEach(function(l){var h=l.split("/");if(h.length>1){var g=o,y=h.pop();h.forEach(function(E){g[E]||(g[E]={_custom:{value:{},display:E,tooltip:"Module",abstract:!0}}),g=g[E]._custom.value}),g[y]=Ng(function(){return r[l]})}else o[l]=Ng(function(){return r[l]})}),o}function CI(r,o){var l=o.split("/").filter(function(h){return h});return l.reduce(function(h,g,y){var E=h[g];if(!E)throw new Error('Missing module "'+g+'" for path "'+o+'".');return y===l.length-1?E:E._children},o==="root"?r:r.root._children)}function Ng(r){try{return r()}catch(o){return o}}var So=function(o,l){this.runtime=l,this._children=Object.create(null),this._rawModule=o;var h=o.state;this.state=(typeof h=="function"?h():h)||{}},ew={namespaced:{configurable:!0}};ew.namespaced.get=function(){return!!this._rawModule.namespaced};So.prototype.addChild=function(o,l){this._children[o]=l};So.prototype.removeChild=function(o){delete this._children[o]};So.prototype.getChild=function(o){return this._children[o]};So.prototype.hasChild=function(o){return o in this._children};So.prototype.update=function(o){this._rawModule.namespaced=o.namespaced,o.actions&&(this._rawModule.actions=o.actions),o.mutations&&(this._rawModule.mutations=o.mutations),o.getters&&(this._rawModule.getters=o.getters)};So.prototype.forEachChild=function(o){Fc(this._children,o)};So.prototype.forEachGetter=function(o){this._rawModule.getters&&Fc(this._rawModule.getters,o)};So.prototype.forEachAction=function(o){this._rawModule.actions&&Fc(this._rawModule.actions,o)};So.prototype.forEachMutation=function(o){this._rawModule.mutations&&Fc(this._rawModule.mutations,o)};Object.defineProperties(So.prototype,ew);var sl=function(o){this.register([],o,!1)};sl.prototype.get=function(o){return o.reduce(function(l,h){return l.getChild(h)},this.root)};sl.prototype.getNamespace=function(o){var l=this.root;return o.reduce(function(h,g){return l=l.getChild(g),h+(l.namespaced?g+"/":"")},"")};sl.prototype.update=function(o){tw([],this.root,o)};sl.prototype.register=function(o,l,h){var g=this;h===void 0&&(h=!0);var y=new So(l,h);if(o.length===0)this.root=y;else{var E=this.get(o.slice(0,-1));E.addChild(o[o.length-1],y)}l.modules&&Fc(l.modules,function(s,C){g.register(o.concat(C),s,h)})};sl.prototype.unregister=function(o){var l=this.get(o.slice(0,-1)),h=o[o.length-1],g=l.getChild(h);!g||!g.runtime||l.removeChild(h)};sl.prototype.isRegistered=function(o){var l=this.get(o.slice(0,-1)),h=o[o.length-1];return l?l.hasChild(h):!1};function tw(r,o,l){if(o.update(l),l.modules)for(var h in l.modules){if(!o.getChild(h))return;tw(r.concat(h),o.getChild(h),l.modules[h])}}function o5(r){return new Sr(r)}var Sr=function(o){var l=this;o===void 0&&(o={});var h=o.plugins;h===void 0&&(h=[]);var g=o.strict;g===void 0&&(g=!1);var y=o.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new sl(o),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._devtools=y;var E=this,s=this,C=s.dispatch,k=s.commit;this.dispatch=function(R,U){return C.call(E,R,U)},this.commit=function(R,U,ge){return k.call(E,R,U,ge)},this.strict=g;var M=this._modules.root.state;tf(this,M,[],this._modules.root),k_(this,M),h.forEach(function(D){return D(l)})},P_={state:{configurable:!0}};Sr.prototype.install=function(o,l){o.provide(l||Zb,this),o.config.globalProperties.$store=this;var h=this._devtools!==void 0?this._devtools:!1;h&&bI(o,this)};P_.state.get=function(){return this._state.data};P_.state.set=function(r){};Sr.prototype.commit=function(o,l,h){var g=this,y=kp(o,l,h),E=y.type,s=y.payload,C={type:E,payload:s},k=this._mutations[E];!k||(this._withCommit(function(){k.forEach(function(D){D(s)})}),this._subscribers.slice().forEach(function(M){return M(C,g.state)}))};Sr.prototype.dispatch=function(o,l){var h=this,g=kp(o,l),y=g.type,E=g.payload,s={type:y,payload:E},C=this._actions[y];if(!!C){try{this._actionSubscribers.slice().filter(function(M){return M.before}).forEach(function(M){return M.before(s,h.state)})}catch{}var k=C.length>1?Promise.all(C.map(function(M){return M(E)})):C[0](E);return new Promise(function(M,D){k.then(function(R){try{h._actionSubscribers.filter(function(U){return U.after}).forEach(function(U){return U.after(s,h.state)})}catch{}M(R)},function(R){try{h._actionSubscribers.filter(function(U){return U.error}).forEach(function(U){return U.error(s,h.state,R)})}catch{}D(R)})})}};Sr.prototype.subscribe=function(o,l){return Wb(o,this._subscribers,l)};Sr.prototype.subscribeAction=function(o,l){var h=typeof o=="function"?{before:o}:o;return Wb(h,this._actionSubscribers,l)};Sr.prototype.watch=function(o,l,h){var g=this;return wo(function(){return o(g.state,g.getters)},l,Object.assign({},h))};Sr.prototype.replaceState=function(o){var l=this;this._withCommit(function(){l._state.data=o})};Sr.prototype.registerModule=function(o,l,h){h===void 0&&(h={}),typeof o=="string"&&(o=[o]),this._modules.register(o,l),tf(this,this.state,o,this._modules.get(o),h.preserveState),k_(this,this.state)};Sr.prototype.unregisterModule=function(o){var l=this;typeof o=="string"&&(o=[o]),this._modules.unregister(o),this._withCommit(function(){var h=z_(l.state,o.slice(0,-1));delete h[o[o.length-1]]}),Hb(this)};Sr.prototype.hasModule=function(o){return typeof o=="string"&&(o=[o]),this._modules.isRegistered(o)};Sr.prototype.hotUpdate=function(o){this._modules.update(o),Hb(this,!0)};Sr.prototype._withCommit=function(o){var l=this._committing;this._committing=!0,o(),this._committing=l};Object.defineProperties(Sr.prototype,P_);function s5(r){r===void 0&&(r={});var o=r.collapsed;o===void 0&&(o=!0);var l=r.filter;l===void 0&&(l=function(M,D,R){return!0});var h=r.transformer;h===void 0&&(h=function(M){return M});var g=r.mutationTransformer;g===void 0&&(g=function(M){return M});var y=r.actionFilter;y===void 0&&(y=function(M,D){return!0});var E=r.actionTransformer;E===void 0&&(E=function(M){return M});var s=r.logMutations;s===void 0&&(s=!0);var C=r.logActions;C===void 0&&(C=!0);var k=r.logger;return k===void 0&&(k=console),function(M){var D=Fg(M.state);typeof k!="undefined"&&(s&&M.subscribe(function(R,U){var ge=Fg(U);if(l(R,D,ge)){var Ee=hx(),be=g(R),we="mutation "+R.type+Ee;cx(k,we,o),k.log("%c prev state","color: #9E9E9E; font-weight: bold",h(D)),k.log("%c mutation","color: #03A9F4; font-weight: bold",be),k.log("%c next state","color: #4CAF50; font-weight: bold",h(ge)),ux(k)}D=ge}),C&&M.subscribeAction(function(R,U){if(y(R,U)){var ge=hx(),Ee=E(R),be="action "+R.type+ge;cx(k,be,o),k.log("%c action","color: #03A9F4; font-weight: bold",Ee),ux(k)}}))}}function cx(r,o,l){var h=l?r.groupCollapsed:r.group;try{h.call(r,o)}catch{r.log(o)}}function ux(r){try{r.groupEnd()}catch{r.log("\u2014\u2014 log end \u2014\u2014")}}function hx(){var r=new Date;return" @ "+np(r.getHours(),2)+":"+np(r.getMinutes(),2)+":"+np(r.getSeconds(),2)+"."+np(r.getMilliseconds(),3)}function AI(r,o){return new Array(o+1).join(r)}function np(r,o){return AI("0",o-r.toString().length)+r}var MI=Math.ceil,II=Math.max;function kI(r,o,l,h){for(var g=-1,y=II(MI((o-r)/(l||1)),0),E=Array(y);y--;)E[h?y:++g]=r,r+=l;return E}var zI=kI;function PI(r,o){return r===o||r!==r&&o!==o}var DI=PI,LI=typeof Ku=="object"&&Ku&&Ku.Object===Object&&Ku,RI=LI,OI=RI,BI=typeof self=="object"&&self&&self.Object===Object&&self,FI=OI||BI||Function("return this")(),NI=FI,UI=NI,jI=UI.Symbol,iw=jI,dx=iw,nw=Object.prototype,VI=nw.hasOwnProperty,$I=nw.toString,Gu=dx?dx.toStringTag:void 0;function GI(r){var o=VI.call(r,Gu),l=r[Gu];try{r[Gu]=void 0;var h=!0}catch{}var g=$I.call(r);return h&&(o?r[Gu]=l:delete r[Gu]),g}var qI=GI,ZI=Object.prototype,WI=ZI.toString;function HI(r){return WI.call(r)}var XI=HI,px=iw,KI=qI,YI=XI,JI="[object Null]",QI="[object Undefined]",fx=px?px.toStringTag:void 0;function ek(r){return r==null?r===void 0?QI:JI:fx&&fx in Object(r)?KI(r):YI(r)}var rw=ek;function tk(r){var o=typeof r;return r!=null&&(o=="object"||o=="function")}var D_=tk,ik=rw,nk=D_,rk="[object AsyncFunction]",ok="[object Function]",sk="[object GeneratorFunction]",ak="[object Proxy]";function lk(r){if(!nk(r))return!1;var o=ik(r);return o==ok||o==sk||o==rk||o==ak}var ck=lk,uk=9007199254740991;function hk(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=uk}var dk=hk,pk=ck,fk=dk;function mk(r){return r!=null&&fk(r.length)&&!pk(r)}var gk=mk,_k=9007199254740991,yk=/^(?:0|[1-9]\d*)$/;function vk(r,o){var l=typeof r;return o=o==null?_k:o,!!o&&(l=="number"||l!="symbol"&&yk.test(r))&&r>-1&&r%1==0&&r<o}var xk=vk,bk=DI,wk=gk,Tk=xk,Ek=D_;function Sk(r,o,l){if(!Ek(l))return!1;var h=typeof o;return(h=="number"?wk(l)&&Tk(o,l.length):h=="string"&&o in l)?bk(l[o],r):!1}var Ck=Sk,Ak=/\s/;function Mk(r){for(var o=r.length;o--&&Ak.test(r.charAt(o)););return o}var Ik=Mk,kk=Ik,zk=/^\s+/;function Pk(r){return r&&r.slice(0,kk(r)+1).replace(zk,"")}var Dk=Pk;function Lk(r){return r!=null&&typeof r=="object"}var Rk=Lk,Ok=rw,Bk=Rk,Fk="[object Symbol]";function Nk(r){return typeof r=="symbol"||Bk(r)&&Ok(r)==Fk}var Uk=Nk,jk=Dk,mx=D_,Vk=Uk,gx=0/0,$k=/^[-+]0x[0-9a-f]+$/i,Gk=/^0b[01]+$/i,qk=/^0o[0-7]+$/i,Zk=parseInt;function Wk(r){if(typeof r=="number")return r;if(Vk(r))return gx;if(mx(r)){var o=typeof r.valueOf=="function"?r.valueOf():r;r=mx(o)?o+"":o}if(typeof r!="string")return r===0?r:+r;r=jk(r);var l=Gk.test(r);return l||qk.test(r)?Zk(r.slice(2),l?2:8):$k.test(r)?gx:+r}var Hk=Wk,Xk=Hk,_x=1/0,Kk=17976931348623157e292;function Yk(r){if(!r)return r===0?r:0;if(r=Xk(r),r===_x||r===-_x){var o=r<0?-1:1;return o*Kk}return r===r?r:0}var Jk=Yk,Qk=zI,e3=Ck,Hm=Jk;function t3(r){return function(o,l,h){return h&&typeof h!="number"&&e3(o,l,h)&&(l=h=void 0),o=Hm(o),l===void 0?(l=o,o=0):l=Hm(l),h=h===void 0?o<l?1:-1:Hm(h),Qk(o,l,h,r)}}var i3=t3,n3=i3,r3=n3(),a5=r3;/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function yx(r){return Object.prototype.toString.call(r)==="[object Object]"}function o3(r){var o,l;return yx(r)===!1?!1:(o=r.constructor,o===void 0?!0:(l=o.prototype,!(yx(l)===!1||l.hasOwnProperty("isPrototypeOf")===!1)))}var s3=Object.defineProperty,a3=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function al(r,o,l){o===void 0&&(o={}),l===void 0&&(l=!1);var h={_vueTypes_name:{value:r,writable:!0},def:{value:function(g){return g===void 0?("default"in this&&delete this.default,this):(this.default=a3(g)?function(){return[].concat(g)}:o3(g)?function(){return Object.assign({},g)}:g,this)}},isRequired:{get:function(){return this.required=!0,this}}};return l&&(h.validate={value:function(){}}),o.validator||(o.validator=function(){return!0}),Object.defineProperties(o,h)}var l5=function(){return al("bool",{type:Boolean},!0)},c5=function(){return al("string",{type:String},!0)},u5=function(){return al("number",{type:Number},!0)},h5=function(){return al("object",{type:Object},!0)},d5=function(r){return al("oneOf")},p5=function(r){return al("arrayOf",{type:Array})},f5=function(r){return s3(al("shape",{type:Object}),"loose",{get:function(){return this}})},l3={exports:{}};(function(r,o){(function(l,h){r.exports=h()})(Ku,function(){var l,h,g;function y(s,C){if(!l)l=C;else if(!h)h=C;else{var k="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+h+")(sharedChunk); self.onerror = null;",M={};l(M),g=C(M),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(g.workerUrl=window.URL.createObjectURL(new Blob([k],{type:"text/javascript"})))}}y(["exports"],function(s){var C="2.7.0",k=M;function M(t,e,n,a){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=n,this.p2y=a}M.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},M.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},M.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},M.prototype.solveCurveX=function(t,e){var n,a,u,d,m;for(e===void 0&&(e=1e-6),u=t,m=0;m<8;m++){if(d=this.sampleCurveX(u)-t,Math.abs(d)<e)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=d/v}if((u=t)<(n=0))return n;if(u>(a=1))return a;for(;n<a;){if(d=this.sampleCurveX(u),Math.abs(d-t)<e)return u;t>d?n=u:a=u,u=.5*(a-n)+n}return u},M.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var D=R;function R(t,e){this.x=t,this.y=e}R.prototype={clone:function(){return new R(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),a=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=a,this},_rotateAround:function(t,e){var n=Math.cos(t),a=Math.sin(t),u=e.y+a*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-a*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},R.convert=function(t){return t instanceof R?t:Array.isArray(t)?new R(t[0],t[1]):t};var U=typeof self!="undefined"?self:{},ge=1e-6,Ee=typeof Float32Array!="undefined"?Float32Array:Array;function be(){var t=new Ee(9);return Ee!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function we(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function De(t,e,n){var a=e[0],u=e[1],d=e[2],m=e[3],v=e[4],b=e[5],T=e[6],A=e[7],I=e[8],z=e[9],F=e[10],j=e[11],G=e[12],Z=e[13],Q=e[14],se=e[15],de=n[0],me=n[1],_e=n[2],xe=n[3];return t[0]=de*a+me*v+_e*I+xe*G,t[1]=de*u+me*b+_e*z+xe*Z,t[2]=de*d+me*T+_e*F+xe*Q,t[3]=de*m+me*A+_e*j+xe*se,t[4]=(de=n[4])*a+(me=n[5])*v+(_e=n[6])*I+(xe=n[7])*G,t[5]=de*u+me*b+_e*z+xe*Z,t[6]=de*d+me*T+_e*F+xe*Q,t[7]=de*m+me*A+_e*j+xe*se,t[8]=(de=n[8])*a+(me=n[9])*v+(_e=n[10])*I+(xe=n[11])*G,t[9]=de*u+me*b+_e*z+xe*Z,t[10]=de*d+me*T+_e*F+xe*Q,t[11]=de*m+me*A+_e*j+xe*se,t[12]=(de=n[12])*a+(me=n[13])*v+(_e=n[14])*I+(xe=n[15])*G,t[13]=de*u+me*b+_e*z+xe*Z,t[14]=de*d+me*T+_e*F+xe*Q,t[15]=de*m+me*A+_e*j+xe*se,t}function Xe(t,e,n){var a,u,d,m,v,b,T,A,I,z,F,j,G=n[0],Z=n[1],Q=n[2];return e===t?(t[12]=e[0]*G+e[4]*Z+e[8]*Q+e[12],t[13]=e[1]*G+e[5]*Z+e[9]*Q+e[13],t[14]=e[2]*G+e[6]*Z+e[10]*Q+e[14],t[15]=e[3]*G+e[7]*Z+e[11]*Q+e[15]):(u=e[1],d=e[2],m=e[3],v=e[4],b=e[5],T=e[6],A=e[7],I=e[8],z=e[9],F=e[10],j=e[11],t[0]=a=e[0],t[1]=u,t[2]=d,t[3]=m,t[4]=v,t[5]=b,t[6]=T,t[7]=A,t[8]=I,t[9]=z,t[10]=F,t[11]=j,t[12]=a*G+v*Z+I*Q+e[12],t[13]=u*G+b*Z+z*Q+e[13],t[14]=d*G+T*Z+F*Q+e[14],t[15]=m*G+A*Z+j*Q+e[15]),t}function Ue(t,e,n){var a=n[0],u=n[1],d=n[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*u,t[5]=e[5]*u,t[6]=e[6]*u,t[7]=e[7]*u,t[8]=e[8]*d,t[9]=e[9]*d,t[10]=e[10]*d,t[11]=e[11]*d,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function st(t,e,n){var a=Math.sin(n),u=Math.cos(n),d=e[4],m=e[5],v=e[6],b=e[7],T=e[8],A=e[9],I=e[10],z=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=d*u+T*a,t[5]=m*u+A*a,t[6]=v*u+I*a,t[7]=b*u+z*a,t[8]=T*u-d*a,t[9]=A*u-m*a,t[10]=I*u-v*a,t[11]=z*u-b*a,t}function ut(t,e,n){var a=Math.sin(n),u=Math.cos(n),d=e[0],m=e[1],v=e[2],b=e[3],T=e[8],A=e[9],I=e[10],z=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=d*u-T*a,t[1]=m*u-A*a,t[2]=v*u-I*a,t[3]=b*u-z*a,t[8]=d*a+T*u,t[9]=m*a+A*u,t[10]=v*a+I*u,t[11]=b*a+z*u,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var lt=De;function It(){var t=new Ee(3);return Ee!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Ft(t){var e=new Ee(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ct(t){return Math.hypot(t[0],t[1],t[2])}function Tt(t,e,n){var a=new Ee(3);return a[0]=t,a[1]=e,a[2]=n,a}function ot(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Nt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ai(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Zi(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function ri(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function qt(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t}function ei(t,e){var n=e[0],a=e[1],u=e[2],d=n*n+a*a+u*u;return d>0&&(d=1/Math.sqrt(d)),t[0]=e[0]*d,t[1]=e[1]*d,t[2]=e[2]*d,t}function Si(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Qi(t,e,n){var a=e[0],u=e[1],d=e[2],m=n[0],v=n[1],b=n[2];return t[0]=u*b-d*v,t[1]=d*m-a*b,t[2]=a*v-u*m,t}function Et(t,e,n){var a=e[0],u=e[1],d=e[2],m=n[3]*a+n[7]*u+n[11]*d+n[15];return t[0]=(n[0]*a+n[4]*u+n[8]*d+n[12])/(m=m||1),t[1]=(n[1]*a+n[5]*u+n[9]*d+n[13])/m,t[2]=(n[2]*a+n[6]*u+n[10]*d+n[14])/m,t}function en(t,e,n){var a=n[0],u=n[1],d=n[2],m=e[0],v=e[1],b=e[2],T=u*b-d*v,A=d*m-a*b,I=a*v-u*m,z=u*I-d*A,F=d*T-a*I,j=a*A-u*T,G=2*n[3];return A*=G,I*=G,F*=2,j*=2,t[0]=m+(T*=G)+(z*=2),t[1]=v+A+F,t[2]=b+I+j,t}var ti,Dn=Nt,Be=Ai,yt=Ct;function rt(t,e,n){var a=e[0],u=e[1],d=e[2],m=e[3];return t[0]=n[0]*a+n[4]*u+n[8]*d+n[12]*m,t[1]=n[1]*a+n[5]*u+n[9]*d+n[13]*m,t[2]=n[2]*a+n[6]*u+n[10]*d+n[14]*m,t[3]=n[3]*a+n[7]*u+n[11]*d+n[15]*m,t}function At(){var t=new Ee(4);return Ee!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function ui(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function pi(t,e,n){n*=.5;var a=e[0],u=e[1],d=e[2],m=e[3],v=Math.sin(n),b=Math.cos(n);return t[0]=a*b+m*v,t[1]=u*b+d*v,t[2]=d*b-u*v,t[3]=m*b-a*v,t}function Le(t,e){return t[0]===e[0]&&t[1]===e[1]}It(),ti=new Ee(4),Ee!=Float32Array&&(ti[0]=0,ti[1]=0,ti[2]=0,ti[3]=0),It(),Tt(1,0,0),Tt(0,1,0),At(),At(),be(),function(){var t;t=new Ee(2),Ee!=Float32Array&&(t[0]=0,t[1]=0)}();const We=Math.PI/180,te=180/Math.PI;function ae(t){return t*We}function Ce(t){return t*te}const Ie=[[0,0],[1,0],[1,1],[0,1]];function Ve(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function Ke(t,e,n,a){const u=new k(t,e,n,a);return function(d){return u.solve(d)}}const ht=Ke(.25,.1,.25,1);function Ne(t,e,n){return Math.min(n,Math.max(e,t))}function tt(t,e,n){return(n=Ne((n-t)/(e-t),0,1))*n*(3-2*n)}function Ze(t,e,n){const a=n-e,u=((t-e)%a+a)%a+e;return u===e?n:u}function Mt(t,e,n){if(!t.length)return n(null,[]);let a=t.length;const u=new Array(t.length);let d=null;t.forEach((m,v)=>{e(m,(b,T)=>{b&&(d=b),u[v]=T,--a==0&&n(d,u)})})}function wt(t){const e=[];for(const n in t)e.push(t[n]);return e}function dt(t,...e){for(const n of e)for(const a in n)t[a]=n[a];return t}let Lt=1;function Zt(){return Lt++}function hi(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Wt(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function oi(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function Ki(t,e){t.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function Cn(t,e){return t.indexOf(e,t.length-e.length)!==-1}function fn(t,e,n){const a={};for(const u in t)a[u]=e.call(n||this,t[u],u,t);return a}function Hn(t,e,n){const a={};for(const u in t)e.call(n||this,t[u],u,t)&&(a[u]=t[u]);return a}function An(t){return Array.isArray(t)?t.map(An):typeof t=="object"&&t?fn(t,An):t}const Ni={};function Yt(t){Ni[t]||(typeof console!="undefined"&&console.warn(t),Ni[t]=!0)}function Mn(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function ro(t){let e=0;for(let n,a,u=0,d=t.length,m=d-1;u<d;m=u++)n=t[u],a=t[m],e+=(a.x-n.x)*(n.y+a.y);return e}function Xn(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function oo(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,a,u,d)=>{const m=u||d;return e[a]=!m||m.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let Vr,Kn,jn,$r=null;function un(t){if($r==null){const e=t.navigator?t.navigator.userAgent:null;$r=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return $r}function so(t){try{const e=U[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}const Ln={now:()=>jn!==void 0?jn:U.performance.now(),setNow(t){jn=t},restoreNow(){jn=void 0},frame(t){const e=U.requestAnimationFrame(t);return{cancel:()=>U.cancelAnimationFrame(e)}},getImageData(t,e=0){const n=U.document.createElement("canvas"),a=n.getContext("2d");if(!a)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,a.drawImage(t,0,0,t.width,t.height),a.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:t=>(Vr||(Vr=U.document.createElement("a")),Vr.href=t,Vr.href),get devicePixelRatio(){return U.devicePixelRatio},get prefersReducedMotion(){return!!U.matchMedia&&(Kn==null&&(Kn=U.matchMedia("(prefers-reduced-motion: reduce)")),Kn.matches)}};let J;const B={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(J==null){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{J={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):t}catch{J=t}}return J},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},V={supported:!1,testSupport:function(t){!he&&ee&&(ye?ve(t):K=t)}};let K,ee,he=!1,ye=!1;function ve(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,ee),t.isContextLost())return;V.supported=!0}catch{}t.deleteTexture(e),he=!0}U.document&&(ee=U.document.createElement("img"),ee.onload=function(){K&&ve(K),K=null,ye=!0},ee.onerror=function(){he=!0,K=null},ee.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const pe="01",ue="NO_ACCESS_TOKEN";function Y(t){return t.indexOf("mapbox:")===0}function fe(t){return B.API_URL_REGEX.test(t)}const Te=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function it(t){const e=t.match(Te);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function mt(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}function gt(t){if(!t)return null;const e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(U.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class vt{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=gt(B.ACCESS_TOKEN);let a="";return a=n&&n.u?U.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(u,d)=>String.fromCharCode(Number("0x"+d)))):B.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${a}`:`mapbox.eventData:${a}`}fetchEventData(){const e=so("localStorage"),n=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{const u=U.localStorage.getItem(n);u&&(this.eventData=JSON.parse(u));const d=U.localStorage.getItem(a);d&&(this.anonId=d)}catch{Yt("Unable to read from LocalStorage")}}saveEventData(){const e=so("localStorage"),n=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{U.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&U.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{Yt("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,a,u){if(!B.EVENTS_URL)return;const d=it(B.EVENTS_URL);d.params.push(`access_token=${u||B.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:pe,userId:this.anonId},v=n?dt(m,n):m,b={url:mt(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=qr(b,T=>{this.pendingRequest=null,a(T),this.saveEventData(),this.processRequests(u)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const $t=new class extends vt{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){B.EVENTS_URL&&B.ACCESS_TOKEN&&Array.isArray(t)&&t.some(n=>Y(n)||fe(n))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=gt(B.ACCESS_TOKEN),n=e?e.u:B.ACCESS_TOKEN;let a=n!==this.eventData.tokenU;oi(this.anonId)||(this.anonId=hi(),a=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const d=new Date(this.eventData.lastSuccess),m=new Date(u),v=(u-this.eventData.lastSuccess)/864e5;a=a||v>=1||v<-1||d.getDate()!==m.getDate()}else a=!0;if(!a)return this.processRequests();this.postEvent(u,{"enabled.telemetry":!1},d=>{d||(this.eventData.lastSuccess=u,this.eventData.tokenU=n)},t)}},Ht=$t.postTurnstileEvent.bind($t),Pi=new class extends vt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,a){this.skuToken=e,this.errorCb=a,B.EVENTS_URL&&(n||B.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(ue)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),oi(this.anonId)||(this.anonId=hi()),this.postEvent(n,{skuToken:this.skuToken},a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},t))}},Mi=Pi.postMapLoadEvent.bind(Pi),Bi=new class extends vt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,a){if(!B.API_URL||!B.SESSION_PATH)return;const u=it(B.API_URL+B.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${a||B.ACCESS_TOKEN||""}`);const d={url:mt(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=cf(d,m=>{this.pendingRequest=null,n(m),this.saveEventData(),this.processRequests(a)})}getSessionAPI(t,e,n,a){this.skuToken=e,this.errorCb=a,B.SESSION_PATH&&B.API_URL&&(n||B.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(ue)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},t)}},Ao=Bi.getSessionAPI.bind(Bi),ao=new Set,In="mapbox-tiles";let Gr,cl,Ch=500,$c=50;function la(){U.caches&&!Gr&&(Gr=U.caches.open(In))}function Gc(t){const e=t.indexOf("?");return e<0?t:t.slice(0,e)}let ul=1/0;const hl={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(hl);class ca extends Error{constructor(e,n,a){n===401&&fe(a)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=a}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const qc=Xn()?()=>self.worker&&self.worker.referrer:()=>(U.location.protocol==="blob:"?U.parent:U).location.href,Cr=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(qc())&&!/^\w+:/.test(n))){if(U.fetch&&U.Request&&U.AbortController&&U.Request.prototype.hasOwnProperty("signal"))return function(a,u){const d=new U.AbortController,m=new U.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:qc(),signal:d.signal});let v=!1,b=!1;const T=(A=m.url).indexOf("sku=")>0&&fe(A);var A;a.type==="json"&&m.headers.set("Accept","application/json");const I=(F,j,G)=>{if(b)return;if(F&&F.message!=="SecurityError"&&Yt(F),j&&G)return z(j);const Z=Date.now();U.fetch(m).then(Q=>{if(Q.ok){const se=T?Q.clone():null;return z(Q,se,Z)}return u(new ca(Q.statusText,Q.status,a.url))}).catch(Q=>{Q.code!==20&&u(new Error(Q.message))})},z=(F,j,G)=>{(a.type==="arrayBuffer"?F.arrayBuffer():a.type==="json"?F.json():F.text()).then(Z=>{b||(j&&G&&function(Q,se,de){if(la(),!Gr)return;const me={status:se.status,statusText:se.statusText,headers:new U.Headers};se.headers.forEach((xe,Oe)=>me.headers.set(Oe,xe));const _e=oo(se.headers.get("Cache-Control")||"");_e["no-store"]||(_e["max-age"]&&me.headers.set("Expires",new Date(de+1e3*_e["max-age"]).toUTCString()),new Date(me.headers.get("Expires")).getTime()-de<42e4||function(xe,Oe){if(cl===void 0)try{new Response(new ReadableStream),cl=!0}catch{cl=!1}cl?Oe(xe.body):xe.blob().then(Oe)}(se,xe=>{const Oe=new U.Response(xe,me);la(),Gr&&Gr.then(Pe=>Pe.put(Gc(Q.url),Oe)).catch(Pe=>Yt(Pe.message))}))}(m,j,G),v=!0,u(null,Z,F.headers.get("Cache-Control"),F.headers.get("Expires")))}).catch(Z=>{b||u(new Error(Z.message))})};return T?function(F,j){if(la(),!Gr)return j(null);const G=Gc(F.url);Gr.then(Z=>{Z.match(G).then(Q=>{const se=function(de){if(!de)return!1;const me=new Date(de.headers.get("Expires")||0),_e=oo(de.headers.get("Cache-Control")||"");return me>Date.now()&&!_e["no-cache"]}(Q);Z.delete(G),se&&Z.put(G,Q.clone()),j(null,Q,se)}).catch(j)}).catch(j)}(m,I):I(null,null),{cancel:()=>{b=!0,v||d.abort()}}}(t,e);if(Xn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(a,u){const d=new U.XMLHttpRequest;d.open(a.method||"GET",a.url,!0),a.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(const m in a.headers)d.setRequestHeader(m,a.headers[m]);return a.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=a.credentials==="include",d.onerror=()=>{u(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let m=d.response;if(a.type==="json")try{m=JSON.parse(d.response)}catch(v){return u(v)}u(null,m,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else u(new ca(d.statusText,d.status,a.url))},d.send(a.body),{cancel:()=>d.abort()}}(t,e)},ua=function(t,e){return Cr(dt(t,{type:"arrayBuffer"}),e)},qr=function(t,e){return Cr(dt(t,{method:"POST"}),e)},cf=function(t,e){return Cr(dt(t,{method:"GET"}),e)};function Ah(t){const e=U.document.createElement("a");return e.href=t,e.protocol===U.document.location.protocol&&e.host===U.document.location.host}const xs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let bs,ha;bs=[],ha=0;const Mh=function(t,e){if(V.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ha>=B.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return bs.push(d),d}ha++;let n=!1;const a=()=>{if(!n)for(n=!0,ha--;bs.length&&ha<B.MAX_PARALLEL_IMAGE_REQUESTS;){const d=bs.shift(),{requestParameters:m,callback:v,cancelled:b}=d;b||(d.cancel=Mh(m,v).cancel)}},u=ua(t,(d,m,v,b)=>{a(),d?e(d):m&&(U.createImageBitmap?function(T,A){const I=new U.Blob([new Uint8Array(T)],{type:"image/png"});U.createImageBitmap(I).then(z=>{A(null,z)}).catch(z=>{A(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(T,A)=>e(T,A,v,b)):function(T,A){const I=new U.Image,z=U.URL;I.onload=()=>{A(null,I),z.revokeObjectURL(I.src),I.onload=null,U.requestAnimationFrame(()=>{I.src=xs})},I.onerror=()=>A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const F=new U.Blob([new Uint8Array(T)],{type:"image/png"});I.src=T.byteLength?z.createObjectURL(F):xs}(m,(T,A)=>e(T,A,v,b)))});return{cancel:()=>{u.cancel(),a()}}};function Ih(t,e,n){n[t]&&n[t].indexOf(e)!==-1||(n[t]=n[t]||[],n[t].push(e))}function dl(t,e,n){if(n&&n[t]){const a=n[t].indexOf(e);a!==-1&&n[t].splice(a,1)}}class Mo{constructor(e,n={}){dt(this,n),this.type=e}}class pl extends Mo{constructor(e,n={}){super("error",dt({error:e},n))}}class Io{on(e,n){return this._listeners=this._listeners||{},Ih(e,n,this._listeners),this}off(e,n){return dl(e,n,this._listeners),dl(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Ih(e,n,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,n){typeof e=="string"&&(e=new Mo(e,n||{}));const a=e.type;if(this.listens(a)){e.target=this;const u=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const v of u)v.call(this,e);const d=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const v of d)dl(a,v,this._oneTimeListeners),v.call(this,e);const m=this._eventedParent;m&&(dt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),m.fire(e))}else e instanceof pl&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var ke=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class pt{constructor(e,n,a,u){this.message=(e?`${e}: `:"")+a,u&&(this.identifier=u),n!=null&&n.__line__&&(this.line=n.__line__)}}function kh(t){const e=t.value;return e?[new pt(t.key,e,"constants have been deprecated as of v8")]:[]}function ko(t,...e){for(const n of e)for(const a in n)t[a]=n[a];return t}function tn(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function lo(t){if(Array.isArray(t))return t.map(lo);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=lo(t[n]);return e}return tn(t)}class Zr extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class fl{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[a,u]of n)this.bindings[a]=u}concat(e){return new fl(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const zo={kind:"null"},ct={kind:"number"},si={kind:"string"},Jt={kind:"boolean"},Wr={kind:"color"},ws={kind:"object"},Qt={kind:"value"},da={kind:"collator"},Po={kind:"formatted"},pa={kind:"resolvedImage"};function pr(t,e){return{kind:"array",itemType:t,N:e}}function Wi(t){if(t.kind==="array"){const e=Wi(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}const uf=[zo,ct,si,Jt,Wr,Po,ws,pr(Qt),pa];function Yn(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Yn(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(const n of uf)if(!Yn(n,e))return null}}return`Expected ${Wi(t)} but found ${Wi(e)} instead.`}function ml(t,e){return e.some(n=>n.kind===t.kind)}function Ts(t,e){return e.some(n=>n==="null"?t===null:n==="array"?Array.isArray(t):n==="object"?t&&!Array.isArray(t)&&typeof t=="object":n===typeof t)}function Es(t){var e={exports:{}};return t(e,e.exports),e.exports}var Ss=Es(function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(v){return(v=Math.round(v))<0?0:v>255?255:v}function u(v){return a(v[v.length-1]==="%"?parseFloat(v)/100*255:parseInt(v))}function d(v){return(b=v[v.length-1]==="%"?parseFloat(v)/100:parseFloat(v))<0?0:b>1?1:b;var b}function m(v,b,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?v+(b-v)*T*6:2*T<1?b:3*T<2?v+(b-v)*(2/3-T)*6:v}try{e.parseCSSColor=function(v){var b,T=v.replace(/ /g,"").toLowerCase();if(T in n)return n[T].slice();if(T[0]==="#")return T.length===4?(b=parseInt(T.substr(1),16))>=0&&b<=4095?[(3840&b)>>4|(3840&b)>>8,240&b|(240&b)>>4,15&b|(15&b)<<4,1]:null:T.length===7&&(b=parseInt(T.substr(1),16))>=0&&b<=16777215?[(16711680&b)>>16,(65280&b)>>8,255&b,1]:null;var A=T.indexOf("("),I=T.indexOf(")");if(A!==-1&&I+1===T.length){var z=T.substr(0,A),F=T.substr(A+1,I-(A+1)).split(","),j=1;switch(z){case"rgba":if(F.length!==4)return null;j=d(F.pop());case"rgb":return F.length!==3?null:[u(F[0]),u(F[1]),u(F[2]),j];case"hsla":if(F.length!==4)return null;j=d(F.pop());case"hsl":if(F.length!==3)return null;var G=(parseFloat(F[0])%360+360)%360/360,Z=d(F[1]),Q=d(F[2]),se=Q<=.5?Q*(Z+1):Q+Z-Q*Z,de=2*Q-se;return[a(255*m(de,se,G+1/3)),a(255*m(de,se,G)),a(255*m(de,se,G-1/3)),j];default:return null}}return null}}catch{}});class yi{constructor(e,n,a,u=1){this.r=e,this.g=n,this.b=a,this.a=u}static parse(e){if(!e)return;if(e instanceof yi)return e;if(typeof e!="string")return;const n=Ss.parseCSSColor(e);return n?new yi(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,a,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(a)},${u})`}toArray(){const{r:e,g:n,b:a,a:u}=this;return u===0?[0,0,0,0]:[255*e/u,255*n/u,255*a/u,u]}}yi.black=new yi(0,0,0,1),yi.white=new yi(1,1,1,1),yi.transparent=new yi(0,0,0,0),yi.red=new yi(1,0,0,1),yi.blue=new yi(0,0,1,1);class gl{constructor(e,n,a){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Zc{constructor(e,n,a,u,d){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=a,this.fontStack=u,this.textColor=d}}class Gt{constructor(e){this.sections=e}static fromString(e){return new Gt([new Zc(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Gt?e:Gt.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.name]);continue}e.push(n.text);const a={};n.fontStack&&(a["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(a["font-scale"]=n.scale),n.textColor&&(a["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(a)}return e}}class fr{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new fr({name:e,available:!1}):null}serialize(){return["image",this.name]}}function zh(t,e,n,a){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[t,e,n,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[t,e,n,a]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function _l(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof yi||t instanceof gl||t instanceof Gt||t instanceof fr)return!0;if(Array.isArray(t)){for(const e of t)if(!_l(e))return!1;return!0}if(typeof t=="object"){for(const e in t)if(!_l(t[e]))return!1;return!0}return!1}function rn(t){if(t===null)return zo;if(typeof t=="string")return si;if(typeof t=="boolean")return Jt;if(typeof t=="number")return ct;if(t instanceof yi)return Wr;if(t instanceof gl)return da;if(t instanceof Gt)return Po;if(t instanceof fr)return pa;if(Array.isArray(t)){const e=t.length;let n;for(const a of t){const u=rn(a);if(n){if(n===u)continue;n=Qt;break}n=u}return pr(n||Qt,e)}return ws}function fa(t){const e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof yi||t instanceof Gt||t instanceof fr?t.toString():JSON.stringify(t)}class Do{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!_l(e[1]))return n.error("invalid value");const a=e[1];let u=rn(a);const d=n.expectedType;return u.kind!=="array"||u.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(u=d),new Do(u,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof yi?["rgba"].concat(this.value.toArray()):this.value instanceof Gt?this.value.serialize():this.value}}class mn{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const yl={string:si,number:ct,boolean:Jt,object:ws};class mr{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let a,u=1;const d=e[0];if(d==="array"){let v,b;if(e.length>2){const T=e[1];if(typeof T!="string"||!(T in yl)||T==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);v=yl[T],u++}else v=Qt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);b=e[2],u++}a=pr(v,b)}else a=yl[d];const m=[];for(;u<e.length;u++){const v=n.parse(e[u],u,Qt);if(!v)return null;m.push(v)}return new mr(a,m)}evaluate(e){for(let n=0;n<this.args.length;n++){const a=this.args[n].evaluate(e);if(!Yn(this.type,rn(a)))return a;if(n===this.args.length-1)throw new mn(`Expected value to be of type ${Wi(this.type)}, but found ${Wi(rn(a))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if(e.kind==="array"){const a=e.itemType;if(a.kind==="string"||a.kind==="number"||a.kind==="boolean"){n.push(a.kind);const u=e.N;(typeof u=="number"||this.args.length>1)&&n.push(u)}}return n.concat(this.args.map(a=>a.serialize()))}}class Hr{constructor(e){this.type=Po,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return n.error("First argument must be an image or text section.");const u=[];let d=!1;for(let m=1;m<=e.length-1;++m){const v=e[m];if(d&&typeof v=="object"&&!Array.isArray(v)){d=!1;let b=null;if(v["font-scale"]&&(b=n.parse(v["font-scale"],1,ct),!b))return null;let T=null;if(v["text-font"]&&(T=n.parse(v["text-font"],1,pr(si)),!T))return null;let A=null;if(v["text-color"]&&(A=n.parse(v["text-color"],1,Wr),!A))return null;const I=u[u.length-1];I.scale=b,I.font=T,I.textColor=A}else{const b=n.parse(e[m],1,Qt);if(!b)return null;const T=b.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,u.push({content:b,scale:null,font:null,textColor:null})}}return new Hr(u)}evaluate(e){return new Gt(this.sections.map(n=>{const a=n.content.evaluate(e);return rn(a)===pa?new Zc("",a,null,null,null):new Zc(fa(a),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const a={};n.scale&&(a["font-scale"]=n.scale.serialize()),n.font&&(a["text-font"]=n.font.serialize()),n.textColor&&(a["text-color"]=n.textColor.serialize()),e.push(a)}return e}}class es{constructor(e){this.type=pa,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const a=n.parse(e[1],1,si);return a?new es(a):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),a=fr.fromString(n);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(n)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const hf={"to-boolean":Jt,"to-color":Wr,"to-number":ct,"to-string":si};class Xr{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const a=e[0];if((a==="to-boolean"||a==="to-string")&&e.length!==2)return n.error("Expected one argument.");const u=hf[a],d=[];for(let m=1;m<e.length;m++){const v=n.parse(e[m],m,Qt);if(!v)return null;d.push(v)}return new Xr(u,d)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let n,a;for(const u of this.args){if(n=u.evaluate(e),a=null,n instanceof yi)return n;if(typeof n=="string"){const d=e.parseColor(n);if(d)return d}else if(Array.isArray(n)&&(a=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:zh(n[0],n[1],n[2],n[3]),!a))return new yi(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new mn(a||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const a of this.args){if(n=a.evaluate(e),n===null)return 0;const u=Number(n);if(!isNaN(u))return u}throw new mn(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?Gt.fromString(fa(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?fr.fromString(fa(this.args[0].evaluate(e))):fa(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Hr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new es(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}const Ph=["Unknown","Point","LineString","Polygon"];class Dh{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ph[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,n=this.featureDistanceData.scale,{x:a,y:u}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(a*n-e[0])+this.featureDistanceData.bearing[1]*(u*n-e[1])}return 0}parseColor(e){let n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=yi.parse(e)),n}}class nr{constructor(e,n,a,u){this.name=e,this.type=n,this._evaluate=a,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const a=e[0],u=nr.definitions[a];if(!u)return n.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(u)?u[0]:u.type,m=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,v=m.filter(([T])=>!Array.isArray(T)||T.length===e.length-1);let b=null;for(const[T,A]of v){b=new bl(n.registry,n.path,null,n.scope);const I=[];let z=!1;for(let F=1;F<e.length;F++){const j=e[F],G=Array.isArray(T)?T[F-1]:T.type,Z=b.parse(j,1+I.length,G);if(!Z){z=!0;break}I.push(Z)}if(!z)if(Array.isArray(T)&&T.length!==I.length)b.error(`Expected ${T.length} arguments, but found ${I.length} instead.`);else{for(let F=0;F<I.length;F++){const j=Array.isArray(T)?T[F]:T.type,G=I[F];b.concat(F+1).checkSubtype(j,G.type)}if(b.errors.length===0)return new nr(a,d,A,I)}}if(v.length===1)n.errors.push(...b.errors);else{const T=(v.length?v:m).map(([I])=>{return z=I,Array.isArray(z)?`(${z.map(Wi).join(", ")})`:`(${Wi(z.type)}...)`;var z}).join(" | "),A=[];for(let I=1;I<e.length;I++){const z=n.parse(e[I],1+A.length);if(!z)return null;A.push(Wi(z.type))}n.error(`Expected arguments of type ${T}, but found (${A.join(", ")}) instead.`)}return null}static register(e,n){nr.definitions=n;for(const a in n)e[a]=nr}}class ma{constructor(e,n,a){this.type=da,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return n.error("Collator options argument must be an object.");const u=n.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,Jt);if(!u)return null;const d=n.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,Jt);if(!d)return null;let m=null;return a.locale&&(m=n.parse(a.locale,1,si),!m)?null:new ma(u,d,m)}evaluate(e){return new gl(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Lo=8192;function vl(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function ga(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Lh(t,e){const n=(180+t[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(n*u*Lo),Math.round(a*u*Lo)]}function Rh(t,e,n){const a=t[0]-e[0],u=t[1]-e[1],d=t[0]-n[0],m=t[1]-n[1];return a*m-d*u==0&&a*d<=0&&u*m<=0}function Wc(t,e){let n=!1;for(let m=0,v=e.length;m<v;m++){const b=e[m];for(let T=0,A=b.length;T<A-1;T++){if(Rh(t,b[T],b[T+1]))return!1;(u=b[T])[1]>(a=t)[1]!=(d=b[T+1])[1]>a[1]&&a[0]<(d[0]-u[0])*(a[1]-u[1])/(d[1]-u[1])+u[0]&&(n=!n)}}var a,u,d;return n}function Oh(t,e){for(let n=0;n<e.length;n++)if(Wc(t,e[n]))return!0;return!1}function Hc(t,e,n,a){const u=a[0]-n[0],d=a[1]-n[1],m=(t[0]-n[0])*d-u*(t[1]-n[1]),v=(e[0]-n[0])*d-u*(e[1]-n[1]);return m>0&&v<0||m<0&&v>0}function df(t,e,n){for(const T of n)for(let A=0;A<T.length-1;++A)if((v=[(m=T[A+1])[0]-(d=T[A])[0],m[1]-d[1]])[0]*(b=[(u=e)[0]-(a=t)[0],u[1]-a[1]])[1]-v[1]*b[0]!=0&&Hc(a,u,d,m)&&Hc(d,m,a,u))return!0;var a,u,d,m,v,b;return!1}function Bh(t,e){for(let n=0;n<t.length;++n)if(!Wc(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(df(t[n],t[n+1],e))return!1;return!0}function pf(t,e){for(let n=0;n<e.length;n++)if(Bh(t,e[n]))return!0;return!1}function Xc(t,e,n){const a=[];for(let u=0;u<t.length;u++){const d=[];for(let m=0;m<t[u].length;m++){const v=Lh(t[u][m],n);vl(e,v),d.push(v)}a.push(d)}return a}function Fh(t,e,n){const a=[];for(let u=0;u<t.length;u++){const d=Xc(t[u],e,n);a.push(d)}return a}function Kc(t,e,n,a){if(t[0]<n[0]||t[0]>n[2]){const u=.5*a;let d=t[0]-n[0]>u?-a:n[0]-t[0]>u?a:0;d===0&&(d=t[0]-n[2]>u?-a:n[2]-t[0]>u?a:0),t[0]+=d}vl(e,t)}function Nh(t,e,n,a){const u=Math.pow(2,a.z)*Lo,d=[a.x*Lo,a.y*Lo],m=[];for(const v of t)for(const b of v){const T=[b.x+d[0],b.y+d[1]];Kc(T,e,n,u),m.push(T)}return m}function Uh(t,e,n,a){const u=Math.pow(2,a.z)*Lo,d=[a.x*Lo,a.y*Lo],m=[];for(const b of t){const T=[];for(const A of b){const I=[A.x+d[0],A.y+d[1]];vl(e,I),T.push(I)}m.push(T)}if(e[2]-e[0]<=u/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const b of m)for(const T of b)Kc(T,e,n,u)}var v;return m}class ts{constructor(e,n){this.type=Jt,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(_l(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let u=0;u<a.features.length;++u){const d=a.features[u].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new ts(a,a.features[u].geometry)}else if(a.type==="Feature"){const u=a.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new ts(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new ts(a,a)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,a){const u=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],m=n.canonicalID();if(a.type==="Polygon"){const v=Xc(a.coordinates,d,m),b=Nh(n.geometry(),u,d,m);if(!ga(u,d))return!1;for(const T of b)if(!Wc(T,v))return!1}if(a.type==="MultiPolygon"){const v=Fh(a.coordinates,d,m),b=Nh(n.geometry(),u,d,m);if(!ga(u,d))return!1;for(const T of b)if(!Oh(T,v))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,a){const u=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],m=n.canonicalID();if(a.type==="Polygon"){const v=Xc(a.coordinates,d,m),b=Uh(n.geometry(),u,d,m);if(!ga(u,d))return!1;for(const T of b)if(!Bh(T,v))return!1}if(a.type==="MultiPolygon"){const v=Fh(a.coordinates,d,m),b=Uh(n.geometry(),u,d,m);if(!ga(u,d))return!1;for(const T of b)if(!pf(T,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Cs(t){if(t instanceof nr&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof ts)return!1;let e=!0;return t.eachChild(n=>{e&&!Cs(n)&&(e=!1)}),e}function _a(t){if(t instanceof nr&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(n=>{e&&!_a(n)&&(e=!1)}),e}function ya(t,e){if(t instanceof nr&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(a=>{n&&!ya(a,e)&&(n=!1)}),n}class xl{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const a=e[1];return n.scope.has(a)?new xl(a,n.scope.get(a)):n.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class bl{constructor(e,n=[],a,u=new fl,d=[]){this.registry=e,this.path=n,this.key=n.map(m=>`[${m}]`).join(""),this.scope=u,this.errors=d,this.expectedType=a}parse(e,n,a,u,d={}){return n?this.concat(n,a,u)._parse(e,d):this._parse(e,d)}_parse(e,n){function a(u,d,m){return m==="assert"?new mr(d,[u]):m==="coerce"?new Xr(d,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const d=this.registry[u];if(d){let m=d.parse(e,this);if(!m)return null;if(this.expectedType){const v=this.expectedType,b=m.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||b.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(v,b))return null}else m=a(m,v,n.typeAnnotation||"coerce");else m=a(m,v,n.typeAnnotation||"assert")}if(!(m instanceof Do)&&m.type.kind!=="resolvedImage"&&wl(m)){const v=new Dh;try{m=new Do(m.type,m.evaluate(v))}catch(b){return this.error(b.message),null}}return m}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,a){const u=typeof e=="number"?this.path.concat(e):this.path,d=a?this.scope.concat(a):this.scope;return new bl(this.registry,u,n||null,d,this.errors)}error(e,...n){const a=`${this.key}${n.map(u=>`[${u}]`).join("")}`;this.errors.push(new Zr(a,e))}checkSubtype(e,n){const a=Yn(e,n);return a&&this.error(a),a}}function wl(t){if(t instanceof xl)return wl(t.boundExpression);if(t instanceof nr&&t.name==="error"||t instanceof ma||t instanceof ts)return!1;const e=t instanceof Xr||t instanceof mr;let n=!0;return t.eachChild(a=>{n=e?n&&wl(a):n&&a instanceof Do}),!!n&&Cs(t)&&ya(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function va(t,e){const n=t.length-1;let a,u,d=0,m=n,v=0;for(;d<=m;)if(v=Math.floor((d+m)/2),a=t[v],u=t[v+1],a<=e){if(v===n||e<u)return v;d=v+1}else{if(!(a>e))throw new mn("Input is not a number.");m=v-1}return 0}class xa{constructor(e,n,a){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[u,d]of a)this.labels.push(u),this.outputs.push(d)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const a=n.parse(e[1],1,ct);if(!a)return null;const u=[];let d=null;n.expectedType&&n.expectedType.kind!=="value"&&(d=n.expectedType);for(let m=1;m<e.length;m+=2){const v=m===1?-1/0:e[m],b=e[m+1],T=m,A=m+1;if(typeof v!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(u.length&&u[u.length-1][0]>=v)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const I=n.parse(b,A,d);if(!I)return null;d=d||I.type,u.push([v,I])}return new xa(d,a,u)}evaluate(e){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(e);const u=this.input.evaluate(e);if(u<=n[0])return a[0].evaluate(e);const d=n.length;return u>=n[d-1]?a[d-1].evaluate(e):a[va(n,u)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}function Ei(t,e,n){return t*(1-n)+e*n}var Tl=Object.freeze({__proto__:null,number:Ei,color:function(t,e,n){return new yi(Ei(t.r,e.r,n),Ei(t.g,e.g,n),Ei(t.b,e.b,n),Ei(t.a,e.a,n))},array:function(t,e,n){return t.map((a,u)=>Ei(a,e[u],n))}});const jh=.95047,ba=1.08883,Yc=4/29,El=6/29,Vh=3*El*El,ff=Math.PI/180,mf=180/Math.PI;function Sl(t){return t>.008856451679035631?Math.pow(t,1/3):t/Vh+Yc}function Cl(t){return t>El?t*t*t:Vh*(t-Yc)}function Al(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function wa(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function $h(t){const e=wa(t.r),n=wa(t.g),a=wa(t.b),u=Sl((.4124564*e+.3575761*n+.1804375*a)/jh),d=Sl((.2126729*e+.7151522*n+.072175*a)/1);return{l:116*d-16,a:500*(u-d),b:200*(d-Sl((.0193339*e+.119192*n+.9503041*a)/ba)),alpha:t.a}}function Gh(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,a=isNaN(t.b)?e:e-t.b/200;return e=1*Cl(e),n=jh*Cl(n),a=ba*Cl(a),new yi(Al(3.2404542*n-1.5371385*e-.4985314*a),Al(-.969266*n+1.8760108*e+.041556*a),Al(.0556434*n-.2040259*e+1.0572252*a),t.alpha)}function gf(t,e,n){const a=e-t;return t+n*(a>180||a<-180?a-360*Math.round(a/360):a)}const Ta={forward:$h,reverse:Gh,interpolate:function(t,e,n){return{l:Ei(t.l,e.l,n),a:Ei(t.a,e.a,n),b:Ei(t.b,e.b,n),alpha:Ei(t.alpha,e.alpha,n)}}},Ea={forward:function(t){const{l:e,a:n,b:a}=$h(t),u=Math.atan2(a,n)*mf;return{h:u<0?u+360:u,c:Math.sqrt(n*n+a*a),l:e,alpha:t.a}},reverse:function(t){const e=t.h*ff,n=t.c;return Gh({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:gf(t.h,e.h,n),c:Ei(t.c,e.c,n),l:Ei(t.l,e.l,n),alpha:Ei(t.alpha,e.alpha,n)}}};var qh=Object.freeze({__proto__:null,lab:Ta,hcl:Ea});class Jn{constructor(e,n,a,u,d){this.type=e,this.operator=n,this.interpolation=a,this.input=u,this.labels=[],this.outputs=[];for(const[m,v]of d)this.labels.push(m),this.outputs.push(v)}static interpolationFactor(e,n,a,u){let d=0;if(e.name==="exponential")d=Ml(n,e.base,a,u);else if(e.name==="linear")d=Ml(n,1,a,u);else if(e.name==="cubic-bezier"){const m=e.controlPoints;d=new k(m[0],m[1],m[2],m[3]).solve(Ml(n,1,a,u))}return d}static parse(e,n){let[a,u,d,...m]=e;if(!Array.isArray(u)||u.length===0)return n.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const T=u[1];if(typeof T!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:T}}else{if(u[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const T=u.slice(1);if(T.length!==4||T.some(A=>typeof A!="number"||A<0||A>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:T}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(d=n.parse(d,2,ct),!d)return null;const v=[];let b=null;a==="interpolate-hcl"||a==="interpolate-lab"?b=Wr:n.expectedType&&n.expectedType.kind!=="value"&&(b=n.expectedType);for(let T=0;T<m.length;T+=2){const A=m[T],I=m[T+1],z=T+3,F=T+4;if(typeof A!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(v.length&&v[v.length-1][0]>=A)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const j=n.parse(I,F,b);if(!j)return null;b=b||j.type,v.push([A,j])}return b.kind==="number"||b.kind==="color"||b.kind==="array"&&b.itemType.kind==="number"&&typeof b.N=="number"?new Jn(b,a,u,d,v):n.error(`Type ${Wi(b)} is not interpolatable.`)}evaluate(e){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(e);const u=this.input.evaluate(e);if(u<=n[0])return a[0].evaluate(e);const d=n.length;if(u>=n[d-1])return a[d-1].evaluate(e);const m=va(n,u),v=Jn.interpolationFactor(this.interpolation,u,n[m],n[m+1]),b=a[m].evaluate(e),T=a[m+1].evaluate(e);return this.operator==="interpolate"?Tl[this.type.kind.toLowerCase()](b,T,v):this.operator==="interpolate-hcl"?Ea.reverse(Ea.interpolate(Ea.forward(b),Ea.forward(T),v)):Ta.reverse(Ta.interpolate(Ta.forward(b),Ta.forward(T),v))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let a=0;a<this.labels.length;a++)n.push(this.labels[a],this.outputs[a].serialize());return n}}function Ml(t,e,n,a){const u=a-n,d=t-n;return u===0?0:e===1?d/u:(Math.pow(e,d)-1)/(Math.pow(e,u)-1)}class is{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let a=null;const u=n.expectedType;u&&u.kind!=="value"&&(a=u);const d=[];for(const v of e.slice(1)){const b=n.parse(v,1+d.length,a,void 0,{typeAnnotation:"omit"});if(!b)return null;a=a||b.type,d.push(b)}const m=u&&d.some(v=>Yn(u,v.type));return new is(m?Qt:a,d)}evaluate(e){let n,a=null,u=0;for(const d of this.args){if(u++,a=d.evaluate(e),a&&a instanceof fr&&!a.available&&(n||(n=a),a=null,u===this.args.length))return n;if(a!==null)break}return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}class Il{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let d=1;d<e.length-1;d+=2){const m=e[d];if(typeof m!="string")return n.error(`Expected string, but found ${typeof m} instead.`,d);if(/[^a-zA-Z0-9_]/.test(m))return n.error("Variable names must contain only alphanumeric characters or '_'.",d);const v=n.parse(e[d+1],d+1);if(!v)return null;a.push([m,v])}const u=n.parse(e[e.length-1],e.length-1,n.expectedType,a);return u?new Il(a,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,a]of this.bindings)e.push(n,a.serialize());return e.push(this.result.serialize()),e}}class Jc{constructor(e,n,a){this.type=e,this.index=n,this.input=a}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,ct),u=n.parse(e[2],2,pr(n.expectedType||Qt));return a&&u?new Jc(u.type.itemType,a,u):null}evaluate(e){const n=this.index.evaluate(e),a=this.input.evaluate(e);if(n<0)throw new mn(`Array index out of bounds: ${n} < 0.`);if(n>=a.length)throw new mn(`Array index out of bounds: ${n} > ${a.length-1}.`);if(n!==Math.floor(n))throw new mn(`Array index must be an integer, but found ${n} instead.`);return a[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Qc{constructor(e,n){this.type=Jt,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,Qt),u=n.parse(e[2],2,Qt);return a&&u?ml(a.type,[Jt,si,ct,zo,Qt])?new Qc(a,u):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(a.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!Ts(n,["boolean","string","number","null"]))throw new mn(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(rn(n))} instead.`);if(!Ts(a,["string","array"]))throw new mn(`Expected second argument to be of type array or string, but found ${Wi(rn(a))} instead.`);return a.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Ar{constructor(e,n,a){this.type=ct,this.needle=e,this.haystack=n,this.fromIndex=a}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,Qt),u=n.parse(e[2],2,Qt);if(!a||!u)return null;if(!ml(a.type,[Jt,si,ct,zo,Qt]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(a.type)} instead`);if(e.length===4){const d=n.parse(e[3],3,ct);return d?new Ar(a,u,d):null}return new Ar(a,u)}evaluate(e){const n=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!Ts(n,["boolean","string","number","null"]))throw new mn(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(rn(n))} instead.`);if(!Ts(a,["string","array"]))throw new mn(`Expected second argument to be of type array or string, but found ${Wi(rn(a))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return a.indexOf(n,u)}return a.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class kl{constructor(e,n,a,u,d,m){this.inputType=e,this.type=n,this.input=a,this.cases=u,this.outputs=d,this.otherwise=m}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let a,u;n.expectedType&&n.expectedType.kind!=="value"&&(u=n.expectedType);const d={},m=[];for(let T=2;T<e.length-1;T+=2){let A=e[T];const I=e[T+1];Array.isArray(A)||(A=[A]);const z=n.concat(T);if(A.length===0)return z.error("Expected at least one branch label.");for(const j of A){if(typeof j!="number"&&typeof j!="string")return z.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return z.error("Numeric branch labels must be integer values.");if(a){if(z.checkSubtype(a,rn(j)))return null}else a=rn(j);if(d[String(j)]!==void 0)return z.error("Branch labels must be unique.");d[String(j)]=m.length}const F=n.parse(I,T,u);if(!F)return null;u=u||F.type,m.push(F)}const v=n.parse(e[1],1,Qt);if(!v)return null;const b=n.parse(e[e.length-1],e.length-1,u);return b?v.type.kind!=="value"&&n.concat(1).checkSubtype(a,v.type)?null:new kl(a,u,v,d,m,b):null}evaluate(e){const n=this.input.evaluate(e);return(rn(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),a=[],u={};for(const m of n){const v=u[this.cases[m]];v===void 0?(u[this.cases[m]]=a.length,a.push([this.cases[m],[m]])):a[v][1].push(m)}const d=m=>this.inputType.kind==="number"?Number(m):m;for(const[m,v]of a)e.push(v.length===1?d(v[0]):v.map(d)),e.push(this.outputs[m].serialize());return e.push(this.otherwise.serialize()),e}}class Ro{constructor(e,n,a){this.type=e,this.branches=n,this.otherwise=a}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let a;n.expectedType&&n.expectedType.kind!=="value"&&(a=n.expectedType);const u=[];for(let m=1;m<e.length-1;m+=2){const v=n.parse(e[m],m,Jt);if(!v)return null;const b=n.parse(e[m+1],m+1,a);if(!b)return null;u.push([v,b]),a=a||b.type}const d=n.parse(e[e.length-1],e.length-1,a);return d?new Ro(a,u,d):null}evaluate(e){for(const[n,a]of this.branches)if(n.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,a]of this.branches)e(n),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}class Sa{constructor(e,n,a,u){this.type=e,this.input=n,this.beginIndex=a,this.endIndex=u}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,Qt),u=n.parse(e[2],2,ct);if(!a||!u)return null;if(!ml(a.type,[pr(Qt),si,Qt]))return n.error(`Expected first argument to be of type array or string, but found ${Wi(a.type)} instead`);if(e.length===4){const d=n.parse(e[3],3,ct);return d?new Sa(a.type,a,u,d):null}return new Sa(a.type,a,u)}evaluate(e){const n=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!Ts(n,["string","array"]))throw new mn(`Expected first argument to be of type array or string, but found ${Wi(rn(n))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return n.slice(a,u)}return n.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Zh(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function zl(t,e,n,a){return a.compare(e,n)===0}function Oo(t,e,n){const a=t!=="=="&&t!=="!=";return class ow{constructor(d,m,v){this.type=Jt,this.lhs=d,this.rhs=m,this.collator=v,this.hasUntypedArgument=d.type.kind==="value"||m.type.kind==="value"}static parse(d,m){if(d.length!==3&&d.length!==4)return m.error("Expected two or three arguments.");const v=d[0];let b=m.parse(d[1],1,Qt);if(!b)return null;if(!Zh(v,b.type))return m.concat(1).error(`"${v}" comparisons are not supported for type '${Wi(b.type)}'.`);let T=m.parse(d[2],2,Qt);if(!T)return null;if(!Zh(v,T.type))return m.concat(2).error(`"${v}" comparisons are not supported for type '${Wi(T.type)}'.`);if(b.type.kind!==T.type.kind&&b.type.kind!=="value"&&T.type.kind!=="value")return m.error(`Cannot compare types '${Wi(b.type)}' and '${Wi(T.type)}'.`);a&&(b.type.kind==="value"&&T.type.kind!=="value"?b=new mr(T.type,[b]):b.type.kind!=="value"&&T.type.kind==="value"&&(T=new mr(b.type,[T])));let A=null;if(d.length===4){if(b.type.kind!=="string"&&T.type.kind!=="string"&&b.type.kind!=="value"&&T.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(A=m.parse(d[3],3,da),!A)return null}return new ow(b,T,A)}evaluate(d){const m=this.lhs.evaluate(d),v=this.rhs.evaluate(d);if(a&&this.hasUntypedArgument){const b=rn(m),T=rn(v);if(b.kind!==T.kind||b.kind!=="string"&&b.kind!=="number")throw new mn(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${b.kind}, ${T.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const b=rn(m),T=rn(v);if(b.kind!=="string"||T.kind!=="string")return e(d,m,v)}return this.collator?n(d,m,v,this.collator.evaluate(d)):e(d,m,v)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[t];return this.eachChild(m=>{d.push(m.serialize())}),d}}}const Wh=Oo("==",function(t,e,n){return e===n},zl),eu=Oo("!=",function(t,e,n){return e!==n},function(t,e,n,a){return!zl(0,e,n,a)}),tu=Oo("<",function(t,e,n){return e<n},function(t,e,n,a){return a.compare(e,n)<0}),Hh=Oo(">",function(t,e,n){return e>n},function(t,e,n,a){return a.compare(e,n)>0}),iu=Oo("<=",function(t,e,n){return e<=n},function(t,e,n,a){return a.compare(e,n)<=0}),Xh=Oo(">=",function(t,e,n){return e>=n},function(t,e,n,a){return a.compare(e,n)>=0});class Pl{constructor(e,n,a,u,d){this.type=si,this.number=e,this.locale=n,this.currency=a,this.minFractionDigits=u,this.maxFractionDigits=d}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const a=n.parse(e[1],1,ct);if(!a)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return n.error("NumberFormat options argument must be an object.");let d=null;if(u.locale&&(d=n.parse(u.locale,1,si),!d))return null;let m=null;if(u.currency&&(m=n.parse(u.currency,1,si),!m))return null;let v=null;if(u["min-fraction-digits"]&&(v=n.parse(u["min-fraction-digits"],1,ct),!v))return null;let b=null;return u["max-fraction-digits"]&&(b=n.parse(u["max-fraction-digits"],1,ct),!b)?null:new Pl(a,d,m,v,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Dl{constructor(e){this.type=ct,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=n.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Wi(a.type)} instead.`):new Dl(a):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new mn(`Expected value to be of type string or array, but found ${Wi(rn(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}const Mr={"==":Wh,"!=":eu,">":Hh,"<":tu,">=":Xh,"<=":iu,array:mr,at:Jc,boolean:mr,case:Ro,coalesce:is,collator:ma,format:Hr,image:es,in:Qc,"index-of":Ar,interpolate:Jn,"interpolate-hcl":Jn,"interpolate-lab":Jn,length:Dl,let:Il,literal:Do,match:kl,number:mr,"number-format":Pl,object:mr,slice:Sa,step:xa,string:mr,"to-boolean":Xr,"to-color":Xr,"to-number":Xr,"to-string":Xr,var:xl,within:ts};function nu(t,[e,n,a,u]){e=e.evaluate(t),n=n.evaluate(t),a=a.evaluate(t);const d=u?u.evaluate(t):1,m=zh(e,n,a,d);if(m)throw new mn(m);return new yi(e/255*d,n/255*d,a/255*d,d)}function ru(t,e){return t in e}function Ca(t,e){const n=e[t];return n===void 0?null:n}function Bo(t){return{type:t}}function Kh(t){return{result:"success",value:t}}function co(t){return{result:"error",value:t}}function As(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function Yh(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function ou(t){return!!t.expression&&t.expression.interpolated}function bi(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function Ll(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Rl(t){return t}function Aa(t,e){const n=e.type==="color",a=t.stops&&typeof t.stops[0][0]=="object",u=a||!(a||t.property!==void 0),d=t.type||(ou(e)?"exponential":"interval");if(n&&((t=ko({},t)).stops&&(t.stops=t.stops.map(T=>[T[0],yi.parse(T[1])])),t.default=yi.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!qh[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let m,v,b;if(d==="exponential")m=Jh;else if(d==="interval")m=_f;else if(d==="categorical"){m=Ol,v=Object.create(null);for(const T of t.stops)v[T[0]]=T[1];b=typeof t.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);m=yf}if(a){const T={},A=[];for(let F=0;F<t.stops.length;F++){const j=t.stops[F],G=j[0].zoom;T[G]===void 0&&(T[G]={zoom:G,type:t.type,property:t.property,default:t.default,stops:[]},A.push(G)),T[G].stops.push([j[0].value,j[1]])}const I=[];for(const F of A)I.push([T[F].zoom,Aa(T[F],e)]);const z={name:"linear"};return{kind:"composite",interpolationType:z,interpolationFactor:Jn.interpolationFactor.bind(void 0,z),zoomStops:I.map(F=>F[0]),evaluate:({zoom:F},j)=>Jh({stops:I,base:t.base},e,F).evaluate(F,j)}}if(u){const T=d==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:Jn.interpolationFactor.bind(void 0,T),zoomStops:t.stops.map(A=>A[0]),evaluate:({zoom:A})=>m(t,e,A,v,b)}}return{kind:"source",evaluate(T,A){const I=A&&A.properties?A.properties[t.property]:void 0;return I===void 0?kn(t.default,e.default):m(t,e,I,v,b)}}}function kn(t,e,n){return t!==void 0?t:e!==void 0?e:n!==void 0?n:void 0}function Ol(t,e,n,a,u){return kn(typeof n===u?a[n]:void 0,t.default,e.default)}function _f(t,e,n){if(bi(n)!=="number")return kn(t.default,e.default);const a=t.stops.length;if(a===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[a-1][0])return t.stops[a-1][1];const u=va(t.stops.map(d=>d[0]),n);return t.stops[u][1]}function Jh(t,e,n){const a=t.base!==void 0?t.base:1;if(bi(n)!=="number")return kn(t.default,e.default);const u=t.stops.length;if(u===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[u-1][0])return t.stops[u-1][1];const d=va(t.stops.map(A=>A[0]),n),m=function(A,I,z,F){const j=F-z,G=A-z;return j===0?0:I===1?G/j:(Math.pow(I,G)-1)/(Math.pow(I,j)-1)}(n,a,t.stops[d][0],t.stops[d+1][0]),v=t.stops[d][1],b=t.stops[d+1][1];let T=Tl[e.type]||Rl;if(t.colorSpace&&t.colorSpace!=="rgb"){const A=qh[t.colorSpace];T=(I,z)=>A.reverse(A.interpolate(A.forward(I),A.forward(z),m))}return typeof v.evaluate=="function"?{evaluate(...A){const I=v.evaluate.apply(void 0,A),z=b.evaluate.apply(void 0,A);if(I!==void 0&&z!==void 0)return T(I,z,m)}}:T(v,b,m)}function yf(t,e,n){return e.type==="color"?n=yi.parse(n):e.type==="formatted"?n=Gt.fromString(n.toString()):e.type==="resolvedImage"?n=fr.fromString(n.toString()):bi(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),kn(n,t.default,e.default)}nr.register(Mr,{error:[{kind:"error"},[si],(t,[e])=>{throw new mn(e.evaluate(t))}],typeof:[si,[Qt],(t,[e])=>Wi(rn(e.evaluate(t)))],"to-rgba":[pr(ct,4),[Wr],(t,[e])=>e.evaluate(t).toArray()],rgb:[Wr,[ct,ct,ct],nu],rgba:[Wr,[ct,ct,ct,ct],nu],has:{type:Jt,overloads:[[[si],(t,[e])=>ru(e.evaluate(t),t.properties())],[[si,ws],(t,[e,n])=>ru(e.evaluate(t),n.evaluate(t))]]},get:{type:Qt,overloads:[[[si],(t,[e])=>Ca(e.evaluate(t),t.properties())],[[si,ws],(t,[e,n])=>Ca(e.evaluate(t),n.evaluate(t))]]},"feature-state":[Qt,[si],(t,[e])=>Ca(e.evaluate(t),t.featureState||{})],properties:[ws,[],t=>t.properties()],"geometry-type":[si,[],t=>t.geometryType()],id:[Qt,[],t=>t.id()],zoom:[ct,[],t=>t.globals.zoom],pitch:[ct,[],t=>t.globals.pitch||0],"distance-from-center":[ct,[],t=>t.distanceFromCenter()],"heatmap-density":[ct,[],t=>t.globals.heatmapDensity||0],"line-progress":[ct,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[ct,[],t=>t.globals.skyRadialProgress||0],accumulated:[Qt,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[ct,Bo(ct),(t,e)=>{let n=0;for(const a of e)n+=a.evaluate(t);return n}],"*":[ct,Bo(ct),(t,e)=>{let n=1;for(const a of e)n*=a.evaluate(t);return n}],"-":{type:ct,overloads:[[[ct,ct],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[ct],(t,[e])=>-e.evaluate(t)]]},"/":[ct,[ct,ct],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[ct,[ct,ct],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[ct,[],()=>Math.LN2],pi:[ct,[],()=>Math.PI],e:[ct,[],()=>Math.E],"^":[ct,[ct,ct],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[ct,[ct],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[ct,[ct],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[ct,[ct],(t,[e])=>Math.log(e.evaluate(t))],log2:[ct,[ct],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[ct,[ct],(t,[e])=>Math.sin(e.evaluate(t))],cos:[ct,[ct],(t,[e])=>Math.cos(e.evaluate(t))],tan:[ct,[ct],(t,[e])=>Math.tan(e.evaluate(t))],asin:[ct,[ct],(t,[e])=>Math.asin(e.evaluate(t))],acos:[ct,[ct],(t,[e])=>Math.acos(e.evaluate(t))],atan:[ct,[ct],(t,[e])=>Math.atan(e.evaluate(t))],min:[ct,Bo(ct),(t,e)=>Math.min(...e.map(n=>n.evaluate(t)))],max:[ct,Bo(ct),(t,e)=>Math.max(...e.map(n=>n.evaluate(t)))],abs:[ct,[ct],(t,[e])=>Math.abs(e.evaluate(t))],round:[ct,[ct],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[ct,[ct],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[ct,[ct],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Jt,[si,Qt],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[Jt,[Qt],(t,[e])=>t.id()===e.value],"filter-type-==":[Jt,[si],(t,[e])=>t.geometryType()===e.value],"filter-<":[Jt,[si,Qt],(t,[e,n])=>{const a=t.properties()[e.value],u=n.value;return typeof a==typeof u&&a<u}],"filter-id-<":[Jt,[Qt],(t,[e])=>{const n=t.id(),a=e.value;return typeof n==typeof a&&n<a}],"filter->":[Jt,[si,Qt],(t,[e,n])=>{const a=t.properties()[e.value],u=n.value;return typeof a==typeof u&&a>u}],"filter-id->":[Jt,[Qt],(t,[e])=>{const n=t.id(),a=e.value;return typeof n==typeof a&&n>a}],"filter-<=":[Jt,[si,Qt],(t,[e,n])=>{const a=t.properties()[e.value],u=n.value;return typeof a==typeof u&&a<=u}],"filter-id-<=":[Jt,[Qt],(t,[e])=>{const n=t.id(),a=e.value;return typeof n==typeof a&&n<=a}],"filter->=":[Jt,[si,Qt],(t,[e,n])=>{const a=t.properties()[e.value],u=n.value;return typeof a==typeof u&&a>=u}],"filter-id->=":[Jt,[Qt],(t,[e])=>{const n=t.id(),a=e.value;return typeof n==typeof a&&n>=a}],"filter-has":[Jt,[Qt],(t,[e])=>e.value in t.properties()],"filter-has-id":[Jt,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[Jt,[pr(si)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Jt,[pr(Qt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Jt,[si,pr(Qt)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Jt,[si,pr(Qt)],(t,[e,n])=>function(a,u,d,m){for(;d<=m;){const v=d+m>>1;if(u[v]===a)return!0;u[v]>a?m=v-1:d=v+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Jt,overloads:[[[Jt,Jt],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Bo(Jt),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:Jt,overloads:[[[Jt,Jt],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Bo(Jt),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[Jt,[Jt],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Jt,[si],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[si,[si],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[si,[si],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[si,Bo(Qt),(t,e)=>e.map(n=>fa(n.evaluate(t))).join("")],"resolved-locale":[si,[da],(t,[e])=>e.evaluate(t).resolvedLocale()]});class su{constructor(e,n){this.expression=e,this._warningHistory={},this._evaluator=new Dh,this._defaultValue=n?function(a){return a.type==="color"&&Ll(a.default)?new yi(0,0,0,0):a.type==="color"?yi.parse(a.default)||null:a.default===void 0?null:a.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,a,u,d,m,v,b){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=a,this._evaluator.canonical=u,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=b||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,a,u,d,m,v,b){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=a||null,this._evaluator.canonical=u,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=b||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new mn(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console!="undefined"&&console.warn(T.message)),this._defaultValue}}}function Ms(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Mr}function Ma(t,e){const n=new bl(Mr,[],e?function(u){const d={color:Wr,string:si,number:ct,enum:si,boolean:Jt,formatted:Po,resolvedImage:pa};return u.type==="array"?pr(d[u.value]||Qt,u.length):d[u.type]}(e):void 0),a=n.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?Kh(new su(a,e)):co(n.errors)}class Ia{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!_a(n.expression)}evaluateWithoutErrorHandling(e,n,a,u,d,m){return this._styleExpression.evaluateWithoutErrorHandling(e,n,a,u,d,m)}evaluate(e,n,a,u,d,m){return this._styleExpression.evaluate(e,n,a,u,d,m)}}class au{constructor(e,n,a,u){this.kind=e,this.zoomStops=a,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!_a(n.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,n,a,u,d,m){return this._styleExpression.evaluateWithoutErrorHandling(e,n,a,u,d,m)}evaluate(e,n,a,u,d,m){return this._styleExpression.evaluate(e,n,a,u,d,m)}interpolationFactor(e,n,a){return this.interpolationType?Jn.interpolationFactor(this.interpolationType,e,n,a):0}}function Qh(t,e){if((t=Ma(t,e)).result==="error")return t;const n=t.value.expression,a=Cs(n);if(!a&&!As(e))return co([new Zr("","data expressions not supported")]);const u=ya(n,["zoom","pitch","distance-from-center"]);if(!u&&!Yh(e))return co([new Zr("","zoom expressions not supported")]);const d=Bl(n);return d||u?d instanceof Zr?co([d]):d instanceof Jn&&!ou(e)?co([new Zr("",'"interpolate" expressions cannot be used with this property')]):Kh(d?new au(a?"camera":"composite",t.value,d.labels,d instanceof Jn?d.interpolation:void 0):new Ia(a?"constant":"source",t.value)):co([new Zr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Is{constructor(e,n){this._parameters=e,this._specification=n,ko(this,Aa(this._parameters,this._specification))}static deserialize(e){return new Is(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Bl(t){let e=null;if(t instanceof Il)e=Bl(t.result);else if(t instanceof is){for(const n of t.args)if(e=Bl(n),e)break}else(t instanceof xa||t instanceof Jn)&&t.input instanceof nr&&t.input.name==="zoom"&&(e=t);return e instanceof Zr||t.eachChild(n=>{const a=Bl(n);a instanceof Zr?e=a:!e&&a?e=new Zr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new Zr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function gr(t){const e=t.key,n=t.value,a=t.valueSpec||{},u=t.objectElementValidators||{},d=t.style,m=t.styleSpec;let v=[];const b=bi(n);if(b!=="object")return[new pt(e,n,`object expected, ${b} found`)];for(const T in n){const A=T.split(".")[0],I=a[A]||a["*"];let z;if(u[A])z=u[A];else if(a[A])z=gn;else if(u["*"])z=u["*"];else{if(!a["*"]){v.push(new pt(e,n[T],`unknown property "${T}"`));continue}z=gn}v=v.concat(z({key:(e&&`${e}.`)+T,value:n[T],valueSpec:I,style:d,styleSpec:m,object:n,objectKey:T},n))}for(const T in a)u[T]||a[T].required&&a[T].default===void 0&&n[T]===void 0&&v.push(new pt(e,n,`missing required property "${T}"`));return v}function lu(t){const e=t.value,n=t.valueSpec,a=t.style,u=t.styleSpec,d=t.key,m=t.arrayElementValidator||gn;if(bi(e)!=="array")return[new pt(d,e,`array expected, ${bi(e)} found`)];if(n.length&&e.length!==n.length)return[new pt(d,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new pt(d,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let v={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum};u.$version<7&&(v.function=n.function),bi(n.value)==="object"&&(v=n.value);let b=[];for(let T=0;T<e.length;T++)b=b.concat(m({array:e,arrayIndex:T,value:e[T],valueSpec:v,style:a,styleSpec:u,key:`${d}[${T}]`}));return b}function ed(t){const e=t.key,n=t.value,a=t.valueSpec;let u=bi(n);if(u==="number"&&n!=n&&(u="NaN"),u!=="number")return[new pt(e,n,`number expected, ${u} found`)];if("minimum"in a){let d=a.minimum;if(bi(a.minimum)==="array"&&(d=a.minimum[t.arrayIndex]),n<d)return[new pt(e,n,`${n} is less than the minimum value ${d}`)]}if("maximum"in a){let d=a.maximum;if(bi(a.maximum)==="array"&&(d=a.maximum[t.arrayIndex]),n>d)return[new pt(e,n,`${n} is greater than the maximum value ${d}`)]}return[]}function Fl(t){const e=t.valueSpec,n=tn(t.value.type);let a,u,d,m={};const v=n!=="categorical"&&t.value.property===void 0,b=!v,T=bi(t.value.stops)==="array"&&bi(t.value.stops[0])==="array"&&bi(t.value.stops[0][0])==="object",A=gr({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(F){if(n==="identity")return[new pt(F.key,F.value,'identity function may not have a "stops" property')];let j=[];const G=F.value;return j=j.concat(lu({key:F.key,value:G,valueSpec:F.valueSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:I})),bi(G)==="array"&&G.length===0&&j.push(new pt(F.key,G,"array must have at least one stop")),j},default:function(F){return gn({key:F.key,value:F.value,valueSpec:e,style:F.style,styleSpec:F.styleSpec})}}});return n==="identity"&&v&&A.push(new pt(t.key,t.value,'missing required property "property"')),n==="identity"||t.value.stops||A.push(new pt(t.key,t.value,'missing required property "stops"')),n==="exponential"&&t.valueSpec.expression&&!ou(t.valueSpec)&&A.push(new pt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(b&&!As(t.valueSpec)?A.push(new pt(t.key,t.value,"property functions not supported")):v&&!Yh(t.valueSpec)&&A.push(new pt(t.key,t.value,"zoom functions not supported"))),n!=="categorical"&&!T||t.value.property!==void 0||A.push(new pt(t.key,t.value,'"property" property is required')),A;function I(F){let j=[];const G=F.value,Z=F.key;if(bi(G)!=="array")return[new pt(Z,G,`array expected, ${bi(G)} found`)];if(G.length!==2)return[new pt(Z,G,`array length 2 expected, length ${G.length} found`)];if(T){if(bi(G[0])!=="object")return[new pt(Z,G,`object expected, ${bi(G[0])} found`)];if(G[0].zoom===void 0)return[new pt(Z,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new pt(Z,G,"object stop key must have value")];if(d&&d>tn(G[0].zoom))return[new pt(Z,G[0].zoom,"stop zoom values must appear in ascending order")];tn(G[0].zoom)!==d&&(d=tn(G[0].zoom),u=void 0,m={}),j=j.concat(gr({key:`${Z}[0]`,value:G[0],valueSpec:{zoom:{}},style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:ed,value:z}}))}else j=j.concat(z({key:`${Z}[0]`,value:G[0],valueSpec:{},style:F.style,styleSpec:F.styleSpec},G));return Ms(lo(G[1]))?j.concat([new pt(`${Z}[1]`,G[1],"expressions are not allowed in function stops.")]):j.concat(gn({key:`${Z}[1]`,value:G[1],valueSpec:e,style:F.style,styleSpec:F.styleSpec}))}function z(F,j){const G=bi(F.value),Z=tn(F.value),Q=F.value!==null?F.value:j;if(a){if(G!==a)return[new pt(F.key,Q,`${G} stop domain type must match previous stop domain type ${a}`)]}else a=G;if(G!=="number"&&G!=="string"&&G!=="boolean")return[new pt(F.key,Q,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&n!=="categorical"){let se=`number expected, ${G} found`;return As(e)&&n===void 0&&(se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pt(F.key,Q,se)]}return n!=="categorical"||G!=="number"||isFinite(Z)&&Math.floor(Z)===Z?n!=="categorical"&&G==="number"&&u!==void 0&&Z<u?[new pt(F.key,Q,"stop domain values must appear in ascending order")]:(u=Z,n==="categorical"&&Z in m?[new pt(F.key,Q,"stop domain values must be unique")]:(m[Z]=!0,[])):[new pt(F.key,Q,`integer expected, found ${Z}`)]}}function uo(t){const e=(t.expressionContext==="property"?Qh:Ma)(lo(t.value),t.valueSpec);if(e.result==="error")return e.value.map(a=>new pt(`${t.key}${a.key}`,t.value,a.message));const n=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!n.outputDefined())return[new pt(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!_a(n))return[new pt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter")return cu(n,t);if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!ya(n,["zoom","feature-state"]))return[new pt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!Cs(n))return[new pt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function cu(t,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);for(const u of e.valueSpec.expression.parameters)n.delete(u);if(n.size===0)return[];const a=[];return t instanceof nr&&n.has(t.name)?[new pt(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(u=>{a.push(...cu(u,e))}),a)}function Nl(t){const e=t.key,n=t.value,a=t.valueSpec,u=[];return Array.isArray(a.values)?a.values.indexOf(tn(n))===-1&&u.push(new pt(e,n,`expected one of [${a.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(a.values).indexOf(tn(n))===-1&&u.push(new pt(e,n,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(n)} found`)),u}function Ul(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Ul(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function jl(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ul(t)||(t=$l(t));const n=t;let a=!0;try{a=function(T){if(!ks(T))return T;let A=lo(T);return td(A),A=Vl(A),A}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const u=ke[`filter_${e}`],d=Ma(a,u);let m=null;if(d.result==="error")throw new Error(d.value.map(T=>`${T.key}: ${T.message}`).join(", "));m=(T,A,I)=>d.value.evaluate(T,A,{},I);let v=null,b=null;if(a!==n){const T=Ma(n,u);if(T.result==="error")throw new Error(T.value.map(A=>`${A.key}: ${A.message}`).join(", "));v=(A,I,z,F,j)=>T.value.evaluate(A,I,{},z,void 0,void 0,F,j),b=!Cs(T.value.expression)}return m=m,{filter:m,dynamicFilter:v||void 0,needGeometry:uu(a),needFeature:!!b}}function Vl(t){if(!Array.isArray(t))return t;const e=function(n){if(vf.has(n[0])){for(let a=1;a<n.length;a++)if(ks(n[a]))return!0}return n}(t);return e===!0?e:e.map(n=>Vl(n))}function td(t){let e=!1;const n=[];if(t[0]==="case"){for(let a=1;a<t.length-1;a+=2)e=e||ks(t[a]),n.push(t[a+1]);n.push(t[t.length-1])}else if(t[0]==="match"){e=e||ks(t[1]);for(let a=2;a<t.length-1;a+=2)n.push(t[a+1]);n.push(t[t.length-1])}else if(t[0]==="step"){e=e||ks(t[1]);for(let a=1;a<t.length-1;a+=2)n.push(t[a+1])}e&&(t.length=0,t.push("any",...n));for(let a=1;a<t.length;a++)td(t[a])}function ks(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<t.length;n++)if(ks(t[n]))return!0;return!1}const vf=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function xf(t,e){return t<e?-1:t>e?1:0}function uu(t){if(!Array.isArray(t))return!1;if(t[0]==="within")return!0;for(let e=1;e<t.length;e++)if(uu(t[e]))return!0;return!1}function $l(t){if(!t)return!0;const e=t[0];return t.length<=1?e!=="any":e==="=="?hu(t[1],t[2],"=="):e==="!="?Gl(hu(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?hu(t[1],t[2],e):e==="any"?(n=t.slice(1),["any"].concat(n.map($l))):e==="all"?["all"].concat(t.slice(1).map($l)):e==="none"?["all"].concat(t.slice(1).map($l).map(Gl)):e==="in"?id(t[1],t.slice(2)):e==="!in"?Gl(id(t[1],t.slice(2))):e==="has"?nd(t[1]):e==="!has"?Gl(nd(t[1])):e!=="within"||t;var n}function hu(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function id(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",t,["literal",e.sort(xf)]]:["filter-in-small",t,["literal",e]]}}function nd(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Gl(t){return["!",t]}function du(t){if(Ul(lo(t.value))){const e=lo(t.layerType);return uo(ko({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${e||"fill"}`]}))}return rd(t)}function rd(t){const e=t.value,n=t.key;if(bi(e)!=="array")return[new pt(n,e,`array expected, ${bi(e)} found`)];const a=t.styleSpec;let u,d=[];if(e.length<1)return[new pt(n,e,"filter array must have at least 1 element")];switch(d=d.concat(Nl({key:`${n}[0]`,value:e[0],valueSpec:a.filter_operator,style:t.style,styleSpec:t.styleSpec})),tn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&tn(e[1])==="$type"&&d.push(new pt(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&d.push(new pt(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=bi(e[1]),u!=="string"&&d.push(new pt(`${n}[1]`,e[1],`string expected, ${u} found`)));for(let m=2;m<e.length;m++)u=bi(e[m]),tn(e[1])==="$type"?d=d.concat(Nl({key:`${n}[${m}]`,value:e[m],valueSpec:a.geometry_type,style:t.style,styleSpec:t.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&d.push(new pt(`${n}[${m}]`,e[m],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let m=1;m<e.length;m++)d=d.concat(rd({key:`${n}[${m}]`,value:e[m],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":u=bi(e[1]),e.length!==2?d.push(new pt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&d.push(new pt(`${n}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=bi(e[1]),e.length!==2?d.push(new pt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="object"&&d.push(new pt(`${n}[1]`,e[1],`object expected, ${u} found`))}return d}function ka(t,e){const n=t.key,a=t.style,u=t.styleSpec,d=t.value,m=t.objectKey,v=u[`${e}_${t.layerType}`];if(!v)return[];const b=m.match(/^(.*)-transition$/);if(e==="paint"&&b&&v[b[1]]&&v[b[1]].transition)return gn({key:n,value:d,valueSpec:u.transition,style:a,styleSpec:u});const T=t.valueSpec||v[m];if(!T)return[new pt(n,d,`unknown property "${m}"`)];let A;if(bi(d)==="string"&&As(T)&&!T.tokens&&(A=/^{([^}]+)}$/.exec(d)))return[new pt(n,d,`"${m}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const I=[];return t.layerType==="symbol"&&(m==="text-field"&&a&&!a.glyphs&&I.push(new pt(n,d,'use of "text-field" requires a style "glyphs" property')),m==="text-font"&&Ll(lo(d))&&tn(d.type)==="identity"&&I.push(new pt(n,d,'"text-font" does not support identity functions'))),I.concat(gn({key:t.key,value:d,valueSpec:T,style:a,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:m}))}function od(t){return ka(t,"paint")}function sd(t){return ka(t,"layout")}function za(t){let e=[];const n=t.value,a=t.key,u=t.style,d=t.styleSpec;n.type||n.ref||e.push(new pt(a,n,'either "type" or "ref" is required'));let m=tn(n.type);const v=tn(n.ref);if(n.id){const b=tn(n.id);for(let T=0;T<t.arrayIndex;T++){const A=u.layers[T];tn(A.id)===b&&e.push(new pt(a,n.id,`duplicate layer id "${n.id}", previously used at line ${A.id.__line__}`))}}if("ref"in n){let b;["type","source","source-layer","filter","layout"].forEach(T=>{T in n&&e.push(new pt(a,n[T],`"${T}" is prohibited for ref layers`))}),u.layers.forEach(T=>{tn(T.id)===v&&(b=T)}),b?b.ref?e.push(new pt(a,n.ref,"ref cannot reference another ref layer")):m=tn(b.type):e.push(new pt(a,n.ref,`ref layer "${v}" not found`))}else if(m!=="background"&&m!=="sky")if(n.source){const b=u.sources&&u.sources[n.source],T=b&&tn(b.type);b?T==="vector"&&m==="raster"?e.push(new pt(a,n.source,`layer "${n.id}" requires a raster source`)):T==="raster"&&m!=="raster"?e.push(new pt(a,n.source,`layer "${n.id}" requires a vector source`)):T!=="vector"||n["source-layer"]?T==="raster-dem"&&m!=="hillshade"?e.push(new pt(a,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):m!=="line"||!n.paint||!n.paint["line-gradient"]||T==="geojson"&&b.lineMetrics||e.push(new pt(a,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new pt(a,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new pt(a,n.source,`source "${n.source}" not found`))}else e.push(new pt(a,n,'missing required property "source"'));return e=e.concat(gr({key:a,value:n,valueSpec:d.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>gn({key:`${a}.type`,value:n.type,valueSpec:d.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:b=>du(ko({layerType:m},b)),layout:b=>gr({layer:n,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":T=>sd(ko({layerType:m},T))}}),paint:b=>gr({layer:n,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":T=>od(ko({layerType:m},T))}})}})),e}function zs(t){const e=t.value,n=t.key,a=bi(e);return a!=="string"?[new pt(n,e,`string expected, ${a} found`)]:[]}const pu={promoteId:function({key:t,value:e}){if(bi(e)==="string")return zs({key:t,value:e});{const n=[];for(const a in e)n.push(...zs({key:`${t}.${a}`,value:e[a]}));return n}}};function ad(t){const e=t.value,n=t.key,a=t.styleSpec,u=t.style;if(!e.type)return[new pt(n,e,'"type" is required')];const d=tn(e.type);let m;switch(d){case"vector":case"raster":case"raster-dem":return m=gr({key:n,value:e,valueSpec:a[`source_${d.replace("-","_")}`],style:t.style,styleSpec:a,objectElementValidators:pu}),m;case"geojson":if(m=gr({key:n,value:e,valueSpec:a.source_geojson,style:u,styleSpec:a,objectElementValidators:pu}),e.cluster)for(const v in e.clusterProperties){const[b,T]=e.clusterProperties[v],A=typeof b=="string"?[b,["accumulated"],["get",v]]:b;m.push(...uo({key:`${n}.${v}.map`,value:T,expressionContext:"cluster-map"})),m.push(...uo({key:`${n}.${v}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return m;case"video":return gr({key:n,value:e,valueSpec:a.source_video,style:u,styleSpec:a});case"image":return gr({key:n,value:e,valueSpec:a.source_image,style:u,styleSpec:a});case"canvas":return[new pt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Nl({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:u,styleSpec:a})}}function fu(t){const e=t.value,n=t.styleSpec,a=n.light,u=t.style;let d=[];const m=bi(e);if(e===void 0)return d;if(m!=="object")return d=d.concat([new pt("light",e,`object expected, ${m} found`)]),d;for(const v in e){const b=v.match(/^(.*)-transition$/);d=d.concat(b&&a[b[1]]&&a[b[1]].transition?gn({key:v,value:e[v],valueSpec:n.transition,style:u,styleSpec:n}):a[v]?gn({key:v,value:e[v],valueSpec:a[v],style:u,styleSpec:n}):[new pt(v,e[v],`unknown property "${v}"`)])}return d}function mu(t){const e=t.value,n=t.key,a=t.style,u=t.styleSpec,d=u.terrain;let m=[];const v=bi(e);if(e===void 0)return m;if(v!=="object")return m=m.concat([new pt("terrain",e,`object expected, ${v} found`)]),m;for(const b in e){const T=b.match(/^(.*)-transition$/);m=m.concat(T&&d[T[1]]&&d[T[1]].transition?gn({key:b,value:e[b],valueSpec:u.transition,style:a,styleSpec:u}):d[b]?gn({key:b,value:e[b],valueSpec:d[b],style:a,styleSpec:u}):[new pt(b,e[b],`unknown property "${b}"`)])}if(e.source){const b=a.sources&&a.sources[e.source],T=b&&tn(b.type);b?T!=="raster-dem"&&m.push(new pt(n,e.source,`terrain cannot be used with a source of type ${T}, it only be used with a "raster-dem" source type`)):m.push(new pt(n,e.source,`source "${e.source}" not found`))}else m.push(new pt(n,e,'terrain is missing required property "source"'));return m}function gu(t){const e=t.value,n=t.style,a=t.styleSpec,u=a.fog;let d=[];const m=bi(e);if(e===void 0)return d;if(m!=="object")return d=d.concat([new pt("fog",e,`object expected, ${m} found`)]),d;for(const v in e){const b=v.match(/^(.*)-transition$/);d=d.concat(b&&u[b[1]]&&u[b[1]].transition?gn({key:v,value:e[v],valueSpec:a.transition,style:n,styleSpec:a}):u[v]?gn({key:v,value:e[v],valueSpec:u[v],style:n,styleSpec:a}):[new pt(v,e[v],`unknown property "${v}"`)])}return d}const _u={"*":()=>[],array:lu,boolean:function(t){const e=t.value,n=t.key,a=bi(e);return a!=="boolean"?[new pt(n,e,`boolean expected, ${a} found`)]:[]},number:ed,color:function(t){const e=t.key,n=t.value,a=bi(n);return a!=="string"?[new pt(e,n,`color expected, ${a} found`)]:Ss.parseCSSColor(n)===null?[new pt(e,n,`color expected, "${n}" found`)]:[]},constants:kh,enum:Nl,filter:du,function:Fl,layer:za,object:gr,source:ad,light:fu,terrain:mu,fog:gu,string:zs,formatted:function(t){return zs(t).length===0?[]:uo(t)},resolvedImage:function(t){return zs(t).length===0?[]:uo(t)},projection:function(t){const e=t.value,n=t.styleSpec,a=n.projection,u=t.style;let d=[];const m=bi(e);if(m==="object")for(const v in e)d=d.concat(gn({key:v,value:e[v],valueSpec:a[v],style:u,styleSpec:n}));else m!=="string"&&(d=d.concat([new pt("projection",e,`object or string expected, ${m} found`)]));return d}};function gn(t){const e=t.value,n=t.valueSpec,a=t.styleSpec;return n.expression&&Ll(tn(e))?Fl(t):n.expression&&Ms(lo(e))?uo(t):n.type&&_u[n.type]?_u[n.type](t):gr(ko({},t,{valueSpec:n.type?a[n.type]:n}))}function yu(t){const e=t.value,n=t.key,a=zs(t);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new pt(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new pt(n,e,'"glyphs" url must include a "{range}" token'))),a}function ho(t,e=ke){let n=[];return n=n.concat(gn({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:yu,"*":()=>[]}})),t.constants&&(n=n.concat(kh({key:"constants",value:t.constants,style:t,styleSpec:e}))),ld(n)}function ld(t){return[].concat(t).sort((e,n)=>e.line-n.line)}function Ir(t){return function(...e){return ld(t.apply(this,e))}}ho.source=Ir(ad),ho.light=Ir(fu),ho.terrain=Ir(mu),ho.fog=Ir(gu),ho.layer=Ir(za),ho.filter=Ir(du),ho.paintProperty=Ir(od),ho.layoutProperty=Ir(sd);const Ps=ho,Ds=Ps.light,bf=Ps.fog,vu=Ps.paintProperty,wf=Ps.layoutProperty;function cd(t,e){let n=!1;if(e&&e.length)for(const a of e)t.fire(new pl(new Error(a.message))),n=!0;return n}var Pa=Vn;function Vn(t,e,n){var a=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var u=new Int32Array(this.arrayBuffer);t=u[0],this.d=(e=u[1])+2*(n=u[2]);for(var d=0;d<this.d*this.d;d++){var m=u[3+d],v=u[3+d+1];a.push(m===v?null:u.subarray(m,v))}var b=u[3+a.length+1];this.keys=u.subarray(u[3+a.length],b),this.bboxes=u.subarray(b),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var T=0;T<this.d*this.d;T++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var A=n/e*t;this.min=-A,this.max=t+A}Vn.prototype.insert=function(t,e,n,a,u){this._forEachCell(e,n,a,u,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(a),this.bboxes.push(u)},Vn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Vn.prototype._insertCell=function(t,e,n,a,u,d){this.cells[u].push(d)},Vn.prototype.query=function(t,e,n,a,u){var d=this.min,m=this.max;if(t<=d&&e<=d&&m<=n&&m<=a&&!u)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(t,e,n,a,this._queryCell,v,{},u),v},Vn.prototype._queryCell=function(t,e,n,a,u,d,m,v){var b=this.cells[u];if(b!==null)for(var T=this.keys,A=this.bboxes,I=0;I<b.length;I++){var z=b[I];if(m[z]===void 0){var F=4*z;(v?v(A[F+0],A[F+1],A[F+2],A[F+3]):t<=A[F+2]&&e<=A[F+3]&&n>=A[F+0]&&a>=A[F+1])?(m[z]=!0,d.push(T[z])):m[z]=!1}}},Vn.prototype._forEachCell=function(t,e,n,a,u,d,m,v){for(var b=this._convertToCellCoord(t),T=this._convertToCellCoord(e),A=this._convertToCellCoord(n),I=this._convertToCellCoord(a),z=b;z<=A;z++)for(var F=T;F<=I;F++){var j=this.d*F+z;if((!v||v(this._convertFromCellCoord(z),this._convertFromCellCoord(F),this._convertFromCellCoord(z+1),this._convertFromCellCoord(F+1)))&&u.call(this,t,e,n,a,j,d,m,v))return}},Vn.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Vn.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Vn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,a=0;a<this.cells.length;a++)n+=this.cells[a].length;var u=new Int32Array(e+n+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var d=e,m=0;m<t.length;m++){var v=t[m];u[3+m]=d,u.set(v,d),d+=v.length}return u[3+t.length]=d,u.set(this.keys,d),u[3+t.length+1]=d+=this.keys.length,u.set(this.bboxes,d),d+=this.bboxes.length,u.buffer};const{ImageData:Da,ImageBitmap:Ls}=U,La={};function _t(t,e,n={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),La[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}_t("Object",Object),Pa.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},Pa.deserialize=function(t){return new Pa(t.buffer)},_t("Grid",Pa),_t("Color",yi),_t("Error",Error),_t("ResolvedImage",fr),_t("StylePropertyFunction",Is),_t("StyleExpression",su,{omit:["_evaluator"]}),_t("ZoomDependentExpression",au),_t("ZoomConstantExpression",Ia),_t("CompoundExpression",nr,{omit:["_evaluate"]});for(const t in Mr)Mr[t]._classRegistryKey||_t(`Expression_${t}`,Mr[t]);function Rs(t){return t&&typeof ArrayBuffer!="undefined"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function ud(t){return Ls&&t instanceof Ls}function Ra(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Rs(t)||ud(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof Da)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const a of t)n.push(Ra(a,e));return n}if(typeof t=="object"){const n=t.constructor,a=n._classRegistryKey;if(!a)throw new Error("can't serialize object of unregistered class");const u=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const d in t){if(!t.hasOwnProperty(d)||La[a].omit.indexOf(d)>=0)continue;const m=t[d];u[d]=La[a].shallow.indexOf(d)>=0?m:Ra(m,e)}t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(u.$name=a),u}throw new Error("can't serialize object of type "+typeof t)}function Fo(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Rs(t)||ud(t)||ArrayBuffer.isView(t)||t instanceof Da)return t;if(Array.isArray(t))return t.map(Fo);if(typeof t=="object"){const e=t.$name||"Object",{klass:n}=La[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const a=Object.create(n.prototype);for(const u of Object.keys(t)){if(u==="$name")continue;const d=t[u];a[u]=La[e].shallow.indexOf(u)>=0?d:Fo(d)}return a}throw new Error("can't deserialize object of type "+typeof t)}class p{constructor(){this.first=!0}update(e,n){const a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))}}const i=t=>t>=1536&&t<=1791,c=t=>t>=1872&&t<=1919,f=t=>t>=2208&&t<=2303,_=t=>t>=11904&&t<=12031,x=t=>t>=12032&&t<=12255,w=t=>t>=12272&&t<=12287,S=t=>t>=12288&&t<=12351,P=t=>t>=12352&&t<=12447,L=t=>t>=12448&&t<=12543,O=t=>t>=12544&&t<=12591,N=t=>t>=12704&&t<=12735,$=t=>t>=12736&&t<=12783,H=t=>t>=12784&&t<=12799,q=t=>t>=12800&&t<=13055,X=t=>t>=13056&&t<=13311,le=t=>t>=13312&&t<=19903,W=t=>t>=19968&&t<=40959,re=t=>t>=40960&&t<=42127,oe=t=>t>=42128&&t<=42191,ie=t=>t>=44032&&t<=55215,ne=t=>t>=63744&&t<=64255,ce=t=>t>=64336&&t<=65023,Se=t=>t>=65040&&t<=65055,Me=t=>t>=65072&&t<=65103,et=t=>t>=65104&&t<=65135,qe=t=>t>=65136&&t<=65279,Ge=t=>t>=65280&&t<=65519;function ze(t){for(const e of t)if(Fe(e.charCodeAt(0)))return!0;return!1}function Ae(t){for(const e of t)if(!$e(e.charCodeAt(0)))return!1;return!0}function $e(t){return!(i(t)||c(t)||f(t)||ce(t)||qe(t))}function Fe(t){return!(t!==746&&t!==747&&(t<4352||!(N(t)||O(t)||Me(t)&&!(t>=65097&&t<=65103)||ne(t)||X(t)||_(t)||$(t)||!(!S(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||le(t)||W(t)||q(t)||(e=>e>=12592&&e<=12687)(t)||(e=>e>=43360&&e<=43391)(t)||(e=>e>=55216&&e<=55295)(t)||(e=>e>=4352&&e<=4607)(t)||ie(t)||P(t)||w(t)||(e=>e>=12688&&e<=12703)(t)||x(t)||H(t)||L(t)&&t!==12540||!(!Ge(t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!et(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(e=>e>=5120&&e<=5759)(t)||(e=>e>=6320&&e<=6399)(t)||Se(t)||(e=>e>=19904&&e<=19967)(t)||re(t)||oe(t))))}function St(t){return!(Fe(t)||function(e){return!!((n=>n>=128&&n<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(n=>n>=8192&&n<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(n=>n>=8448&&n<=8527)(e)||(n=>n>=8528&&n<=8591)(e)||(n=>n>=8960&&n<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(n=>n>=9216&&n<=9279)(e)&&e!==9251||(n=>n>=9280&&n<=9311)(e)||(n=>n>=9312&&n<=9471)(e)||(n=>n>=9632&&n<=9727)(e)||(n=>n>=9728&&n<=9983)(e)&&!(e>=9754&&e<=9759)||(n=>n>=11008&&n<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||S(e)||L(e)||(n=>n>=57344&&n<=63743)(e)||Me(e)||et(e)||Ge(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function Dt(t){return t>=1424&&t<=2303||ce(t)||qe(t)}function Xt(t,e){return!(!e&&Dt(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(n=>n>=6016&&n<=6143)(t))}function Qe(t){for(const e of t)if(Dt(e.charCodeAt(0)))return!0;return!1}const zt="deferred",Ut="loading",Ci="loaded";let Di=null,Ot="unavailable",ii=null;const Ui=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Ot="error"),Di&&Di(t)};function hn(){Qn.fire(new Mo("pluginStateChange",{pluginStatus:Ot,pluginURL:ii}))}const Qn=new Io,_r=function(){return Ot},kr=function(){if(Ot!==zt||!ii)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ot=Ut,hn(),ii&&ua({url:ii},t=>{t?Ui(t):(Ot=Ci,hn())})},fi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ot===Ci||fi.applyArabicShaping!=null,isLoading:()=>Ot===Ut,setState(t){Ot=t.pluginStatus,ii=t.pluginURL},isParsed:()=>fi.applyArabicShaping!=null&&fi.processBidirectionalText!=null&&fi.processStyledBidirectionalText!=null,getPluginURL:()=>ii};class jt{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new p,this.transition={},this.pitch=0)}isSupportedScript(e){return function(n,a){for(const u of n)if(!Xt(u.charCodeAt(0),a))return!1;return!0}(e,fi.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*n}}}class ai{constructor(e,n){this.property=e,this.value=n,this.expression=function(a,u){if(Ll(a))return new Is(a,u);if(Ms(a)){const d=Qh(a,u);if(d.result==="error")throw new Error(d.value.map(m=>`${m.key}: ${m.message}`).join(", "));return d.value}{let d=a;return typeof a=="string"&&u.type==="color"&&(d=yi.parse(a)),{kind:"constant",evaluate:()=>d}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,a){return this.property.possiblyEvaluate(this,e,n,a)}}class Yi{constructor(e){this.property=e,this.value=new ai(e,void 0)}transitioned(e,n){return new Fi(this.property,this.value,n,dt({},e.transition,this.transition),e.now)}untransitioned(){return new Fi(this.property,this.value,null,{},0)}}class rr{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return An(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Yi(this._values[e].property)),this._values[e].value=new ai(this._values[e].property,n===null?void 0:An(n))}getTransition(e){return An(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Yi(this._values[e].property)),this._values[e].transition=An(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(e[n]=a);const u=this.getTransition(n);u!==void 0&&(e[`${n}-transition`]=u)}return e}transitioned(e,n){const a=new or(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].transitioned(e,n._values[u]);return a}untransitioned(){const e=new or(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class Fi{constructor(e,n,a,u,d){const m=u.delay||0,v=u.duration||0;d=d||0,this.property=e,this.value=n,this.begin=d+m,this.end=this.begin+v,e.specification.transition&&(u.delay||u.duration)&&(this.prior=a)}possiblyEvaluate(e,n,a){const u=e.now||0,d=this.value.possiblyEvaluate(e,n,a),m=this.prior;if(m){if(u>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(u<this.begin)return m.possiblyEvaluate(e,n,a);{const v=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,n,a),d,Ve(v))}}return d}}class or{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,a){const u=new ns(this._properties);for(const d of Object.keys(this._values))u._values[d]=this._values[d].possiblyEvaluate(e,n,a);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Oa{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return An(this._values[e].value)}setValue(e,n){this._values[e]=new ai(this._values[e].property,n===null?void 0:An(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(e[n]=a)}return e}possiblyEvaluate(e,n,a){const u=new ns(this._properties);for(const d of Object.keys(this._values))u._values[d]=this._values[d].possiblyEvaluate(e,n,a);return u}}class er{constructor(e,n,a){this.property=e,this.value=n,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,a,u){return this.property.evaluate(this.value,this.parameters,e,n,a,u)}}class ns{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class xt{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,a){const u=Tl[this.specification.type];return u?u(e,n,a):e}}class Pt{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,a,u){return new er(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},a,u)}:e.expression,n)}interpolate(e,n,a){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new er(this,{kind:"constant",value:void 0},e.parameters);const u=Tl[this.specification.type];return u?new er(this,{kind:"constant",value:u(e.value.value,n.value.value,a)},e.parameters):e}evaluate(e,n,a,u,d,m){return e.kind==="constant"?e.value:e.evaluate(n,a,u,d,m)}}class _n extends Pt{possiblyEvaluate(e,n,a,u){if(e.value===void 0)return new er(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const d=e.expression.evaluate(n,null,{},a,u),m=e.property.specification.type==="resolvedImage"&&typeof d!="string"?d.name:d,v=this._calculate(m,m,m,n);return new er(this,{kind:"constant",value:v},n)}if(e.expression.kind==="camera"){const d=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new er(this,{kind:"constant",value:d},n)}return new er(this,e.expression,n)}evaluate(e,n,a,u,d,m){if(e.kind==="source"){const v=e.evaluate(n,a,u,d,m);return this._calculate(v,v,v,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},a,u),e.evaluate({zoom:Math.floor(n.zoom)},a,u),e.evaluate({zoom:Math.floor(n.zoom)+1},a,u),n):e.value}_calculate(e,n,a,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:n,other:a}:{from:a,to:n,other:e}}interpolate(e){return e}}class rs{constructor(e){this.specification=e}possiblyEvaluate(e,n,a,u){if(e.value!==void 0){if(e.expression.kind==="constant"){const d=e.expression.evaluate(n,null,{},a,u);return this._calculate(d,d,d,n)}return this._calculate(e.expression.evaluate(new jt(Math.floor(n.zoom-1),n)),e.expression.evaluate(new jt(Math.floor(n.zoom),n)),e.expression.evaluate(new jt(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,a,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:a,to:n}}interpolate(e){return e}}class No{constructor(e){this.specification=e}possiblyEvaluate(e,n,a,u){return!!e.expression.evaluate(n,null,{},a,u)}interpolate(){return!1}}class zn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){const a=e[n];a.specification.overridable&&this.overridableProperties.push(n);const u=this.defaultPropertyValues[n]=new ai(a,void 0),d=this.defaultTransitionablePropertyValues[n]=new Yi(a);this.defaultTransitioningPropertyValues[n]=d.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=u.possiblyEvaluate({})}}}function W_(t,e){return 256*(t=Ne(Math.floor(t),0,255))+Ne(Math.floor(e),0,255)}_t("DataDrivenProperty",Pt),_t("DataConstantProperty",xt),_t("CrossFadedDataDrivenProperty",_n),_t("CrossFadedProperty",rs),_t("ColorRampProperty",No);const Hw={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xu{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class on{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Hi(t,e=1){let n=0,a=0;return{members:t.map(u=>{const d=Hw[u.type].BYTES_PER_ELEMENT,m=n=H_(n,Math.max(e,d)),v=u.components||1;return a=Math.max(a,d),n+=d*v,{name:u.name,type:u.type,components:v,offset:m}}),size:H_(n,Math.max(a,e)),alignment:e}}function H_(t,e){return Math.ceil(t/e)*e}class ql extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const u=2*e;return this.int16[u+0]=n,this.int16[u+1]=a,e}}ql.prototype.bytesPerElement=4,_t("StructArrayLayout2i4",ql);class Zl extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,a,u)}emplace(e,n,a,u,d){const m=4*e;return this.int16[m+0]=n,this.int16[m+1]=a,this.int16[m+2]=u,this.int16[m+3]=d,e}}Zl.prototype.bytesPerElement=8,_t("StructArrayLayout4i8",Zl);class Tf extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,v){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,a,u,d,m,v)}emplace(e,n,a,u,d,m,v,b){const T=6*e,A=12*e,I=3*e;return this.int16[T+0]=n,this.int16[T+1]=a,this.uint8[A+4]=u,this.uint8[A+5]=d,this.uint8[A+6]=m,this.uint8[A+7]=v,this.float32[I+2]=b,e}}Tf.prototype.bytesPerElement=12,_t("StructArrayLayout2i4ub1f12",Tf);class Wl extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,a)}emplace(e,n,a,u){const d=3*e;return this.float32[d+0]=n,this.float32[d+1]=a,this.float32[d+2]=u,e}}Wl.prototype.bytesPerElement=12,_t("StructArrayLayout3f12",Wl);class Os extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,v,b,T,A){const I=this.length;return this.resize(I+1),this.emplace(I,e,n,a,u,d,m,v,b,T,A)}emplace(e,n,a,u,d,m,v,b,T,A,I){const z=10*e;return this.uint16[z+0]=n,this.uint16[z+1]=a,this.uint16[z+2]=u,this.uint16[z+3]=d,this.uint16[z+4]=m,this.uint16[z+5]=v,this.uint16[z+6]=b,this.uint16[z+7]=T,this.uint16[z+8]=A,this.uint16[z+9]=I,e}}Os.prototype.bytesPerElement=20,_t("StructArrayLayout10ui20",Os);class hd extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,v,b){const T=this.length;return this.resize(T+1),this.emplace(T,e,n,a,u,d,m,v,b)}emplace(e,n,a,u,d,m,v,b,T){const A=8*e;return this.uint16[A+0]=n,this.uint16[A+1]=a,this.uint16[A+2]=u,this.uint16[A+3]=d,this.uint16[A+4]=m,this.uint16[A+5]=v,this.uint16[A+6]=b,this.uint16[A+7]=T,e}}hd.prototype.bytesPerElement=16,_t("StructArrayLayout8ui16",hd);class Ef extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,v,b,T,A,I,z,F,j,G,Z){const Q=this.length;return this.resize(Q+1),this.emplace(Q,e,n,a,u,d,m,v,b,T,A,I,z,F,j,G,Z)}emplace(e,n,a,u,d,m,v,b,T,A,I,z,F,j,G,Z,Q){const se=16*e;return this.int16[se+0]=n,this.int16[se+1]=a,this.int16[se+2]=u,this.int16[se+3]=d,this.uint16[se+4]=m,this.uint16[se+5]=v,this.uint16[se+6]=b,this.uint16[se+7]=T,this.int16[se+8]=A,this.int16[se+9]=I,this.int16[se+10]=z,this.int16[se+11]=F,this.int16[se+12]=j,this.int16[se+13]=G,this.int16[se+14]=Z,this.int16[se+15]=Q,e}}Ef.prototype.bytesPerElement=32,_t("StructArrayLayout4i4ui4i4i32",Ef);class Sf extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}Sf.prototype.bytesPerElement=4,_t("StructArrayLayout1ul4",Sf);class Cf extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,v,b,T,A,I,z,F){const j=this.length;return this.resize(j+1),this.emplace(j,e,n,a,u,d,m,v,b,T,A,I,z,F)}emplace(e,n,a,u,d,m,v,b,T,A,I,z,F,j){const G=20*e,Z=10*e;return this.int16[G+0]=n,this.int16[G+1]=a,this.int16[G+2]=u,this.int16[G+3]=d,this.int16[G+4]=m,this.float32[Z+3]=v,this.float32[Z+4]=b,this.float32[Z+5]=T,this.float32[Z+6]=A,this.int16[G+14]=I,this.uint32[Z+8]=z,this.uint16[G+18]=F,this.uint16[G+19]=j,e}}Cf.prototype.bytesPerElement=40,_t("StructArrayLayout5i4f1i1ul2ui40",Cf);class dd extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,v){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,a,u,d,m,v)}emplace(e,n,a,u,d,m,v,b){const T=8*e;return this.int16[T+0]=n,this.int16[T+1]=a,this.int16[T+2]=u,this.int16[T+4]=d,this.int16[T+5]=m,this.int16[T+6]=v,this.int16[T+7]=b,e}}dd.prototype.bytesPerElement=16,_t("StructArrayLayout3i2i2i16",dd);class Af extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,a,u,d)}emplace(e,n,a,u,d,m){const v=4*e,b=8*e;return this.float32[v+0]=n,this.float32[v+1]=a,this.float32[v+2]=u,this.int16[b+6]=d,this.int16[b+7]=m,e}}Af.prototype.bytesPerElement=16,_t("StructArrayLayout2f1f2i16",Af);class Mf extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,a,u)}emplace(e,n,a,u,d){const m=12*e,v=3*e;return this.uint8[m+0]=n,this.uint8[m+1]=a,this.float32[v+1]=u,this.float32[v+2]=d,e}}Mf.prototype.bytesPerElement=12,_t("StructArrayLayout2ub2f12",Mf);class zr extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,a)}emplace(e,n,a,u){const d=3*e;return this.uint16[d+0]=n,this.uint16[d+1]=a,this.uint16[d+2]=u,e}}zr.prototype.bytesPerElement=6,_t("StructArrayLayout3ui6",zr);class If extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,v,b,T,A,I,z,F,j,G,Z,Q,se,de,me,_e){const xe=this.length;return this.resize(xe+1),this.emplace(xe,e,n,a,u,d,m,v,b,T,A,I,z,F,j,G,Z,Q,se,de,me,_e)}emplace(e,n,a,u,d,m,v,b,T,A,I,z,F,j,G,Z,Q,se,de,me,_e,xe){const Oe=30*e,Pe=15*e,nt=60*e;return this.int16[Oe+0]=n,this.int16[Oe+1]=a,this.int16[Oe+2]=u,this.float32[Pe+2]=d,this.float32[Pe+3]=m,this.uint16[Oe+8]=v,this.uint16[Oe+9]=b,this.uint32[Pe+5]=T,this.uint32[Pe+6]=A,this.uint32[Pe+7]=I,this.uint16[Oe+16]=z,this.uint16[Oe+17]=F,this.uint16[Oe+18]=j,this.float32[Pe+10]=G,this.float32[Pe+11]=Z,this.uint8[nt+48]=Q,this.uint8[nt+49]=se,this.uint8[nt+50]=de,this.uint32[Pe+13]=me,this.int16[Oe+28]=_e,this.uint8[nt+58]=xe,e}}If.prototype.bytesPerElement=60,_t("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",If);class kf extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,v,b,T,A,I,z,F,j,G,Z,Q,se,de,me,_e,xe,Oe,Pe,nt,Ye,Re,Je,at,je){const ft=this.length;return this.resize(ft+1),this.emplace(ft,e,n,a,u,d,m,v,b,T,A,I,z,F,j,G,Z,Q,se,de,me,_e,xe,Oe,Pe,nt,Ye,Re,Je,at,je)}emplace(e,n,a,u,d,m,v,b,T,A,I,z,F,j,G,Z,Q,se,de,me,_e,xe,Oe,Pe,nt,Ye,Re,Je,at,je,ft){const bt=38*e,di=19*e;return this.int16[bt+0]=n,this.int16[bt+1]=a,this.int16[bt+2]=u,this.float32[di+2]=d,this.float32[di+3]=m,this.int16[bt+8]=v,this.int16[bt+9]=b,this.int16[bt+10]=T,this.int16[bt+11]=A,this.int16[bt+12]=I,this.int16[bt+13]=z,this.uint16[bt+14]=F,this.uint16[bt+15]=j,this.uint16[bt+16]=G,this.uint16[bt+17]=Z,this.uint16[bt+18]=Q,this.uint16[bt+19]=se,this.uint16[bt+20]=de,this.uint16[bt+21]=me,this.uint16[bt+22]=_e,this.uint16[bt+23]=xe,this.uint16[bt+24]=Oe,this.uint16[bt+25]=Pe,this.uint16[bt+26]=nt,this.uint16[bt+27]=Ye,this.uint16[bt+28]=Re,this.uint32[di+15]=Je,this.float32[di+16]=at,this.float32[di+17]=je,this.float32[di+18]=ft,e}}kf.prototype.bytesPerElement=76,_t("StructArrayLayout3i2f6i15ui1ul3f76",kf);class pd extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}pd.prototype.bytesPerElement=4,_t("StructArrayLayout1f4",pd);class zf extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,a)}emplace(e,n,a,u){const d=3*e;return this.int16[d+0]=n,this.int16[d+1]=a,this.int16[d+2]=u,e}}zf.prototype.bytesPerElement=6,_t("StructArrayLayout3i6",zf);class bu extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,v){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,a,u,d,m,v)}emplace(e,n,a,u,d,m,v,b){const T=7*e;return this.float32[T+0]=n,this.float32[T+1]=a,this.float32[T+2]=u,this.float32[T+3]=d,this.float32[T+4]=m,this.float32[T+5]=v,this.float32[T+6]=b,e}}bu.prototype.bytesPerElement=28,_t("StructArrayLayout7f28",bu);class Pf extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,a,u)}emplace(e,n,a,u,d){const m=6*e;return this.uint32[3*e+0]=n,this.uint16[m+2]=a,this.uint16[m+3]=u,this.uint16[m+4]=d,e}}Pf.prototype.bytesPerElement=12,_t("StructArrayLayout1ul3ui12",Pf);class Bs extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const u=2*e;return this.uint16[u+0]=n,this.uint16[u+1]=a,e}}Bs.prototype.bytesPerElement=4,_t("StructArrayLayout2ui4",Bs);class fd extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}fd.prototype.bytesPerElement=2,_t("StructArrayLayout1ui2",fd);class md extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const u=2*e;return this.float32[u+0]=n,this.float32[u+1]=a,e}}md.prototype.bytesPerElement=8,_t("StructArrayLayout2f8",md);class Df extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,a,u)}emplace(e,n,a,u,d){const m=4*e;return this.float32[m+0]=n,this.float32[m+1]=a,this.float32[m+2]=u,this.float32[m+3]=d,e}}Df.prototype.bytesPerElement=16,_t("StructArrayLayout4f16",Df);class X_ extends xu{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}X_.prototype.size=40;class Lf extends Cf{get(e){return new X_(this,e)}}_t("CollisionBoxArray",Lf);class K_ extends xu{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}K_.prototype.size=60;class Y_ extends If{get(e){return new K_(this,e)}}_t("PlacedSymbolArray",Y_);class J_ extends xu{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}J_.prototype.size=76;class Q_ extends kf{get(e){return new J_(this,e)}}_t("SymbolInstanceArray",Q_);class ey extends pd{getoffsetX(e){return this.float32[1*e+0]}}_t("GlyphOffsetArray",ey);class ty extends zf{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}_t("SymbolLineVertexArray",ty);class iy extends xu{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}iy.prototype.size=12;class ny extends Pf{get(e){return new iy(this,e)}}_t("FeatureIndexArray",ny);class ry extends xu{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}ry.prototype.size=4;class oy extends Bs{get(e){return new ry(this,e)}}_t("FillExtrusionCentroidArray",oy);const Xw=Hi([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),Kw=Hi([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var sy=Es(function(t){t.exports=function(e,n){var a,u,d,m,v,b,T,A;for(u=e.length-(a=3&e.length),d=n,v=3432918353,b=461845907,A=0;A<u;)T=255&e.charCodeAt(A)|(255&e.charCodeAt(++A))<<8|(255&e.charCodeAt(++A))<<16|(255&e.charCodeAt(++A))<<24,++A,d=27492+(65535&(m=5*(65535&(d=(d^=T=(65535&(T=(T=(65535&T)*v+(((T>>>16)*v&65535)<<16)&4294967295)<<15|T>>>17))*b+(((T>>>16)*b&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(T=0,a){case 3:T^=(255&e.charCodeAt(A+2))<<16;case 2:T^=(255&e.charCodeAt(A+1))<<8;case 1:d^=T=(65535&(T=(T=(65535&(T^=255&e.charCodeAt(A)))*v+(((T>>>16)*v&65535)<<16)&4294967295)<<15|T>>>17))*b+(((T>>>16)*b&65535)<<16)&4294967295}return d^=e.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0}}),Yw=Es(function(t){t.exports=function(e,n){for(var a,u=e.length,d=n^u,m=0;u>=4;)a=1540483477*(65535&(a=255&e.charCodeAt(m)|(255&e.charCodeAt(++m))<<8|(255&e.charCodeAt(++m))<<16|(255&e.charCodeAt(++m))<<24))+((1540483477*(a>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),u-=4,++m;switch(u){case 3:d^=(255&e.charCodeAt(m+2))<<16;case 2:d^=(255&e.charCodeAt(m+1))<<8;case 1:d=1540483477*(65535&(d^=255&e.charCodeAt(m)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0}}),wu=sy,Jw=Yw;wu.murmur3=sy,wu.murmur2=Jw;class gd{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,a,u){this.ids.push(ay(e)),this.positions.push(n,a,u)}getPositions(e){const n=ay(e);let a=0,u=this.ids.length-1;for(;a<u;){const m=a+u>>1;this.ids[m]>=n?u=m:a=m+1}const d=[];for(;this.ids[a]===n;)d.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return d}static serialize(e,n){const a=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Rf(a,u,0,a.length-1),n&&n.push(a.buffer,u.buffer),{ids:a,positions:u}}static deserialize(e){const n=new gd;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function ay(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:wu(String(t))}function Rf(t,e,n,a){for(;n<a;){const u=t[n+a>>1];let d=n-1,m=a+1;for(;;){do d++;while(t[d]<u);do m--;while(t[m]>u);if(d>=m)break;_d(t,d,m),_d(e,3*d,3*m),_d(e,3*d+1,3*m+1),_d(e,3*d+2,3*m+2)}m-n<a-m?(Rf(t,e,n,m),n=m+1):(Rf(t,e,m+1,a),a=m)}}function _d(t,e,n){const a=t[e];t[e]=t[n],t[n]=a}_t("FeaturePositionMap",gd);class os{constructor(e,n){this.gl=e.gl,this.location=n}}class yd extends os{constructor(e,n){super(e,n),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class ly extends os{constructor(e,n){super(e,n),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class cy extends os{constructor(e,n){super(e,n),this.current=yi.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Qw=new Float32Array(16),e2=new Float32Array(9),t2=new Float32Array(4);function Of(t){return[W_(255*t.r,255*t.g),W_(255*t.b,255*t.a)]}class Tu{constructor(e,n,a){this.value=e,this.uniformNames=n.map(u=>`u_${u}`),this.type=a}setUniform(e,n,a){e.set(a.constantOr(this.value))}getBinding(e,n,a){return this.type==="color"?new cy(e,n):new yd(e,n)}}class Hl{constructor(e,n){this.uniformNames=n.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tl.concat(n.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,n,a,u){const d=u==="u_pattern_to"||u==="u_dash_to"?this.patternTo:u==="u_pattern_from"||u==="u_dash_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;d&&e.set(d)}getBinding(e,n,a){return a==="u_pattern_from"||a==="u_pattern_to"||a==="u_dash_from"||a==="u_dash_to"?new ly(e,n):new yd(e,n)}}class ss{constructor(e,n,a,u){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=n.map(d=>({name:`a_${d}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,n,a,u,d,m){const v=this.paintVertexArray.length,b=this.expression.evaluate(new jt(0),n,{},d,u,m);this.paintVertexArray.resize(e),this._setPaintValue(v,e,b)}updatePaintArray(e,n,a,u,d){const m=this.expression.evaluate({zoom:0},a,u,void 0,d);this._setPaintValue(e,n,m)}_setPaintValue(e,n,a){if(this.type==="color"){const u=Of(a);for(let d=e;d<n;d++)this.paintVertexArray.emplace(d,u[0],u[1])}else{for(let u=e;u<n;u++)this.paintVertexArray.emplace(u,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class po{constructor(e,n,a,u,d,m){this.expression=e,this.uniformNames=n.map(v=>`u_${v}_t`),this.type=a,this.useIntegerZoom=u,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=n.map(v=>({name:`a_${v}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(e,n,a,u,d,m){const v=this.expression.evaluate(new jt(this.zoom),n,{},d,u,m),b=this.expression.evaluate(new jt(this.zoom+1),n,{},d,u,m),T=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(T,e,v,b)}updatePaintArray(e,n,a,u,d){const m=this.expression.evaluate({zoom:this.zoom},a,u,void 0,d),v=this.expression.evaluate({zoom:this.zoom+1},a,u,void 0,d);this._setPaintValue(e,n,m,v)}_setPaintValue(e,n,a,u){if(this.type==="color"){const d=Of(a),m=Of(u);for(let v=e;v<n;v++)this.paintVertexArray.emplace(v,d[0],d[1],m[0],m[1])}else{for(let d=e;d<n;d++)this.paintVertexArray.emplace(d,a,u);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n){const a=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,u=Ne(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);e.set(u)}getBinding(e,n,a){return new yd(e,n)}}class Fs{constructor(e,n,a,u,d,m,v){this.expression=e,this.type=a,this.useIntegerZoom=u,this.zoom=d,this.layerId=v,this.paintVertexAttributes=(a==="array"?Kw:Xw).members;for(let b=0;b<n.length;++b);this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,n,a){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,n.patterns&&n.patterns[this.layerId],a)}updatePaintArray(e,n,a,u,d,m){this._setPaintValues(e,n,a.patterns&&a.patterns[this.layerId],m)}_setPaintValues(e,n,a,u){if(!u||!a)return;const{min:d,mid:m,max:v}=a,b=u[d],T=u[m],A=u[v];if(b&&T&&A)for(let I=e;I<n;I++)this._setPaintValue(this.zoomInPaintVertexArray,I,T,b),this._setPaintValue(this.zoomOutPaintVertexArray,I,T,A)}_setPaintValue(e,n,a,u){e.emplace(n,a.tl[0],a.tl[1],a.br[0],a.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],a.pixelRatio,u.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class as{constructor(e,n,a=()=>!0){this.binders={},this._buffers=[];const u=[];for(const d in e.paint._values){if(!a(d))continue;const m=e.paint.get(d);if(!(m instanceof er&&As(m.property.specification)))continue;const v=n2(d,e.type),b=m.value,T=m.property.specification.type,A=m.property.useIntegerZoom,I=m.property.specification["property-type"],z=I==="cross-faded"||I==="cross-faded-data-driven",F=String(d)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(b.kind!=="constant"||F)if(b.kind==="source"||F||z){const j=uy(d,T,"source");this.binders[d]=z?new Fs(b,v,T,A,n,j,e.id):new ss(b,v,T,j),u.push(`/a_${d}`)}else{const j=uy(d,T,"composite");this.binders[d]=new po(b,v,T,A,n,j),u.push(`/z_${d}`)}else this.binders[d]=z?new Hl(b.value,v):new Tu(b.value,v,T),u.push(`/u_${d}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof ss||n instanceof po?n.maxValue:0}populatePaintArrays(e,n,a,u,d,m){for(const v in this.binders){const b=this.binders[v];(b instanceof ss||b instanceof po||b instanceof Fs)&&b.populatePaintArray(e,n,a,u,d,m)}}setConstantPatternPositions(e,n){for(const a in this.binders){const u=this.binders[a];u instanceof Hl&&u.setConstantPatternPositions(e,n)}}updatePaintArrays(e,n,a,u,d,m){let v=!1;for(const b in e){const T=n.getPositions(b);for(const A of T){const I=a.feature(A.index);for(const z in this.binders){const F=this.binders[z];if((F instanceof ss||F instanceof po||F instanceof Fs)&&F.expression.isStateDependent===!0){const j=u.paint.get(z);F.expression=j.value,F.updatePaintArray(A.start,A.end,I,e[b],d,m),v=!0}}}}return v}defines(){const e=[];for(const n in this.binders){const a=this.binders[n];(a instanceof Tu||a instanceof Hl)&&e.push(...a.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof ss||a instanceof po||a instanceof Fs)for(let u=0;u<a.paintVertexAttributes.length;u++)e.push(a.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof Tu||a instanceof Hl||a instanceof po)for(const u of a.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,n){const a=[];for(const u in this.binders){const d=this.binders[u];if(d instanceof Tu||d instanceof Hl||d instanceof po){for(const m of d.uniformNames)if(n[m]){const v=d.getBinding(e,n[m],m);a.push({name:m,property:u,binding:v})}}}return a}setUniforms(e,n,a,u){for(const{name:d,property:m,binding:v}of n)this.binders[m].setUniform(v,u,a.get(m),d)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const a=this.binders[n];if(e&&a instanceof Fs){const u=e.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(a instanceof ss||a instanceof po)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const n in this.binders){const a=this.binders[n];(a instanceof ss||a instanceof po||a instanceof Fs)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof ss||n instanceof po||n instanceof Fs)&&n.destroy()}}}class Ba{constructor(e,n,a=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new as(u,n,a);this.needsUpload=!1,this._featureMap=new gd,this._bufferOffset=0}populatePaintArrays(e,n,a,u,d,m,v){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(e,n,u,d,m,v);n.id!==void 0&&this._featureMap.add(n.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,a,u,d){for(const m of a)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,n,m,u,d)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const i2={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function n2(t,e){return i2[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const r2={"line-pattern":{source:Os,composite:Os},"fill-pattern":{source:Os,composite:Os},"fill-extrusion-pattern":{source:Os,composite:Os},"line-dasharray":{source:hd,composite:hd}},o2={color:{source:md,composite:Df},number:{source:pd,composite:md}};function uy(t,e,n){const a=r2[t];return a&&a[n]||o2[e][n]}_t("ConstantBinder",Tu),_t("CrossFadedConstantBinder",Hl),_t("SourceExpressionBinder",ss),_t("CrossFadedCompositeBinder",Fs),_t("CompositeExpressionBinder",po),_t("ProgramConfiguration",as,{omit:["_buffers"]}),_t("ProgramConfigurationSet",Ba);const vd="-transition";class fo extends Io{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new Oa(n.layout)),n.paint)){this._transitionablePaint=new rr(n.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ns(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,a={}){n!=null&&this._validate(wf,`layers.${this.id}.layout.${e}`,e,n,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return Cn(e,vd)?this._transitionablePaint.getTransition(e.slice(0,-vd.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,a={}){if(n!=null&&this._validate(vu,`layers.${this.id}.paint.${e}`,e,n,a))return!1;if(Cn(e,vd))return this._transitionablePaint.setTransition(e.slice(0,-vd.length),n||void 0),!1;{const u=this._transitionablePaint._values[e],d=u.property.specification["property-type"]==="cross-faded-data-driven",m=u.value.isDataDriven(),v=u.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value;return b.isDataDriven()||m||d||this._handleOverridablePaintPropertyUpdate(e,v,b)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Hn(e,(n,a)=>!(n===void 0||a==="layout"&&!Object.keys(n).length||a==="paint"&&!Object.keys(n).length))}_validate(e,n,a,u,d={}){return(!d||d.validate!==!1)&&cd(this,e.call(Ps,{key:n,layerType:this.type,objectKey:a,value:u,styleSpec:ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof er&&As(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=jl(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const s2=Hi([{name:"a_pos",components:2,type:"Int16"}],4),{members:a2}=s2;class sn{constructor(e=[]){this.segments=e}prepareSegment(e,n,a,u){let d=this.segments[this.segments.length-1];return e>sn.MAX_VERTEX_ARRAY_LENGTH&&Yt(`Max vertices per segment is ${sn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!d||d.vertexLength+e>sn.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==u)&&(d={vertexOffset:n.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},u!==void 0&&(d.sortKey=u),this.segments.push(d)),d}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,a,u){return new sn([{vertexOffset:e,primitiveOffset:n,vertexLength:a,primitiveLength:u,vaos:{},sortKey:0}])}}sn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,_t("SegmentVector",sn);var ni=8192;class Fa{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Ii?new Ii(e.lng,e.lat):Ii.convert(e),this}setSouthWest(e){return this._sw=e instanceof Ii?new Ii(e.lng,e.lat):Ii.convert(e),this}extend(e){const n=this._sw,a=this._ne;let u,d;if(e instanceof Ii)u=e,d=e;else{if(!(e instanceof Fa))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Fa.convert(e)):this.extend(Ii.convert(e)):this;if(u=e._sw,d=e._ne,!u||!d)return this}return n||a?(n.lng=Math.min(u.lng,n.lng),n.lat=Math.min(u.lat,n.lat),a.lng=Math.max(d.lng,a.lng),a.lat=Math.max(d.lat,a.lat)):(this._sw=new Ii(u.lng,u.lat),this._ne=new Ii(d.lng,d.lat)),this}getCenter(){return new Ii((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ii(this.getWest(),this.getNorth())}getSouthEast(){return new Ii(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:a}=Ii.convert(e);let u=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&u}static convert(e){return!e||e instanceof Fa?e:new Fa(e)}}const hy=63710088e-1;class Ii{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ii(Ze(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,a=this.lat*n,u=e.lat*n,d=Math.sin(a)*Math.sin(u)+Math.cos(a)*Math.cos(u)*Math.cos((e.lng-this.lng)*n);return hy*Math.acos(Math.min(d,1))}toBounds(e=0){const n=360*e/40075017,a=n/Math.cos(Math.PI/180*this.lat);return new Fa(new Ii(this.lng-a,this.lat-n),new Ii(this.lng+a,this.lat+n))}static convert(e){if(e instanceof Ii)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Ii(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Ii(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const dy=2*Math.PI*hy;function py(t){return dy*Math.cos(t*Math.PI/180)}function Xl(t){return(180+t)/360}function Kl(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function mo(t,e){return t/py(e)}function ls(t){return 360*t-180}function Kr(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function fy(t,e){return t*py(Kr(e))}const Uo=85.051129;class xd{constructor(e,n,a=0){this.x=+e,this.y=+n,this.z=+a}static fromLngLat(e,n=0){const a=Ii.convert(e);return new xd(Xl(a.lng),Kl(a.lat),mo(n,a.lat))}toLngLat(){return new Ii(ls(this.x),Kr(this.y))}toAltitude(){return fy(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/dy*(e=Kr(this.y),1/Math.cos(e*Math.PI/180));var e}}function Bf(t,e,n,a,u,d,m,v,b){const T=(e+a)/2,A=(n+u)/2,I=new D(T,A);v(I),function(z,F,j,G,Z,Q){const se=j-Z,de=G-Q;return Math.abs((G-F)*se-(j-z)*de)/Math.hypot(se,de)}(I.x,I.y,d.x,d.y,m.x,m.y)>=b?(Bf(t,e,n,T,A,d,I,v,b),Bf(t,T,A,a,u,I,m,v,b)):t.push(m)}function l2(t,e,n){const a=[];let u,d,m;for(const v of t){const{x:b,y:T}=v;e(v),m?Bf(a,u,d,b,T,m,v,e,n):a.push(v),u=b,d=T,m=v}return a}const Ff=Math.pow(2,14)-1,my=-Ff-1;function c2(t,e){const n=Math.round(t.x*e),a=Math.round(t.y*e);return t.x=Ne(n,my,Ff),t.y=Ne(a,my,Ff),(n<t.x||n>t.x+1||a<t.y||a>t.y+1)&&Yt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function cs(t,e,n){const a=t.loadGeometry(),u=t.extent,d=ni/u;if(e&&n&&n.projection.isReprojectedInTileSpace){const m=1<<e.z,{scale:v,x:b,y:T,projection:A}=n,I=z=>{const F=ls((e.x+z.x/u)/m),j=Kr((e.y+z.y/u)/m),G=A.project(F,j);z.x=(G.x*v-b)*u,z.y=(G.y*v-T)*u};for(let z=0;z<a.length;z++)if(t.type!==1)a[z]=l2(a[z],I,1);else{const F=[];for(const j of a[z])j.x<0||j.x>=u||j.y<0||j.y>=u||(I(j),F.push(j));a[z]=F}}for(const m of a)for(const v of m)c2(v,d);return a}function Na(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?cs(t):[]}}function bd(t,e,n,a,u){t.emplaceBack(2*e+(a+1)/2,2*n+(u+1)/2)}class Nf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ql,this.indexArray=new zr,this.segments=new sn,this.programConfigurations=new Ba(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a,u){const d=this.layers[0],m=[];let v=null;d.type==="circle"&&(v=d.layout.get("circle-sort-key"));for(const{feature:b,id:T,index:A,sourceLayerIndex:I}of e){const z=this.layers[0]._featureFilter.needGeometry,F=Na(b,z);if(!this.layers[0]._featureFilter.filter(new jt(this.zoom),F,a))continue;const j=v?v.evaluate(F,{},a):void 0,G={id:T,properties:b.properties,type:b.type,sourceLayerIndex:I,index:A,geometry:z?F.geometry:cs(b,a,u),patterns:{},sortKey:j};m.push(G)}v&&m.sort((b,T)=>b.sortKey-T.sortKey);for(const b of m){const{geometry:T,index:A,sourceLayerIndex:I}=b,z=e[A].feature;this.addFeature(b,T,A,n.availableImages,a),n.featureIndex.insert(z,T,A,I,this.index)}}update(e,n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,a2),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,a,u,d){for(const m of n)for(const v of m){const b=v.x,T=v.y;if(b<0||b>=ni||T<0||T>=ni)continue;const A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),I=A.vertexLength;bd(this.layoutVertexArray,b,T,-1,-1),bd(this.layoutVertexArray,b,T,1,-1),bd(this.layoutVertexArray,b,T,1,1),bd(this.layoutVertexArray,b,T,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+3,I+2),A.vertexLength+=4,A.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},u,d)}}function gy(t,e){for(let n=0;n<t.length;n++)if(Yl(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Yl(t,e[n]))return!0;return!!Uf(t,e)}function u2(t,e,n){return!!Yl(t,e)||!!jf(e,t,n)}function _y(t,e){if(t.length===1)return vy(e,t[0]);for(let n=0;n<e.length;n++){const a=e[n];for(let u=0;u<a.length;u++)if(Yl(t,a[u]))return!0}for(let n=0;n<t.length;n++)if(vy(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Uf(t,e[n]))return!0;return!1}function h2(t,e,n){if(t.length>1){if(Uf(t,e))return!0;for(let a=0;a<e.length;a++)if(jf(e[a],t,n))return!0}for(let a=0;a<t.length;a++)if(jf(t[a],e,n))return!0;return!1}function Uf(t,e){if(t.length===0||e.length===0)return!1;for(let n=0;n<t.length-1;n++){const a=t[n],u=t[n+1];for(let d=0;d<e.length-1;d++)if(d2(a,u,e[d],e[d+1]))return!0}return!1}function d2(t,e,n,a){return Mn(t,n,a)!==Mn(e,n,a)&&Mn(t,e,n)!==Mn(t,e,a)}function jf(t,e,n){const a=n*n;if(e.length===1)return t.distSqr(e[0])<a;for(let u=1;u<e.length;u++)if(yy(t,e[u-1],e[u])<a)return!0;return!1}function yy(t,e,n){const a=e.distSqr(n);if(a===0)return t.distSqr(e);const u=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/a;return t.distSqr(u<0?e:u>1?n:n.sub(e)._mult(u)._add(e))}function vy(t,e){let n,a,u,d=!1;for(let m=0;m<t.length;m++){n=t[m];for(let v=0,b=n.length-1;v<n.length;b=v++)a=n[v],u=n[b],a.y>e.y!=u.y>e.y&&e.x<(u.x-a.x)*(e.y-a.y)/(u.y-a.y)+a.x&&(d=!d)}return d}function Yl(t,e){let n=!1;for(let a=0,u=t.length-1;a<t.length;u=a++){const d=t[a],m=t[u];d.y>e.y!=m.y>e.y&&e.x<(m.x-d.x)*(e.y-d.y)/(m.y-d.y)+d.x&&(n=!n)}return n}function xy(t,e,n,a,u){for(const m of t)if(e<=m.x&&n<=m.y&&a>=m.x&&u>=m.y)return!0;const d=[new D(e,n),new D(e,u),new D(a,u),new D(a,n)];if(t.length>2){for(const m of d)if(Yl(t,m))return!0}for(let m=0;m<t.length-1;m++)if(p2(t[m],t[m+1],d))return!0;return!1}function p2(t,e,n){const a=n[0],u=n[2];if(t.x<a.x&&e.x<a.x||t.x>u.x&&e.x>u.x||t.y<a.y&&e.y<a.y||t.y>u.y&&e.y>u.y)return!1;const d=Mn(t,e,n[0]);return d!==Mn(t,e,n[1])||d!==Mn(t,e,n[2])||d!==Mn(t,e,n[3])}function Jl(t,e,n){const a=e.paint.get(t).value;return a.kind==="constant"?a.value:n.programConfigurations.get(e.id).getMaxValue(t)}function wd(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function by(t,e,n,a,u){if(!e[0]&&!e[1])return t;const d=D.convert(e)._mult(u);n==="viewport"&&d._rotate(-a);const m=[];for(let v=0;v<t.length;v++)m.push(t[v].sub(d));return m}function wy(t,e,n,a){const u=D.convert(t)._mult(a);return e==="viewport"&&u._rotate(-n),u}_t("CircleBucket",Nf,{omit:["layers"]});const f2=new zn({"circle-sort-key":new Pt(ke.layout_circle["circle-sort-key"])});var m2={paint:new zn({"circle-radius":new Pt(ke.paint_circle["circle-radius"]),"circle-color":new Pt(ke.paint_circle["circle-color"]),"circle-blur":new Pt(ke.paint_circle["circle-blur"]),"circle-opacity":new Pt(ke.paint_circle["circle-opacity"]),"circle-translate":new xt(ke.paint_circle["circle-translate"]),"circle-translate-anchor":new xt(ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new xt(ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new xt(ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Pt(ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Pt(ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Pt(ke.paint_circle["circle-stroke-opacity"])}),layout:f2};class Vf{constructor(e,n){this.points=e,this.planes=n}static fromInvProjectionMatrix(e,n,a,u){const d=Math.pow(2,a),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const T=rt([],b,e),A=1/T[3]/n*d;return function(I,z,F){return I[0]=z[0]*F[0],I[1]=z[1]*F[1],I[2]=z[2]*F[2],I[3]=z[3]*F[3],I}(T,T,[A,A,u?1/T[3]:A,A])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const T=ei([],Qi([],Dn([],m[b[0]],m[b[1]]),Dn([],m[b[2]],m[b[1]]))),A=-Si(T,m[b[1]]);return T.concat(A)});return new Vf(m,v)}}class go{constructor(e,n){this.min=e,this.max=n,this.center=ri([],ot([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],a=Ft(this.min),u=Ft(this.max);for(let d=0;d<n.length;d++)a[d]=n[d]?this.min[d]:this.center[d],u[d]=n[d]?this.center[d]:this.max[d];return u[2]=this.max[2],new go(a,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){const n=this.getCorners();let a=!0;for(let u=0;u<e.planes.length;u++){const d=e.planes[u];let m=0;for(let v=0;v<n.length;v++)m+=Si(d,n[v])+d[3]>=0;if(m===0)return 0;m!==n.length&&(a=!1)}if(a)return 2;for(let u=0;u<3;u++){let d=Number.MAX_VALUE,m=-Number.MAX_VALUE;for(let v=0;v<e.points.length;v++){const b=e.points[v][u]-this.min[u];d=Math.min(d,b),m=Math.max(m,b)}if(m<0||d>this.max[u]-this.min[u])return 0}return 1}}function Ty(t,e,n,a,u,d,m,v,b){if(d&&t.queryGeometry.isAboveHorizon)return!1;d&&(b*=t.pixelToTileUnitsFactor);for(const T of e)for(const A of T){const I=A.add(v),z=u&&n.elevation?n.elevation.exaggeration()*u.getElevationAt(I.x,I.y,!0):0,F=d?I:g2(I,z,a),j=d?t.tilespaceRays.map(Z=>y2(Z,z)):t.queryGeometry.screenGeometry,G=rt([],[A.x,A.y,z,1],a);if(!m&&d?b*=G[3]/n.cameraToCenterDistance:m&&!d&&(b*=n.cameraToCenterDistance/G[3]),u2(j,F,b))return!0}return!1}function g2(t,e,n){const a=rt([],[t.x,t.y,e,1],n);return new D(a[0]/a[3],a[1]/a[3])}const Ey=Tt(0,0,0),_2=Tt(0,0,1);function y2(t,e){const n=It();return Ey[2]=e,t.intersectsPlane(Ey,_2,n),new D(n[0],n[1])}class Sy extends Nf{}function $f(t,{width:e,height:n},a,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*n*a)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*n*a);return t.width=e,t.height=n,t.data=u,t}function Cy(t,{width:e,height:n},a){if(e===t.width&&n===t.height)return;const u=$f({},{width:e,height:n},a);Gf(t,u,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,n)},a),t.width=e,t.height=n,t.data=u.data}function Gf(t,e,n,a,u,d){if(u.width===0||u.height===0)return e;if(u.width>t.width||u.height>t.height||n.x>t.width-u.width||n.y>t.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||a.x>e.width-u.width||a.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const m=t.data,v=e.data;for(let b=0;b<u.height;b++){const T=((n.y+b)*t.width+n.x)*d,A=((a.y+b)*e.width+a.x)*d;for(let I=0;I<u.width*d;I++)v[A+I]=m[T+I]}return e}_t("HeatmapBucket",Sy,{omit:["layers"]});class Ns{constructor(e,n){$f(this,e,1,n)}resize(e){Cy(this,e,1)}clone(){return new Ns({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,a,u,d){Gf(e,n,a,u,d,1)}}class Pr{constructor(e,n){$f(this,e,4,n)}resize(e){Cy(this,e,4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Pr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,a,u,d){Gf(e,n,a,u,d,4)}}_t("AlphaImage",Ns),_t("RGBAImage",Pr);var v2={paint:new zn({"heatmap-radius":new Pt(ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Pt(ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new xt(ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new No(ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new xt(ke.paint_heatmap["heatmap-opacity"])})};function qf(t){const e={},n=t.resolution||256,a=t.clips?t.clips.length:1,u=t.image||new Pr({width:n,height:a}),d=(m,v,b)=>{e[t.evaluationKey]=b;const T=t.expression.evaluate(e);u.data[m+v+0]=Math.floor(255*T.r/T.a),u.data[m+v+1]=Math.floor(255*T.g/T.a),u.data[m+v+2]=Math.floor(255*T.b/T.a),u.data[m+v+3]=Math.floor(255*T.a)};if(t.clips)for(let m=0,v=0;m<a;++m,v+=4*n)for(let b=0,T=0;b<n;b++,T+=4){const A=b/(n-1),{start:I,end:z}=t.clips[m];d(v,T,I*(1-A)+z*A)}else for(let m=0,v=0;m<n;m++,v+=4)d(0,v,m/(n-1));return u}var x2={paint:new zn({"hillshade-illumination-direction":new xt(ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new xt(ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new xt(ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new xt(ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new xt(ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new xt(ke.paint_hillshade["hillshade-accent-color"])})};const b2=Hi([{name:"a_pos",components:2,type:"Int16"}],4),{members:w2}=b2;var Td=Ed,T2=Ed;function Ed(t,e,n){n=n||2;var a,u,d,m,v,b,T,A=e&&e.length,I=A?e[0]*n:t.length,z=Ay(t,0,I,n,!0),F=[];if(!z||z.next===z.prev)return F;if(A&&(z=function(G,Z,Q,se){var de,me,_e,xe=[];for(de=0,me=Z.length;de<me;de++)(_e=Ay(G,Z[de]*se,de<me-1?Z[de+1]*se:G.length,se,!1))===_e.next&&(_e.steiner=!0),xe.push(z2(_e));for(xe.sort(M2),de=0;de<xe.length;de++)Q=Us(Q=I2(xe[de],Q),Q.next);return Q}(t,e,z,n)),t.length>80*n){a=d=t[0],u=m=t[1];for(var j=n;j<I;j+=n)(v=t[j])<a&&(a=v),(b=t[j+1])<u&&(u=b),v>d&&(d=v),b>m&&(m=b);T=(T=Math.max(d-a,m-u))!==0?1/T:0}return Eu(z,F,n,a,u,T),F}function Ay(t,e,n,a,u){var d,m;if(u===Hf(t,e,n,a)>0)for(d=e;d<n;d+=a)m=ky(d,t[d],t[d+1],m);else for(d=n-a;d>=e;d-=a)m=ky(d,t[d],t[d+1],m);return m&&Sd(m,m.next)&&(Cu(m),m=m.next),m}function Us(t,e){if(!t)return t;e||(e=t);var n,a=t;do if(n=!1,a.steiner||!Sd(a,a.next)&&an(a.prev,a,a.next)!==0)a=a.next;else{if(Cu(a),(a=e=a.prev)===a.next)break;n=!0}while(n||a!==e);return e}function Eu(t,e,n,a,u,d,m){if(t){!m&&d&&function(A,I,z,F){var j=A;do j.z===null&&(j.z=Zf(j.x,j.y,I,z,F)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==A);j.prevZ.nextZ=null,j.prevZ=null,function(G){var Z,Q,se,de,me,_e,xe,Oe,Pe=1;do{for(Q=G,G=null,me=null,_e=0;Q;){for(_e++,se=Q,xe=0,Z=0;Z<Pe&&(xe++,se=se.nextZ);Z++);for(Oe=Pe;xe>0||Oe>0&&se;)xe!==0&&(Oe===0||!se||Q.z<=se.z)?(de=Q,Q=Q.nextZ,xe--):(de=se,se=se.nextZ,Oe--),me?me.nextZ=de:G=de,de.prevZ=me,me=de;Q=se}me.nextZ=null,Pe*=2}while(_e>1)}(j)}(t,a,u,d);for(var v,b,T=t;t.prev!==t.next;)if(v=t.prev,b=t.next,d?S2(t,a,u,d):E2(t))e.push(v.i/n),e.push(t.i/n),e.push(b.i/n),Cu(t),t=b.next,T=b.next;else if((t=b)===T){m?m===1?Eu(t=C2(Us(t),e,n),e,n,a,u,d,2):m===2&&A2(t,e,n,a,u,d):Eu(Us(t),e,n,a,u,d,1);break}}}function E2(t){var e=t.prev,n=t,a=t.next;if(an(e,n,a)>=0)return!1;for(var u=t.next.next;u!==t.prev;){if(Ql(e.x,e.y,n.x,n.y,a.x,a.y,u.x,u.y)&&an(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function S2(t,e,n,a){var u=t.prev,d=t,m=t.next;if(an(u,d,m)>=0)return!1;for(var v=u.x>d.x?u.x>m.x?u.x:m.x:d.x>m.x?d.x:m.x,b=u.y>d.y?u.y>m.y?u.y:m.y:d.y>m.y?d.y:m.y,T=Zf(u.x<d.x?u.x<m.x?u.x:m.x:d.x<m.x?d.x:m.x,u.y<d.y?u.y<m.y?u.y:m.y:d.y<m.y?d.y:m.y,e,n,a),A=Zf(v,b,e,n,a),I=t.prevZ,z=t.nextZ;I&&I.z>=T&&z&&z.z<=A;){if(I!==t.prev&&I!==t.next&&Ql(u.x,u.y,d.x,d.y,m.x,m.y,I.x,I.y)&&an(I.prev,I,I.next)>=0||(I=I.prevZ,z!==t.prev&&z!==t.next&&Ql(u.x,u.y,d.x,d.y,m.x,m.y,z.x,z.y)&&an(z.prev,z,z.next)>=0))return!1;z=z.nextZ}for(;I&&I.z>=T;){if(I!==t.prev&&I!==t.next&&Ql(u.x,u.y,d.x,d.y,m.x,m.y,I.x,I.y)&&an(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;z&&z.z<=A;){if(z!==t.prev&&z!==t.next&&Ql(u.x,u.y,d.x,d.y,m.x,m.y,z.x,z.y)&&an(z.prev,z,z.next)>=0)return!1;z=z.nextZ}return!0}function C2(t,e,n){var a=t;do{var u=a.prev,d=a.next.next;!Sd(u,d)&&My(u,a,a.next,d)&&Su(u,d)&&Su(d,u)&&(e.push(u.i/n),e.push(a.i/n),e.push(d.i/n),Cu(a),Cu(a.next),a=t=d),a=a.next}while(a!==t);return Us(a)}function A2(t,e,n,a,u,d){var m=t;do{for(var v=m.next.next;v!==m.prev;){if(m.i!==v.i&&P2(m,v)){var b=Iy(m,v);return m=Us(m,m.next),b=Us(b,b.next),Eu(m,e,n,a,u,d),void Eu(b,e,n,a,u,d)}v=v.next}m=m.next}while(m!==t)}function M2(t,e){return t.x-e.x}function I2(t,e){var n=function(d,m){var v,b=m,T=d.x,A=d.y,I=-1/0;do{if(A<=b.y&&A>=b.next.y&&b.next.y!==b.y){var z=b.x+(A-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(z<=T&&z>I){if(I=z,z===T){if(A===b.y)return b;if(A===b.next.y)return b.next}v=b.x<b.next.x?b:b.next}}b=b.next}while(b!==m);if(!v)return null;if(T===I)return v;var F,j=v,G=v.x,Z=v.y,Q=1/0;b=v;do T>=b.x&&b.x>=G&&T!==b.x&&Ql(A<Z?T:I,A,G,Z,A<Z?I:T,A,b.x,b.y)&&(F=Math.abs(A-b.y)/(T-b.x),Su(b,d)&&(F<Q||F===Q&&(b.x>v.x||b.x===v.x&&k2(v,b)))&&(v=b,Q=F)),b=b.next;while(b!==j);return v}(t,e);if(!n)return e;var a=Iy(n,t),u=Us(n,n.next);return Us(a,a.next),e===n?u:e}function k2(t,e){return an(t.prev,t,e.prev)<0&&an(e.next,t,t.next)<0}function Zf(t,e,n,a,u){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*u)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-a)*u)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function z2(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Ql(t,e,n,a,u,d,m,v){return(u-m)*(e-v)-(t-m)*(d-v)>=0&&(t-m)*(a-v)-(n-m)*(e-v)>=0&&(n-m)*(d-v)-(u-m)*(a-v)>=0}function P2(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(n,a){var u=n;do{if(u.i!==n.i&&u.next.i!==n.i&&u.i!==a.i&&u.next.i!==a.i&&My(u,u.next,n,a))return!0;u=u.next}while(u!==n);return!1}(t,e)&&(Su(t,e)&&Su(e,t)&&function(n,a){var u=n,d=!1,m=(n.x+a.x)/2,v=(n.y+a.y)/2;do u.y>v!=u.next.y>v&&u.next.y!==u.y&&m<(u.next.x-u.x)*(v-u.y)/(u.next.y-u.y)+u.x&&(d=!d),u=u.next;while(u!==n);return d}(t,e)&&(an(t.prev,t,e.prev)||an(t,e.prev,e))||Sd(t,e)&&an(t.prev,t,t.next)>0&&an(e.prev,e,e.next)>0)}function an(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Sd(t,e){return t.x===e.x&&t.y===e.y}function My(t,e,n,a){var u=Ad(an(t,e,n)),d=Ad(an(t,e,a)),m=Ad(an(n,a,t)),v=Ad(an(n,a,e));return u!==d&&m!==v||!(u!==0||!Cd(t,n,e))||!(d!==0||!Cd(t,a,e))||!(m!==0||!Cd(n,t,a))||!(v!==0||!Cd(n,e,a))}function Cd(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ad(t){return t>0?1:t<0?-1:0}function Su(t,e){return an(t.prev,t,t.next)<0?an(t,e,t.next)>=0&&an(t,t.prev,e)>=0:an(t,e,t.prev)<0||an(t,t.next,e)<0}function Iy(t,e){var n=new Wf(t.i,t.x,t.y),a=new Wf(e.i,e.x,e.y),u=t.next,d=e.prev;return t.next=e,e.prev=t,n.next=u,u.prev=n,a.next=n,n.prev=a,d.next=a,a.prev=d,a}function ky(t,e,n,a){var u=new Wf(t,e,n);return a?(u.next=a.next,u.prev=a,a.next.prev=u,a.next=u):(u.prev=u,u.next=u),u}function Cu(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Wf(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Hf(t,e,n,a){for(var u=0,d=e,m=n-a;d<n;d+=a)u+=(t[m]-t[d])*(t[d+1]+t[m+1]),m=d;return u}function D2(t,e,n,a,u){zy(t,e,n||0,a||t.length-1,u||L2)}function zy(t,e,n,a,u){for(;a>n;){if(a-n>600){var d=a-n+1,m=e-n+1,v=Math.log(d),b=.5*Math.exp(2*v/3),T=.5*Math.sqrt(v*b*(d-b)/d)*(m-d/2<0?-1:1);zy(t,e,Math.max(n,Math.floor(e-m*b/d+T)),Math.min(a,Math.floor(e+(d-m)*b/d+T)),u)}var A=t[e],I=n,z=a;for(Au(t,n,e),u(t[a],A)>0&&Au(t,n,a);I<z;){for(Au(t,I,z),I++,z--;u(t[I],A)<0;)I++;for(;u(t[z],A)>0;)z--}u(t[n],A)===0?Au(t,n,z):Au(t,++z,a),z<=e&&(n=z+1),e<=z&&(a=z-1)}}function Au(t,e,n){var a=t[e];t[e]=t[n],t[n]=a}function L2(t,e){return t<e?-1:t>e?1:0}function Xf(t,e){const n=t.length;if(n<=1)return[t];const a=[];let u,d;for(let m=0;m<n;m++){const v=ro(t[m]);v!==0&&(t[m].area=Math.abs(v),d===void 0&&(d=v<0),d===v<0?(u&&a.push(u),u=[t[m]]):u.push(t[m]))}if(u&&a.push(u),e>1)for(let m=0;m<a.length;m++)a[m].length<=e||(D2(a[m],e,1,a[m].length-1,R2),a[m]=a[m].slice(0,e));return a}function R2(t,e){return e.area-t.area}function Kf(t,e,n){const a=n.patternDependencies;let u=!1;for(const d of e){const m=d.paint.get(`${t}-pattern`);m.isConstant()||(u=!0);const v=m.constantOr(null);v&&(u=!0,a[v.to]=!0,a[v.from]=!0)}return u}function Yf(t,e,n,a,u){const d=u.patternDependencies;for(const m of e){const v=m.paint.get(`${t}-pattern`).value;if(v.kind!=="constant"){let b=v.evaluate({zoom:a-1},n,{},u.availableImages),T=v.evaluate({zoom:a},n,{},u.availableImages),A=v.evaluate({zoom:a+1},n,{},u.availableImages);b=b&&b.name?b.name:b,T=T&&T.name?T.name:T,A=A&&A.name?A.name:A,d[b]=!0,d[T]=!0,d[A]=!0,n.patterns[m.id]={min:b,mid:T,max:A}}}return n}Ed.deviation=function(t,e,n,a){var u=e&&e.length,d=Math.abs(Hf(t,0,u?e[0]*n:t.length,n));if(u)for(var m=0,v=e.length;m<v;m++)d-=Math.abs(Hf(t,e[m]*n,m<v-1?e[m+1]*n:t.length,n));var b=0;for(m=0;m<a.length;m+=3){var T=a[m]*n,A=a[m+1]*n,I=a[m+2]*n;b+=Math.abs((t[T]-t[I])*(t[A+1]-t[T+1])-(t[T]-t[A])*(t[I+1]-t[T+1]))}return d===0&&b===0?0:Math.abs((b-d)/d)},Ed.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},a=0,u=0;u<t.length;u++){for(var d=0;d<t[u].length;d++)for(var m=0;m<e;m++)n.vertices.push(t[u][d][m]);u>0&&n.holes.push(a+=t[u-1].length)}return n},Td.default=T2;class Md{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ql,this.indexArray=new zr,this.indexArray2=new Bs,this.programConfigurations=new Ba(e.layers,e.zoom),this.segments=new sn,this.segments2=new sn,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a,u){this.hasPattern=Kf("fill",this.layers,n);const d=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:v,id:b,index:T,sourceLayerIndex:A}of e){const I=this.layers[0]._featureFilter.needGeometry,z=Na(v,I);if(!this.layers[0]._featureFilter.filter(new jt(this.zoom),z,a))continue;const F=d?d.evaluate(z,{},a,n.availableImages):void 0,j={id:b,properties:v.properties,type:v.type,sourceLayerIndex:A,index:T,geometry:I?z.geometry:cs(v,a,u),patterns:{},sortKey:F};m.push(j)}d&&m.sort((v,b)=>v.sortKey-b.sortKey);for(const v of m){const{geometry:b,index:T,sourceLayerIndex:A}=v;if(this.hasPattern){const I=Yf("fill",this.layers,v,this.zoom,n);this.patternFeatures.push(I)}else this.addFeature(v,b,T,a,{},n.availableImages);n.featureIndex.insert(e[T].feature,b,T,A,this.index)}}update(e,n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,u)}addFeatures(e,n,a,u){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,w2),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,a,u,d,m=[]){for(const v of Xf(n,500)){let b=0;for(const j of v)b+=j.length;const T=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),A=T.vertexLength,I=[],z=[];for(const j of v){if(j.length===0)continue;j!==v[0]&&z.push(I.length/2);const G=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),Z=G.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(Z+j.length-1,Z),I.push(j[0].x),I.push(j[0].y);for(let Q=1;Q<j.length;Q++)this.layoutVertexArray.emplaceBack(j[Q].x,j[Q].y),this.indexArray2.emplaceBack(Z+Q-1,Z+Q),I.push(j[Q].x),I.push(j[Q].y);G.vertexLength+=j.length,G.primitiveLength+=j.length}const F=Td(I,z);for(let j=0;j<F.length;j+=3)this.indexArray.emplaceBack(A+F[j],A+F[j+1],A+F[j+2]);T.vertexLength+=b,T.primitiveLength+=F.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,d,m,u)}}_t("FillBucket",Md,{omit:["layers","patternFeatures"]});const O2=new zn({"fill-sort-key":new Pt(ke.layout_fill["fill-sort-key"])});var B2={paint:new zn({"fill-antialias":new xt(ke.paint_fill["fill-antialias"]),"fill-opacity":new Pt(ke.paint_fill["fill-opacity"]),"fill-color":new Pt(ke.paint_fill["fill-color"]),"fill-outline-color":new Pt(ke.paint_fill["fill-outline-color"]),"fill-translate":new xt(ke.paint_fill["fill-translate"]),"fill-translate-anchor":new xt(ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new _n(ke.paint_fill["fill-pattern"])}),layout:O2};const F2=Hi([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),N2=Hi([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:U2}=F2;var Py=ec;function ec(t,e,n,a,u){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=a,this._values=u,t.readFields(j2,this,e)}function j2(t,e,n){t==1?e.id=n.readVarint():t==2?function(a,u){for(var d=a.readVarint()+a.pos;a.pos<d;){var m=u._keys[a.readVarint()],v=u._values[a.readVarint()];u.properties[m]=v}}(n,e):t==3?e.type=n.readVarint():t==4&&(e._geometry=n.pos)}function V2(t){for(var e,n,a=0,u=0,d=t.length,m=d-1;u<d;m=u++)a+=((n=t[m]).x-(e=t[u]).x)*(e.y+n.y);return a}ec.types=["Unknown","Point","LineString","Polygon"],ec.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,a=1,u=0,d=0,m=0,v=[];t.pos<n;){if(u<=0){var b=t.readVarint();a=7&b,u=b>>3}if(u--,a===1||a===2)d+=t.readSVarint(),m+=t.readSVarint(),a===1&&(e&&v.push(e),e=[]),e.push(new D(d,m));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&v.push(e),v},ec.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,a=0,u=0,d=0,m=1/0,v=-1/0,b=1/0,T=-1/0;t.pos<e;){if(a<=0){var A=t.readVarint();n=7&A,a=A>>3}if(a--,n===1||n===2)(u+=t.readSVarint())<m&&(m=u),u>v&&(v=u),(d+=t.readSVarint())<b&&(b=d),d>T&&(T=d);else if(n!==7)throw new Error("unknown command "+n)}return[m,b,v,T]},ec.prototype.toGeoJSON=function(t,e,n){var a,u,d=this.extent*Math.pow(2,n),m=this.extent*t,v=this.extent*e,b=this.loadGeometry(),T=ec.types[this.type];function A(F){for(var j=0;j<F.length;j++){var G=F[j];F[j]=[360*(G.x+m)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+v)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var I=[];for(a=0;a<b.length;a++)I[a]=b[a][0];A(b=I);break;case 2:for(a=0;a<b.length;a++)A(b[a]);break;case 3:for(b=function(F){var j=F.length;if(j<=1)return[F];for(var G,Z,Q=[],se=0;se<j;se++){var de=V2(F[se]);de!==0&&(Z===void 0&&(Z=de<0),Z===de<0?(G&&Q.push(G),G=[F[se]]):G.push(F[se]))}return G&&Q.push(G),Q}(b),a=0;a<b.length;a++)for(u=0;u<b[a].length;u++)A(b[a][u])}b.length===1?b=b[0]:T="Multi"+T;var z={type:"Feature",geometry:{type:T,coordinates:b},properties:this.properties};return"id"in this&&(z.id=this.id),z};var Dy=Ly;function Ly(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields($2,this,e),this.length=this._features.length}function $2(t,e,n){t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(function(a){for(var u=null,d=a.readVarint()+a.pos;a.pos<d;){var m=a.readVarint()>>3;u=m===1?a.readString():m===2?a.readFloat():m===3?a.readDouble():m===4?a.readVarint64():m===5?a.readVarint():m===6?a.readSVarint():m===7?a.readBoolean():null}return u}(n))}function G2(t,e,n){if(t===3){var a=new Dy(n,n.readVarint()+n.pos);a.length&&(e[a.name]=a)}}Ly.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Py(this._pbf,e,this.extent,this._keys,this._values)};var Ua={VectorTile:function(t,e){this.layers=t.readFields(G2,{},e)},VectorTileFeature:Py,VectorTileLayer:Dy};const q2=Ua.VectorTileFeature.types,Z2=Math.pow(2,13);function Mu(t,e,n,a,u,d,m,v){t.emplaceBack((e<<1)+m,(n<<1)+d,(Math.floor(a*Z2)<<1)+u,Math.round(v))}class Ry{constructor(){this.acc=new D(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new D(e.x,e.y),this.max=new D(e.x,e.y))}append(e,n){this.currentPolyCount.edges++,this.acc._add(e);let a=!!this.borders;const u=this.min,d=this.max;e.x<u.x?(u.x=e.x,a=!0):e.x>d.x&&(d.x=e.x,a=!0),e.y<u.y?(u.y=e.y,a=!0):e.y>d.y&&(d.y=e.y,a=!0),((e.x===0||e.x===ni)&&e.x===n.x)!=((e.y===0||e.y===ni)&&e.y===n.y)&&this.processBorderOverlap(e,n),a&&this.checkBorderIntersection(e,n)}checkBorderIntersection(e,n){n.x<0!=e.x<0&&this.addBorderIntersection(0,Ei(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>ni!=e.x>ni&&this.addBorderIntersection(1,Ei(n.y,e.y,(ni-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,Ei(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>ni!=e.y>ni&&this.addBorderIntersection(3,Ei(n.x,e.x,(ni-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const a=this.borders[e];n<a[0]&&(a[0]=n),n>a[1]&&(a[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const a=e.x===0?0:1;this.addBorderIntersection(a,n.y),this.addBorderIntersection(a,e.y)}else{const a=e.y===0?2:3;this.addBorderIntersection(a,n.x),this.addBorderIntersection(a,e.x)}}centroid(){const e=this.polyCount.reduce((n,a)=>n+a.edges,0);return e!==0?this.acc.div(e)._round():new D(0,0)}span(){return new D(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0)}}class Jf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Zl,this.centroidVertexArray=new oy,this.indexArray=new zr,this.programConfigurations=new Ba(e.layers,e.zoom),this.segments=new sn,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=e.enableTerrain}populate(e,n,a,u){this.features=[],this.hasPattern=Kf("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(d){const m=Math.exp(Math.PI*(1-d.y/(1<<d.z)*2));return 80150034*m/(m*m+1)/ni/(1<<d.z)}(a);for(const{feature:d,id:m,index:v,sourceLayerIndex:b}of e){const T=this.layers[0]._featureFilter.needGeometry,A=Na(d,T);if(!this.layers[0]._featureFilter.filter(new jt(this.zoom),A,a))continue;const I={id:m,sourceLayerIndex:b,index:v,geometry:T?A.geometry:cs(d,a,u),properties:d.properties,type:d.type,patterns:{}},z=this.layoutVertexArray.length;this.hasPattern?this.features.push(Yf("fill-extrusion",this.layers,I,this.zoom,n)):this.addFeature(I,I.geometry,v,a,{},n.availableImages),n.featureIndex.insert(d,I.geometry,v,b,this.index,z)}this.sortBorders()}addFeatures(e,n,a,u){for(const d of this.features){const{geometry:m}=d;this.addFeature(d,m,d.index,n,a,u)}this.sortBorders()}update(e,n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,U2),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,N2.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,a,u,d,m){const v=this.enableTerrain?new Ry:null;for(const T of Xf(n,500)){let A=0,I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(T.length===0||(b=T[0]).every(Z=>Z.x<=0)||b.every(Z=>Z.x>=ni)||b.every(Z=>Z.y<=0)||b.every(Z=>Z.y>=ni))continue;for(let Z=0;Z<T.length;Z++){const Q=T[Z];if(Q.length===0)continue;A+=Q.length;let se=0;v&&v.startRing(Q[0]);for(let de=0;de<Q.length;de++){const me=Q[de];if(de>=1){const _e=Q[de-1];if(!W2(me,_e)){v&&v.append(me,_e),I.vertexLength+4>sn.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const xe=me.sub(_e)._perp(),Oe=xe.x/(Math.abs(xe.x)+Math.abs(xe.y)),Pe=xe.y>0?1:0,nt=_e.dist(me);se+nt>32768&&(se=0),Mu(this.layoutVertexArray,me.x,me.y,Oe,Pe,0,0,se),Mu(this.layoutVertexArray,me.x,me.y,Oe,Pe,0,1,se),se+=nt,Mu(this.layoutVertexArray,_e.x,_e.y,Oe,Pe,0,0,se),Mu(this.layoutVertexArray,_e.x,_e.y,Oe,Pe,0,1,se);const Ye=I.vertexLength;this.indexArray.emplaceBack(Ye,Ye+2,Ye+1),this.indexArray.emplaceBack(Ye+1,Ye+2,Ye+3),I.vertexLength+=4,I.primitiveLength+=2}}}}if(I.vertexLength+A>sn.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray)),q2[e.type]!=="Polygon")continue;const z=[],F=[],j=I.vertexLength;for(let Z=0;Z<T.length;Z++){const Q=T[Z];if(Q.length!==0){Q!==T[0]&&F.push(z.length/2);for(let se=0;se<Q.length;se++){const de=Q[se];Mu(this.layoutVertexArray,de.x,de.y,0,0,1,1,0),z.push(de.x),z.push(de.y),v&&v.currentPolyCount.top++}}}const G=Td(z,F);for(let Z=0;Z<G.length;Z+=3)this.indexArray.emplaceBack(j+G[Z],j+G[Z+2],j+G[Z+1]);I.primitiveLength+=G.length/3,I.vertexLength+=A}var b;if(v&&v.polyCount.length>0){if(v.borders){v.vertexArrayOffset=this.centroidVertexArray.length;const T=v.borders,A=this.featuresOnBorder.push(v)-1;for(let I=0;I<4;I++)T[I][0]!==Number.MAX_VALUE&&this.borders[I].push(A)}this.encodeCentroid(v.borders?void 0:v.centroid(),v)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,d,m,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((n,a)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[a].borders[e][0])}encodeCentroid(e,n,a=!0){let u,d;if(e)if(e.y!==0){const v=n.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(v.x/10)),d=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(v.y/10))}else u=Math.ceil(7*(e.x+450)),d=0;else u=0,d=+a;let m=a?this.centroidVertexArray.length:n.vertexArrayOffset;for(const v of n.polyCount){a&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*v.edges+v.top);for(let b=0;b<2*v.edges;b++)this.centroidVertexArray.emplace(m++,0,d),this.centroidVertexArray.emplace(m++,u,d);for(let b=0;b<v.top;b++)this.centroidVertexArray.emplace(m++,u,d)}}}function W2(t,e){return t.x===e.x&&(t.x<0||t.x>ni)||t.y===e.y&&(t.y<0||t.y>ni)}_t("FillExtrusionBucket",Jf,{omit:["layers","features"]}),_t("PartMetadata",Ry);var H2={paint:new zn({"fill-extrusion-opacity":new xt(ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Pt(ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new xt(ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new xt(ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _n(ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Pt(ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Pt(ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new xt(ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Iu(t,e){return t.x*e.x+t.y*e.y}function Oy(t,e){if(t.length===1){let n=0;const a=e[n++];let u;for(;!u||a.equals(u);)if(u=e[n++],!u)return 1/0;for(;n<e.length;n++){const d=e[n],m=t[0],v=u.sub(a),b=d.sub(a),T=m.sub(a),A=Iu(v,v),I=Iu(v,b),z=Iu(b,b),F=Iu(T,v),j=Iu(T,b),G=A*z-I*I,Z=(z*F-I*j)/G,Q=(A*j-I*F)/G,se=a.z*(1-Z-Q)+u.z*Z+d.z*Q;if(isFinite(se))return se}return 1/0}{let n=1/0;for(const a of e)n=Math.min(n,a.z);return n}}function By(t){const e=new D(t[0],t[1]);return e.z=t[2],e}function X2(t,e,n,a,u,d,m,v){const b=m*u.getElevationAt(t,e,!0,!0),T=d[0]!==0,A=T?d[1]===0?m*(d[0]/7-450):m*function(I,z,F){const j=Math.floor(z[0]/8),G=Math.floor(z[1]/8),Z=10*(z[0]-8*j),Q=10*(z[1]-8*G),se=I.getElevationAt(j,G,!0,!0),de=I.getMeterToDEM(F),me=Math.floor(.5*(Z*de-1)),_e=Math.floor(.5*(Q*de-1)),xe=I.tileCoordToPixel(j,G),Oe=2*me+1,Pe=2*_e+1,nt=function(ft,bt,di,Ri,mi){return[ft.getElevationAtPixel(bt,di,!0),ft.getElevationAtPixel(bt+mi,di,!0),ft.getElevationAtPixel(bt,di+mi,!0),ft.getElevationAtPixel(bt+Ri,di+mi,!0)]}(I,xe.x-me,xe.y-_e,Oe,Pe),Ye=Math.abs(nt[0]-nt[1]),Re=Math.abs(nt[2]-nt[3]),Je=Math.abs(nt[0]-nt[2])+Math.abs(nt[1]-nt[3]),at=Math.min(.25,.5*de*(Ye+Re)/Oe),je=Math.min(.25,.5*de*Je/Pe);return se+Math.max(at*Z,je*Q)}(u,d,v):b;return{base:b+(n===0)?-1:n,top:T?Math.max(A+a,b+n+2):b+a}}const K2=Hi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Y2}=K2,J2=Hi([{name:"a_packed",components:3,type:"Float32"}]),{members:Q2}=J2,eT=Ua.VectorTileFeature.types,tT=Math.cos(Math.PI/180*37.5);class Id{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Tf,this.layoutVertexArray2=new Wl,this.indexArray=new zr,this.programConfigurations=new Ba(e.layers,e.zoom),this.segments=new sn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a,u){this.hasPattern=Kf("line",this.layers,n);const d=this.layers[0].layout.get("line-sort-key"),m=[];for(const{feature:A,id:I,index:z,sourceLayerIndex:F}of e){const j=this.layers[0]._featureFilter.needGeometry,G=Na(A,j);if(!this.layers[0]._featureFilter.filter(new jt(this.zoom),G,a))continue;const Z=d?d.evaluate(G,{},a):void 0,Q={id:I,properties:A.properties,type:A.type,sourceLayerIndex:F,index:z,geometry:j?G.geometry:cs(A,a,u),patterns:{},sortKey:Z};m.push(Q)}d&&m.sort((A,I)=>A.sortKey-I.sortKey);const{lineAtlas:v,featureIndex:b}=n,T=this.addConstantDashes(v);for(const A of m){const{geometry:I,index:z,sourceLayerIndex:F}=A;if(T&&this.addFeatureDashes(A,v),this.hasPattern){const j=Yf("line",this.layers,A,this.zoom,n);this.patternFeatures.push(j)}else this.addFeature(A,I,z,a,v.positions,n.availableImages);b.insert(e[z].feature,I,z,F,this.index)}}addConstantDashes(e){let n=!1;for(const a of this.layers){const u=a.paint.get("line-dasharray").value,d=a.layout.get("line-cap").value;if(u.kind!=="constant"||d.kind!=="constant")n=!0;else{const m=d.value,v=u.value;if(!v)continue;e.addDash(v.from,m),e.addDash(v.to,m),v.other&&e.addDash(v.other,m)}}return n}addFeatureDashes(e,n){const a=this.zoom;for(const u of this.layers){const d=u.paint.get("line-dasharray").value,m=u.layout.get("line-cap").value;if(d.kind==="constant"&&m.kind==="constant")continue;let v,b,T,A,I,z;if(d.kind==="constant"){const Z=d.value;if(!Z)continue;v=Z.other||Z.to,b=Z.to,T=Z.from}else v=d.evaluate({zoom:a-1},e),b=d.evaluate({zoom:a},e),T=d.evaluate({zoom:a+1},e);m.kind==="constant"?A=I=z=m.value:(A=m.evaluate({zoom:a-1},e),I=m.evaluate({zoom:a},e),z=m.evaluate({zoom:a+1},e)),n.addDash(v,A),n.addDash(b,I),n.addDash(T,z);const F=n.getKey(v,A),j=n.getKey(b,I),G=n.getKey(T,z);e.patterns[u.id]={min:F,mid:j,max:G}}}update(e,n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,u)}addFeatures(e,n,a,u){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Q2)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Y2),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,a,u,d,m){const v=this.layers[0].layout,b=v.get("line-join").evaluate(e,{}),T=v.get("line-cap").evaluate(e,{}),A=v.get("line-miter-limit"),I=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const z of n)this.addLine(z,e,b,T,A,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,d,m,u)}addLine(e,n,a,u,d,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Q=0;Q<e.length-1;Q++)this.totalDistance+=e[Q].dist(e[Q+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=eT[n.type]==="Polygon";let b=e.length;for(;b>=2&&e[b-1].equals(e[b-2]);)b--;let T=0;for(;T<b-1&&e[T].equals(e[T+1]);)T++;if(b<(v?3:2))return;a==="bevel"&&(d=1.05);const A=this.overscaling<=16?122880/(512*this.overscaling):0,I=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let z,F,j,G,Z;this.e1=this.e2=-1,v&&(z=e[b-2],Z=e[T].sub(z)._unit()._perp());for(let Q=T;Q<b;Q++){if(j=Q===b-1?v?e[T+1]:void 0:e[Q+1],j&&e[Q].equals(j))continue;Z&&(G=Z),z&&(F=z),z=e[Q],Z=j?j.sub(z)._unit()._perp():G,G=G||Z;let se=G.add(Z);se.x===0&&se.y===0||se._unit();const de=G.x*Z.x+G.y*Z.y,me=se.x*Z.x+se.y*Z.y,_e=me!==0?1/me:1/0,xe=2*Math.sqrt(2-2*me),Oe=me<tT&&F&&j,Pe=G.x*Z.y-G.y*Z.x>0;if(Oe&&Q>T){const Re=z.dist(F);if(Re>2*A){const Je=z.sub(z.sub(F)._mult(A/Re)._round());this.updateDistance(F,Je),this.addCurrentVertex(Je,G,0,0,I),F=Je}}const nt=F&&j;let Ye=nt?a:v?"butt":u;if(nt&&Ye==="round"&&(_e<m?Ye="miter":_e<=2&&(Ye="fakeround")),Ye==="miter"&&_e>d&&(Ye="bevel"),Ye==="bevel"&&(_e>2&&(Ye="flipbevel"),_e<d&&(Ye="miter")),F&&this.updateDistance(F,z),Ye==="miter")se._mult(_e),this.addCurrentVertex(z,se,0,0,I);else if(Ye==="flipbevel"){if(_e>100)se=Z.mult(-1);else{const Re=_e*G.add(Z).mag()/G.sub(Z).mag();se._perp()._mult(Re*(Pe?-1:1))}this.addCurrentVertex(z,se,0,0,I),this.addCurrentVertex(z,se.mult(-1),0,0,I)}else if(Ye==="bevel"||Ye==="fakeround"){const Re=-Math.sqrt(_e*_e-1),Je=Pe?Re:0,at=Pe?0:Re;if(F&&this.addCurrentVertex(z,G,Je,at,I),Ye==="fakeround"){const je=Math.round(180*xe/Math.PI/20);for(let ft=1;ft<je;ft++){let bt=ft/je;if(bt!==.5){const Ri=bt-.5;bt+=bt*Ri*(bt-1)*((1.0904+de*(de*(3.55645-1.43519*de)-3.2452))*Ri*Ri+(.848013+de*(.215638*de-1.06021)))}const di=Z.sub(G)._mult(bt)._add(G)._unit()._mult(Pe?-1:1);this.addHalfVertex(z,di.x,di.y,!1,Pe,0,I)}}j&&this.addCurrentVertex(z,Z,-Je,-at,I)}else if(Ye==="butt")this.addCurrentVertex(z,se,0,0,I);else if(Ye==="square"){const Re=F?1:-1;F||this.addCurrentVertex(z,se,Re,Re,I),this.addCurrentVertex(z,se,0,0,I),F&&this.addCurrentVertex(z,se,Re,Re,I)}else Ye==="round"&&(F&&(this.addCurrentVertex(z,G,0,0,I),this.addCurrentVertex(z,G,1,1,I,!0)),j&&(this.addCurrentVertex(z,Z,-1,-1,I,!0),this.addCurrentVertex(z,Z,0,0,I)));if(Oe&&Q<b-1){const Re=z.dist(j);if(Re>2*A){const Je=z.add(j.sub(z)._mult(A/Re)._round());this.updateDistance(z,Je),this.addCurrentVertex(Je,Z,0,0,I),z=Je}}}}addCurrentVertex(e,n,a,u,d,m=!1){const v=n.y*u-n.x,b=-n.y-n.x*u;this.addHalfVertex(e,n.x+n.y*a,n.y-n.x*a,m,!1,a,d),this.addHalfVertex(e,v,b,m,!0,-u,d)}addHalfVertex({x:e,y:n},a,u,d,m,v,b){this.layoutVertexArray.emplaceBack((e<<1)+(d?1:0),(n<<1)+(m?1:0),Math.round(63*a)+128,Math.round(63*u)+128,1+(v===0?0:v<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const T=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),b.primitiveLength++),m?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}_t("LineBucket",Id,{omit:["layers","patternFeatures"]});const iT=new zn({"line-cap":new Pt(ke.layout_line["line-cap"]),"line-join":new Pt(ke.layout_line["line-join"]),"line-miter-limit":new xt(ke.layout_line["line-miter-limit"]),"line-round-limit":new xt(ke.layout_line["line-round-limit"]),"line-sort-key":new Pt(ke.layout_line["line-sort-key"])});var Fy={paint:new zn({"line-opacity":new Pt(ke.paint_line["line-opacity"]),"line-color":new Pt(ke.paint_line["line-color"]),"line-translate":new xt(ke.paint_line["line-translate"]),"line-translate-anchor":new xt(ke.paint_line["line-translate-anchor"]),"line-width":new Pt(ke.paint_line["line-width"]),"line-gap-width":new Pt(ke.paint_line["line-gap-width"]),"line-offset":new Pt(ke.paint_line["line-offset"]),"line-blur":new Pt(ke.paint_line["line-blur"]),"line-dasharray":new _n(ke.paint_line["line-dasharray"]),"line-pattern":new _n(ke.paint_line["line-pattern"]),"line-gradient":new No(ke.paint_line["line-gradient"])}),layout:iT};const Ny=new class extends Pt{possiblyEvaluate(t,e){return e=new jt(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,a){return e=dt({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,a)}}(Fy.paint.properties["line-width"].specification);function Uy(t,e){return e>0?e+2*t:t}Ny.useIntegerZoom=!0;const nT=Hi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),rT=Hi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Hi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const oT=Hi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),sT=Hi([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Hi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const jy=Hi([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),aT=Hi([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Hi([{name:"triangle",components:3,type:"Uint16"}]),Hi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Hi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Hi([{type:"Float32",name:"offsetX"}]),Hi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Rn=24;const jo=128;function Qf(t,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new jt(t+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:u}=n;let d=0;for(;d<a.length&&a[d]<=t;)d++;d=Math.max(0,d-1);let m=d;for(;m<a.length&&a[m]<t+1;)m++;m=Math.min(a.length-1,m);const v=a[d],b=a[m];return n.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:b,interpolationType:u}:{kind:"camera",minZoom:v,maxZoom:b,minSize:n.evaluate(new jt(v)),maxSize:n.evaluate(new jt(b)),interpolationType:u}}}function kd(t,{uSize:e,uSizeT:n},{lowerSize:a,upperSize:u}){return t.kind==="source"?a/jo:t.kind==="composite"?Ei(a/jo,u/jo,n):e}function tc(t,e){let n=0,a=0;if(t.kind==="constant")a=t.layoutSize;else if(t.kind!=="source"){const{interpolationType:u,minZoom:d,maxZoom:m}=t,v=u?Ne(Jn.interpolationFactor(u,e,d,m),0,1):0;t.kind==="camera"?a=Ei(t.minSize,t.maxSize,v):n=v}return{uSizeT:n,uSize:a}}var lT=Object.freeze({__proto__:null,getSizeData:Qf,evaluateSizeForFeature:kd,evaluateSizeForZoom:tc,SIZE_PACK_FACTOR:jo});function cT(t,e,n){return t.sections.forEach(a=>{a.text=function(u,d,m){const v=d.layout.get("text-transform").evaluate(m,{});return v==="uppercase"?u=u.toLocaleUpperCase():v==="lowercase"&&(u=u.toLocaleLowerCase()),fi.applyArabicShaping&&(u=fi.applyArabicShaping(u)),u}(a.text,e,n)}),t}const ku={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function uT(t){return t==="\uFE36"||t==="\uFE48"||t==="\uFE38"||t==="\uFE44"||t==="\uFE42"||t==="\uFE3E"||t==="\uFE3C"||t==="\uFE3A"||t==="\uFE18"||t==="\uFE40"||t==="\uFE10"||t==="\uFE13"||t==="\uFE14"||t==="\uFF40"||t==="\uFFE3"||t==="\uFE11"||t==="\uFE12"}function hT(t){return t==="\uFE35"||t==="\uFE47"||t==="\uFE37"||t==="\uFE43"||t==="\uFE41"||t==="\uFE3D"||t==="\uFE3B"||t==="\uFE39"||t==="\uFE17"||t==="\uFE3F"}var Vy=function(t,e,n,a,u){var d,m,v=8*u-a-1,b=(1<<v)-1,T=b>>1,A=-7,I=n?u-1:0,z=n?-1:1,F=t[e+I];for(I+=z,d=F&(1<<-A)-1,F>>=-A,A+=v;A>0;d=256*d+t[e+I],I+=z,A-=8);for(m=d&(1<<-A)-1,d>>=-A,A+=a;A>0;m=256*m+t[e+I],I+=z,A-=8);if(d===0)d=1-T;else{if(d===b)return m?NaN:1/0*(F?-1:1);m+=Math.pow(2,a),d-=T}return(F?-1:1)*m*Math.pow(2,d-a)},$y=function(t,e,n,a,u,d){var m,v,b,T=8*d-u-1,A=(1<<T)-1,I=A>>1,z=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=a?0:d-1,j=a?1:-1,G=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,m=A):(m=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-m))<1&&(m--,b*=2),(e+=m+I>=1?z/b:z*Math.pow(2,1-I))*b>=2&&(m++,b/=2),m+I>=A?(v=0,m=A):m+I>=1?(v=(e*b-1)*Math.pow(2,u),m+=I):(v=e*Math.pow(2,I-1)*Math.pow(2,u),m=0));u>=8;t[n+F]=255&v,F+=j,v/=256,u-=8);for(m=m<<u|v,T+=u;T>0;t[n+F]=255&m,F+=j,m/=256,T-=8);t[n+F-j]|=128*G},zu=Li;function Li(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Li.Varint=0,Li.Fixed64=1,Li.Bytes=2,Li.Fixed32=5;var em=4294967296,Gy=1/em,qy=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function us(t){return t.type===Li.Bytes?t.readVarint()+t.pos:t.pos+1}function ic(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Zy(t,e,n){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(a);for(var u=n.pos-1;u>=t;u--)n.buf[u+a]=n.buf[u]}function dT(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function pT(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function fT(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function mT(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function gT(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function _T(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function yT(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function vT(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function xT(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function zd(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function nc(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Wy(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function bT(t,e,n){e.glyphs=[],t===1&&n.readMessage(wT,e)}function wT(t,e,n){if(t===3){const{id:a,bitmap:u,width:d,height:m,left:v,top:b,advance:T}=n.readMessage(TT,{});e.glyphs.push({id:a,bitmap:new Ns({width:d+6,height:m+6},u),metrics:{width:d,height:m,left:v,top:b,advance:T}})}else t===4?e.ascender=n.readSVarint():t===5&&(e.descender=n.readSVarint())}function TT(t,e,n){t===1?e.id=n.readVarint():t===2?e.bitmap=n.readBytes():t===3?e.width=n.readVarint():t===4?e.height=n.readVarint():t===5?e.left=n.readSVarint():t===6?e.top=n.readSVarint():t===7&&(e.advance=n.readVarint())}function tm(t){let e=0,n=0;for(const m of t)e+=m.w*m.h,n=Math.max(n,m.w);t.sort((m,v)=>v.h-m.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let u=0,d=0;for(const m of t)for(let v=a.length-1;v>=0;v--){const b=a[v];if(!(m.w>b.w||m.h>b.h)){if(m.x=b.x,m.y=b.y,d=Math.max(d,m.y+m.h),u=Math.max(u,m.x+m.w),m.w===b.w&&m.h===b.h){const T=a.pop();v<a.length&&(a[v]=T)}else m.h===b.h?(b.x+=m.w,b.w-=m.w):m.w===b.w?(b.y+=m.h,b.h-=m.h):(a.push({x:b.x+m.w,y:b.y,w:b.w-m.w,h:m.h}),b.y+=m.h,b.h-=m.h);break}}return{w:u,h:d,fill:e/(u*d)||0}}Li.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var a=this.readVarint(),u=a>>3,d=this.pos;this.type=7&a,t(u,e,this),this.pos===d&&this.skip(a)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=zd(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Wy(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=zd(this.buf,this.pos)+zd(this.buf,this.pos+4)*em;return this.pos+=8,t},readSFixed64:function(){var t=zd(this.buf,this.pos)+Wy(this.buf,this.pos+4)*em;return this.pos+=8,t},readFloat:function(){var t=Vy(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Vy(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,a=this.buf;return e=127&(n=a[this.pos++]),n<128?e:(e|=(127&(n=a[this.pos++]))<<7,n<128?e:(e|=(127&(n=a[this.pos++]))<<14,n<128?e:(e|=(127&(n=a[this.pos++]))<<21,n<128?e:function(u,d,m){var v,b,T=m.buf;if(v=(112&(b=T[m.pos++]))>>4,b<128||(v|=(127&(b=T[m.pos++]))<<3,b<128)||(v|=(127&(b=T[m.pos++]))<<10,b<128)||(v|=(127&(b=T[m.pos++]))<<17,b<128)||(v|=(127&(b=T[m.pos++]))<<24,b<128)||(v|=(1&(b=T[m.pos++]))<<31,b<128))return ic(u,v,d);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=a[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&qy?function(n,a,u){return qy.decode(n.subarray(a,u))}(this.buf,e,t):function(n,a,u){for(var d="",m=a;m<u;){var v,b,T,A=n[m],I=null,z=A>239?4:A>223?3:A>191?2:1;if(m+z>u)break;z===1?A<128&&(I=A):z===2?(192&(v=n[m+1]))==128&&(I=(31&A)<<6|63&v)<=127&&(I=null):z===3?(b=n[m+2],(192&(v=n[m+1]))==128&&(192&b)==128&&((I=(15&A)<<12|(63&v)<<6|63&b)<=2047||I>=55296&&I<=57343)&&(I=null)):z===4&&(b=n[m+2],T=n[m+3],(192&(v=n[m+1]))==128&&(192&b)==128&&(192&T)==128&&((I=(15&A)<<18|(63&v)<<12|(63&b)<<6|63&T)<=65535||I>=1114112)&&(I=null)),I===null?(I=65533,z=1):I>65535&&(I-=65536,d+=String.fromCharCode(I>>>10&1023|55296),I=56320|1023&I),d+=String.fromCharCode(I),m+=z}return d}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Li.Bytes)return t.push(this.readVarint(e));var n=us(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Li.Bytes)return t.push(this.readSVarint());var e=us(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Li.Bytes)return t.push(this.readBoolean());var e=us(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Li.Bytes)return t.push(this.readFloat());var e=us(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Li.Bytes)return t.push(this.readDouble());var e=us(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Li.Bytes)return t.push(this.readFixed32());var e=us(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Li.Bytes)return t.push(this.readSFixed32());var e=us(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Li.Bytes)return t.push(this.readFixed64());var e=us(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Li.Bytes)return t.push(this.readSFixed64());var e=us(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Li.Varint)for(;this.buf[this.pos++]>127;);else if(e===Li.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Li.Fixed32)this.pos+=4;else{if(e!==Li.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),nc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),nc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),nc(this.buf,-1&t,this.pos),nc(this.buf,Math.floor(t*Gy),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),nc(this.buf,-1&t,this.pos),nc(this.buf,Math.floor(t*Gy),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,n){var a,u;if(e>=0?(a=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,u=u+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(d,m,v){v.buf[v.pos++]=127&d|128,d>>>=7,v.buf[v.pos++]=127&d|128,d>>>=7,v.buf[v.pos++]=127&d|128,d>>>=7,v.buf[v.pos++]=127&d|128,v.buf[v.pos]=127&(d>>>=7)}(a,0,n),function(d,m){var v=(7&d)<<4;m.buf[m.pos++]|=v|((d>>>=3)?128:0),d&&(m.buf[m.pos++]=127&d|((d>>>=7)?128:0),d&&(m.buf[m.pos++]=127&d|((d>>>=7)?128:0),d&&(m.buf[m.pos++]=127&d|((d>>>=7)?128:0),d&&(m.buf[m.pos++]=127&d|((d>>>=7)?128:0),d&&(m.buf[m.pos++]=127&d)))))}(u,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(a,u,d){for(var m,v,b=0;b<u.length;b++){if((m=u.charCodeAt(b))>55295&&m<57344){if(!v){m>56319||b+1===u.length?(a[d++]=239,a[d++]=191,a[d++]=189):v=m;continue}if(m<56320){a[d++]=239,a[d++]=191,a[d++]=189,v=m;continue}m=v-55296<<10|m-56320|65536,v=null}else v&&(a[d++]=239,a[d++]=191,a[d++]=189,v=null);m<128?a[d++]=m:(m<2048?a[d++]=m>>6|192:(m<65536?a[d++]=m>>12|224:(a[d++]=m>>18|240,a[d++]=m>>12&63|128),a[d++]=m>>6&63|128),a[d++]=63&m|128)}return d}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Zy(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),$y(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),$y(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var a=this.pos-n;a>=128&&Zy(n,a,this),this.pos=n-1,this.writeVarint(a),this.pos+=a},writeMessage:function(t,e,n){this.writeTag(t,Li.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,dT,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,pT,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,gT,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,fT,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,mT,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,_T,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,yT,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,vT,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,xT,e)},writeBytesField:function(t,e){this.writeTag(t,Li.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Li.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Li.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Li.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Li.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Li.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Li.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Li.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Li.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Li.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class im{constructor(e,{pixelRatio:n,version:a,stretchX:u,stretchY:d,content:m}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=u,this.stretchY=d,this.content=m,this.version=a}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Hy{constructor(e,n){const a={},u={};this.haveRenderCallbacks=[];const d=[];this.addImages(e,a,d),this.addImages(n,u,d);const{w:m,h:v}=tm(d),b=new Pr({width:m||1,height:v||1});for(const T in e){const A=e[T],I=a[T].paddedRect;Pr.copy(A.data,b,{x:0,y:0},{x:I.x+1,y:I.y+1},A.data)}for(const T in n){const A=n[T],I=u[T].paddedRect,z=I.x+1,F=I.y+1,j=A.data.width,G=A.data.height;Pr.copy(A.data,b,{x:0,y:0},{x:z,y:F},A.data),Pr.copy(A.data,b,{x:0,y:G-1},{x:z,y:F-1},{width:j,height:1}),Pr.copy(A.data,b,{x:0,y:0},{x:z,y:F+G},{width:j,height:1}),Pr.copy(A.data,b,{x:j-1,y:0},{x:z-1,y:F},{width:1,height:G}),Pr.copy(A.data,b,{x:0,y:0},{x:z+j,y:F},{width:1,height:G})}this.image=b,this.iconPositions=a,this.patternPositions=u}addImages(e,n,a){for(const u in e){const d=e[u],m={x:0,y:0,w:d.data.width+2,h:d.data.height+2};a.push(m),n[u]=new im(m,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,n){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),n),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),n)}patchUpdatedImage(e,n,a){if(!e||!n||e.version===n.version)return;e.version=n.version;const[u,d]=e.tl;a.update(n.data,void 0,{x:u,y:d})}}_t("ImagePosition",im),_t("ImageAtlas",Hy);const Dr={horizontal:1,vertical:2,horizontalOnly:3};class Pu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const a=new Pu;return a.scale=e||1,a.fontStack=n,a}static forImage(e){const n=new Pu;return n.imageName=e,n}}class rc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const a=new rc;for(let u=0;u<e.sections.length;u++){const d=e.sections[u];d.image?a.addImageSection(d):a.addTextSection(d,n)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(n,a){let u="";for(let d=0;d<n.length;d++){const m=n.charCodeAt(d+1)||null,v=n.charCodeAt(d-1)||null;u+=!a&&(m&&St(m)&&!ku[n[d+1]]||v&&St(v)&&!ku[n[d-1]])||!ku[n[d]]?n[d]:ku[n[d]]}return u}(this.text,e)}trim(){let e=0;for(let a=0;a<this.text.length&&Pd[this.text.charCodeAt(a)];a++)e++;let n=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&Pd[this.text.charCodeAt(a)];a--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const a=new rc;return a.text=this.text.substring(e,n),a.sectionIndex=this.sectionIndex.slice(e,n),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Pu.forText(e.scale,e.fontStack||n));const a=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(a)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void Yt("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Pu.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Yt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function nm(t,e,n,a,u,d,m,v,b,T,A,I,z,F,j,G){const Z=rc.fromFeature(t,u);let Q;I===Dr.vertical&&Z.verticalizePunctuation(z);const{processBidirectionalText:se,processStyledBidirectionalText:de}=fi;if(se&&Z.sections.length===1){Q=[];const xe=se(Z.toString(),rm(Z,T,d,e,a,F,j));for(const Oe of xe){const Pe=new rc;Pe.text=Oe,Pe.sections=Z.sections;for(let nt=0;nt<Oe.length;nt++)Pe.sectionIndex.push(0);Q.push(Pe)}}else if(de){Q=[];const xe=de(Z.text,Z.sectionIndex,rm(Z,T,d,e,a,F,j));for(const Oe of xe){const Pe=new rc;Pe.text=Oe[0],Pe.sectionIndex=Oe[1],Pe.sections=Z.sections,Q.push(Pe)}}else Q=function(xe,Oe){const Pe=[],nt=xe.text;let Ye=0;for(const Re of Oe)Pe.push(xe.substring(Ye,Re)),Ye=Re;return Ye<nt.length&&Pe.push(xe.substring(Ye,nt.length)),Pe}(Z,rm(Z,T,d,e,a,F,j));const me=[],_e={positionedLines:me,text:Z.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:I,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(xe,Oe,Pe,nt,Ye,Re,Je,at,je,ft,bt,di){let Ri=0,mi=0,gi=0;const He=at==="right"?1:at==="left"?0:.5;let wi=!1;for(const Ti of Ye){const li=Ti.getSections();for(const Vi of li){if(Vi.imageName)continue;const cn=Oe[Vi.fontStack];if(cn&&(wi=cn.ascender!==void 0&&cn.descender!==void 0,!wi))break}if(!wi)break}let vi=0;for(const Ti of Ye){Ti.trim();const li=Ti.getMaxScale(),Vi=(li-1)*Rn,cn={positionedGlyphs:[],lineOffset:0};xe.positionedLines[vi]=cn;const nn=cn.positionedGlyphs;let dn=0;if(!Ti.length()){mi+=Re,++vi;continue}let On=0,ar=0;for(let ji=0;ji<Ti.length();ji++){const vn=Ti.getSection(ji),Jr=Ti.getSectionIndex(ji),Pn=Ti.getCharCode(ji);let ki=vn.scale,xn=null,$i=null,Gn=null,pn=Rn,qn=0;const tr=!(je===Dr.horizontal||!bt&&!Fe(Pn)||bt&&(Pd[Pn]||(ln=Pn,i(ln)||c(ln)||f(ln)||ce(ln)||qe(ln))));if(vn.imageName){const ir=nt[vn.imageName];if(!ir)continue;Gn=vn.imageName,xe.iconsInText=xe.iconsInText||!0,$i=ir.paddedRect;const bn=ir.displaySize;ki=ki*Rn/di,xn={width:bn[0],height:bn[1],left:1,top:-3,advance:tr?bn[1]:bn[0],localGlyph:!1},qn=wi?-xn.height*ki:li*Rn-17-bn[1]*ki,pn=xn.advance;const yo=(tr?bn[0]:bn[1])*ki-Rn*li;yo>0&&yo>dn&&(dn=yo)}else{const ir=Pe[vn.fontStack];if(!ir)continue;ir[Pn]&&($i=ir[Pn]);const bn=Oe[vn.fontStack];if(!bn)continue;const yo=bn.glyphs[Pn];if(!yo)continue;if(xn=yo.metrics,pn=Pn!==8203?Rn:0,wi){const uc=bn.ascender!==void 0?Math.abs(bn.ascender):0,Nu=bn.descender!==void 0?Math.abs(bn.descender):0,Uu=(uc+Nu)*ki;On<Uu&&(On=Uu,ar=(uc-Nu)/2*ki),qn=-uc*ki}else qn=(li-ki)*Rn-17}tr?(xe.verticalizable=!0,nn.push({glyph:Pn,imageName:Gn,x:Ri,y:mi+qn,vertical:tr,scale:ki,localGlyph:xn.localGlyph,fontStack:vn.fontStack,sectionIndex:Jr,metrics:xn,rect:$i}),Ri+=pn*ki+ft):(nn.push({glyph:Pn,imageName:Gn,x:Ri,y:mi+qn,vertical:tr,scale:ki,localGlyph:xn.localGlyph,fontStack:vn.fontStack,sectionIndex:Jr,metrics:xn,rect:$i}),Ri+=xn.advance*ki+ft)}nn.length!==0&&(gi=Math.max(Ri-ft,gi),wi?Qy(nn,He,dn,ar,Re*li/2):Qy(nn,He,dn,0,Re/2)),Ri=0;const lr=Re*li+dn;cn.lineOffset=Math.max(dn,Vi),mi+=lr,++vi}var ln;const Ji=mi,{horizontalAlign:yn,verticalAlign:$n}=om(Je);(function(Ti,li,Vi,cn,nn,dn){const On=(li-Vi)*nn,ar=-dn*cn;for(const lr of Ti)for(const ji of lr.positionedGlyphs)ji.x+=On,ji.y+=ar})(xe.positionedLines,He,yn,$n,gi,Ji),xe.top+=-$n*Ji,xe.bottom=xe.top+Ji,xe.left+=-yn*gi,xe.right=xe.left+gi,xe.hasBaseline=wi}(_e,e,n,a,Q,m,v,b,I,T,z,G),!function(xe){for(const Oe of xe)if(Oe.positionedGlyphs.length!==0)return!1;return!0}(me)&&_e}const Pd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ET={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Xy(t,e,n,a,u,d){if(e.imageName){const m=a[e.imageName];return m?m.displaySize[0]*e.scale*Rn/d+u:0}{const m=n[e.fontStack],v=m&&m.glyphs[t];return v?v.metrics.advance*e.scale+u:0}}function Ky(t,e,n,a){const u=Math.pow(t-e,2);return a?t<e?u/2:2*u:u+Math.abs(n)*n}function ST(t,e,n){let a=0;return t===10&&(a-=1e4),n&&(a+=150),t!==40&&t!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function Yy(t,e,n,a,u,d){let m=null,v=Ky(e,n,u,d);for(const b of a){const T=Ky(e-b.x,n,u,d)+b.badness;T<=v&&(m=b,v=T)}return{index:t,x:e,priorBreak:m,badness:v}}function Jy(t){return t?Jy(t.priorBreak).concat(t.index):[]}function rm(t,e,n,a,u,d,m){if(d!=="point")return[];if(!t)return[];const v=[],b=function(z,F,j,G,Z,Q){let se=0;for(let de=0;de<z.length();de++){const me=z.getSection(de);se+=Xy(z.getCharCode(de),me,G,Z,F,Q)}return se/Math.max(1,Math.ceil(se/j))}(t,e,n,a,u,m),T=t.text.indexOf("\u200B")>=0;let A=0;for(let z=0;z<t.length();z++){const F=t.getSection(z),j=t.getCharCode(z);if(Pd[j]||(A+=Xy(j,F,a,u,e,m)),z<t.length()-1){const G=!((I=j)<11904||!(N(I)||O(I)||Me(I)||ne(I)||X(I)||_(I)||$(I)||S(I)||le(I)||W(I)||q(I)||Ge(I)||P(I)||w(I)||x(I)||H(I)||L(I)||Se(I)||oe(I)||re(I)));(ET[j]||G||F.imageName)&&v.push(Yy(z+1,A,b,v,ST(j,t.getCharCode(z+1),G&&T),!1))}}var I;return Jy(Yy(t.length(),A,b,v,0,!0))}function om(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Qy(t,e,n,a,u){if(!(e||n||a||u))return;const d=t.length-1,m=t[d],v=(m.x+m.metrics.advance*m.scale)*e;for(let b=0;b<=d;b++)t[b].x-=v,t[b].y+=n+a+u}function CT(t,e,n){const{horizontalAlign:a,verticalAlign:u}=om(n),d=e[0]-t.displaySize[0]*a,m=e[1]-t.displaySize[1]*u;return{image:t,top:m,bottom:m+t.displaySize[1],left:d,right:d+t.displaySize[0]}}function e0(t,e,n,a,u,d){const m=t.image;let v;if(m.content){const Z=m.content,Q=m.pixelRatio||1;v=[Z[0]/Q,Z[1]/Q,m.displaySize[0]-Z[2]/Q,m.displaySize[1]-Z[3]/Q]}const b=e.left*d,T=e.right*d;let A,I,z,F;n==="width"||n==="both"?(F=u[0]+b-a[3],I=u[0]+T+a[1]):(F=u[0]+(b+T-m.displaySize[0])/2,I=F+m.displaySize[0]);const j=e.top*d,G=e.bottom*d;return n==="height"||n==="both"?(A=u[1]+j-a[0],z=u[1]+G+a[2]):(A=u[1]+(j+G-m.displaySize[1])/2,z=A+m.displaySize[1]),{image:m,top:A,right:I,bottom:z,left:F,collisionPadding:v}}class hs extends D{constructor(e,n,a,u,d){super(e,n),this.angle=u,this.z=a,d!==void 0&&(this.segment=d)}clone(){return new hs(this.x,this.y,this.z,this.angle,this.segment)}}function t0(t,e,n,a,u){if(e.segment===void 0)return!0;let d=e,m=e.segment+1,v=0;for(;v>-n/2;){if(m--,m<0)return!1;v-=t[m].dist(d),d=t[m]}v+=t[m].dist(t[m+1]),m++;const b=[];let T=0;for(;v<n/2;){const A=t[m],I=t[m+1];if(!I)return!1;let z=t[m-1].angleTo(A)-A.angleTo(I);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:v,angleDelta:z}),T+=z;v-b[0].distance>a;)T-=b.shift().angleDelta;if(T>u)return!1;m++,v+=A.dist(I)}return!0}function i0(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function n0(t,e,n){return t?.6*e*n:0}function r0(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function AT(t,e,n,a,u,d){const m=n0(n,u,d),v=r0(n,a)*d;let b=0;const T=i0(t)/2;for(let A=0;A<t.length-1;A++){const I=t[A],z=t[A+1],F=I.dist(z);if(b+F>T){const j=(T-b)/F,G=Ei(I.x,z.x,j),Z=Ei(I.y,z.y,j),Q=new hs(G,Z,0,z.angleTo(I),A);return!m||t0(t,Q,v,m,e)?Q:void 0}b+=F}}function MT(t,e,n,a,u,d,m,v,b){const T=n0(a,d,m),A=r0(a,u),I=A*m,z=t[0].x===0||t[0].x===b||t[0].y===0||t[0].y===b;return e-I<e/4&&(e=I+e/4),o0(t,z?e/2*v%e:(A/2+2*d)*m*v%e,e,T,n,I,z,!1,b)}function o0(t,e,n,a,u,d,m,v,b){const T=d/2,A=i0(t);let I=0,z=e-n,F=[];for(let j=0;j<t.length-1;j++){const G=t[j],Z=t[j+1],Q=G.dist(Z),se=Z.angleTo(G);for(;z+n<I+Q;){z+=n;const de=(z-I)/Q,me=Ei(G.x,Z.x,de),_e=Ei(G.y,Z.y,de);if(me>=0&&me<b&&_e>=0&&_e<b&&z-T>=0&&z+T<=A){const xe=new hs(me,_e,0,se,j);xe._round(),a&&!t0(t,xe,d,a,u)||F.push(xe)}}I+=Q}return v||F.length||m||(F=o0(t,I/2,n,a,u,d,m,!0,b)),F}function s0(t,e,n,a,u){const d=[];for(let m=0;m<t.length;m++){const v=t[m];let b;for(let T=0;T<v.length-1;T++){let A=v[T],I=v[T+1];A.x<e&&I.x<e||(A.x<e?A=new D(e,A.y+(e-A.x)/(I.x-A.x)*(I.y-A.y))._round():I.x<e&&(I=new D(e,A.y+(e-A.x)/(I.x-A.x)*(I.y-A.y))._round()),A.y<n&&I.y<n||(A.y<n?A=new D(A.x+(n-A.y)/(I.y-A.y)*(I.x-A.x),n)._round():I.y<n&&(I=new D(A.x+(n-A.y)/(I.y-A.y)*(I.x-A.x),n)._round()),A.x>=a&&I.x>=a||(A.x>=a?A=new D(a,A.y+(a-A.x)/(I.x-A.x)*(I.y-A.y))._round():I.x>=a&&(I=new D(a,A.y+(a-A.x)/(I.x-A.x)*(I.y-A.y))._round()),A.y>=u&&I.y>=u||(A.y>=u?A=new D(A.x+(u-A.y)/(I.y-A.y)*(I.x-A.x),u)._round():I.y>=u&&(I=new D(A.x+(u-A.y)/(I.y-A.y)*(I.x-A.x),u)._round()),b&&A.equals(b[b.length-1])||(b=[A],d.push(b)),b.push(I)))))}}return d}_t("Anchor",hs);const Du=1e20;function a0(t,e,n,a,u,d,m,v,b){for(let T=e;T<e+a;T++)l0(t,n*d+T,d,u,m,v,b);for(let T=n;T<n+u;T++)l0(t,T*d+e,1,a,m,v,b)}function l0(t,e,n,a,u,d,m){d[0]=0,m[0]=-Du,m[1]=Du,u[0]=t[e];for(let v=1,b=0,T=0;v<a;v++){u[v]=t[e+v*n];const A=v*v;do{const I=d[b];T=(u[v]-u[I]+A-I*I)/(v-I)/2}while(T<=m[b]&&--b>-1);b++,d[b]=v,m[b]=T,m[b+1]=Du}for(let v=0,b=0;v<a;v++){for(;m[b+1]<v;)b++;const T=d[b],A=v-T;t[e+v*n]=u[T]+A*A}}const sm={none:0,ideographs:1,all:2};class oc{constructor(e,n,a){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=a,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,n){const a=[];for(const u in e)for(const d of e[u])a.push({stack:u,id:d});Mt(a,({stack:u,id:d},m)=>{let v=this.entries[u];v||(v=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let b=v.glyphs[d];if(b!==void 0)return void m(null,{stack:u,id:d,glyph:b});if(b=this._tinySDF(v,u,d),b)return v.glyphs[d]=b,void m(null,{stack:u,id:d,glyph:b});const T=Math.floor(d/256);if(256*T>65535)return void m(new Error("glyphs > 65535 not supported"));if(v.ranges[T])return void m(null,{stack:u,id:d,glyph:b});let A=v.requests[T];A||(A=v.requests[T]=[],oc.loadGlyphRange(u,T,this.url,this.requestManager,(I,z)=>{if(z){v.ascender=z.ascender,v.descender=z.descender;for(const F in z.glyphs)this._doesCharSupportLocalGlyph(+F)||(v.glyphs[+F]=z.glyphs[+F]);v.ranges[T]=!0}for(const F of A)F(I,z);delete v.requests[T]})),A.push((I,z)=>{I?m(I):z&&m(null,{stack:u,id:d,glyph:z.glyphs[d]||null})})},(u,d)=>{if(u)n(u);else if(d){const m={};for(const{stack:v,id:b,glyph:T}of d)m[v]===void 0&&(m[v]={}),m[v].glyphs===void 0&&(m[v].glyphs={}),m[v].glyphs[b]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics},m[v].ascender=this.entries[v].ascender,m[v].descender=this.entries[v].descender;n(null,m)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==sm.none&&(this.localGlyphMode===sm.all?!!this.localFontFamily:!!this.localFontFamily&&(W(e)||ie(e)||P(e)||L(e))||S(e))}_tinySDF(e,n,a){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(a))return;let d=e.tinySDF;if(!d){let G="400";/bold/i.test(n)?G="900":/medium/i.test(n)?G="500":/light/i.test(n)&&(G="200"),d=e.tinySDF=new oc.TinySDF({fontFamily:u,fontWeight:G,fontSize:48,buffer:6,radius:16}),d.fontWeight=G}if(this.localGlyphs[d.fontWeight][a])return this.localGlyphs[d.fontWeight][a];const m=String.fromCharCode(a),{data:v,width:b,height:T,glyphWidth:A,glyphHeight:I,glyphLeft:z,glyphTop:F,glyphAdvance:j}=d.draw(m);return this.localGlyphs[d.fontWeight][a]={id:a,bitmap:new Ns({width:b,height:T},v),metrics:{width:A/2,height:I/2,left:z/2,top:F/2-27,advance:j/2,localGlyph:!0}}}}function c0(t,e,n,a){const u=[],d=t.image,m=d.pixelRatio,v=d.paddedRect.w-2,b=d.paddedRect.h-2,T=t.right-t.left,A=t.bottom-t.top,I=d.stretchX||[[0,v]],z=d.stretchY||[[0,b]],F=(Re,Je)=>Re+Je[1]-Je[0],j=I.reduce(F,0),G=z.reduce(F,0),Z=v-j,Q=b-G;let se=0,de=j,me=0,_e=G,xe=0,Oe=Z,Pe=0,nt=Q;if(d.content&&a){const Re=d.content;se=Dd(I,0,Re[0]),me=Dd(z,0,Re[1]),de=Dd(I,Re[0],Re[2]),_e=Dd(z,Re[1],Re[3]),xe=Re[0]-se,Pe=Re[1]-me,Oe=Re[2]-Re[0]-de,nt=Re[3]-Re[1]-_e}const Ye=(Re,Je,at,je)=>{const ft=Ld(Re.stretch-se,de,T,t.left),bt=Rd(Re.fixed-xe,Oe,Re.stretch,j),di=Ld(Je.stretch-me,_e,A,t.top),Ri=Rd(Je.fixed-Pe,nt,Je.stretch,G),mi=Ld(at.stretch-se,de,T,t.left),gi=Rd(at.fixed-xe,Oe,at.stretch,j),He=Ld(je.stretch-me,_e,A,t.top),wi=Rd(je.fixed-Pe,nt,je.stretch,G),vi=new D(ft,di),ln=new D(mi,di),Ji=new D(mi,He),yn=new D(ft,He),$n=new D(bt/m,Ri/m),Ti=new D(gi/m,wi/m),li=e*Math.PI/180;if(li){const nn=Math.sin(li),dn=Math.cos(li),On=[dn,-nn,nn,dn];vi._matMult(On),ln._matMult(On),yn._matMult(On),Ji._matMult(On)}const Vi=Re.stretch+Re.fixed,cn=Je.stretch+Je.fixed;return{tl:vi,tr:ln,bl:yn,br:Ji,tex:{x:d.paddedRect.x+1+Vi,y:d.paddedRect.y+1+cn,w:at.stretch+at.fixed-Vi,h:je.stretch+je.fixed-cn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$n,pixelOffsetBR:Ti,minFontScaleX:Oe/m/T,minFontScaleY:nt/m/A,isSDF:n}};if(a&&(d.stretchX||d.stretchY)){const Re=u0(I,Z,j),Je=u0(z,Q,G);for(let at=0;at<Re.length-1;at++){const je=Re[at],ft=Re[at+1];for(let bt=0;bt<Je.length-1;bt++)u.push(Ye(je,Je[bt],ft,Je[bt+1]))}}else u.push(Ye({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:b+1}));return u}function Dd(t,e,n){let a=0;for(const u of t)a+=Math.max(e,Math.min(n,u[1]))-Math.max(e,Math.min(n,u[0]));return a}function u0(t,e,n){const a=[{fixed:-1,stretch:0}];for(const[u,d]of t){const m=a[a.length-1];a.push({fixed:u-m.stretch,stretch:m.stretch}),a.push({fixed:u-m.stretch,stretch:m.stretch+(d-u)})}return a.push({fixed:e+1,stretch:n}),a}function Ld(t,e,n,a){return t/e*n+a}function Rd(t,e,n,a){return t-e*n/a}function IT(t,e,n,a){const u=e+t.positionedLines[a].lineOffset;return a===0?n+u/2:n+(u+(e+t.positionedLines[a-1].lineOffset))/2}oc.loadGlyphRange=function(t,e,n,a,u){const d=256*e,m=d+255,v=a.transformRequest(a.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${d}-${m}`),hl.Glyphs);ua(v,(b,T)=>{if(b)u(b);else if(T){const A={},I=function(z){return new zu(z).readFields(bT,{})}(T);for(const z of I.glyphs)A[z.id]=z;u(null,{glyphs:A,ascender:I.ascender,descender:I.descender})}})},oc.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:a=.25,fontFamily:u="sans-serif",fontWeight:d="normal",fontStyle:m="normal"}){this.buffer=e,this.cutoff=a,this.radius=n;const v=this.size=t+4*e,b=this._createCanvas(v),T=this.ctx=b.getContext("2d",{willReadFrequently:!0});T.font=`${m} ${d} ${t}px ${u}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:a,actualBoundingBoxLeft:u,actualBoundingBoxRight:d}=this.ctx.measureText(t),m=Math.floor(n),v=Math.min(this.size-this.buffer,Math.ceil(d-u)),b=Math.min(this.size-this.buffer,Math.ceil(n)+Math.ceil(a)),T=v+2*this.buffer,A=b+2*this.buffer,I=T*A,z=new Uint8ClampedArray(I),F={data:z,width:T,height:A,glyphWidth:v,glyphHeight:b,glyphTop:m,glyphLeft:0,glyphAdvance:e};if(v===0||b===0)return F;const{ctx:j,buffer:G,gridInner:Z,gridOuter:Q}=this;j.clearRect(G,G,v,b),j.fillText(t,G,G+m+1);const se=j.getImageData(G,G,v,b);Q.fill(Du,0,I),Z.fill(0,0,I);for(let de=0;de<b;de++)for(let me=0;me<v;me++){const _e=se.data[4*(de*v+me)+3]/255;if(_e===0)continue;const xe=(de+G)*T+me+G;if(_e===1)Q[xe]=0,Z[xe]=Du;else{const Oe=.5-_e;Q[xe]=Oe>0?Oe*Oe:0,Z[xe]=Oe<0?Oe*Oe:0}}a0(Q,0,0,T,A,T,this.f,this.v,this.z),a0(Z,G,G,v,b,T,this.f,this.v,this.z);for(let de=0;de<I;de++){const me=Math.sqrt(Q[de])-Math.sqrt(Z[de]);z[de]=Math.round(255-255*(me/this.radius+this.cutoff))}return F}};class kT{constructor(e=[],n=zT){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:a}=this,u=n[e];for(;e>0;){const d=e-1>>1,m=n[d];if(a(u,m)>=0)break;n[e]=m,e=d}n[e]=u}_down(e){const{data:n,compare:a}=this,u=this.length>>1,d=n[e];for(;e<u;){let m=1+(e<<1),v=n[m];const b=m+1;if(b<this.length&&a(n[b],v)<0&&(m=b,v=n[b]),a(v,d)>=0)break;n[e]=v,e=m}n[e]=d}}function zT(t,e){return t<e?-1:t>e?1:0}function PT(t,e=1,n=!1){let a=1/0,u=1/0,d=-1/0,m=-1/0;const v=t[0];for(let F=0;F<v.length;F++){const j=v[F];(!F||j.x<a)&&(a=j.x),(!F||j.y<u)&&(u=j.y),(!F||j.x>d)&&(d=j.x),(!F||j.y>m)&&(m=j.y)}const b=Math.min(d-a,m-u);let T=b/2;const A=new kT([],DT);if(b===0)return new D(a,u);for(let F=a;F<d;F+=b)for(let j=u;j<m;j+=b)A.push(new sc(F+T,j+T,T,t));let I=function(F){let j=0,G=0,Z=0;const Q=F[0];for(let se=0,de=Q.length,me=de-1;se<de;me=se++){const _e=Q[se],xe=Q[me],Oe=_e.x*xe.y-xe.x*_e.y;G+=(_e.x+xe.x)*Oe,Z+=(_e.y+xe.y)*Oe,j+=3*Oe}return new sc(G/j,Z/j,0,F)}(t),z=A.length;for(;A.length;){const F=A.pop();(F.d>I.d||!I.d)&&(I=F,n&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,z)),F.max-I.d<=e||(T=F.h/2,A.push(new sc(F.p.x-T,F.p.y-T,T,t)),A.push(new sc(F.p.x+T,F.p.y-T,T,t)),A.push(new sc(F.p.x-T,F.p.y+T,T,t)),A.push(new sc(F.p.x+T,F.p.y+T,T,t)),z+=4)}return n&&(console.log(`num probes: ${z}`),console.log(`best distance: ${I.d}`)),I.p}function DT(t,e){return e.max-t.max}function sc(t,e,n,a){this.p=new D(t,e),this.h=n,this.d=function(u,d){let m=!1,v=1/0;for(let b=0;b<d.length;b++){const T=d[b];for(let A=0,I=T.length,z=I-1;A<I;z=A++){const F=T[A],j=T[z];F.y>u.y!=j.y>u.y&&u.x<(j.x-F.x)*(u.y-F.y)/(j.y-F.y)+F.x&&(m=!m),v=Math.min(v,yy(u,F,j))}}return(m?1:-1)*Math.sqrt(v)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}const am=Number.POSITIVE_INFINITY,LT=Math.sqrt(2);function h0(t,e){return e[1]!==am?function(n,a,u){let d=0,m=0;switch(a=Math.abs(a),u=Math.abs(u),n){case"top-right":case"top-left":case"top":m=u-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-u}switch(n){case"top-right":case"bottom-right":case"right":d=-a;break;case"top-left":case"bottom-left":case"left":d=a}return[d,m]}(t,e[0],e[1]):function(n,a){let u=0,d=0;a<0&&(a=0);const m=a/LT;switch(n){case"top-right":case"top-left":d=m-7;break;case"bottom-right":case"bottom-left":d=7-m;break;case"bottom":d=7-a;break;case"top":d=a-7}switch(n){case"top-right":case"bottom-right":u=-m;break;case"top-left":case"bottom-left":u=m;break;case"left":u=a;break;case"right":u=-a}return[u,d]}(t,e[0])}function RT(t,e,n,a,u,d,m,v,b,T){t.createArrays(),t.tilePixelRatio=ni/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const A=t.layers[0].layout,I=t.layers[0]._unevaluatedLayout._values,z={};if(t.textSizeData.kind==="composite"){const{minZoom:G,maxZoom:Z}=t.textSizeData;z.compositeTextSizes=[I["text-size"].possiblyEvaluate(new jt(G),v),I["text-size"].possiblyEvaluate(new jt(Z),v)]}if(t.iconSizeData.kind==="composite"){const{minZoom:G,maxZoom:Z}=t.iconSizeData;z.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new jt(G),v),I["icon-size"].possiblyEvaluate(new jt(Z),v)]}z.layoutTextSize=I["text-size"].possiblyEvaluate(new jt(b+1),v),z.layoutIconSize=I["icon-size"].possiblyEvaluate(new jt(b+1),v),z.textMaxSize=I["text-size"].possiblyEvaluate(new jt(18),v);const F=A.get("text-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",j=A.get("text-size");for(const G of t.features){const Z=A.get("text-font").evaluate(G,{},v).join(","),Q=j.evaluate(G,{},v),se=z.layoutTextSize.evaluate(G,{},v),de=(z.layoutIconSize.evaluate(G,{},v),{horizontal:{},vertical:void 0}),me=G.text;let _e,xe=[0,0];if(me){const nt=me.toString(),Ye=A.get("text-letter-spacing").evaluate(G,{},v)*Rn,Re=A.get("text-line-height").evaluate(G,{},v)*Rn,Je=Ae(nt)?Ye:0,at=A.get("text-anchor").evaluate(G,{},v),je=A.get("text-variable-anchor");if(!je){const gi=A.get("text-radial-offset").evaluate(G,{},v);xe=gi?h0(at,[gi*Rn,am]):A.get("text-offset").evaluate(G,{},v).map(He=>He*Rn)}let ft=F?"center":A.get("text-justify").evaluate(G,{},v);const bt=A.get("symbol-placement"),di=bt==="point",Ri=bt==="point"?A.get("text-max-width").evaluate(G,{},v)*Rn:0,mi=gi=>{t.allowVerticalPlacement&&ze(nt)&&(de.vertical=nm(me,e,n,u,Z,Ri,Re,at,gi,Je,xe,Dr.vertical,!0,bt,se,Q))};if(!F&&je){const gi=ft==="auto"?je.map(wi=>lm(wi)):[ft];let He=!1;for(let wi=0;wi<gi.length;wi++){const vi=gi[wi];if(!de.horizontal[vi])if(He)de.horizontal[vi]=de.horizontal[0];else{const ln=nm(me,e,n,u,Z,Ri,Re,"center",vi,Je,xe,Dr.horizontal,!1,bt,se,Q);ln&&(de.horizontal[vi]=ln,He=ln.positionedLines.length===1)}}mi("left")}else{if(ft==="auto"&&(ft=lm(at)),di||A.get("text-writing-mode").indexOf("horizontal")>=0||!ze(nt)){const gi=nm(me,e,n,u,Z,Ri,Re,at,ft,Je,xe,Dr.horizontal,!1,bt,se,Q);gi&&(de.horizontal[ft]=gi)}mi(bt==="point"?"left":ft)}}let Oe=!1;if(G.icon&&G.icon.name){const nt=a[G.icon.name];nt&&(_e=CT(u[G.icon.name],A.get("icon-offset").evaluate(G,{},v),A.get("icon-anchor").evaluate(G,{},v)),Oe=nt.sdf,t.sdfIcons===void 0?t.sdfIcons=nt.sdf:t.sdfIcons!==nt.sdf&&Yt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(nt.pixelRatio!==t.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}const Pe=p0(de.horizontal)||de.vertical;t.iconsInText||(t.iconsInText=!!Pe&&Pe.iconsInText),(Pe||_e)&&OT(t,G,de,_e,a,z,se,0,xe,Oe,m,v,T)}d&&t.generateCollisionDebugBuffers(b,t.collisionBoxArray)}function lm(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function OT(t,e,n,a,u,d,m,v,b,T,A,I,z){let F=d.textMaxSize.evaluate(e,{},I);F===void 0&&(F=m);const j=t.layers[0].layout,G=j.get("icon-offset").evaluate(e,{},I),Z=p0(n.horizontal)||n.vertical,Q=m/24,se=t.tilePixelRatio*F/24,de=t.tilePixelRatio*j.get("symbol-spacing"),me=j.get("text-padding")*t.tilePixelRatio,_e=j.get("icon-padding")*t.tilePixelRatio,xe=ae(j.get("text-max-angle")),Oe=j.get("text-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",Pe=j.get("icon-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",nt=j.get("symbol-placement"),Ye=de/2,Re=j.get("icon-text-fit");let Je;a&&Re!=="none"&&(t.allowVerticalPlacement&&n.vertical&&(Je=e0(a,n.vertical,Re,j.get("icon-text-fit-padding"),G,Q)),Z&&(a=e0(a,Z,Re,j.get("icon-text-fit-padding"),G,Q)));const at=(je,ft,bt)=>{if(ft.x<0||ft.x>=ni||ft.y<0||ft.y>=ni)return;const{x:di,y:Ri,z:mi}=z.projectTilePoint(ft.x,ft.y,bt),gi=new hs(di,Ri,mi,0,void 0);(function(He,wi,vi,ln,Ji,yn,$n,Ti,li,Vi,cn,nn,dn,On,ar,lr,ji,vn,Jr,Pn,ki,xn,$i,Gn,pn){const qn=He.addToLineVertexArray(wi,ln);let tr,ir,bn,yo,uc,Nu,Uu,H0=0,X0=0,K0=0,Y0=0,Am=-1,Mm=-1;const qo={};let J0=wu(""),Im=0,km=0;if(li._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Im,km]=li.layout.get("text-offset").evaluate(ki,{},pn).map(xr=>xr*Rn):(Im=li.layout.get("text-radial-offset").evaluate(ki,{},pn)*Rn,km=am),He.allowVerticalPlacement&&Ji.vertical){const xr=Ji.vertical;if(ar)Nu=cm(xr),Ti&&(Uu=cm(Ti));else{const br=li.layout.get("text-rotate").evaluate(ki,{},pn)+90;bn=Od(Vi,vi,wi,cn,nn,dn,xr,On,br,lr),Ti&&(yo=Od(Vi,vi,wi,cn,nn,dn,Ti,vn,br))}}if(yn){const xr=li.layout.get("icon-rotate").evaluate(ki,{},pn),br=li.layout.get("icon-text-fit")!=="none",ju=c0(yn,xr,$i,br),Pm=Ti?c0(Ti,xr,$i,br):void 0;ir=Od(Vi,vi,wi,cn,nn,dn,yn,vn,xr),H0=4*ju.length;const Q0=He.iconSizeData;let Ga=null;Q0.kind==="source"?(Ga=[jo*li.layout.get("icon-size").evaluate(ki,{},pn)],Ga[0]>js&&Yt(`${He.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Q0.kind==="composite"&&(Ga=[jo*xn.compositeIconSizes[0].evaluate(ki,{},pn),jo*xn.compositeIconSizes[1].evaluate(ki,{},pn)],(Ga[0]>js||Ga[1]>js)&&Yt(`${He.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),He.addSymbols(He.icon,ju,Ga,Pn,Jr,ki,!1,vi,wi,qn.lineStartIndex,qn.lineLength,-1,Gn,pn),Am=He.icon.placedSymbolArray.length-1,Pm&&(X0=4*Pm.length,He.addSymbols(He.icon,Pm,Ga,Pn,Jr,ki,Dr.vertical,vi,wi,qn.lineStartIndex,qn.lineLength,-1,Gn,pn),Mm=He.icon.placedSymbolArray.length-1)}for(const xr in Ji.horizontal){const br=Ji.horizontal[xr];tr||(J0=wu(br.text),ar?uc=cm(br):tr=Od(Vi,vi,wi,cn,nn,dn,br,On,li.layout.get("text-rotate").evaluate(ki,{},pn),lr));const ju=br.positionedLines.length===1;if(K0+=d0(He,vi,wi,br,$n,li,ar,ki,lr,qn,Ji.vertical?Dr.horizontal:Dr.horizontalOnly,ju?Object.keys(Ji.horizontal):[xr],qo,Am,xn,Gn,pn),ju)break}Ji.vertical&&(Y0+=d0(He,vi,wi,Ji.vertical,$n,li,ar,ki,lr,qn,Dr.vertical,["vertical"],qo,Mm,xn,Gn,pn));let Zs=-1;const zm=(xr,br)=>xr?Math.max(xr,br):br;Zs=zm(uc,Zs),Zs=zm(Nu,Zs),Zs=zm(Uu,Zs);const hE=Zs>-1?1:0;He.glyphOffsetArray.length>=Vs.MAX_GLYPHS&&Yt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ki.sortKey!==void 0&&He.addToSortKeyRanges(He.symbolInstances.length,ki.sortKey),He.symbolInstances.emplaceBack(vi.x,vi.y,vi.z,wi.x,wi.y,qo.right>=0?qo.right:-1,qo.center>=0?qo.center:-1,qo.left>=0?qo.left:-1,qo.vertical>=0?qo.vertical:-1,Am,Mm,J0,tr!==void 0?tr:He.collisionBoxArray.length,tr!==void 0?tr+1:He.collisionBoxArray.length,bn!==void 0?bn:He.collisionBoxArray.length,bn!==void 0?bn+1:He.collisionBoxArray.length,ir!==void 0?ir:He.collisionBoxArray.length,ir!==void 0?ir+1:He.collisionBoxArray.length,yo||He.collisionBoxArray.length,yo?yo+1:He.collisionBoxArray.length,cn,K0,Y0,H0,X0,hE,0,Im,km,Zs)})(t,ft,gi,je,n,a,u,Je,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,me,Oe,b,0,_e,Pe,G,e,d,T,A,I)};if(nt==="line")for(const je of s0(e.geometry,0,0,ni,ni)){const ft=MT(je,de,xe,n.vertical||Z,a,24,se,t.overscaling,ni);for(const bt of ft){const di=Z;di&&BT(t,di.text,Ye,bt)||at(je,bt,I)}}else if(nt==="line-center"){for(const je of e.geometry)if(je.length>1){const ft=AT(je,xe,n.vertical||Z,a,24,se);ft&&at(je,ft,I)}}else if(e.type==="Polygon")for(const je of Xf(e.geometry,0)){const ft=PT(je,16);at(je[0],new hs(ft.x,ft.y,0,0,void 0),I)}else if(e.type==="LineString")for(const je of e.geometry)at(je,new hs(je[0].x,je[0].y,0,0,void 0),I);else if(e.type==="Point")for(const je of e.geometry)for(const ft of je)at([ft],new hs(ft.x,ft.y,0,0,void 0),I)}const js=32640;function d0(t,e,n,a,u,d,m,v,b,T,A,I,z,F,j,G,Z){const Q=function(me,_e,xe,Oe,Pe,nt,Ye,Re){const Je=[];if(_e.positionedLines.length===0)return Je;const at=Oe.layout.get("text-rotate").evaluate(nt,{})*Math.PI/180,je=function(mi){const gi=mi[0],He=mi[1],wi=gi*He;return wi>0?[gi,-He]:wi<0?[-gi,He]:gi===0?[He,gi]:[He,-gi]}(xe);let ft=Math.abs(_e.top-_e.bottom);for(const mi of _e.positionedLines)ft-=mi.lineOffset;const bt=_e.positionedLines.length,di=ft/bt;let Ri=_e.top-xe[1];for(let mi=0;mi<bt;++mi){const gi=_e.positionedLines[mi];Ri=IT(_e,di,Ri,mi);for(const He of gi.positionedGlyphs){if(!He.rect)continue;const wi=He.rect||{};let vi=4,ln=!0,Ji=1,yn=0;if(He.imageName){const $i=Ye[He.imageName];if(!$i)continue;if($i.sdf){Yt("SDF images are not supported in formatted text and will be ignored.");continue}ln=!1,Ji=$i.pixelRatio,vi=1/Ji}const $n=(Pe||Re)&&He.vertical,Ti=He.metrics.advance*He.scale/2,li=He.metrics,Vi=He.rect;if(Vi===null)continue;Re&&_e.verticalizable&&(yn=He.imageName?Ti-He.metrics.width*He.scale/2:0);const cn=Pe?[He.x+Ti,He.y]:[0,0];let nn=[0,0],dn=[0,0],On=!1;Pe||($n?(dn=[He.x+Ti+je[0],He.y+je[1]-yn],On=!0):nn=[He.x+Ti+xe[0],He.y+xe[1]-yn]);const ar=Vi.w*He.scale/(Ji*(He.localGlyph?2:1)),lr=Vi.h*He.scale/(Ji*(He.localGlyph?2:1));let ji,vn,Jr,Pn;if($n){const $i=He.y-Ri,Gn=new D(-Ti,Ti-$i),pn=-Math.PI/2,qn=new D(...dn);ji=new D(-Ti+nn[0],nn[1]),ji._rotateAround(pn,Gn)._add(qn),ji.x+=-$i+Ti,ji.y-=(li.left-vi)*He.scale;const tr=He.imageName?li.advance*He.scale:Rn*He.scale,ir=String.fromCharCode(He.glyph);uT(ir)?ji.x+=(1-vi)*He.scale:hT(ir)?ji.x+=tr-li.height*He.scale+(-vi-1)*He.scale:ji.x+=He.imageName||li.width+2*vi===Vi.w&&li.height+2*vi===Vi.h?(tr-lr)/2:(tr-(li.height+2*vi)*He.scale)/2,vn=new D(ji.x,ji.y-ar),Jr=new D(ji.x+lr,ji.y),Pn=new D(ji.x+lr,ji.y-ar)}else{const $i=(li.left-vi)*He.scale-Ti+nn[0],Gn=(-li.top-vi)*He.scale+nn[1],pn=$i+ar,qn=Gn+lr;ji=new D($i,Gn),vn=new D(pn,Gn),Jr=new D($i,qn),Pn=new D(pn,qn)}if(at){let $i;$i=Pe?new D(0,0):On?new D(je[0],je[1]):new D(xe[0],xe[1]),ji._rotateAround(at,$i),vn._rotateAround(at,$i),Jr._rotateAround(at,$i),Pn._rotateAround(at,$i)}const ki=new D(0,0),xn=new D(0,0);Je.push({tl:ji,tr:vn,bl:Jr,br:Pn,tex:wi,writingMode:_e.writingMode,glyphOffset:cn,sectionIndex:He.sectionIndex,isSDF:ln,pixelOffsetTL:ki,pixelOffsetBR:xn,minFontScaleX:0,minFontScaleY:0})}}return Je}(0,a,b,d,m,v,u,t.allowVerticalPlacement),se=t.textSizeData;let de=null;se.kind==="source"?(de=[jo*d.layout.get("text-size").evaluate(v,{},Z)],de[0]>js&&Yt(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):se.kind==="composite"&&(de=[jo*j.compositeTextSizes[0].evaluate(v,{},Z),jo*j.compositeTextSizes[1].evaluate(v,{},Z)],(de[0]>js||de[1]>js)&&Yt(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,Q,de,b,m,v,A,e,n,T.lineStartIndex,T.lineLength,F,G,Z);for(const me of I)z[me]=t.text.placedSymbolArray.length-1;return 4*Q.length}function p0(t){for(const e in t)return t[e];return null}function Od(t,e,n,a,u,d,m,v,b,T){let A=m.top,I=m.bottom,z=m.left,F=m.right;const j=m.collisionPadding;if(j&&(z-=j[0],A-=j[1],F+=j[2],I+=j[3]),b){const G=new D(z,A),Z=new D(F,A),Q=new D(z,I),se=new D(F,I),de=ae(b);let me=new D(0,0);T&&(me=new D(T[0],T[1])),G._rotateAround(de,me),Z._rotateAround(de,me),Q._rotateAround(de,me),se._rotateAround(de,me),z=Math.min(G.x,Z.x,Q.x,se.x),F=Math.max(G.x,Z.x,Q.x,se.x),A=Math.min(G.y,Z.y,Q.y,se.y),I=Math.max(G.y,Z.y,Q.y,se.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,z,A,F,I,v,a,u,d),t.length-1}function cm(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function BT(t,e,n,a){const u=t.compareText;if(e in u){const d=u[e];for(let m=d.length-1;m>=0;m--)if(a.dist(d[m])<n)return!0}else u[e]=[];return u[e].push(a),!1}const FT=Ua.VectorTileFeature.types,NT=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Bd(t,e,n,a,u,d,m,v,b,T,A,I,z,F,j,G){const Z=A?Math.min(js,Math.round(A[0])):0,Q=A?Math.min(js,Math.round(A[1])):0;t.emplaceBack(e,n,Math.round(32*m),Math.round(32*v),b,T,(Z<<1)+(I?1:0),Q,16*z,16*F,256*j,256*G,a,u,d,0)}function um(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function UT(t){for(const e of t.sections)if(Qe(e.text))return!0;return!1}class hm{constructor(e){this.layoutVertexArray=new Ef,this.indexArray=new zr,this.programConfigurations=e,this.segments=new sn,this.dynamicLayoutVertexArray=new Wl,this.opacityVertexArray=new Sf,this.placedSymbolArray=new Y_}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,a,u){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nT.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,rT.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,NT,!0),this.opacityVertexBuffer.itemSize=1),(a||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}_t("SymbolBuffers",hm);class dm{constructor(e,n,a){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new a,this.segments=new sn,this.collisionVertexArray=new Mf,this.collisionVertexArrayExt=new Wl}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,oT.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,sT.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}_t("CollisionBuffers",dm);class Vs{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(m=>m.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=we([]),this.placementViewportMatrix=we([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Qf(this.zoom,n["text-size"]),this.iconSizeData=Qf(this.zoom,n["icon-size"]);const a=this.layers[0].layout,u=a.get("symbol-sort-key"),d=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=a.get("text-writing-mode").map(m=>Dr[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=e.sourceID}createArrays(){this.text=new hm(new Ba(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new hm(new Ba(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new ey,this.lineVertexArray=new ty,this.symbolInstances=new Q_}calculateGlyphDependencies(e,n,a,u,d){for(let m=0;m<e.length;m++)if(n[e.charCodeAt(m)]=!0,u&&d){const v=ku[e.charAt(m)];v&&(n[v.charCodeAt(0)]=!0)}}populate(e,n,a,u){const d=this.layers[0],m=d.layout,v=m.get("text-font"),b=m.get("text-field"),T=m.get("icon-image"),A=(b.value.kind!=="constant"||b.value.value instanceof Gt&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),I=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,z=m.get("symbol-sort-key");if(this.features=[],!A&&!I)return;const F=n.iconDependencies,j=n.glyphDependencies,G=n.availableImages,Z=new jt(this.zoom);for(const{feature:Q,id:se,index:de,sourceLayerIndex:me}of e){const _e=d._featureFilter.needGeometry,xe=Na(Q,_e);if(!d._featureFilter.filter(Z,xe,a))continue;let Oe,Pe;if(_e||(xe.geometry=cs(Q,a,u)),A){const Ye=d.getValueAndResolveTokens("text-field",xe,a,G),Re=Gt.factory(Ye);UT(Re)&&(this.hasRTLText=!0),(!this.hasRTLText||_r()==="unavailable"||this.hasRTLText&&fi.isParsed())&&(Oe=cT(Re,d,xe))}if(I){const Ye=d.getValueAndResolveTokens("icon-image",xe,a,G);Pe=Ye instanceof fr?Ye:fr.fromString(Ye)}if(!Oe&&!Pe)continue;const nt=this.sortFeaturesByKey?z.evaluate(xe,{},a):void 0;if(this.features.push({id:se,text:Oe,icon:Pe,index:de,sourceLayerIndex:me,geometry:xe.geometry,properties:Q.properties,type:FT[Q.type],sortKey:nt}),Pe&&(F[Pe.name]=!0),Oe){const Ye=v.evaluate(xe,{},a).join(","),Re=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Dr.vertical)>=0;for(const Je of Oe.sections)if(Je.image)F[Je.image.name]=!0;else{const at=ze(Oe.toString()),je=Je.fontStack||Ye,ft=j[je]=j[je]||{};this.calculateGlyphDependencies(Je.text,ft,Re,this.allowVerticalPlacement,at)}}}m.get("symbol-placement")==="line"&&(this.features=function(Q){const se={},de={},me=[];let _e=0;function xe(Ye){me.push(Q[Ye]),_e++}function Oe(Ye,Re,Je){const at=de[Ye];return delete de[Ye],de[Re]=at,me[at].geometry[0].pop(),me[at].geometry[0]=me[at].geometry[0].concat(Je[0]),at}function Pe(Ye,Re,Je){const at=se[Re];return delete se[Re],se[Ye]=at,me[at].geometry[0].shift(),me[at].geometry[0]=Je[0].concat(me[at].geometry[0]),at}function nt(Ye,Re,Je){const at=Je?Re[0][Re[0].length-1]:Re[0][0];return`${Ye}:${at.x}:${at.y}`}for(let Ye=0;Ye<Q.length;Ye++){const Re=Q[Ye],Je=Re.geometry,at=Re.text?Re.text.toString():null;if(!at){xe(Ye);continue}const je=nt(at,Je),ft=nt(at,Je,!0);if(je in de&&ft in se&&de[je]!==se[ft]){const bt=Pe(je,ft,Je),di=Oe(je,ft,me[bt].geometry);delete se[je],delete de[ft],de[nt(at,me[di].geometry,!0)]=di,me[bt].geometry=null}else je in de?Oe(je,ft,Je):ft in se?Pe(je,ft,Je):(xe(Ye),se[je]=_e-1,de[ft]=_e-1)}return me.filter(Ye=>Ye.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Q,se)=>Q.sortKey-se.sortKey)}update(e,n,a,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,a,u),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,a,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const a=this.lineVertexArray.length;if(e.segment!==void 0){let u=e.dist(n[e.segment+1]),d=e.dist(n[e.segment]);const m={};for(let v=e.segment+1;v<n.length;v++)m[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:u},v<n.length-1&&(u+=n[v+1].dist(n[v]));for(let v=e.segment||0;v>=0;v--)m[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:d},v>0&&(d+=n[v-1].dist(n[v]));for(let v=0;v<n.length;v++){const b=m[v];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,n,a,u,d,m,v,b,T,A,I,z,F,j){const G=e.indexArray,Z=e.layoutVertexArray,Q=e.segments.prepareSegment(4*n.length,Z,G,this.canOverlap?m.sortKey:void 0),se=this.glyphOffsetArray.length,de=Q.vertexLength,me=this.allowVerticalPlacement&&v===Dr.vertical?Math.PI/2:0,_e=m.text&&m.text.sections;for(let xe=0;xe<n.length;xe++){const{tl:Oe,tr:Pe,bl:nt,br:Ye,tex:Re,pixelOffsetTL:Je,pixelOffsetBR:at,minFontScaleX:je,minFontScaleY:ft,glyphOffset:bt,isSDF:di,sectionIndex:Ri}=n[xe],mi=Q.vertexLength,gi=bt[1];Bd(Z,b.x,b.y,b.z,T.x,T.y,Oe.x,gi+Oe.y,Re.x,Re.y,a,di,Je.x,Je.y,je,ft),Bd(Z,b.x,b.y,b.z,T.x,T.y,Pe.x,gi+Pe.y,Re.x+Re.w,Re.y,a,di,at.x,Je.y,je,ft),Bd(Z,b.x,b.y,b.z,T.x,T.y,nt.x,gi+nt.y,Re.x,Re.y+Re.h,a,di,Je.x,at.y,je,ft),Bd(Z,b.x,b.y,b.z,T.x,T.y,Ye.x,gi+Ye.y,Re.x+Re.w,Re.y+Re.h,a,di,at.x,at.y,je,ft),um(e.dynamicLayoutVertexArray,b,me),G.emplaceBack(mi,mi+1,mi+2),G.emplaceBack(mi+1,mi+2,mi+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(bt[0]),xe!==n.length-1&&Ri===n[xe+1].sectionIndex||e.programConfigurations.populatePaintArrays(Z.length,m,m.index,{},F,j,_e&&_e[Ri])}e.placedSymbolArray.emplaceBack(b.x,b.y,b.z,T.x,T.y,se,this.glyphOffsetArray.length-se,de,A,I,T.segment,a?a[0]:0,a?a[1]:0,u[0],u[1],v,0,!1,0,z,0)}_commitLayoutVertex(e,n,a,u,d,m,v){e.emplaceBack(n,a,u,d,m,Math.round(v.x),Math.round(v.y))}_addCollisionDebugVertices(e,n,a,u,d,m,v){const b=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),T=b.vertexLength,A=v.tileAnchorX,I=v.tileAnchorY;for(let F=0;F<4;F++)a.collisionVertexArray.emplaceBack(0,0,0,0);a.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),a.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(a.layoutVertexArray,u,d,m,A,I,new D(e.x1,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,u,d,m,A,I,new D(e.x2,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,u,d,m,A,I,new D(e.x2,e.y2)),this._commitLayoutVertex(a.layoutVertexArray,u,d,m,A,I,new D(e.x1,e.y2)),b.vertexLength+=4;const z=a.indexArray;z.emplaceBack(T,T+1),z.emplaceBack(T+1,T+2),z.emplaceBack(T+2,T+3),z.emplaceBack(T+3,T),b.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,a,u,d,m){for(let v=u;v<d;v++){const b=a.get(v),T=this.getSymbolInstanceTextSize(e,m,n,v);this._addCollisionDebugVertices(b,T,this.textCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(e,n,a,u,d,m){for(let v=u;v<d;v++){const b=a.get(v),T=this.getSymbolInstanceIconSize(e,n,v);this._addCollisionDebugVertices(b,T,this.iconCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,m)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new dm(dd,jy.members,Bs),this.iconCollisionBox=new dm(dd,jy.members,Bs);const a=tc(this.iconSizeData,e),u=tc(this.textSizeData,e);for(let d=0;d<this.symbolInstances.length;d++){const m=this.symbolInstances.get(d);this._addTextDebugCollisionBoxes(u,e,n,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(u,e,n,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(a,e,n,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(a,e,n,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(e,n,a,u){const d=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:u),m=kd(this.textSizeData,e,d)/Rn;return this.tilePixelRatio*m}getSymbolInstanceIconSize(e,n,a){const u=this.icon.placedSymbolArray.get(a),d=kd(this.iconSizeData,e,u);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(e,n,a){e.emplaceBack(n,-a,-a),e.emplaceBack(n,a,-a),e.emplaceBack(n,a,a),e.emplaceBack(n,-a,a)}_updateTextDebugCollisionBoxes(e,n,a,u,d,m){for(let v=u;v<d;v++){const b=a.get(v),T=this.getSymbolInstanceTextSize(e,m,n,v);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,b.padding)}}_updateIconDebugCollisionBoxes(e,n,a,u,d){for(let m=u;m<d;m++){const v=a.get(m),b=this.getSymbolInstanceIconSize(e,n,m);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,v.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const a=tc(this.iconSizeData,e),u=tc(this.textSizeData,e);for(let d=0;d<this.symbolInstances.length;d++){const m=this.symbolInstances.get(d);this._updateTextDebugCollisionBoxes(u,e,n,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(u,e,n,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(a,e,n,m.iconBoxStartIndex,m.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(a,e,n,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,a,u,d,m,v,b,T){const A={};for(let I=n;I<a;I++){const z=e.get(I);A.textBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},A.textFeatureIndex=z.featureIndex;break}for(let I=u;I<d;I++){const z=e.get(I);A.verticalTextBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},A.verticalTextFeatureIndex=z.featureIndex;break}for(let I=m;I<v;I++){const z=e.get(I);A.iconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},A.iconFeatureIndex=z.featureIndex;break}for(let I=b;I<T;I++){const z=e.get(I);A.verticalIconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},A.verticalIconFeatureIndex=z.featureIndex;break}return A}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const a=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const a=e.placedSymbolArray.get(n),u=a.vertexStartIndex+4*a.numGlyphs;for(let d=a.vertexStartIndex;d<u;d+=4)e.indexArray.emplaceBack(d,d+1,d+2),e.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),a=Math.cos(e),u=[],d=[],m=[];for(let v=0;v<this.symbolInstances.length;++v){m.push(v);const b=this.symbolInstances.get(v);u.push(0|Math.round(n*b.tileAnchorX+a*b.tileAnchorY)),d.push(b.featureIndex)}return m.sort((v,b)=>u[v]-u[b]||d[b]-d[v]),m}addToSortKeyRanges(e,n){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===n?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const a=this.symbolInstances.get(n);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((u,d,m)=>{u>=0&&m.indexOf(u)===d&&this.addIndicesForPlacedSymbol(this.text,u)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}_t("SymbolBucket",Vs,{omit:["layers","collisionBoxArray","features","compareText"]}),Vs.MAX_GLYPHS=65535,Vs.addDynamicAttributes=um;const jT=new zn({"symbol-placement":new xt(ke.layout_symbol["symbol-placement"]),"symbol-spacing":new xt(ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new xt(ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Pt(ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new xt(ke.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new xt(ke.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new xt(ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new xt(ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new xt(ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new Pt(ke.layout_symbol["icon-size"]),"icon-text-fit":new xt(ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new xt(ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new Pt(ke.layout_symbol["icon-image"]),"icon-rotate":new Pt(ke.layout_symbol["icon-rotate"]),"icon-padding":new xt(ke.layout_symbol["icon-padding"]),"icon-keep-upright":new xt(ke.layout_symbol["icon-keep-upright"]),"icon-offset":new Pt(ke.layout_symbol["icon-offset"]),"icon-anchor":new Pt(ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new xt(ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new xt(ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new xt(ke.layout_symbol["text-rotation-alignment"]),"text-field":new Pt(ke.layout_symbol["text-field"]),"text-font":new Pt(ke.layout_symbol["text-font"]),"text-size":new Pt(ke.layout_symbol["text-size"]),"text-max-width":new Pt(ke.layout_symbol["text-max-width"]),"text-line-height":new Pt(ke.layout_symbol["text-line-height"]),"text-letter-spacing":new Pt(ke.layout_symbol["text-letter-spacing"]),"text-justify":new Pt(ke.layout_symbol["text-justify"]),"text-radial-offset":new Pt(ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new xt(ke.layout_symbol["text-variable-anchor"]),"text-anchor":new Pt(ke.layout_symbol["text-anchor"]),"text-max-angle":new xt(ke.layout_symbol["text-max-angle"]),"text-writing-mode":new xt(ke.layout_symbol["text-writing-mode"]),"text-rotate":new Pt(ke.layout_symbol["text-rotate"]),"text-padding":new xt(ke.layout_symbol["text-padding"]),"text-keep-upright":new xt(ke.layout_symbol["text-keep-upright"]),"text-transform":new Pt(ke.layout_symbol["text-transform"]),"text-offset":new Pt(ke.layout_symbol["text-offset"]),"text-allow-overlap":new xt(ke.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new xt(ke.layout_symbol["text-ignore-placement"]),"text-optional":new xt(ke.layout_symbol["text-optional"])});var pm={paint:new zn({"icon-opacity":new Pt(ke.paint_symbol["icon-opacity"]),"icon-color":new Pt(ke.paint_symbol["icon-color"]),"icon-halo-color":new Pt(ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new Pt(ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Pt(ke.paint_symbol["icon-halo-blur"]),"icon-translate":new xt(ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new xt(ke.paint_symbol["icon-translate-anchor"]),"text-opacity":new Pt(ke.paint_symbol["text-opacity"]),"text-color":new Pt(ke.paint_symbol["text-color"],{runtimeType:Wr,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new Pt(ke.paint_symbol["text-halo-color"]),"text-halo-width":new Pt(ke.paint_symbol["text-halo-width"]),"text-halo-blur":new Pt(ke.paint_symbol["text-halo-blur"]),"text-translate":new xt(ke.paint_symbol["text-translate"]),"text-translate-anchor":new xt(ke.paint_symbol["text-translate-anchor"])}),layout:jT};class f0{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:zo,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}_t("FormatSectionOverride",f0,{omit:["defaultValue"]});class Fd extends fo{constructor(e){super(e,pm)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const a=this.layout.get("text-writing-mode");if(a){const u=[];for(const d of a)u.indexOf(d)<0&&u.push(d);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,a,u){const d=this.layout.get(e).evaluate(n,{},a,u),m=this._unevaluatedLayout._values[e];return m.isDataDriven()||Ms(m.value)||!d?d:function(v,b){return b.replace(/{([^{}]+)}/g,(T,A)=>A in v?String(v[A]):"")}(n.properties,d)}createBucket(e){return new Vs(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of pm.paint.overridableProperties){if(!Fd.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),a=new f0(n),u=new su(a,n.property.specification);let d=null;d=n.value.kind==="constant"||n.value.kind==="source"?new Ia("source",u):new au("composite",u,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new er(n.property,d,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,a){return!(!this.layout||n.isDataDriven()||a.isDataDriven())&&Fd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const a=e.get("text-field"),u=pm.paint.properties[n];let d=!1;const m=v=>{for(const b of v)if(u.overrides&&u.overrides.hasOverride(b))return void(d=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Gt)m(a.value.value.sections);else if(a.value.kind==="source"){const v=T=>{d||(T instanceof Do&&rn(T.value)===Po?m(T.value.sections):T instanceof Hr?m(T.sections):T.eachChild(v))},b=a.value;b._styleExpression&&v(b._styleExpression.expression)}return d}getProgramConfiguration(e){return new as(this,e)}}var VT={paint:new zn({"background-color":new xt(ke.paint_background["background-color"]),"background-pattern":new rs(ke.paint_background["background-pattern"]),"background-opacity":new xt(ke.paint_background["background-opacity"])})},$T={paint:new zn({"raster-opacity":new xt(ke.paint_raster["raster-opacity"]),"raster-hue-rotate":new xt(ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new xt(ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new xt(ke.paint_raster["raster-brightness-max"]),"raster-saturation":new xt(ke.paint_raster["raster-saturation"]),"raster-contrast":new xt(ke.paint_raster["raster-contrast"]),"raster-resampling":new xt(ke.paint_raster["raster-resampling"]),"raster-fade-duration":new xt(ke.paint_raster["raster-fade-duration"])})};class GT extends fo{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var qT={paint:new zn({"sky-type":new xt(ke.paint_sky["sky-type"]),"sky-atmosphere-sun":new xt(ke.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new xt(ke.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new xt(ke.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new xt(ke.paint_sky["sky-gradient-radius"]),"sky-gradient":new No(ke.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new xt(ke.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new xt(ke.paint_sky["sky-atmosphere-color"]),"sky-opacity":new xt(ke.paint_sky["sky-opacity"])})};function fm(t,e,n){const a=Tt(0,0,1),u=ui(At());return function(d,m,v){v*=.5;var b=m[0],T=m[1],A=m[2],I=m[3],z=Math.sin(v),F=Math.cos(v);d[0]=b*F-A*z,d[1]=T*F+I*z,d[2]=A*F+b*z,d[3]=I*F-T*z}(u,u,n?-ae(t)+Math.PI:ae(t)),pi(u,u,-ae(e)),en(a,a,u),ei(a,a)}const ZT={circle:class extends fo{constructor(t){super(t,m2)}createBucket(t){return new Nf(t)}queryRadius(t){const e=t;return Jl("circle-radius",this,e)+Jl("circle-stroke-width",this,e)+wd(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,a,u,d,m,v){const b=wy(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,t.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return Ty(t,a,d,m,v,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",b,T)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new as(this,t)}},heatmap:class extends fo{createBucket(t){return new Sy(t)}constructor(t){super(t,v2),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=qf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return Jl("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,a,u,d,m,v){const b=this.paint.get("heatmap-radius").evaluate(e,n);return Ty(t,a,d,m,v,!0,!0,new D(0,0),b)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new as(this,t)}},hillshade:class extends fo{constructor(t){super(t,x2)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(t){return new as(this,t)}},fill:class extends fo{constructor(t){super(t,B2)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new as(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Md(t)}queryRadius(){return wd(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,a,u,d){return!t.queryGeometry.isAboveHorizon&&_y(by(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,t.pixelToTileUnitsFactor),a)}isTileClipped(){return!0}},"fill-extrusion":class extends fo{constructor(t){super(t,H2)}createBucket(t){return new Jf(t)}queryRadius(){return wd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new as(this,t)}queryIntersectsFeature(t,e,n,a,u,d,m,v,b){const T=wy(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,t.pixelToTileUnitsFactor),A=this.paint.get("fill-extrusion-height").evaluate(e,n),I=this.paint.get("fill-extrusion-base").evaluate(e,n),z=[0,0],F=v&&d.elevation,j=d.elevation?d.elevation.exaggeration():1;if(F){const Q=t.tile.getBucket(this).centroidVertexArray,se=b+1;if(se<Q.length){const de=Q.get(se);z[0]=de.a_centroid_pos0,z[1]=de.a_centroid_pos1}}if(z[0]===0&&z[1]===1)return!1;const G=function(Q,se,de,me,_e,xe,Oe,Pe,nt){return xe?function(Ye,Re,Je,at,je,ft,bt,di,Ri){const mi=[],gi=[],He=[0,0,0,1];for(const wi of Ye){const vi=[],ln=[];for(const Ji of wi){const yn=Ji.x+at.x,$n=Ji.y+at.y,Ti=X2(yn,$n,Re,Je,ft,bt,di,Ri);He[0]=yn,He[1]=$n,He[2]=Ti.base,He[3]=1,rt(He,He,je),He[3]=Math.max(He[3],1e-5);const li=By([He[0]/He[3],He[1]/He[3],He[2]/He[3]]);He[0]=yn,He[1]=$n,He[2]=Ti.top,He[3]=1,rt(He,He,je),He[3]=Math.max(He[3],1e-5);const Vi=By([He[0]/He[3],He[1]/He[3],He[2]/He[3]]);vi.push(li),ln.push(Vi)}mi.push(vi),gi.push(ln)}return[mi,gi]}(Q,se,de,me,_e,xe,Oe,Pe,nt):function(Ye,Re,Je,at,je){const ft=[],bt=[],di=je[8]*Re,Ri=je[9]*Re,mi=je[10]*Re,gi=je[11]*Re,He=je[8]*Je,wi=je[9]*Je,vi=je[10]*Je,ln=je[11]*Je;for(const Ji of Ye){const yn=[],$n=[];for(const Ti of Ji){const li=Ti.x+at.x,Vi=Ti.y+at.y,cn=je[0]*li+je[4]*Vi+je[12],nn=je[1]*li+je[5]*Vi+je[13],dn=je[2]*li+je[6]*Vi+je[14],On=je[3]*li+je[7]*Vi+je[15],ar=cn+di,lr=nn+Ri,ji=dn+mi,vn=Math.max(On+gi,1e-5),Jr=cn+He,Pn=nn+wi,ki=dn+vi,xn=Math.max(On+ln,1e-5),$i=new D(ar/vn,lr/vn);$i.z=ji/vn,yn.push($i);const Gn=new D(Jr/xn,Pn/xn);Gn.z=ki/xn,$n.push(Gn)}ft.push(yn),bt.push($n)}return[ft,bt]}(Q,se,de,me,_e)}(a,I,A,T,m,F?v:null,z,j,d.center.lat),Z=t.queryGeometry;return function(Q,se,de){let me=1/0;_y(de,se)&&(me=Oy(de,se[0]));for(let _e=0;_e<se.length;_e++){const xe=se[_e],Oe=Q[_e];for(let Pe=0;Pe<xe.length-1;Pe++){const nt=xe[Pe],Ye=[nt,xe[Pe+1],Oe[Pe+1],Oe[Pe],nt];gy(de,Ye)&&(me=Math.min(me,Oy(de,Ye)))}}return me!==1/0&&me}(G[0],G[1],Z.isPointQuery()?Z.screenBounds:Z.screenGeometry)}},line:class extends fo{constructor(t){super(t,Fy),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof xa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Ny.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Id(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new as(this,t)}queryRadius(t){const e=t,n=Uy(Jl("line-width",this,e),Jl("line-gap-width",this,e)),a=Jl("line-offset",this,e);return n/2+Math.abs(a)+wd(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,a,u,d){if(t.queryGeometry.isAboveHorizon)return!1;const m=by(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,t.pixelToTileUnitsFactor),v=t.pixelToTileUnitsFactor/2*Uy(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),b=this.paint.get("line-offset").evaluate(e,n);return b&&(a=function(T,A){const I=[],z=new D(0,0);for(let F=0;F<T.length;F++){const j=T[F],G=[];for(let Z=0;Z<j.length;Z++){const Q=j[Z-1],se=j[Z],de=j[Z+1],me=Z===0?z:se.sub(Q)._unit()._perp(),_e=Z===j.length-1?z:de.sub(se)._unit()._perp(),xe=me._add(_e)._unit();xe._mult(1/(xe.x*_e.x+xe.y*_e.y)),G.push(xe._mult(A)._add(se))}I.push(G)}return I}(a,b*t.pixelToTileUnitsFactor)),function(T,A,I){for(let z=0;z<A.length;z++){const F=A[z];if(T.length>=3){for(let j=0;j<F.length;j++)if(Yl(T,F[j]))return!0}if(h2(T,F,I))return!0}return!1}(m,a,v)}isTileClipped(){return!0}},symbol:Fd,background:class extends fo{constructor(t){super(t,VT)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends fo{constructor(t){super(t,$T)}getProgramIds(){return["raster"]}},sky:class extends fo{constructor(t){super(t,qT),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=qf({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(t,e){const n=this.paint.get("sky-type");if(n==="atmosphere"){const a=this.paint.get("sky-atmosphere-sun"),u=!a,d=t.style.light,m=d.properties.get("position");return u&&d.properties.get("anchor")==="viewport"&&Yt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?fm(m.azimuthal,90-m.polar,e):fm(a[0],90-a[1],e)}if(n==="gradient"){const a=this.paint.get("sky-gradient-center");return fm(a[0],90-a[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}}},{HTMLImageElement:m0,HTMLCanvasElement:g0,HTMLVideoElement:_0,ImageData:y0,ImageBitmap:Nd}=U;class Ud{constructor(e,n,a,u){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(n,u)}update(e,n,a){const{width:u,height:d}=e,{context:m}=this,{gl:v}=m;if(v.bindTexture(v.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!n||n.premultiply!==!1)),a||this.size&&this.size[0]===u&&this.size[1]===d){const{x:b,y:T}=a||{x:0,y:0};e instanceof m0||e instanceof g0||e instanceof _0||e instanceof y0||Nd&&e instanceof Nd?v.texSubImage2D(v.TEXTURE_2D,0,b,T,v.RGBA,v.UNSIGNED_BYTE,e):v.texSubImage2D(v.TEXTURE_2D,0,b,T,u,d,v.RGBA,v.UNSIGNED_BYTE,e.data)}else this.size=[u,d],e instanceof m0||e instanceof g0||e instanceof _0||e instanceof y0||Nd&&e instanceof Nd?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,e):v.texImage2D(v.TEXTURE_2D,0,this.format,u,d,0,this.format,v.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(e,n){const{context:a}=this,{gl:u}=a;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),n!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class mm{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new Ns({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const a=this.getKey(e,n);return this.positions[a]}trim(){const e=this.width,n=this.height=Wt(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,a){const u=[];let d=e.length%2==1?-e[e.length-1]*a:0,m=e[0]*a,v=!0;u.push({left:d,right:m,isDash:v,zeroLength:e[0]===0});let b=e[0];for(let T=1;T<e.length;T++){v=!v;const A=e[T];d=b*a,b+=A,m=b*a,u.push({left:d,right:m,isDash:v,zeroLength:A===0})}return u}addRoundDash(e,n,a){const u=n/2;for(let d=-a;d<=a;d++){const m=this.width*(this.nextRow+a+d);let v=0,b=e[v];for(let T=0;T<this.width;T++){T/b.right>1&&(b=e[++v]);const A=Math.abs(T-b.left),I=Math.abs(T-b.right),z=Math.min(A,I);let F;const j=d/a*(u+1);if(b.isDash){const G=u-Math.abs(j);F=Math.sqrt(z*z+G*G)}else F=u-Math.sqrt(z*z+j*j);this.image.data[m+T]=Math.max(0,Math.min(255,F+128))}}}addRegularDash(e,n){for(let b=e.length-1;b>=0;--b){const T=e[b],A=e[b+1];T.zeroLength?e.splice(b,1):A&&A.isDash===T.isDash&&(A.left=T.left,e.splice(b,1))}const a=e[0],u=e[e.length-1];a.isDash===u.isDash&&(a.left=u.left-this.width,u.right=a.right+this.width);const d=this.width*this.nextRow;let m=0,v=e[m];for(let b=0;b<this.width;b++){b/v.right>1&&(v=e[++m]);const T=Math.abs(b-v.left),A=Math.abs(b-v.right),I=Math.min(T,A);this.image.data[d+b]=Math.max(0,Math.min(255,(v.isDash?I:-I)+n+128))}}addDash(e,n){const a=this.getKey(e,n);if(this.positions[a])return this.positions[a];const u=n==="round",d=u?7:0,m=2*d+1;if(this.nextRow+m>this.height)return Yt("LineAtlas out of space"),null;e.length===0&&e.push(1);let v=0;for(let A=0;A<e.length;A++)e[A]<0&&(Yt("Negative value is found in line dasharray, replacing values with 0"),e[A]=0),v+=e[A];if(v!==0){const A=this.width/v,I=this.getDashRanges(e,this.width,A);u?this.addRoundDash(I,A,d):this.addRegularDash(I,n==="square"?.5*A:0)}const b=this.nextRow+d;this.nextRow+=m;const T={tl:[b,d],br:[v,0]};return this.positions[a]=T,T}}_t("LineAtlas",mm);class WT{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const HT=U.performance;function v0(t){const e=t?t.url.toString():void 0;return HT.getEntriesByName(e)}class XT{constructor(){this.tasks={},this.taskQueue=[],Ki(["process"],this),this.invoker=new WT(this.process),this.nextId=0}add(e,n){const a=this.nextId++,u=function({type:d,isSymbolTile:m,zoom:v}){return v=v||0,d==="message"?0:d!=="maybePrepare"||m?d!=="parseTile"||m?d==="parseTile"&&m?300-v:d==="maybePrepare"&&m?400-v:500:200-v:100-v}(n);if(u===0){Xn();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[a]={fn:e,metadata:n,priority:u,id:a},this.taskQueue.push(a),this.invoker.trigger(),{cancel:()=>{delete this.tasks[a]}}}process(){Xn();try{if(this.taskQueue=this.taskQueue.filter(a=>!!this.tasks[a]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let u=0;u<this.taskQueue.length;u++){const d=this.tasks[this.taskQueue[u]];d.priority<n&&(n=d.priority,e=u)}if(e===null)return null;const a=this.taskQueue[e];return this.taskQueue.splice(e,1),a}remove(){this.invoker.remove()}}function x0(t,e,n){var a=2*Math.PI*6378137/256/Math.pow(2,n);return[t*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class jd{constructor(e,n,a){this.z=e,this.x=n,this.y=a,this.key=Lu(0,e,e,n,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const a=function(d,m,v){var b=x0(256*d,256*(m=Math.pow(2,v)-m-1),v),T=x0(256*(d+1),256*(m+1),v);return b[0]+","+b[1]+","+T[0]+","+T[1]}(this.x,this.y,this.z),u=function(d,m,v){let b,T="";for(let A=d;A>0;A--)b=1<<A-1,T+=(m&b?1:0)+(v&b?2:0);return T}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",a)}toString(){return`${this.z}/${this.x}/${this.y}`}}class gm{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Lu(e,n.z,n.z,n.x,n.y)}}class sr{constructor(e,n,a,u,d){this.overscaledZ=e,this.wrap=n,this.canonical=new jd(a,+u,+d),this.key=n===0&&e===a?this.canonical.key:Lu(n,e,a,u,d)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new sr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new sr(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return Lu(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const a=this.canonical.z-e;return Lu(this.wrap*+n,e,e,this.canonical.x>>a,this.canonical.y>>a)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new sr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,a=2*this.canonical.x,u=2*this.canonical.y;return[new sr(n,this.wrap,n,a,u),new sr(n,this.wrap,n,a+1,u),new sr(n,this.wrap,n,a,u+1),new sr(n,this.wrap,n,a+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new sr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new sr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new gm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Lu(t,e,n,a,u){const d=1<<Math.min(n,22);let m=d*(u%d)+a%d;return t&&n<22&&(m+=d*d*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*m+n)+(e-n)}_t("CanonicalTileID",jd),_t("OverscaledTileID",sr,{omit:["projMatrix"]});class ac{constructor(e,n,a){this.func=e,this.mask=n,this.range=a}}ac.ReadOnly=!1,ac.ReadWrite=!0,ac.disabled=new ac(519,ac.ReadOnly,[0,1]);const _m=7680;class ym{constructor(e,n,a,u,d,m){this.test=e,this.ref=n,this.mask=a,this.fail=u,this.depthFail=d,this.pass=m}}ym.disabled=new ym({func:519,mask:0},0,0,_m,_m,_m);class Vo{constructor(e,n,a){this.blendFunction=e,this.blendColor=n,this.mask=a}}Vo.Replace=[1,0],Vo.disabled=new Vo(Vo.Replace,yi.transparent,[!1,!1,!1,!1]),Vo.unblended=new Vo(Vo.Replace,yi.transparent,[!0,!0,!0,!0]),Vo.alphaBlended=new Vo([1,771],yi.transparent,[!0,!0,!0,!0]);const vm=1029,xm=2305;class _o{constructor(e,n,a){this.enable=e,this.mode=n,this.frontFace=a}}_o.disabled=new _o(!1,vm,xm),_o.backCCW=new _o(!0,vm,xm),_o.backCW=new _o(!0,vm,2304),_o.frontCW=new _o(!0,1028,2304),_o.frontCCW=new _o(!0,1028,xm);class b0{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const a=e[n];this._stringToNumber[a]=n,this._numberToString[n]=a}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}class w0{constructor(e,n,a,u,d){this.type="Feature",this._vectorTileFeature=e,e._z=n,e._x=a,e._y=u,this.properties=e.properties,this.id=d}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(e[n]=this[n]);return e}}class KT{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,a){const u=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},dt(this.stateChanges[e][u],a),this.deletedStates[e]===null){this.deletedStates[e]={};for(const d in this.state[e])d!==u&&(this.deletedStates[e][d]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const d in this.state[e][u])a[d]||(this.deletedStates[e][u][d]=null)}else for(const d in a)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][d]===null&&delete this.deletedStates[e][u][d]}removeFeatureState(e,n,a){if(this.deletedStates[e]===null)return;const u=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&n!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][a]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(a in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][a]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,n){const a=String(n),u=dt({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const d=this.deletedStates[e][n];if(d===null)return{};for(const m in d)delete u[m]}return u}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const a={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const d={};for(const m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),dt(this.state[u][m],this.stateChanges[u][m]),d[m]=this.state[u][m];a[u]=d}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const d={};if(this.deletedStates[u]===null)for(const m in this.state[u])d[m]={},this.state[u][m]={};else for(const m in this.deletedStates[u]){if(this.deletedStates[u][m]===null)this.state[u][m]={};else for(const v of Object.keys(this.deletedStates[u][m]))delete this.state[u][m][v];d[m]=this.state[u][m]}a[u]=a[u]||{},dt(a[u],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(a).length!==0)for(const u in e)e[u].setFeatureState(a,n)}}class T0{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const a=this.toIdx(e,n);return{min:this.minimums[a],max:this.maximums[a]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function E0(t,e,n,a){let u=0,d=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(a[m])<1e-15){if(n[m]<t[m]||n[m]>e[m])return null}else{const v=1/a[m];let b=(t[m]-n[m])*v,T=(e[m]-n[m])*v;if(b>T){const A=b;b=T,T=A}if(b>u&&(u=b),T<d&&(d=T),u>d)return null}return u}function S0(t,e,n,a,u,d,m,v,b,T,A){const I=a-t,z=u-e,F=d-n,j=m-t,G=v-e,Z=b-n,Q=A[1]*Z-A[2]*G,se=A[2]*j-A[0]*Z,de=A[0]*G-A[1]*j,me=I*Q+z*se+F*de;if(Math.abs(me)<1e-15)return null;const _e=1/me,xe=T[0]-t,Oe=T[1]-e,Pe=T[2]-n,nt=(xe*Q+Oe*se+Pe*de)*_e;if(nt<0||nt>1)return null;const Ye=Oe*F-Pe*z,Re=Pe*I-xe*F,Je=xe*z-Oe*I,at=(A[0]*Ye+A[1]*Re+A[2]*Je)*_e;return at<0||nt+at>1?null:(j*Ye+G*Re+Z*Je)*_e}function C0(t,e,n){return(t-e)/(n-e)}function A0(t,e,n,a,u,d,m,v,b){const T=1<<n,A=d-a,I=m-u,z=(t+1)/T*A+a,F=(e+0)/T*I+u,j=(e+1)/T*I+u;v[0]=(t+0)/T*A+a,v[1]=F,b[0]=z,b[1]=j}class M0{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(d){const m=Math.ceil(Math.log2(d.dim/8)),v=[];let b=Math.ceil(Math.pow(2,m));const T=1/b,A=(F,j,G,Z,Q)=>{const se=Z?1:0,de=(F+1)*G-se,me=j*G,_e=(j+1)*G-se;Q[0]=F*G,Q[1]=me,Q[2]=de,Q[3]=_e};let I=new T0(b);const z=[];for(let F=0;F<b*b;F++){A(F%b,Math.floor(F/b),T,!1,z);const j=$s(z[0],z[1],d),G=$s(z[2],z[1],d),Z=$s(z[2],z[3],d),Q=$s(z[0],z[3],d);I.minimums.push(Math.min(j,G,Z,Q)),I.maximums.push(Math.max(j,G,Z,Q)),I.leaves.push(1)}for(v.push(I),b/=2;b>=1;b/=2){const F=v[v.length-1];I=new T0(b);for(let j=0;j<b*b;j++){A(j%b,Math.floor(j/b),2,!0,z);const G=F.getElevation(z[0],z[1]),Z=F.getElevation(z[2],z[1]),Q=F.getElevation(z[2],z[3]),se=F.getElevation(z[0],z[3]),de=F.isLeaf(z[0],z[1]),me=F.isLeaf(z[2],z[1]),_e=F.isLeaf(z[2],z[3]),xe=F.isLeaf(z[0],z[3]),Oe=Math.min(G.min,Z.min,Q.min,se.min),Pe=Math.max(G.max,Z.max,Q.max,se.max),nt=de&&me&&_e&&xe;I.maximums.push(Pe),I.minimums.push(Oe),I.leaves.push(Pe-Oe<=5&&nt?1:0)}v.push(I)}return v}(this.dem),a=n.length-1,u=n[a];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(n,0,0,a,0)}raycastRoot(e,n,a,u,d,m,v=1){return E0([e,n,-100],[a,u,this.maximums[0]*v],d,m)}raycast(e,n,a,u,d,m,v=1){if(!this.nodeCount)return null;const b=this.raycastRoot(e,n,a,u,d,m,v);if(b==null)return null;const T=[],A=[],I=[],z=[],F=[{idx:0,t:b,nodex:0,nodey:0,depth:0}];for(;F.length>0;){const{idx:j,t:G,nodex:Z,nodey:Q,depth:se}=F.pop();if(this.leaves[j]){A0(Z,Q,se,e,n,a,u,I,z);const me=1<<se,_e=(Z+0)/me,xe=(Z+1)/me,Oe=(Q+0)/me,Pe=(Q+1)/me,nt=$s(_e,Oe,this.dem)*v,Ye=$s(xe,Oe,this.dem)*v,Re=$s(xe,Pe,this.dem)*v,Je=$s(_e,Pe,this.dem)*v,at=S0(I[0],I[1],nt,z[0],I[1],Ye,z[0],z[1],Re,d,m),je=S0(z[0],z[1],Re,I[0],z[1],Je,I[0],I[1],nt,d,m),ft=Math.min(at!==null?at:Number.MAX_VALUE,je!==null?je:Number.MAX_VALUE);if(ft!==Number.MAX_VALUE)return ft;{const bt=qt([],d,m,G);if(I0(nt,Ye,Je,Re,C0(bt[0],I[0],z[0]),C0(bt[1],I[1],z[1]))>=bt[2])return G}continue}let de=0;for(let me=0;me<this._siblingOffset.length;me++){A0((Z<<1)+this._siblingOffset[me][0],(Q<<1)+this._siblingOffset[me][1],se+1,e,n,a,u,I,z),I[2]=-100,z[2]=this.maximums[this.childOffsets[j]+me]*v;const _e=E0(I,z,d,m);if(_e!=null){const xe=_e;T[me]=xe;let Oe=!1;for(let Pe=0;Pe<de&&!Oe;Pe++)xe>=T[A[Pe]]&&(A.splice(Pe,0,me),Oe=!0);Oe||(A[de]=me),de++}}for(let me=0;me<de;me++){const _e=A[me];F.push({idx:this.childOffsets[j]+_e,t:T[_e],nodex:(Z<<1)+this._siblingOffset[_e][0],nodey:(Q<<1)+this._siblingOffset[_e][1],depth:se+1})}}return null}_addNode(e,n,a){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(a),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,a,u,d){if(e[u].isLeaf(n,a)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const m=u-1,v=e[m];let b,T=0;for(let A=0;A<this._siblingOffset.length;A++){const I=2*n+this._siblingOffset[A][0],z=2*a+this._siblingOffset[A][1],F=v.getElevation(I,z),j=v.isLeaf(I,z),G=this._addNode(F.min,F.max,j);j&&(T|=1<<A),b||(b=G)}for(let A=0;A<this._siblingOffset.length;A++)T&1<<A||this._construct(e,2*n+this._siblingOffset[A][0],2*a+this._siblingOffset[A][1],m,b+A)}}function I0(t,e,n,a,u,d){return Ei(Ei(t,n,d),Ei(e,a,d),u)}function $s(t,e,n){const a=n.dim,u=Ne(t*a-.5,0,a-1),d=Ne(e*a-.5,0,a-1),m=Math.floor(u),v=Math.floor(d),b=Math.min(m+1,a-1),T=Math.min(v+1,a-1);return I0(n.get(m,v),n.get(b,v),n.get(m,T),n.get(b,T),u-m,d-v)}const k0={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Vd{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,a,u=!1,d=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(a&&a!=="mapbox"&&a!=="terrarium")return Yt(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const m=this.dim=n.height-2;if(this.data=new Uint32Array(n.data.buffer),this.encoding=a||"mapbox",this.borderReady=u,!u){for(let v=0;v<m;v++)this.data[this._idx(-1,v)]=this.data[this._idx(0,v)],this.data[this._idx(m,v)]=this.data[this._idx(m-1,v)],this.data[this._idx(v,-1)]=this.data[this._idx(v,0)],this.data[this._idx(v,m)]=this.data[this._idx(v,m-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(m,-1)]=this.data[this._idx(m-1,0)],this.data[this._idx(-1,m)]=this.data[this._idx(0,m-1)],this.data[this._idx(m,m)]=this.data[this._idx(m-1,m-1)],d&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new M0(this)}get(e,n,a=!1){const u=new Uint8Array(this.data.buffer);a&&(e=Ne(e,-1,this.dim),n=Ne(n,-1,this.dim));const d=4*this._idx(e,n);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(u[d],u[d+1],u[d+2])}static getUnpackVector(e){return k0[e]}get unpackVector(){return k0[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}_unpackMapbox(e,n,a){return(256*e*256+256*n+a)/10-1e4}_unpackTerrarium(e,n,a){return 256*e+n+a/256-32768}static pack(e,n){const a=[0,0,0,0],u=Vd.getUnpackVector(n);let d=Math.floor((e+u[3])/u[2]);return a[2]=d%256,d=Math.floor(d/256),a[1]=d%256,d=Math.floor(d/256),a[0]=d,a}getPixels(){return new Pr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,n,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=n*this.dim,d=n*this.dim+this.dim,m=a*this.dim,v=a*this.dim+this.dim;switch(n){case-1:u=d-1;break;case 1:d=u+1}switch(a){case-1:m=v-1;break;case 1:v=m+1}const b=-n*this.dim,T=-a*this.dim;for(let A=m;A<v;A++)for(let I=u;I<d;I++)this.data[this._idx(I,A)]=e.data[this._idx(I+b,A+T)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}_t("DEMData",Vd),_t("DemMinMaxQuadTree",M0,{omit:["dem"]});class YT{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,a){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const d={value:n,timeout:void 0};if(a!==void 0&&(d.timeout=setTimeout(()=>{this.remove(e,d)},a)),this.data[u].push(d),this.order.push(u),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const a=e.wrapped().key,u=n===void 0?0:this.data[a].indexOf(n),d=this.data[a][u];return this.data[a].splice(u,1),d.timeout&&clearTimeout(d.timeout),this.data[a].length===0&&delete this.data[a],this.onRemove(d.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const a in this.data)for(const u of this.data[a])e(u.value)||n.push(u);for(const a of n)this.remove(a.value.tileID,a)}}class ja extends Io{constructor(e,n,a){super(),this.id=e,this._onlySymbols=a,n.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new YT(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=null,this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new KT}onAdd(e){this.map=e,this._minTileCacheSize=e?e._minTileCacheSize:null,this._maxTileCacheSize=e?e._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const a=this._tiles[n];a.upload(e),a.prepare(this.map.style.imageManager)}}getIds(){return wt(this._tiles).map(e=>e.tileID).sort(z0).map(e=>e.key)}getRenderableIds(e){const n=[];for(const a in this._tiles)this._isIdRenderable(+a,e)&&n.push(this._tiles[a]);return e?n.sort((a,u)=>{const d=a.tileID,m=u.tileID,v=new D(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),b=new D(m.canonical.x,m.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-m.overscaledZ||b.y-v.y||b.x-v.x}).map(a=>a.tileID.key):n.map(a=>a.tileID).sort(z0).map(a=>a.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const a=this._tiles[e];a&&(a.state!=="loading"&&(a.state=n),this._loadTile(a,this._tileLoaded.bind(this,a,e,n)))}_tileLoaded(e,n,a,u){if(u)if(e.state="errored",u.status!==404)this._source.fire(new pl(u,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const d=this.map.painter.terrain;this.update(this.transform,d.getScaledDemTileSize(),!0),d.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Ln.now(),a==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Mo("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let u=0;u<n.length;u++){const d=n[u];if(e.neighboringTiles&&e.neighboringTiles[d]){const m=this.getTileByID(d);a(e,m),a(m,e)}}function a(u,d){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let m=d.tileID.canonical.x-u.tileID.canonical.x;const v=d.tileID.canonical.y-u.tileID.canonical.y,b=Math.pow(2,u.tileID.canonical.z),T=d.tileID.key;m===0&&v===0||Math.abs(v)>1||(Math.abs(m)>1&&(Math.abs(m+b)===1?m+=b:Math.abs(m-b)===1&&(m-=b)),d.dem&&u.dem&&(u.dem.backfillBorder(d.dem,m,v),u.neighboringTiles&&u.neighboringTiles[T]&&(u.neighboringTiles[T].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,a,u){for(const d in this._tiles){let m=this._tiles[d];if(u[d]||!m.hasData()||m.tileID.overscaledZ<=n||m.tileID.overscaledZ>a)continue;let v=m.tileID;for(;m&&m.tileID.overscaledZ>n+1;){const T=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[T.key],m&&m.hasData()&&(v=T)}let b=v;for(;b.overscaledZ>n;)if(b=b.scaledTo(b.overscaledZ-1),e[b.key]){u[v.key]=v;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const a=this._loadedParentTiles[e.key];return a&&a.tileID.overscaledZ>=n?a:null}for(let a=e.overscaledZ-1;a>=n;a--){const u=e.scaledTo(a),d=this._getLoadedTile(u);if(d)return d}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const a=Math.ceil(e.width/n)+1,u=Math.ceil(e.height/n)+1,d=Math.floor(a*u*5),m=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,d):d,v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(v)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const a={};for(const u in this._tiles){const d=this._tiles[u];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+n),a[d.tileID.key]=d}this._tiles=a;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,n,a){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!a)return;let u;this.updateCacheSize(e,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new sr(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(u=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!a,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(v=>this._source.hasTile(v)))):u=[];const d=this._updateRetainedTiles(u);if(P0(this._source.type)&&u.length!==0){const v={},b={},T=Object.keys(d);for(const I of T){const z=d[I],F=this._tiles[I];if(!F||F.fadeEndTime&&F.fadeEndTime<=Ln.now())continue;const j=this.findLoadedParent(z,Math.max(z.overscaledZ-ja.maxOverzooming,this._source.minzoom));j&&(this._addTile(j.tileID),v[j.tileID.key]=j.tileID),b[I]=z}const A=u[u.length-1].overscaledZ;for(const I in this._tiles){const z=this._tiles[I];if(d[I]||!z.hasData())continue;let F=z.tileID;for(;F.overscaledZ>A;){F=F.scaledTo(F.overscaledZ-1);const j=this._tiles[F.key];if(j&&j.hasData()&&b[F.key]){d[I]=z.tileID;break}}}for(const I in v)d[I]||(this._coveredTiles[I]=!0,d[I]=v[I])}for(const v in d)this._tiles[v].clearFadeHold();const m=function(v,b){const T=[];for(const A in v)A in b||T.push(A);return T}(this._tiles,d);for(const v of m){const b=this._tiles[v];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(e.length===0)return n;const a={},u=e.reduce((T,A)=>Math.min(T,A.overscaledZ),1/0),d=e[0].overscaledZ,m=Math.max(d-ja.maxOverzooming,this._source.minzoom),v=Math.max(d+ja.maxUnderzooming,this._source.minzoom),b={};for(const T of e){const A=this._addTile(T);n[T.key]=T,A.hasData()||u<this._source.maxzoom&&(b[T.key]=T)}this._retainLoadedChildren(b,u,v,n);for(const T of e){let A=this._tiles[T.key];if(A.hasData())continue;if(T.canonical.z>=this._source.maxzoom){const z=T.children(this._source.maxzoom)[0],F=this.getTile(z);if(F&&F.hasData()){n[z.key]=z;continue}}else{const z=T.children(this._source.maxzoom);if(n[z[0].key]&&n[z[1].key]&&n[z[2].key]&&n[z[3].key])continue}let I=A.wasRequested();for(let z=T.overscaledZ-1;z>=m;--z){const F=T.scaledTo(z);if(a[F.key]||(a[F.key]=!0,A=this.getTile(F),!A&&I&&(A=this._addTile(F)),A&&(n[F.key]=F,I=A.wasRequested(),A.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let a,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){a=this._loadedParentTiles[u.key];break}n.push(u.key);const d=u.scaledTo(u.overscaledZ-1);if(a=this._getLoadedTile(d),a)break;u=d}for(const d of n)this._loadedParentTiles[d]=a}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const a=Boolean(n);if(!a){const u=this.map?this.map.painter:null,d=this._source.type==="raster"||this._source.type==="raster-dem";n=new wm(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,d),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,a||this._source.fire(new Mo("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const a=n.getExpiryTimeout();a&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},a))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset()}tilesIn(e,n,a){const u=[],d=this.transform;if(!d)return u;for(const m in this._tiles){const v=this._tiles[m];if(a&&v.clearQueryDebugViz(),v.holdingForFade())continue;const b=e.containsTile(v,d,n);b&&u.push(b)}return u}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(a=>this._tiles[a].tileID);for(const a of n)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(P0(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=Ln.now())return!0}return!1}setFeatureState(e,n,a){this._state.updateState(e=e||"_geojsonTileLayer",n,a)}removeFeatureState(e,n,a){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,a)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,a){const u=this._tiles[e];u&&u.setDependencies(n,a)}reloadTilesForDependencies(e,n){for(const a in this._tiles)this._tiles[a].hasDependency(e,n)&&this._reloadTile(+a,"reloading");this._cache.filter(a=>!a.hasDependency(e,n))}_preloadTiles(e,n){const a=new Map,u=Array.isArray(e)?e:[e],d=this.map.painter.terrain,m=this.usedForTerrain&&d?d.getScaledDemTileSize():this._source.tileSize;for(const T of u){const A=T.coveringTiles({tileSize:m,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const I of A)a.set(I.key,I);this.usedForTerrain&&T.updateElevation(!1)}const v=Array.from(a.values()),b=this._source.type==="raster"||this._source.type==="raster-dem";Mt(v,(T,A)=>{const I=new wm(T,this._source.tileSize*T.overscaleFactor(),this.transform.tileZoom,this.map.painter,b);this._loadTile(I,z=>{this._source.type==="raster-dem"&&I.dem&&this._backfillDEM(I),A(z,I)})},n)}}function z0(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),a=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||a-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function P0(t){return t==="raster"||t==="image"||t==="video"}ja.maxOverzooming=10,ja.maxUnderzooming=3;class $d{constructor(e,n,a){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=a}static create(e,n,a){const u=a||e.findDEMTileFor(n);if(!u||!u.dem)return;const d=u.dem,m=u.tileID,v=1<<n.canonical.z-m.canonical.z;return new $d(u,u.tileSize/ni/v,[(n.canonical.x/v-m.canonical.x)*d.dim,(n.canonical.y/v-m.canonical.y)*d.dim])}tileCoordToPixel(e,n){const a=n*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),d=Math.floor(a);return new D(u,d)}getElevationAt(e,n,a,u){const d=e*this._scale+this._offset[0],m=n*this._scale+this._offset[1],v=Math.floor(d),b=Math.floor(m),T=this._dem;return u=!!u,a?Ei(Ei(T.get(v,b,u),T.get(v,b+1,u),m-b),Ei(T.get(v+1,b,u),T.get(v+1,b+1,u),m-b),d-v):T.get(v,b,u)}getElevationAtPixel(e,n,a){return this._dem.get(e,n,!!a)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*mo(1,e)*this._dem.stride}}class D0{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Pa(ni,16,0),this.featureIndexArray=new ny,this.promoteId=n}insert(e,n,a,u,d,m=0){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,u,d,m);const b=this.grid;for(let T=0;T<n.length;T++){const A=n[T],I=[1/0,1/0,-1/0,-1/0];for(let z=0;z<A.length;z++){const F=A[z];I[0]=Math.min(I[0],F.x),I[1]=Math.min(I[1],F.y),I[2]=Math.max(I[2],F.x),I[3]=Math.max(I[3],F.y)}I[0]<ni&&I[1]<ni&&I[2]>=0&&I[3]>=0&&b.insert(v,I[0],I[1],I[2],I[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Ua.VectorTile(new zu(this.rawTileData)).layers,this.sourceLayerCoder=new b0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,a,u){this.loadVTLayers();const d=e.params||{},m=jl(d.filter),v=e.tileResult,b=e.transform,T=v.bufferedTilespaceBounds,A=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(j,G,Z,Q)=>xy(v.bufferedTilespaceGeometry,j,G,Z,Q));A.sort(JT);let I=null;b.elevation&&A.length>0&&(I=$d.create(b.elevation,this.tileID));const z={};let F;for(let j=0;j<A.length;j++){const G=A[j];if(G===F)continue;F=G;const Z=this.featureIndexArray.get(G);let Q=null;this.loadMatchingFeature(z,Z,m,d.layers,d.availableImages,n,a,u,(se,de,me,_e=0)=>(Q||(Q=cs(se,this.tileID.canonical,e.tileTransform)),de.queryIntersectsFeature(v,se,me,Q,this.z,e.transform,e.pixelPosMatrix,I,_e)))}return z}loadMatchingFeature(e,n,a,u,d,m,v,b,T){const{featureIndex:A,bucketIndex:I,sourceLayerIndex:z,layoutVertexArrayOffset:F}=n,j=this.bucketLayerIDs[I];if(u&&!function(se,de){for(let me=0;me<se.length;me++)if(de.indexOf(se[me])>=0)return!0;return!1}(u,j))return;const G=this.sourceLayerCoder.decode(z),Z=this.vtLayers[G].feature(A);if(a.needGeometry){const se=Na(Z,!0);if(!a.filter(new jt(this.tileID.overscaledZ),se,this.tileID.canonical))return}else if(!a.filter(new jt(this.tileID.overscaledZ),Z))return;const Q=this.getId(Z,G);for(let se=0;se<j.length;se++){const de=j[se];if(u&&u.indexOf(de)<0)continue;const me=m[de];if(!me)continue;let _e={};Q!==void 0&&b&&(_e=b.getState(me.sourceLayer||"_geojsonTileLayer",Q));const xe=dt({},v[de]);xe.paint=L0(xe.paint,me.paint,Z,_e,d),xe.layout=L0(xe.layout,me.layout,Z,_e,d);const Oe=!T||T(Z,me,_e,F);if(!Oe)continue;const Pe=new w0(Z,this.z,this.x,this.y,Q);Pe.layer=xe;let nt=e[de];nt===void 0&&(nt=e[de]=[]),nt.push({featureIndex:A,feature:Pe,intersectionZ:Oe})}}lookupSymbolFeatures(e,n,a,u,d,m,v,b){const T={};this.loadVTLayers();const A=jl(d);for(const I of e)this.loadMatchingFeature(T,{bucketIndex:a,sourceLayerIndex:u,featureIndex:I,layoutVertexArrayOffset:0},A,m,v,b,n);return T}loadFeature(e){const{featureIndex:n,sourceLayerIndex:a}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(a),d=this.vtFeatures[u];if(d[n])return d[n];const m=this.vtLayers[u].feature(n);return d[n]=m,m}hasLayer(e){for(const n of this.bucketLayerIDs)for(const a of n)if(e===a)return!0;return!1}getId(e,n){let a=e.id;return this.promoteId&&(a=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof a=="boolean"&&(a=Number(a))),a}}function L0(t,e,n,a,u){return fn(t,(d,m)=>{const v=e instanceof ns?e.get(m):null;return v&&v.evaluate?v.evaluate(n,a,u):v})}function JT(t,e){return e-t}_t("FeatureIndex",D0,{omit:["rawTileData","sourceLayerCoder"]});var QT=Hi([{name:"a_pos",type:"Int16",components:2}]);const Yr=32,$o=33,Gs=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,n=0,a=0,u=0,d=0,m=0,v=0;for(1&e?u=d=m=Yr:n=a=v=Yr;(e>>=1)>1;){const T=n+u>>1,A=a+d>>1;1&e?(u=n,d=a,n=m,a=v):(n=u,a=d,u=m,d=v),m=T,v=A}const b=4*t;Gs[b+0]=n,Gs[b+1]=a,Gs[b+2]=u,Gs[b+3]=d}const Go=new Uint16Array(2178),qs=new Uint8Array(1089),Gd=new Uint16Array(1089);function R0(t){return t===0?-.03125:t===32?.03125:0}var bm=Hi([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const O0={type:2,extent:ni,loadGeometry:()=>[[new D(0,0),new D(8193,0),new D(8193,8193),new D(0,8193),new D(0,0)]]};class wm{constructor(e,n,a,u,d){this.tileID=e,this.uid=Zt(),this.uses=0,this.tileSize=n,this.tileZoom=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=d,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<Ln.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=lc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,a){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,d){const m={};if(!d)return m;for(const v of u){const b=v.layerIds.map(T=>d.getLayer(T)).filter(Boolean);if(b.length!==0){v.layers=b,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(T=>b.filter(A=>A.id===T)[0]));for(const T of b)m[T.id]=v}}return m}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const d=this.buckets[u];if(d instanceof Vs){if(this.hasSymbolBuckets=!0,!a)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const d=this.buckets[u];if(d instanceof Vs&&d.hasRTLText){this.hasRTLText=!0,fi.isLoading()||fi.isLoaded()||_r()!=="deferred"||kr();break}}this.queryPadding=0;for(const u in this.buckets){const d=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(u).queryRadius(d))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Lf}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this.globeGridBuffer&&(this.globeGridBuffer.destroy(),this.globeGridBuffer=null),this.globePoleBuffer&&(this.globePoleBuffer.destroy(),this.globePoleBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const a in this.buckets){const u=this.buckets[a];u.uploadPending()&&u.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ud(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ud(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ud(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,a,u,d,m,v,b){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:v,transform:m,params:d,tileTransform:this.tileTransform},e,n,a):{}}querySourceFeatures(e,n){const a=this.latestFeatureIndex;if(!a||!a.rawTileData)return;const u=a.loadVTLayers(),d=n?n.sourceLayer:"",m=u._geojsonTileLayer||u[d];if(!m)return;const v=jl(n&&n.filter),{z:b,x:T,y:A}=this.tileID.canonical,I={z:b,x:T,y:A};for(let z=0;z<m.length;z++){const F=m.feature(z);if(v.needGeometry){const Z=Na(F,!0);if(!v.filter(new jt(this.tileID.overscaledZ),Z,this.tileID.canonical))continue}else if(!v.filter(new jt(this.tileID.overscaledZ),F))continue;const j=a.getId(F,d),G=new w0(F,b,T,A,j);G.tile=I,e.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const a=oo(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const a=Date.now();let u=!1;if(this.expirationTime>a)u=!1;else if(n)if(this.expirationTime<n)u=!0;else{const d=this.expirationTime-n;d?this.expirationTime=a+Math.max(d,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!n)return;const a=this.latestFeatureIndex.loadVTLayers(),u=n.style.listImages();for(const d in this.buckets){if(!n.style.hasLayer(d))continue;const m=this.buckets[d],v=m.layers[0].sourceLayer||"_geojsonTileLayer",b=a[v],T=e[v];if(!b||!T||Object.keys(T).length===0)continue;if(m.update(T,b,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),m instanceof Id||m instanceof Md){const I=n.style._getSourceCache(m.layers[0].source);n._terrain&&n._terrain.enabled&&I&&m.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(I.id,this.tileID)}const A=n&&n.style&&n.style.getLayer(d);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ln.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Ln.now()+e}setDependencies(e,n){const a={};for(const u of n)a[u]=!0;this.dependencies[e]=a}hasDependency(e,n){for(const a of e){const u=this.dependencies[a];if(u){for(const d of n)if(u[d])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const a=cs(O0,this.tileID.canonical,this.tileTransform)[0],u=new ql,d=new fd;for(let m=0;m<a.length;m++){const{x:v,y:b}=a[m];u.emplaceBack(v,b),d.emplaceBack(m)}d.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(d),this._tileDebugBuffer=e.createVertexBuffer(u,bm.members),this._tileDebugSegments=sn.simpleSegment(0,0,u.length,d.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const a=cs(O0,this.tileID.canonical,this.tileTransform)[0];let u,d;if(this.isRaster){const m=function(v,b){const T=lc(v,b),A=Math.pow(2,v.z);for(let Z=0;Z<$o;Z++)for(let Q=0;Q<$o;Q++){const se=ls((v.x+(Q+R0(Q))/Yr)/A),de=Kr((v.y+(Z+R0(Z))/Yr)/A),me=b.project(se,de),_e=Z*$o+Q;Go[2*_e+0]=Math.round((me.x*T.scale-T.x)*ni),Go[2*_e+1]=Math.round((me.y*T.scale-T.y)*ni)}qs.fill(0),Gd.fill(0);for(let Z=2045;Z>=0;Z--){const Q=4*Z,se=Gs[Q+0],de=Gs[Q+1],me=Gs[Q+2],_e=Gs[Q+3],xe=se+me>>1,Oe=de+_e>>1,Pe=xe+Oe-de,nt=Oe+se-xe,Ye=de*$o+se,Re=_e*$o+me,Je=Oe*$o+xe,at=Math.hypot((Go[2*Ye+0]+Go[2*Re+0])/2-Go[2*Je+0],(Go[2*Ye+1]+Go[2*Re+1])/2-Go[2*Je+1])>=16;if(qs[Je]=qs[Je]||(at?1:0),Z<1022){const je=(de+nt>>1)*$o+(se+Pe>>1),ft=(_e+nt>>1)*$o+(me+Pe>>1);qs[Je]=qs[Je]||qs[je]||qs[ft]}}const I=new Zl,z=new zr;let F=0;function j(Z,Q){const se=Q*$o+Z;return Gd[se]===0&&(I.emplaceBack(Go[2*se+0],Go[2*se+1],Z*ni/Yr,Q*ni/Yr),Gd[se]=++F),Gd[se]-1}function G(Z,Q,se,de,me,_e){const xe=Z+se>>1,Oe=Q+de>>1;if(Math.abs(Z-me)+Math.abs(Q-_e)>1&&qs[Oe*$o+xe])G(me,_e,Z,Q,xe,Oe),G(se,de,me,_e,xe,Oe);else{const Pe=j(Z,Q),nt=j(se,de),Ye=j(me,_e);z.emplaceBack(Pe,nt,Ye)}}return G(0,0,Yr,Yr,Yr,0),G(Yr,Yr,0,0,0,Yr),{vertices:I,indices:z}}(this.tileID.canonical,n);u=m.vertices,d=m.indices}else{u=new Zl,d=new zr;for(const{x:v,y:b}of a)u.emplaceBack(v,b,0,0);const m=Td(u.int16,void 0,4);for(let v=0;v<m.length;v+=3)d.emplaceBack(m[v],m[v+1],m[v+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,bm.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(d),this._tileBoundsSegments=sn.simpleSegment(0,0,u.length,d.length)}}const eE=Hi([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),tE=Hi([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:B0}=eE;function Va(t,e){const n=t.fovAboveCenter,a=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,u=(t._camera.position[2]*t.worldSize-a)/Math.cos(t._pitch),d=Math.sin(n)*u/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),m=Math.sin(t._pitch)*d+u;return Math.min(1.01*m,u*(1/t._horizonShift))}const Tm=ni/Math.PI/2,yr=-Tm,vr=Tm,iE=[new go([yr,yr,yr],[vr,vr,vr]),new go([yr,yr,yr],[0,0,vr]),new go([0,yr,yr],[vr,0,vr]),new go([yr,0,yr],[0,vr,vr]),new go([0,0,yr],[vr,vr,vr])];function qd(t){if(t.z<=1)return iE[t.z+2*t.y+t.x];const[e,n]=F0(t),a=[Zd(e[0],e[1]),Zd(e[0],n[1]),Zd(n[0],e[1]),Zd(n[0],n[1])],u=[vr,vr,vr],d=[yr,yr,yr];for(const m of a)u[0]=Math.min(u[0],m[0]),u[1]=Math.min(u[1],m[1]),u[2]=Math.min(u[2],m[2]),d[0]=Math.max(d[0],m[0]),d[1]=Math.max(d[1],m[1]),d[2]=Math.max(d[2],m[2]);return new go(u,d)}function F0(t){const e=Math.pow(2,t.z),n=t.x/e,a=(t.x+1)/e,u=(t.y+1)/e;return[[Kr(t.y/e),ls(n)],[Kr(u),ls(a)]]}function Em(t,e,n,a){return n=ae(n),a||(a=Tm),[t*Math.sin(n)*a,-e*a,t*Math.cos(n)*a]}function Zd(t,e,n){return Em(Math.cos(ae(t)),Math.sin(ae(t)),e,n)}function N0(t){return 16383/Math.max(...Dn([],t.max,t.min))}function U0(t){const e=we(new Float64Array(16)),n=1/N0(t);return Xe(e,e,t.min),Ue(e,e,[n,n,n]),e}function j0(t,e,n){const a=e/(2*Math.PI),u=function(m){const v=ni/(2*Math.PI);return m/(2*Math.PI)/v}(e);if(!n){const m=Ne(t.center.lat,-85.051129,Uo);n=[Xl(t.center.lng)*e,Kl(m)*e]}const d=we(new Float64Array(16));return Xe(d,d,[n[0],n[1],-a]),Ue(d,d,[u,u,u]),st(d,d,ae(-t._center.lat)),ut(d,d,ae(-t._center.lng)),d}class Sm{constructor(e){const n=this._createGridIndices();this.gridIndexBuffer=e.createIndexBuffer(n,!0),this.gridSegments=sn.simpleSegment(0,0,4225,8192);const a=this._createPoleTriangleIndices();this.poleIndexBuffer=e.createIndexBuffer(a,!0),this.poleSegments=sn.simpleSegment(0,0,66,64);const u=new bu;u.emplaceBack(-1,1,1,0,0,0,0),u.emplaceBack(1,1,1,0,0,1,0),u.emplaceBack(1,-1,1,0,0,1,1),u.emplaceBack(-1,-1,1,0,0,0,1);const d=new zr;d.emplaceBack(0,1,2),d.emplaceBack(2,3,0),this.atmosphereVertexBuffer=e.createVertexBuffer(u,tE.members),this.atmosphereIndexBuffer=e.createIndexBuffer(d),this.atmosphereSegments=sn.simpleSegment(0,0,4,2)}destroy(){this.poleIndexBuffer.destroy(),this.gridIndexBuffer.destroy(),this.poleSegments.destroy(),this.gridSegments.destroy(),this.atmosphereVertexBuffer.destroy(),this.atmosphereIndexBuffer.destroy(),this.atmosphereSegments.destroy(),this.wireframeIndexBuffer&&(this.wireframeIndexBuffer.destroy(),this.wireframeSegments.destroy())}static createPoleTriangleVertices(e,n,a){const u=new bu,d=n/Math.PI/2;u.emplaceBack(0,-d,0,0,0,.5,a?0:1);const m=360/e,v=Math.cos(ae(85)),b=Math.sin(ae(85));for(let A=0;A<=64;A++){const I=A/64,z=Em(v,b,0*(1-(T=I))+m*T,d);u.emplaceBack(z[0],z[1],z[2],0,0,I,a?0:1)}var T;return u}_createPoleTriangleIndices(){const e=new zr;for(let n=0;n<=64;n++)e.emplaceBack(0,n+1,n+2);return e}static createGridVertices(e){const n=Math.pow(2,e.z),a=(b,T,A)=>b*(1-A)+T*A,[u,d]=F0(e),m=new bu,v=function(b){const T=we(new Float64Array(16)),A=N0(b);var I,z;return Ue(T,T,[A,A,A]),Xe(T,T,((I=[])[0]=-(z=b.min)[0],I[1]=-z[1],I[2]=-z[2],I)),T}(qd(e));m.reserve(4096);for(let b=0;b<65;b++){const T=a(u[0],d[0],b/64),A=Kl(T),I=A*n-e.y,z=Math.sin(ae(T)),F=Math.cos(ae(T));for(let j=0;j<65;j++){const G=j/64,Z=a(u[1],d[1],G),Q=Em(F,z,Z);Et(Q,Q,v);const se=Xl(Z);m.emplaceBack(Q[0],Q[1],Q[2],se,A,G,I)}}return m}_createGridIndices(){const e=new zr,n=(a,u)=>{const d=65*u+a;e.emplaceBack(d+1,d,d+65),e.emplaceBack(d+65,d+65+1,d+1)};for(let a=0;a<64;a++)for(let u=0;u<64;u++)n(u,a);return e}getWirefameBuffer(e){if(!this.wireframeSegments){const n=this._createWireframeGrid();this.wireframeIndexBuffer=e.createIndexBuffer(n),this.wireframeSegments=sn.simpleSegment(0,0,4096,n.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}_createWireframeGrid(){const e=new Bs,n=(a,u)=>{const d=65*u+a;e.emplaceBack(d,d+1),e.emplaceBack(d,d+65),e.emplaceBack(d,d+65+1)};for(let a=0;a<64;a++)for(let u=0;u<64;u++)n(u,a);return e}}function lc(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),a=t.x*n,u=(t.x+1)*n,d=t.y*n,m=(t.y+1)*n,v=ls(a),b=ls(u),T=Kr(d),A=Kr(m),I=e.project(v,T),z=e.project(b,T),F=e.project(b,A),j=e.project(v,A);let G=Math.min(I.x,z.x,F.x,j.x),Z=Math.min(I.y,z.y,F.y,j.y),Q=Math.max(I.x,z.x,F.x,j.x),se=Math.max(I.y,z.y,F.y,j.y);const de=n/16;function me(xe,Oe,Pe,nt,Ye,Re){const Je=(Pe+Ye)/2,at=(nt+Re)/2,je=e.project(ls(Je),Kr(at)),ft=Math.max(0,G-je.x,Z-je.y,je.x-Q,je.y-se);G=Math.min(G,je.x),Q=Math.max(Q,je.x),Z=Math.min(Z,je.y),se=Math.max(se,je.y),ft>de&&(me(xe,je,Pe,nt,Je,at),me(je,Oe,Je,at,Ye,Re))}me(I,z,a,d,u,d),me(z,F,u,d,u,m),me(F,j,u,m,a,m),me(j,I,a,m,a,d),G-=de,Z-=de,Q+=de,se+=de;const _e=1/Math.max(Q-G,se-Z);return{scale:_e,x:G*_e,y:Z*_e,x2:Q*_e,y2:se*_e,projection:e}}class V0{constructor(e){const n={},a=[];for(const v in e){const b=e[v],T=n[v]={};for(const A in b.glyphs){const I=b.glyphs[+A];if(!I||I.bitmap.width===0||I.bitmap.height===0)continue;const z=I.metrics.localGlyph?2:1,F={x:0,y:0,w:I.bitmap.width+2*z,h:I.bitmap.height+2*z};a.push(F),T[A]=F}}const{w:u,h:d}=tm(a),m=new Ns({width:u||1,height:d||1});for(const v in e){const b=e[v];for(const T in b.glyphs){const A=b.glyphs[+T];if(!A||A.bitmap.width===0||A.bitmap.height===0)continue;const I=n[v][T],z=A.metrics.localGlyph?2:1;Ns.copy(A.bitmap,m,{x:0,y:0},{x:I.x+z,y:I.y+z},A.bitmap)}}this.image=m,this.positions=n}}_t("GlyphAtlas",V0);class nE{constructor(e){this.tileID=new sr(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=lc(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,n,a,u,d){this.status="parsing",this.data=e,this.collisionBoxArray=new Lf;const m=new b0(Object.keys(e.layers).sort()),v=new D0(this.tileID,this.promoteId);v.bucketLayerIDs=[];const b={},T=new mm(256,256),A={featureIndex:v,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:T,availableImages:a},I=n.familiesBySource[this.source];for(const _e in I){const xe=e.layers[_e];if(!xe)continue;let Oe=!1,Pe=!1;for(const Re of I[_e])Re[0].type==="symbol"?Oe=!0:Pe=!0;if(this.isSymbolTile===!0&&!Oe||this.isSymbolTile===!1&&!Pe)continue;xe.version===1&&Yt(`Vector tile source "${this.source}" layer "${_e}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const nt=m.encode(_e),Ye=[];for(let Re=0;Re<xe.length;Re++){const Je=xe.feature(Re),at=v.getId(Je,_e);Ye.push({feature:Je,id:at,index:Re,sourceLayerIndex:nt})}for(const Re of I[_e]){const Je=Re[0];this.isSymbolTile!==void 0&&Je.type==="symbol"!==this.isSymbolTile||Je.minzoom&&this.zoom<Math.floor(Je.minzoom)||Je.maxzoom&&this.zoom>=Je.maxzoom||Je.visibility!=="none"&&(Cm(Re,this.zoom,a),(b[Je.id]=Je.createBucket({index:v.bucketLayerIDs.length,layers:Re,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:nt,sourceID:this.source,enableTerrain:this.enableTerrain,availableImages:a})).populate(Ye,A,this.tileID.canonical,this.tileTransform),v.bucketLayerIDs.push(Re.map(at=>at.id)))}}let z,F,j,G;T.trim();const Z={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Q=fn(A.glyphDependencies,_e=>Object.keys(_e).map(Number));Object.keys(Q).length?u.send("getGlyphs",{uid:this.uid,stacks:Q},(_e,xe)=>{z||(z=_e,F=xe,me.call(this))},void 0,!1,Z):F={};const se=Object.keys(A.iconDependencies);se.length?u.send("getImages",{icons:se,source:this.source,tileID:this.tileID,type:"icons"},(_e,xe)=>{z||(z=_e,j=xe,me.call(this))},void 0,!1,Z):j={};const de=Object.keys(A.patternDependencies);function me(){if(z)return d(z);if(F&&j&&G){const _e=new V0(F),xe=new Hy(j,G);for(const Oe in b){const Pe=b[Oe];Pe instanceof Vs?(Cm(Pe.layers,this.zoom,a),RT(Pe,F,_e.positions,j,xe.iconPositions,this.showCollisionBoxes,a,this.tileID.canonical,this.tileZoom,this.projection),Pe.projection=this.projection.name):Pe.hasPattern&&(Pe instanceof Id||Pe instanceof Md||Pe instanceof Jf)&&(Cm(Pe.layers,this.zoom,a),Pe.addFeatures(A,this.tileID.canonical,xe.patternPositions,a))}this.status="done",d(null,{buckets:wt(b).filter(Oe=>!Oe.isEmpty()),featureIndex:v,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:_e.image,lineAtlas:T,imageAtlas:xe,glyphMap:this.returnDependencies?F:null,iconMap:this.returnDependencies?j:null,glyphPositions:this.returnDependencies?_e.positions:null})}}de.length?u.send("getImages",{icons:de,source:this.source,tileID:this.tileID,type:"patterns"},(_e,xe)=>{z||(z=_e,G=xe,me.call(this))},void 0,!1,Z):G={},me.call(this)}}function Cm(t,e,n){const a=new jt(e);for(const u of t)u.recalculate(a,n)}class $0{constructor(e){this.entries={},this.scheduler=e}request(e,n,a,u){const d=this.entries[e]=this.entries[e]||{callbacks:[]};if(d.result){const[m,v]=d.result;return this.scheduler?this.scheduler.add(()=>{u(m,v)},n):u(m,v),()=>{}}return d.callbacks.push(u),d.cancel||(d.cancel=a((m,v)=>{d.result=[m,v];for(const b of d.callbacks)this.scheduler?this.scheduler.add(()=>{b(m,v)},n):b(m,v);setTimeout(()=>delete this.entries[e],3e3)})),()=>{d.result||(d.callbacks=d.callbacks.filter(m=>m!==u),d.callbacks.length||(d.cancel(),delete this.entries[e]))}}}function G0(t,e,n){const a=JSON.stringify(t.request);return t.data&&(this.deduped.entries[a]={result:[null,t.data]}),this.deduped.request(a,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},u=>{const d=ua(t.request,(m,v,b,T)=>{m?u(m):v&&u(null,{vectorTile:n?void 0:new Ua.VectorTile(new zu(v)),rawData:v,cacheControl:b,expires:T})});return()=>{d.cancel(),u()}},e)}const rE=we(new Float64Array(16));class $a{constructor(e,n){this._tr=e,this._worldSize=n}createInversionMatrix(){return rE}createTileMatrix(e){let n,a,u;const d=e.canonical,m=we(new Float64Array(16)),v=this._tr.projection;if(v.isReprojectedInTileSpace){const b=lc(d,v);n=1,a=b.x+e.wrap*b.scale,u=b.y,Ue(m,m,[n/b.scale,n/b.scale,this._tr.pixelsPerMeter/this._worldSize])}else n=this._worldSize/this._tr.zoomScale(d.z),a=(d.x+Math.pow(2,d.z)*e.wrap)*n,u=d.y*n;return Xe(m,m,[a,u,0]),Ue(m,m,[n/ni,n/ni,1]),m}pointCoordinate(e,n,a){const u=this._tr.horizonLineFromTop(!1),d=new D(e,Math.max(u,n));return this._tr.rayIntersectionCoordinate(this._tr.pointRayIntersection(d,a))}upVector(){return[0,0,1]}upVectorScale(){return 1}}var oE={name:"albers",range:[4,7],center:[-96,37.5],parallels:[29.5,45.5],zAxisUnit:"meters",conic:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],initializeConstants(){if(this.constants&&Le(this.parallels,this.constants.parallels))return;const t=Math.sin(ae(this.parallels[0])),e=(t+Math.sin(ae(this.parallels[1])))/2,n=1+t*(2*e-t),a=Math.sqrt(n)/e;this.constants={n:e,c:n,r0:a,parallels:this.parallels}},project(t,e){this.initializeConstants();const n=ae(t-this.center[0]),a=ae(e),{n:u,c:d,r0:m}=this.constants,v=Math.sqrt(d-2*u*Math.sin(a))/u;return{x:v*Math.sin(n*u),y:v*Math.cos(n*u)-m,z:0}},unproject(t,e){this.initializeConstants();const{n,c:a,r0:u}=this.constants,d=u+e;let m=Math.atan2(t,Math.abs(d))*Math.sign(d);d*n<0&&(m-=Math.PI*Math.sign(t)*Math.sign(d));const v=ae(this.center[0])*n;m=Ze(m,-Math.PI-v,Math.PI-v);const b=Ce(m/n)+this.center[0],T=Math.asin(Ne((a-(t*t+d*d)*n*n)/(2*n),-1,1)),A=Ne(Ce(T),-85.051129,Uo);return new Ii(b,A)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>mo(1,t)*e,farthestPixelDistance(t){return Va(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new $a(t,e)};const Ru=1.340264,Ou=-.081106,Bu=893e-6,Fu=.003796,Wd=Math.sqrt(3)/2;var sE={name:"equalEarth",center:[0,0],range:[3.5,7],zAxisUnit:"meters",isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project(t,e){e=e/180*Math.PI,t=t/180*Math.PI;const n=Math.asin(Wd*Math.sin(e)),a=n*n,u=a*a*a;return{x:.5*(t*Math.cos(n)/(Wd*(Ru+3*Ou*a+u*(7*Bu+9*Fu*a)))/Math.PI+.5),y:1-.5*(n*(Ru+Ou*a+u*(Bu+Fu*a))/Math.PI+1),z:0}},unproject(t,e){t=(2*t-.5)*Math.PI;let n=e=(2*(1-e)-1)*Math.PI,a=n*n,u=a*a*a;for(let T,A,I,z=0;z<12&&(A=n*(Ru+Ou*a+u*(Bu+Fu*a))-e,I=Ru+3*Ou*a+u*(7*Bu+9*Fu*a),T=A/I,n=Ne(n-T,-Math.PI/3,Math.PI/3),a=n*n,u=a*a*a,!(Math.abs(T)<1e-12));++z);const d=Wd*t*(Ru+3*Ou*a+u*(7*Bu+9*Fu*a))/Math.cos(n),m=Math.asin(Math.sin(n)/Wd),v=Ne(180*d/Math.PI,-180,180),b=Ne(180*m/Math.PI,-85.051129,Uo);return new Ii(v,b)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>mo(1,t)*e,farthestPixelDistance(t){return Va(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new $a(t,e)},aE={name:"equirectangular",supportsWorldCopies:!0,center:[0,0],range:[3.5,7],zAxisUnit:"meters",wrap:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project:(t,e)=>({x:.5+t/360,y:.5-e/360,z:0}),unproject(t,e){const n=360*(t-.5),a=Ne(360*(.5-e),-85.051129,Uo);return new Ii(n,a)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>mo(1,t)*e,farthestPixelDistance(t){return Va(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new $a(t,e)};const cc=Math.PI/2;function Hd(t){return Math.tan((cc+t)/2)}var lE={name:"lambertConformalConic",range:[3.5,7],zAxisUnit:"meters",center:[0,30],parallels:[30,30],conic:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],initializeConstants(){if(this.constants&&Le(this.parallels,this.constants.parallels))return;const t=ae(this.parallels[0]),e=ae(this.parallels[1]),n=Math.cos(t),a=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(Hd(e)/Hd(t)),u=n*Math.pow(Hd(t),a)/a;this.constants={n:a,f:u,parallels:this.parallels}},project(t,e){this.initializeConstants(),e=ae(e),t=ae(t-this.center[0]);const n=1e-6,{n:a,f:u}=this.constants;u>0?e<-cc+n&&(e=-cc+n):e>cc-n&&(e=cc-n);const d=u/Math.pow(Hd(e),a),m=d*Math.sin(a*t),v=u-d*Math.cos(a*t);return{x:.5*(m/Math.PI+.5),y:1-.5*(v/Math.PI+.5),z:0}},unproject(t,e){this.initializeConstants(),t=(2*t-.5)*Math.PI,e=(2*(1-e)-.5)*Math.PI;const{n,f:a}=this.constants,u=a-e,d=Math.sign(u),m=Math.sign(n)*Math.sqrt(t*t+u*u);let v=Math.atan2(t,Math.abs(u))*d;u*n<0&&(v-=Math.PI*Math.sign(t)*d);const b=Ne(Ce(v/n)+this.center[0],-180,180),T=Ne(Ce(2*Math.atan(Math.pow(a/m,1/n))-cc),-85.051129,Uo);return new Ii(b,T)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>mo(1,t)*e,farthestPixelDistance(t){return Va(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new $a(t,e)},cE={name:"mercator",wrap:!0,requiresDraping:!1,supportsWorldCopies:!0,supportsTerrain:!0,supportsFog:!0,supportsFreeCamera:!0,zAxisUnit:"meters",center:[0,0],project:(t,e)=>({x:Xl(t),y:Kl(e),z:0}),unproject(t,e){const n=ls(t),a=Kr(e);return new Ii(n,a)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>mo(1,t)*e,farthestPixelDistance(t){return Va(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new $a(t,e)};const q0=ae(Uo);var uE={name:"naturalEarth",center:[0,0],range:[3.5,7],isReprojectedInTileSpace:!0,zAxisUnit:"meters",unsupportedLayers:["custom"],project(t,e){const n=(e=ae(e))*e,a=n*n;return{x:.5*((t=ae(t))*(.8707-.131979*n+a*(a*(.003971*n-.001529*a)-.013791))/Math.PI+.5),y:1-.5*(e*(1.007226+n*(.015085+a*(.028874*n-.044475-.005916*a)))/Math.PI+1),z:0}},unproject(t,e){t=(2*t-.5)*Math.PI;let n=e=(2*(1-e)-1)*Math.PI,a=25,u=0,d=n*n;do{d=n*n;const b=d*d;u=(n*(1.007226+d*(.015085+b*(.028874*d-.044475-.005916*b)))-e)/(1.007226+d*(.045255+b*(.259866*d-.311325-.005916*11*b))),n=Ne(n-u,-q0,q0)}while(Math.abs(u)>1e-6&&--a>0);d=n*n;const m=Ne(Ce(t/(.8707+d*(d*(d*d*d*(.003971-.001529*d)-.013791)-.131979))),-180,180),v=Ce(n);return new Ii(m,v)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>mo(1,t)*e,farthestPixelDistance(t){return Va(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new $a(t,e)};const Z0=ae(Uo),W0={albers:oE,equalEarth:sE,equirectangular:aE,lambertConformalConic:lE,mercator:cE,naturalEarth:uE,winkelTripel:{name:"winkelTripel",center:[0,0],range:[3.5,7],zAxisUnit:"meters",isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project(t,e){e=ae(e),t=ae(t);const n=Math.cos(e),a=2/Math.PI,u=Math.acos(n*Math.cos(t/2)),d=Math.sin(u)/u,m=.5*(t*a+2*n*Math.sin(t/2)/d)||0,v=.5*(e+Math.sin(e)/d)||0;return{x:.5*(m/Math.PI+.5),y:1-.5*(v/Math.PI+1),z:0}},unproject(t,e){let n=t=(2*t-.5)*Math.PI,a=e=(2*(1-e)-1)*Math.PI,u=25;const d=1e-6;let m=0,v=0;do{const b=Math.cos(a),T=Math.sin(a),A=2*T*b,I=T*T,z=b*b,F=Math.cos(n/2),j=Math.sin(n/2),G=2*F*j,Z=j*j,Q=1-z*F*F,se=Q?1/Q:0,de=Q?Math.acos(b*F)*Math.sqrt(1/Q):0,me=.5*(2*de*b*j+2*n/Math.PI)-t,_e=.5*(de*T+a)-e,xe=.5*se*(z*Z+de*b*F*I)+1/Math.PI,Oe=se*(G*A/4-de*T*j),Pe=.125*se*(A*j-de*T*z*G),nt=.5*se*(I*F+de*Z*b)+.5,Ye=Oe*Pe-nt*xe;m=(_e*Oe-me*nt)/Ye,v=(me*Pe-_e*xe)/Ye,n=Ne(n-m,-Math.PI,Math.PI),a=Ne(a-v,-Z0,Z0)}while((Math.abs(m)>d||Math.abs(v)>d)&&--u>0);return new Ii(Ce(n),Ce(a))},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>mo(1,t)*e,farthestPixelDistance(t){return Va(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new $a(t,e)}};s.ARRAY_TYPE=Ee,s.AUTH_ERR_MSG=ue,s.Aabb=go,s.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},Ki(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Xn()?t:U,this.scheduler=new XT}send(t,e,n,a,u=!1,d){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=d,this.callbacks[m]=n);const v=un(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:t,hasCallback:!!n,targetMapId:a,mustQueue:u,sourceMapId:this.mapId,data:Ra(e,v)},v),{cancel:()=>{n&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const a=this.cancelCallbacks[n];delete this.cancelCallbacks[n],a&&a.cancel()}else if(e.mustQueue||Xn()){const a=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),a&&a.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if(e.type==="<response>"){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(Fo(e.error)):n(null,Fo(e.data)))}else{const n=un(this.globalScope)?void 0:[],a=e.hasCallback?(d,m)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:d?Ra(d):null,data:Ra(m,n)},n)}:d=>{},u=Fo(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,a);else if(this.parent.getWorkerSource){const d=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,d[0],u.source)[d[1]](u,a)}else a(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=jd,s.Color=yi,s.ColorMode=Vo,s.CullFaceMode=_o,s.DEMData=Vd,s.DataConstantProperty=xt,s.DedupedRequest=$0,s.DepthMode=ac,s.EXTENT=ni,s.Elevation=class{getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){e==null&&(e=null);const a=this._source();if(!a||t.y<0||t.y>1)return e;const u=a.getSource().maxzoom,d=1<<u,m=Math.floor(t.x),v=t.x-m,b=new sr(u,m,u,Math.floor(v*d),Math.floor(t.y*d)),T=this.findDEMTileFor(b);if(!T||!T.dem)return e;const A=T.dem,I=1<<T.tileID.canonical.z,z=(v*I-T.tileID.canonical.x)*A.dim,F=(t.y*I-T.tileID.canonical.y)*A.dim,j=Math.floor(z),G=Math.floor(F);return(n?this.exaggeration():1)*Ei(Ei(A.get(j,G),A.get(j,G+1),F-G),Ei(A.get(j+1,G),A.get(j+1,G+1),F-G),z-j)}getAtTileOffset(t,e,n){const a=1<<t.canonical.z;return this.getAtPointOrZero(new xd(t.wrap+(t.canonical.x+e/ni)/a,(t.canonical.y+n/ni)/a))}getAtTileOffsetFunc(t,e){return n=>{const a=this.getAtTileOffset(t,n.x,n.y),u=e.upVector(t.canonical,n.x,n.y);return ri(u,u,a*e.upVectorScale(t.canonical)),u}}getForTilePoints(t,e,n,a){const u=$d.create(this,t,a);return!!u&&(e.forEach(d=>{d[2]=this.exaggeration()*u.getElevationAt(d[0],d[1],n)}),!0)}getMinMaxForTile(t){const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,a=e.tileID,u=1<<t.canonical.z-a.canonical.z;let d=t.canonical.x/u-a.canonical.x,m=t.canonical.y/u-a.canonical.y,v=0;for(let b=0;b<t.canonical.z-a.canonical.z&&!n.leaves[v];b++){d*=2,m*=2;const T=2*Math.floor(m)+Math.floor(d);v=n.childOffsets[v]+T,d%=1,m%=1}return{min:this.exaggeration()*n.minimums[v],max:this.exaggeration()*n.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=pl,s.EvaluationParameters=jt,s.Event=Mo,s.Evented=Io,s.Frustum=Vf,s.GLOBE_ZOOM_THRESHOLD_MAX=6,s.GlobeSharedBuffers=Sm,s.GlyphManager=oc,s.ImagePosition=im,s.LineAtlas=mm,s.LngLat=Ii,s.LngLatBounds=Fa,s.LocalGlyphMode=sm,s.MAX_MERCATOR_LATITUDE=Uo,s.MercatorCoordinate=xd,s.ONE_EM=Rn,s.OverscaledTileID=sr,s.Properties=zn,s.RGBAImage=Pr,s.Ray=class{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(t,e,n){const a=Si(e,this.dir);if(Math.abs(a)<1e-6)return!1;const u=((t[0]-this.pos[0])*e[0]+(t[1]-this.pos[1])*e[1]+(t[2]-this.pos[2])*e[2])/a;return n[0]=this.pos[0]+this.dir[0]*u,n[1]=this.pos[1]+this.dir[1]*u,n[2]=this.pos[2]+this.dir[2]*u,!0}closestPointOnSphere(t,e,n){if(function(z,F){var j=z[0],G=z[1],Z=z[2],Q=F[0],se=F[1],de=F[2];return Math.abs(j-Q)<=ge*Math.max(1,Math.abs(j),Math.abs(Q))&&Math.abs(G-se)<=ge*Math.max(1,Math.abs(G),Math.abs(se))&&Math.abs(Z-de)<=ge*Math.max(1,Math.abs(Z),Math.abs(de))}(this.pos,t)||e===0)return n[0]=n[1]=n[2]=0,!1;const[a,u,d]=this.dir,m=this.pos[0]-t[0],v=this.pos[1]-t[1],b=this.pos[2]-t[2],T=a*a+u*u+d*d,A=2*(m*a+v*u+b*d),I=A*A-4*T*(m*m+v*v+b*b-e*e);if(I<0){const z=Math.max(-A/2,0),F=m+a*z,j=v+u*z,G=b+d*z,Z=Math.hypot(F,j,G);return n[0]=F*e/Z,n[1]=j*e/Z,n[2]=G*e/Z,!1}{const z=(-A-Math.sqrt(I))/(2*T);if(z<0){const F=Math.hypot(m,v,b);return n[0]=m*e/F,n[1]=v*e/F,n[2]=b*e/F,!1}return n[0]=m+a*z,n[1]=v+u*z,n[2]=b+d*z,!0}}},s.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",pe,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!Y(t))return t;const n=it(t);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!Y(t))return t;const n=it(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e){if(!Y(t))return t;const n=it(t);return n.path=`/v4/${n.authority}.json`,n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,a){const u=it(t);return Y(t)?(u.path=`/styles/v1${u.path}/sprite${e}${n}`,this._makeAPIURL(u,this._customAccessToken||a)):(u.path+=`${e}${n}`,mt(u))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Y(t))return t;const a=it(t);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&a.authority!=="raster"&&n===512?"@2x":""}${V.supported?".webp":"$1"}`),a.authority==="raster"?a.path=`/${B.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${B.TILE_URL_VERSION}${a.path}`);const u=this._customAccessToken||function(d){for(const m of d){const v=m.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(a.params)||B.ACCESS_TOKEN;return B.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,u)}canonicalizeTileURL(t,e){const n=it(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let a="mapbox://";n.path.match(/^\/raster\/v1\//)?a+=`raster/${n.path.replace(`/${B.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${n.path.replace(`/${B.TILE_URL_VERSION}/`,"")}`;let u=n.params;return e&&(u=u.filter(d=>!d.match(/^access_token=/))),u.length&&(a+=`?${u.join("&")}`),a}canonicalizeTileset(t,e){const n=!!e&&Y(e),a=[];for(const u of t.tiles||[])fe(u)?a.push(this.canonicalizeTileURL(u,n)):a.push(u);return a}_makeAPIURL(t,e){const n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",a=it(B.API_URL);if(t.protocol=a.protocol,t.authority=a.authority,t.protocol==="http"){const u=t.params.indexOf("secure");u>=0&&t.params.splice(u,1)}if(a.path!=="/"&&(t.path=`${a.path}${t.path}`),!B.REQUIRE_ACCESS_TOKEN)return mt(t);if(e=e||B.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter(u=>u.indexOf("access_token")===-1),t.params.push(`access_token=${e||""}`),mt(t)}},s.ResourceType=hl,s.SegmentVector=sn,s.SourceCache=ja,s.StencilMode=ym,s.StructArrayLayout1ui2=fd,s.StructArrayLayout2f1f2i16=Af,s.StructArrayLayout2i4=ql,s.StructArrayLayout2ui4=Bs,s.StructArrayLayout3f12=Wl,s.StructArrayLayout3ui6=zr,s.StructArrayLayout4i8=Zl,s.Texture=Ud,s.Tile=wm,s.Transitionable=rr,s.Uniform1f=yd,s.Uniform1i=class extends os{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},s.Uniform2f=class extends os{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},s.Uniform3f=class extends os{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},s.Uniform4f=ly,s.UniformColor=cy,s.UniformMatrix2f=class extends os{constructor(t,e){super(t,e),this.current=t2}set(t){for(let e=0;e<4;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix2fv(this.location,!1,t);break}}},s.UniformMatrix3f=class extends os{constructor(t,e){super(t,e),this.current=e2}set(t){for(let e=0;e<9;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix3fv(this.location,!1,t);break}}},s.UniformMatrix4f=class extends os{constructor(t,e){super(t,e),this.current=Qw}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},s.UnwrappedTileID=gm,s.ValidationError=pt,s.VectorTileWorkerSource=class extends Io{constructor(t,e,n,a,u){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=u||G0,this.loading={},this.loaded={},this.deduped=new $0(t.scheduler),this.isSpriteLoaded=a,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,a=t&&t.request,u=a&&a.collectResourceTiming,d=this.loading[n]=new nE(t);d.abort=this.loadVectorData(t,(m,v)=>{const b=!this.loading[n];if(delete this.loading[n],b||m||!v)return d.status="done",b||(this.loaded[n]=d),e(m);const T=v.rawData,A={};v.expires&&(A.expires=v.expires),v.cacheControl&&(A.cacheControl=v.cacheControl),d.vectorTile=v.vectorTile||new Ua.VectorTile(new zu(T));const I=()=>{d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,(z,F)=>{if(z||!F)return e(z);const j={};if(u){const G=v0(a);G.length>0&&(j.resourceTiming=JSON.parse(JSON.stringify(G)))}e(null,dt({rawTileData:T.slice(0)},F,A,j))})};this.isSpriteLoaded?I():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(I,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):I()}),this.loaded=this.loaded||{},this.loaded[n]=d})}reloadTile(t,e){const n=this.loaded,a=t.uid,u=this;if(n&&n[a]){const d=n[a];d.showCollisionBoxes=t.showCollisionBoxes,d.enableTerrain=!!t.enableTerrain,d.projection=t.projection;const m=(v,b)=>{const T=d.reloadCallback;T&&(delete d.reloadCallback,d.parse(d.vectorTile,u.layerIndex,this.availableImages,u.actor,T)),e(v,b)};d.status==="parsing"?d.reloadCallback=m:d.status==="done"&&(d.vectorTile?d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,m):m())}}abortTile(t,e){const n=t.uid,a=this.loading[n];a&&(a.abort&&a.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,a=t.uid;n&&n[a]&&delete n[a],e()}},s.WritingMode=Dr,s.ZoomHistory=p,s.add=ot,s.addDynamicAttributes=um,s.adjoint=function(t,e){var n=e[0],a=e[1],u=e[2],d=e[3],m=e[4],v=e[5],b=e[6],T=e[7],A=e[8];return t[0]=m*A-v*T,t[1]=u*T-a*A,t[2]=a*v-u*m,t[3]=v*b-d*A,t[4]=n*A-u*b,t[5]=u*d-n*v,t[6]=d*T-m*b,t[7]=a*b-n*T,t[8]=n*m-a*d,t},s.asyncAll=Mt,s.bezier=Ke,s.bindAll=Ki,s.boundsAttributes=bm,s.bufferConvexPolygon=function(t,e){const n=[];for(let a=0;a<t.length;a++){const u=Ze(a-1,-1,t.length-1),d=Ze(a+1,-1,t.length-1),m=t[a],v=t[d],b=t[u].sub(m).unit(),T=v.sub(m).unit(),A=T.angleWithSep(b.x,b.y),I=b.add(T).unit().mult(-1*e/Math.sin(A/2));n.push(m.add(I))}return n},s.cacheEntryPossiblyAdded=function(t){ul++,ul>$c&&(t.getActor().send("enforceCacheSizeLimit",Ch),ul=0)},s.calculateGlobeMatrix=j0,s.calculateGlobeMercatorMatrix=function(t){const e=t.worldSize,n=Ne(t.center.lat,-85.051129,Uo),a=new D(Xl(t.center.lng)*e,Kl(n)*e),u=mo(1,t.center.lat)*e,d=t.pixelsPerMeter,m=e/(u/t.pixelsPerMeter),v=we(new Float64Array(16));return Xe(v,v,[a.x,a.y,0]),Ue(v,v,[m,m,d]),v},s.clamp=Ne,s.clearTileCache=function(t){const e=U.caches.delete(In);t&&e.catch(t).then(()=>t())},s.clipLine=s0,s.clone=function(t){var e=new Ee(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},s.clone$1=An,s.collisionCircleLayout=aT,s.config=B,s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.create=function(){var t=new Ee(16);return Ee!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},s.create$1=be,s.createExpression=Ma,s.createLayout=Hi,s.createStyleLayer=function(t){return t.type==="custom"?new GT(t):new ZT[t.type](t)},s.cross=Qi,s.degToRad=ae,s.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},s.dot=Si,s.ease=ht,s.easeCubicInOut=Ve,s.emitValidationErrors=cd,s.endsWith=Cn,s.enforceCacheSizeLimit=function(t){la(),Gr&&Gr.then(e=>{e.keys().then(n=>{for(let a=0;a<n.length-t;a++)e.delete(n[a])})})},s.evaluateSizeForFeature=kd,s.evaluateSizeForZoom=tc,s.evaluateVariableOffset=h0,s.evented=Qn,s.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},s.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},s.exported=Ln,s.exported$1=V,s.extend=dt,s.extend$1=ko,s.filterObject=Hn,s.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},s.fromQuat=function(t,e){var n=e[0],a=e[1],u=e[2],d=e[3],m=n+n,v=a+a,b=u+u,T=n*m,A=a*m,I=a*v,z=u*m,F=u*v,j=u*b,G=d*m,Z=d*v,Q=d*b;return t[0]=1-I-j,t[1]=A+Q,t[2]=z-Z,t[3]=0,t[4]=A-Q,t[5]=1-T-j,t[6]=F+G,t[7]=0,t[8]=z+Z,t[9]=F-G,t[10]=1-T-I,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},s.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=-n,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},s.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},s.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return Ie[e]},s.getAABBPointSquareDist=function(t,e,n){let a=0;for(let u=0;u<2;++u){const d=n?n[u]:0;t[u]>d&&(a+=(t[u]-d)*(t[u]-d)),e[u]<d&&(a+=(d-e[u])*(d-e[u]))}return a},s.getAnchorAlignment=om,s.getAnchorJustification=lm,s.getBounds=function(t){let e=1/0,n=1/0,a=-1/0,u=-1/0;for(const d of t)e=Math.min(e,d.x),n=Math.min(n,d.y),a=Math.max(a,d.x),u=Math.max(u,d.y);return{min:new D(e,n),max:new D(a,u)}},s.getColumn=function(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]},s.getImage=Mh,s.getJSON=function(t,e){return Cr(dt(t,{type:"json"}),e)},s.getMapSessionAPI=Ao,s.getPerformanceMeasurement=v0,s.getProjection=function(t){const e=W0[t.name];if(!e)throw new Error(`Invalid projection name: ${t.name}`);return e.conic?function(n,a){if(a.parallels&&Math.abs(a.parallels[0]+a.parallels[1])<.01){let u=function(d){const m=Math.max(.01,Math.cos(ae(d))),v=1/(2*Math.max(Math.PI*m,1/m));return{wrap:!0,supportsWorldCopies:!0,unsupportedLayers:["custom"],project(b,T){const A=ae(b)*m,I=Math.sin(ae(T))/m;return{x:A*v+.5,y:-I*v+.5,z:0}},unproject(b,T){const A=-(T-.5)/v,I=Ne(Ce((b-.5)/v)/m,-180,180),z=Math.asin(Ne(A*m,-1,1)),F=Ne(Ce(z),-85.051129,Uo);return new Ii(I,F)}}}(a.parallels[0]);if(a.name==="lambertConformalConic"){const{project:d,unproject:m}=W0.mercator;u={wrap:!0,supportsWorldCopies:!0,project:d,unproject:m}}return dt({},n,a,u)}return dt({},n,a)}(e,t):e},s.getRTLTextPluginStatus=_r,s.getReferrer=qc,s.getTilePoint=function(t,{x:e,y:n},a=0){return new D(((e-a)*t.scale-t.x)*ni,(n*t.scale-t.y)*ni)},s.getTileVec3=function(t,e,n=0){return Tt(((e.x-n)*t.scale-t.x)*ni,(e.y*t.scale-t.y)*ni,fy(e.z,e.y))},s.getVideo=function(t,e){const n=U.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let a=0;a<t.length;a++){const u=U.document.createElement("source");Ah(t[a])||(n.crossOrigin="Anonymous"),u.src=t[a],n.appendChild(u)}return{cancel:()=>{}}},s.globeBuffersForTileMesh=function(t,e,n,a){const u=t.context,d=t.transform;let m=e.globeGridBuffer,v=e.globePoleBuffer;if(!m){const b=Sm.createGridVertices(n.canonical);m=e.globeGridBuffer=u.createVertexBuffer(b,B0,!1)}if(!v){const b=Sm.createPoleTriangleVertices(a,d.tileSize*a,n.canonical.y===0);v=e.globePoleBuffer=u.createVertexBuffer(b,B0,!1)}return[m,v]},s.globeDenormalizeECEF=U0,s.globeMatrixForTile=function(t,e){const n=U0(qd(t)),a=((u=new Float64Array(16))[0]=(d=e)[0],u[1]=d[1],u[2]=d[2],u[3]=d[3],u[4]=d[4],u[5]=d[5],u[6]=d[6],u[7]=d[7],u[8]=d[8],u[9]=d[9],u[10]=d[10],u[11]=d[11],u[12]=d[12],u[13]=d[13],u[14]=d[14],u[15]=d[15],u);var u,d;return lt(a,a,n),a},s.globePoleMatrixForTile=function(t,e,n){const a=we(new Float64Array(16)),u=Math.pow(2,t.z),d=(t.x-u/2)/u*Math.PI*2,m=n.point,v=n.worldSize/(n.tileSize*u);return Xe(a,a,[m.x,m.y,-n.worldSize/Math.PI/2]),Ue(a,a,[v,v,v]),st(a,a,ae(-n._center.lat)),ut(a,a,ae(-n._center.lng)),ut(a,a,d),e&&Ue(a,a,[1,-1,1]),a},s.globeTileBounds=qd,s.globeToMercatorTransition=function(t){return tt(5,6,t)},s.identity=we,s.identity$1=ui,s.invert=function(t,e){var n=e[0],a=e[1],u=e[2],d=e[3],m=e[4],v=e[5],b=e[6],T=e[7],A=e[8],I=e[9],z=e[10],F=e[11],j=e[12],G=e[13],Z=e[14],Q=e[15],se=n*v-a*m,de=n*b-u*m,me=n*T-d*m,_e=a*b-u*v,xe=a*T-d*v,Oe=u*T-d*b,Pe=A*G-I*j,nt=A*Z-z*j,Ye=A*Q-F*j,Re=I*Z-z*G,Je=I*Q-F*G,at=z*Q-F*Z,je=se*at-de*Je+me*Re+_e*Ye-xe*nt+Oe*Pe;return je?(t[0]=(v*at-b*Je+T*Re)*(je=1/je),t[1]=(u*Je-a*at-d*Re)*je,t[2]=(G*Oe-Z*xe+Q*_e)*je,t[3]=(z*xe-I*Oe-F*_e)*je,t[4]=(b*Ye-m*at-T*nt)*je,t[5]=(n*at-u*Ye+d*nt)*je,t[6]=(Z*me-j*Oe-Q*de)*je,t[7]=(A*Oe-z*me+F*de)*je,t[8]=(m*Je-v*Ye+T*Pe)*je,t[9]=(a*Ye-n*Je-d*Pe)*je,t[10]=(j*xe-G*me+Q*se)*je,t[11]=(I*me-A*xe-F*se)*je,t[12]=(v*nt-m*Re-b*Pe)*je,t[13]=(n*Re-a*nt+u*Pe)*je,t[14]=(G*de-j*_e-Z*se)*je,t[15]=(A*_e-I*de+z*se)*je,t):null},s.isMapAuthenticated=function(t){return ao.has(t)},s.isMapboxURL=Y,s.latFromMercatorY=Kr,s.len=yt,s.length=Ct,s.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},s.loadVectorTile=G0,s.makeRequest=Cr,s.mercatorXfromLng=Xl,s.mercatorYfromLat=Kl,s.mercatorZfromAltitude=mo,s.mul=lt,s.mul$1=Be,s.multiply=function(t,e,n){var a=e[0],u=e[1],d=e[2],m=e[3],v=e[4],b=e[5],T=e[6],A=e[7],I=e[8],z=n[0],F=n[1],j=n[2],G=n[3],Z=n[4],Q=n[5],se=n[6],de=n[7],me=n[8];return t[0]=z*a+F*m+j*T,t[1]=z*u+F*v+j*A,t[2]=z*d+F*b+j*I,t[3]=G*a+Z*m+Q*T,t[4]=G*u+Z*v+Q*A,t[5]=G*d+Z*b+Q*I,t[6]=se*a+de*m+me*T,t[7]=se*u+de*v+me*A,t[8]=se*d+de*b+me*I,t},s.multiply$1=De,s.multiply$2=Ai,s.nextPowerOfTwo=Wt,s.normalize=ei,s.normalize$1=function(t,e){var n=e[0],a=e[1],u=e[2],d=e[3],m=n*n+a*a+u*u+d*d;return m>0&&(m=1/Math.sqrt(m)),t[0]=n*m,t[1]=a*m,t[2]=u*m,t[3]=d*m,t},s.number=Ei,s.ortho=function(t,e,n,a,u,d,m){var v=1/(e-n),b=1/(a-u),T=1/(d-m);return t[0]=-2*v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*b,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*T,t[11]=0,t[12]=(e+n)*v,t[13]=(u+a)*b,t[14]=(m+d)*T,t[15]=1,t},s.pbf=zu,s.perspective=function(t,e,n,a,u){var d,m=1/Math.tan(e/2);return t[0]=m/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=m,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,u!=null&&u!==1/0?(t[10]=(u+a)*(d=1/(a-u)),t[14]=2*u*a*d):(t[10]=-1,t[14]=-2*a),t},s.pick=function(t,e){const n={};for(let a=0;a<e.length;a++){const u=e[a];u in t&&(n[u]=t[u])}return n},s.plugin=fi,s.pointGeometry=D,s.polygonIntersectsBox=xy,s.polygonIntersectsPolygon=gy,s.polygonizeBounds=function(t,e,n=0,a=!0){const u=new D(n,n),d=t.sub(u),m=e.add(u),v=[d,new D(m.x,d.y),m,new D(d.x,m.y)];return a&&v.push(d),v},s.posAttributes=QT,s.postMapLoadEvent=Mi,s.postTurnstileEvent=Ht,s.potpack=tm,s.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},s.radToDeg=Ce,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(t){return t({pluginStatus:Ot,pluginURL:ii}),Qn.on("pluginStateChange",t),t},s.removeAuthState=function(t){ao.delete(t)},s.renderColorRamp=qf,s.rotateX=st,s.rotateX$1=pi,s.rotateY=ut,s.rotateZ=function(t,e,n){var a=Math.sin(n),u=Math.cos(n),d=e[0],m=e[1],v=e[2],b=e[3],T=e[4],A=e[5],I=e[6],z=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=d*u+T*a,t[1]=m*u+A*a,t[2]=v*u+I*a,t[3]=b*u+z*a,t[4]=T*u-d*a,t[5]=A*u-m*a,t[6]=I*u-v*a,t[7]=z*u-b*a,t},s.rotateZ$1=function(t,e,n){n*=.5;var a=e[0],u=e[1],d=e[2],m=e[3],v=Math.sin(n),b=Math.cos(n);return t[0]=a*b+u*v,t[1]=u*b-a*v,t[2]=d*b+m*v,t[3]=m*b-d*v,t},s.scale=Ue,s.scale$1=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},s.scale$2=ri,s.scaleAndAdd=qt,s.setCacheLimits=function(t,e){Ch=t,$c=e},s.setColumn=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},s.setRTLTextPlugin=function(t,e,n=!1){if(Ot===zt||Ot===Ut||Ot===Ci)throw new Error("setRTLTextPlugin cannot be called multiple times.");ii=Ln.resolveURL(t),Ot=zt,Di=e,hn(),n||kr()},s.smoothstep=tt,s.spec=ke,s.storeAuthState=function(t,e){e?ao.add(t):ao.delete(t)},s.sub=Dn,s.subtract=Nt,s.symbolSize=lT,s.tileAABB=function(t,e,n,a,u,d,m,v,b){if(b.name==="globe"){const F=qd(new gm(d,new jd(n,a,u)).canonical).getCorners(),j=Number.MAX_VALUE,G=[-j,-j,-j],Z=[j,j,j],Q=j0(t,e);for(let se=0;se<F.length;se++)Et(F[se],F[se],Q),A=Z,I=F[se],(T=Z)[0]=Math.min(A[0],I[0]),T[1]=Math.min(A[1],I[1]),T[2]=Math.min(A[2],I[2]),Zi(G,G,F[se]);return new go(Z,G)}var T,A,I;const z=lc({z:n,x:a,y:u},b);return new go([(d+z.x/z.scale)*e,e*(z.y/z.scale),m],[(d+z.x2/z.scale)*e,e*(z.y2/z.scale),v])},s.tileTransform=lc,s.transformMat3=function(t,e,n){var a=e[0],u=e[1],d=e[2];return t[0]=a*n[0]+u*n[3]+d*n[6],t[1]=a*n[1]+u*n[4]+d*n[7],t[2]=a*n[2]+u*n[5]+d*n[8],t},s.transformMat4=Et,s.transformMat4$1=rt,s.transformQuat=en,s.translate=Xe,s.transpose=function(t,e){if(t===e){var n=e[1],a=e[2],u=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=a,t[7]=u}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},s.triggerPluginCompletionEvent=Ui,s.uniqueId=Zt,s.validateCustomStyleLayer=function(t){const e=[],n=t.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),t.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},s.validateFog=bf,s.validateLight=Ds,s.validateStyle=Ps,s.values=wt,s.vectorTile=Ua,s.version=C,s.warnOnce=Yt,s.window=U,s.wrap=Ze}),y(["./shared"],function(s){function C(J){const B=typeof J;if(B==="number"||B==="boolean"||B==="string"||J==null)return JSON.stringify(J);if(Array.isArray(J)){let ee="[";for(const he of J)ee+=`${C(he)},`;return`${ee}]`}const V=Object.keys(J).sort();let K="{";for(let ee=0;ee<V.length;ee++)K+=`${JSON.stringify(V[ee])}:${C(J[V[ee]])},`;return`${K}}`}function k(J){let B="";for(const V of s.refProperties)B+=`/${C(J[V])}`;return B}class M{constructor(B){this.keyCache={},B&&this.replace(B)}replace(B){this._layerConfigs={},this._layers={},this.update(B,[])}update(B,V){for(const ee of B)this._layerConfigs[ee.id]=ee,(this._layers[ee.id]=s.createStyleLayer(ee)).compileFilter(),this.keyCache[ee.id]&&delete this.keyCache[ee.id];for(const ee of V)delete this.keyCache[ee],delete this._layerConfigs[ee],delete this._layers[ee];this.familiesBySource={};const K=function(ee,he){const ye={};for(let pe=0;pe<ee.length;pe++){const ue=he&&he[ee[pe].id]||k(ee[pe]);he&&(he[ee[pe].id]=ue);let Y=ye[ue];Y||(Y=ye[ue]=[]),Y.push(ee[pe])}const ve=[];for(const pe in ye)ve.push(ye[pe]);return ve}(s.values(this._layerConfigs),this.keyCache);for(const ee of K){const he=ee.map(fe=>this._layers[fe.id]),ye=he[0];if(ye.visibility==="none")continue;const ve=ye.source||"";let pe=this.familiesBySource[ve];pe||(pe=this.familiesBySource[ve]={});const ue=ye.sourceLayer||"_geojsonTileLayer";let Y=pe[ue];Y||(Y=pe[ue]=[]),Y.push(he)}}}const{ImageBitmap:D}=s.window;class R{loadTile(B,V){const{uid:K,encoding:ee,rawImageData:he,padding:ye,buildQuadTree:ve}=B,pe=D&&he instanceof D?this.getImageData(he,ye):he;V(null,new s.DEMData(K,pe,ee,ye<1,ve))}getImageData(B,V){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(B.width,B.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=B.width,this.offscreenCanvas.height=B.height,this.offscreenCanvasContext.drawImage(B,0,0,B.width,B.height);const K=this.offscreenCanvasContext.getImageData(-V,-V,B.width+2*V,B.height+2*V);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new s.RGBAImage({width:K.width,height:K.height},K.data)}}var U=function J(B,V){var K,ee=B&&B.type;if(ee==="FeatureCollection")for(K=0;K<B.features.length;K++)J(B.features[K],V);else if(ee==="GeometryCollection")for(K=0;K<B.geometries.length;K++)J(B.geometries[K],V);else if(ee==="Feature")J(B.geometry,V);else if(ee==="Polygon")ge(B.coordinates,V);else if(ee==="MultiPolygon")for(K=0;K<B.coordinates.length;K++)ge(B.coordinates[K],V);return B};function ge(J,B){if(J.length!==0){Ee(J[0],B);for(var V=1;V<J.length;V++)Ee(J[V],!B)}}function Ee(J,B){for(var V=0,K=0,ee=0,he=J.length,ye=he-1;ee<he;ye=ee++){var ve=(J[ee][0]-J[ye][0])*(J[ye][1]+J[ee][1]),pe=V+ve;K+=Math.abs(V)>=Math.abs(ve)?V-pe+ve:ve-pe+V,V=pe}V+K>=0!=!!B&&J.reverse()}const be=s.vectorTile.VectorTileFeature.prototype.toGeoJSON;class we{constructor(B){this._feature=B,this.extent=s.EXTENT,this.type=B.type,this.properties=B.tags,"id"in B&&!isNaN(B.id)&&(this.id=parseInt(B.id,10))}loadGeometry(){if(this._feature.type===1){const B=[];for(const V of this._feature.geometry)B.push([new s.pointGeometry(V[0],V[1])]);return B}{const B=[];for(const V of this._feature.geometry){const K=[];for(const ee of V)K.push(new s.pointGeometry(ee[0],ee[1]));B.push(K)}return B}}toGeoJSON(B,V,K){return be.call(this,B,V,K)}}class De{constructor(B){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=B.length,this._features=B}feature(B){return new we(this._features[B])}}var Xe=s.vectorTile.VectorTileFeature,Ue=st;function st(J,B){this.options=B||{},this.features=J,this.length=J.length}function ut(J,B){this.id=typeof J.id=="number"?J.id:void 0,this.type=J.type,this.rawGeometry=J.type===1?[J.geometry]:J.geometry,this.properties=J.tags,this.extent=B||4096}st.prototype.feature=function(J){return new ut(this.features[J],this.options.extent)},ut.prototype.loadGeometry=function(){var J=this.rawGeometry;this.geometry=[];for(var B=0;B<J.length;B++){for(var V=J[B],K=[],ee=0;ee<V.length;ee++)K.push(new s.pointGeometry(V[ee][0],V[ee][1]));this.geometry.push(K)}return this.geometry},ut.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var J=this.geometry,B=1/0,V=-1/0,K=1/0,ee=-1/0,he=0;he<J.length;he++)for(var ye=J[he],ve=0;ve<ye.length;ve++){var pe=ye[ve];B=Math.min(B,pe.x),V=Math.max(V,pe.x),K=Math.min(K,pe.y),ee=Math.max(ee,pe.y)}return[B,K,V,ee]},ut.prototype.toGeoJSON=Xe.prototype.toGeoJSON;var lt=Ft,It=Ue;function Ft(J){var B=new s.pbf;return function(V,K){for(var ee in V.layers)K.writeMessage(3,Ct,V.layers[ee])}(J,B),B.finish()}function Ct(J,B){var V;B.writeVarintField(15,J.version||1),B.writeStringField(1,J.name||""),B.writeVarintField(5,J.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<J.length;V++)K.feature=J.feature(V),B.writeMessage(2,Tt,K);var ee=K.keys;for(V=0;V<ee.length;V++)B.writeStringField(3,ee[V]);var he=K.values;for(V=0;V<he.length;V++)B.writeMessage(4,ri,he[V])}function Tt(J,B){var V=J.feature;V.id!==void 0&&B.writeVarintField(1,V.id),B.writeMessage(2,ot,J),B.writeVarintField(3,V.type),B.writeMessage(4,Zi,V)}function ot(J,B){var V=J.feature,K=J.keys,ee=J.values,he=J.keycache,ye=J.valuecache;for(var ve in V.properties){var pe=V.properties[ve],ue=he[ve];if(pe!==null){ue===void 0&&(K.push(ve),he[ve]=ue=K.length-1),B.writeVarint(ue);var Y=typeof pe;Y!=="string"&&Y!=="boolean"&&Y!=="number"&&(pe=JSON.stringify(pe));var fe=Y+":"+pe,Te=ye[fe];Te===void 0&&(ee.push(pe),ye[fe]=Te=ee.length-1),B.writeVarint(Te)}}}function Nt(J,B){return(B<<3)+(7&J)}function Ai(J){return J<<1^J>>31}function Zi(J,B){for(var V=J.loadGeometry(),K=J.type,ee=0,he=0,ye=V.length,ve=0;ve<ye;ve++){var pe=V[ve],ue=1;K===1&&(ue=pe.length),B.writeVarint(Nt(1,ue));for(var Y=K===3?pe.length-1:pe.length,fe=0;fe<Y;fe++){fe===1&&K!==1&&B.writeVarint(Nt(2,Y-1));var Te=pe[fe].x-ee,it=pe[fe].y-he;B.writeVarint(Ai(Te)),B.writeVarint(Ai(it)),ee+=Te,he+=it}K===3&&B.writeVarint(Nt(7,1))}}function ri(J,B){var V=typeof J;V==="string"?B.writeStringField(1,J):V==="boolean"?B.writeBooleanField(7,J):V==="number"&&(J%1!=0?B.writeDoubleField(3,J):J<0?B.writeSVarintField(6,J):B.writeVarintField(5,J))}function qt(J,B,V,K,ee,he){if(ee-K<=V)return;const ye=K+ee>>1;ei(J,B,ye,K,ee,he%2),qt(J,B,V,K,ye-1,he+1),qt(J,B,V,ye+1,ee,he+1)}function ei(J,B,V,K,ee,he){for(;ee>K;){if(ee-K>600){const ue=ee-K+1,Y=V-K+1,fe=Math.log(ue),Te=.5*Math.exp(2*fe/3),it=.5*Math.sqrt(fe*Te*(ue-Te)/ue)*(Y-ue/2<0?-1:1);ei(J,B,V,Math.max(K,Math.floor(V-Y*Te/ue+it)),Math.min(ee,Math.floor(V+(ue-Y)*Te/ue+it)),he)}const ye=B[2*V+he];let ve=K,pe=ee;for(Si(J,B,K,V),B[2*ee+he]>ye&&Si(J,B,K,ee);ve<pe;){for(Si(J,B,ve,pe),ve++,pe--;B[2*ve+he]<ye;)ve++;for(;B[2*pe+he]>ye;)pe--}B[2*K+he]===ye?Si(J,B,K,pe):(pe++,Si(J,B,pe,ee)),pe<=V&&(K=pe+1),V<=pe&&(ee=pe-1)}}function Si(J,B,V,K){Qi(J,V,K),Qi(B,2*V,2*K),Qi(B,2*V+1,2*K+1)}function Qi(J,B,V){const K=J[B];J[B]=J[V],J[V]=K}function Et(J,B,V,K){const ee=J-V,he=B-K;return ee*ee+he*he}lt.fromVectorTileJs=Ft,lt.fromGeojsonVt=function(J,B){B=B||{};var V={};for(var K in J)V[K]=new Ue(J[K].features,B),V[K].name=K,V[K].version=B.version,V[K].extent=B.extent;return Ft({layers:V})},lt.GeoJSONWrapper=It;const en=J=>J[0],ti=J=>J[1];class Dn{constructor(B,V=en,K=ti,ee=64,he=Float64Array){this.nodeSize=ee,this.points=B;const ye=B.length<65536?Uint16Array:Uint32Array,ve=this.ids=new ye(B.length),pe=this.coords=new he(2*B.length);for(let ue=0;ue<B.length;ue++)ve[ue]=ue,pe[2*ue]=V(B[ue]),pe[2*ue+1]=K(B[ue]);qt(ve,pe,ee,0,ve.length-1,0)}range(B,V,K,ee){return function(he,ye,ve,pe,ue,Y,fe){const Te=[0,he.length-1,0],it=[];let mt,gt;for(;Te.length;){const vt=Te.pop(),$t=Te.pop(),Ht=Te.pop();if($t-Ht<=fe){for(let Bi=Ht;Bi<=$t;Bi++)mt=ye[2*Bi],gt=ye[2*Bi+1],mt>=ve&&mt<=ue&&gt>=pe&&gt<=Y&&it.push(he[Bi]);continue}const Pi=Math.floor((Ht+$t)/2);mt=ye[2*Pi],gt=ye[2*Pi+1],mt>=ve&&mt<=ue&&gt>=pe&&gt<=Y&&it.push(he[Pi]);const Mi=(vt+1)%2;(vt===0?ve<=mt:pe<=gt)&&(Te.push(Ht),Te.push(Pi-1),Te.push(Mi)),(vt===0?ue>=mt:Y>=gt)&&(Te.push(Pi+1),Te.push($t),Te.push(Mi))}return it}(this.ids,this.coords,B,V,K,ee,this.nodeSize)}within(B,V,K){return function(ee,he,ye,ve,pe,ue){const Y=[0,ee.length-1,0],fe=[],Te=pe*pe;for(;Y.length;){const it=Y.pop(),mt=Y.pop(),gt=Y.pop();if(mt-gt<=ue){for(let Mi=gt;Mi<=mt;Mi++)Et(he[2*Mi],he[2*Mi+1],ye,ve)<=Te&&fe.push(ee[Mi]);continue}const vt=Math.floor((gt+mt)/2),$t=he[2*vt],Ht=he[2*vt+1];Et($t,Ht,ye,ve)<=Te&&fe.push(ee[vt]);const Pi=(it+1)%2;(it===0?ye-pe<=$t:ve-pe<=Ht)&&(Y.push(gt),Y.push(vt-1),Y.push(Pi)),(it===0?ye+pe>=$t:ve+pe>=Ht)&&(Y.push(vt+1),Y.push(mt),Y.push(Pi))}return fe}(this.ids,this.coords,B,V,K,this.nodeSize)}}const Be={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:J=>J},yt=Math.fround||(rt=new Float32Array(1),J=>(rt[0]=+J,rt[0]));var rt;class At{constructor(B){this.options=Ie(Object.create(Be),B),this.trees=new Array(this.options.maxZoom+1)}load(B){const{log:V,minZoom:K,maxZoom:ee,nodeSize:he}=this.options;V&&console.time("total time");const ye=`prepare ${B.length} points`;V&&console.time(ye),this.points=B;let ve=[];for(let pe=0;pe<B.length;pe++)B[pe].geometry&&ve.push(pi(B[pe],pe));this.trees[ee+1]=new Dn(ve,Ve,Ke,he,Float32Array),V&&console.timeEnd(ye);for(let pe=ee;pe>=K;pe--){const ue=+Date.now();ve=this._cluster(ve,pe),this.trees[pe]=new Dn(ve,Ve,Ke,he,Float32Array),V&&console.log("z%d: %d clusters in %dms",pe,ve.length,+Date.now()-ue)}return V&&console.timeEnd("total time"),this}getClusters(B,V){let K=((B[0]+180)%360+360)%360-180;const ee=Math.max(-90,Math.min(90,B[1]));let he=B[2]===180?180:((B[2]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,B[3]));if(B[2]-B[0]>=360)K=-180,he=180;else if(K>he){const Y=this.getClusters([K,ee,180,ye],V),fe=this.getClusters([-180,ee,he,ye],V);return Y.concat(fe)}const ve=this.trees[this._limitZoom(V)],pe=ve.range(te(K),ae(ye),te(he),ae(ee)),ue=[];for(const Y of pe){const fe=ve.points[Y];ue.push(fe.numPoints?Le(fe):this.points[fe.index])}return ue}getChildren(B){const V=this._getOriginId(B),K=this._getOriginZoom(B),ee="No cluster with the specified id.",he=this.trees[K];if(!he)throw new Error(ee);const ye=he.points[V];if(!ye)throw new Error(ee);const ve=this.options.radius/(this.options.extent*Math.pow(2,K-1)),pe=he.within(ye.x,ye.y,ve),ue=[];for(const Y of pe){const fe=he.points[Y];fe.parentId===B&&ue.push(fe.numPoints?Le(fe):this.points[fe.index])}if(ue.length===0)throw new Error(ee);return ue}getLeaves(B,V,K){const ee=[];return this._appendLeaves(ee,B,V=V||10,K=K||0,0),ee}getTile(B,V,K){const ee=this.trees[this._limitZoom(B)],he=Math.pow(2,B),{extent:ye,radius:ve}=this.options,pe=ve/ye,ue=(K-pe)/he,Y=(K+1+pe)/he,fe={features:[]};return this._addTileFeatures(ee.range((V-pe)/he,ue,(V+1+pe)/he,Y),ee.points,V,K,he,fe),V===0&&this._addTileFeatures(ee.range(1-pe/he,ue,1,Y),ee.points,he,K,he,fe),V===he-1&&this._addTileFeatures(ee.range(0,ue,pe/he,Y),ee.points,-1,K,he,fe),fe.features.length?fe:null}getClusterExpansionZoom(B){let V=this._getOriginZoom(B)-1;for(;V<=this.options.maxZoom;){const K=this.getChildren(B);if(V++,K.length!==1)break;B=K[0].properties.cluster_id}return V}_appendLeaves(B,V,K,ee,he){const ye=this.getChildren(V);for(const ve of ye){const pe=ve.properties;if(pe&&pe.cluster?he+pe.point_count<=ee?he+=pe.point_count:he=this._appendLeaves(B,pe.cluster_id,K,ee,he):he<ee?he++:B.push(ve),B.length===K)break}return he}_addTileFeatures(B,V,K,ee,he,ye){for(const ve of B){const pe=V[ve],ue=pe.numPoints;let Y,fe,Te;if(ue)Y=We(pe),fe=pe.x,Te=pe.y;else{const gt=this.points[pe.index];Y=gt.properties,fe=te(gt.geometry.coordinates[0]),Te=ae(gt.geometry.coordinates[1])}const it={type:1,geometry:[[Math.round(this.options.extent*(fe*he-K)),Math.round(this.options.extent*(Te*he-ee))]],tags:Y};let mt;ue?mt=pe.id:this.options.generateId?mt=pe.index:this.points[pe.index].id&&(mt=this.points[pe.index].id),mt!==void 0&&(it.id=mt),ye.features.push(it)}}_limitZoom(B){return Math.max(this.options.minZoom,Math.min(+B,this.options.maxZoom+1))}_cluster(B,V){const K=[],{radius:ee,extent:he,reduce:ye,minPoints:ve}=this.options,pe=ee/(he*Math.pow(2,V));for(let ue=0;ue<B.length;ue++){const Y=B[ue];if(Y.zoom<=V)continue;Y.zoom=V;const fe=this.trees[V+1],Te=fe.within(Y.x,Y.y,pe),it=Y.numPoints||1;let mt=it;for(const gt of Te){const vt=fe.points[gt];vt.zoom>V&&(mt+=vt.numPoints||1)}if(mt>it&&mt>=ve){let gt=Y.x*it,vt=Y.y*it,$t=ye&&it>1?this._map(Y,!0):null;const Ht=(ue<<5)+(V+1)+this.points.length;for(const Pi of Te){const Mi=fe.points[Pi];if(Mi.zoom<=V)continue;Mi.zoom=V;const Bi=Mi.numPoints||1;gt+=Mi.x*Bi,vt+=Mi.y*Bi,Mi.parentId=Ht,ye&&($t||($t=this._map(Y,!0)),ye($t,this._map(Mi)))}Y.parentId=Ht,K.push(ui(gt/mt,vt/mt,Ht,mt,$t))}else if(K.push(Y),mt>1)for(const gt of Te){const vt=fe.points[gt];vt.zoom<=V||(vt.zoom=V,K.push(vt))}}return K}_getOriginId(B){return B-this.points.length>>5}_getOriginZoom(B){return(B-this.points.length)%32}_map(B,V){if(B.numPoints)return V?Ie({},B.properties):B.properties;const K=this.points[B.index].properties,ee=this.options.map(K);return V&&ee===K?Ie({},ee):ee}}function ui(J,B,V,K,ee){return{x:yt(J),y:yt(B),zoom:1/0,id:V,parentId:-1,numPoints:K,properties:ee}}function pi(J,B){const[V,K]=J.geometry.coordinates;return{x:yt(te(V)),y:yt(ae(K)),zoom:1/0,index:B,parentId:-1}}function Le(J){return{type:"Feature",id:J.id,properties:We(J),geometry:{type:"Point",coordinates:[(B=J.x,360*(B-.5)),Ce(J.y)]}};var B}function We(J){const B=J.numPoints,V=B>=1e4?`${Math.round(B/1e3)}k`:B>=1e3?Math.round(B/100)/10+"k":B;return Ie(Ie({},J.properties),{cluster:!0,cluster_id:J.id,point_count:B,point_count_abbreviated:V})}function te(J){return J/360+.5}function ae(J){const B=Math.sin(J*Math.PI/180),V=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return V<0?0:V>1?1:V}function Ce(J){const B=(180-360*J)*Math.PI/180;return 360*Math.atan(Math.exp(B))/Math.PI-90}function Ie(J,B){for(const V in B)J[V]=B[V];return J}function Ve(J){return J.x}function Ke(J){return J.y}function ht(J,B,V,K){for(var ee,he=K,ye=V-B>>1,ve=V-B,pe=J[B],ue=J[B+1],Y=J[V],fe=J[V+1],Te=B+3;Te<V;Te+=3){var it=Ne(J[Te],J[Te+1],pe,ue,Y,fe);if(it>he)ee=Te,he=it;else if(it===he){var mt=Math.abs(Te-ye);mt<ve&&(ee=Te,ve=mt)}}he>K&&(ee-B>3&&ht(J,B,ee,K),J[ee+2]=he,V-ee>3&&ht(J,ee,V,K))}function Ne(J,B,V,K,ee,he){var ye=ee-V,ve=he-K;if(ye!==0||ve!==0){var pe=((J-V)*ye+(B-K)*ve)/(ye*ye+ve*ve);pe>1?(V=ee,K=he):pe>0&&(V+=ye*pe,K+=ve*pe)}return(ye=J-V)*ye+(ve=B-K)*ve}function tt(J,B,V,K){var ee={id:J===void 0?null:J,type:B,geometry:V,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(he){var ye=he.geometry,ve=he.type;if(ve==="Point"||ve==="MultiPoint"||ve==="LineString")Ze(he,ye);else if(ve==="Polygon"||ve==="MultiLineString")for(var pe=0;pe<ye.length;pe++)Ze(he,ye[pe]);else if(ve==="MultiPolygon")for(pe=0;pe<ye.length;pe++)for(var ue=0;ue<ye[pe].length;ue++)Ze(he,ye[pe][ue])}(ee),ee}function Ze(J,B){for(var V=0;V<B.length;V+=3)J.minX=Math.min(J.minX,B[V]),J.minY=Math.min(J.minY,B[V+1]),J.maxX=Math.max(J.maxX,B[V]),J.maxY=Math.max(J.maxY,B[V+1])}function Mt(J,B,V,K){if(B.geometry){var ee=B.geometry.coordinates,he=B.geometry.type,ye=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),ve=[],pe=B.id;if(V.promoteId?pe=B.properties[V.promoteId]:V.generateId&&(pe=K||0),he==="Point")wt(ee,ve);else if(he==="MultiPoint")for(var ue=0;ue<ee.length;ue++)wt(ee[ue],ve);else if(he==="LineString")dt(ee,ve,ye,!1);else if(he==="MultiLineString"){if(V.lineMetrics){for(ue=0;ue<ee.length;ue++)dt(ee[ue],ve=[],ye,!1),J.push(tt(pe,"LineString",ve,B.properties));return}Lt(ee,ve,ye,!1)}else if(he==="Polygon")Lt(ee,ve,ye,!0);else{if(he!=="MultiPolygon"){if(he==="GeometryCollection"){for(ue=0;ue<B.geometry.geometries.length;ue++)Mt(J,{id:pe,geometry:B.geometry.geometries[ue],properties:B.properties},V,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ue=0;ue<ee.length;ue++){var Y=[];Lt(ee[ue],Y,ye,!0),ve.push(Y)}}J.push(tt(pe,he,ve,B.properties))}}function wt(J,B){B.push(Zt(J[0])),B.push(hi(J[1])),B.push(0)}function dt(J,B,V,K){for(var ee,he,ye=0,ve=0;ve<J.length;ve++){var pe=Zt(J[ve][0]),ue=hi(J[ve][1]);B.push(pe),B.push(ue),B.push(0),ve>0&&(ye+=K?(ee*ue-pe*he)/2:Math.sqrt(Math.pow(pe-ee,2)+Math.pow(ue-he,2))),ee=pe,he=ue}var Y=B.length-3;B[2]=1,ht(B,0,Y,V),B[Y+2]=1,B.size=Math.abs(ye),B.start=0,B.end=B.size}function Lt(J,B,V,K){for(var ee=0;ee<J.length;ee++){var he=[];dt(J[ee],he,V,K),B.push(he)}}function Zt(J){return J/360+.5}function hi(J){var B=Math.sin(J*Math.PI/180),V=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return V<0?0:V>1?1:V}function Wt(J,B,V,K,ee,he,ye,ve){if(K/=B,he>=(V/=B)&&ye<K)return J;if(ye<V||he>=K)return null;for(var pe=[],ue=0;ue<J.length;ue++){var Y=J[ue],fe=Y.geometry,Te=Y.type,it=ee===0?Y.minX:Y.minY,mt=ee===0?Y.maxX:Y.maxY;if(it>=V&&mt<K)pe.push(Y);else if(!(mt<V||it>=K)){var gt=[];if(Te==="Point"||Te==="MultiPoint")oi(fe,gt,V,K,ee);else if(Te==="LineString")Ki(fe,gt,V,K,ee,!1,ve.lineMetrics);else if(Te==="MultiLineString")fn(fe,gt,V,K,ee,!1);else if(Te==="Polygon")fn(fe,gt,V,K,ee,!0);else if(Te==="MultiPolygon")for(var vt=0;vt<fe.length;vt++){var $t=[];fn(fe[vt],$t,V,K,ee,!0),$t.length&&gt.push($t)}if(gt.length){if(ve.lineMetrics&&Te==="LineString"){for(vt=0;vt<gt.length;vt++)pe.push(tt(Y.id,Te,gt[vt],Y.tags));continue}Te!=="LineString"&&Te!=="MultiLineString"||(gt.length===1?(Te="LineString",gt=gt[0]):Te="MultiLineString"),Te!=="Point"&&Te!=="MultiPoint"||(Te=gt.length===3?"Point":"MultiPoint"),pe.push(tt(Y.id,Te,gt,Y.tags))}}}return pe.length?pe:null}function oi(J,B,V,K,ee){for(var he=0;he<J.length;he+=3){var ye=J[he+ee];ye>=V&&ye<=K&&(B.push(J[he]),B.push(J[he+1]),B.push(J[he+2]))}}function Ki(J,B,V,K,ee,he,ye){for(var ve,pe,ue=Cn(J),Y=ee===0?An:Ni,fe=J.start,Te=0;Te<J.length-3;Te+=3){var it=J[Te],mt=J[Te+1],gt=J[Te+2],vt=J[Te+3],$t=J[Te+4],Ht=ee===0?it:mt,Pi=ee===0?vt:$t,Mi=!1;ye&&(ve=Math.sqrt(Math.pow(it-vt,2)+Math.pow(mt-$t,2))),Ht<V?Pi>V&&(pe=Y(ue,it,mt,vt,$t,V),ye&&(ue.start=fe+ve*pe)):Ht>K?Pi<K&&(pe=Y(ue,it,mt,vt,$t,K),ye&&(ue.start=fe+ve*pe)):Hn(ue,it,mt,gt),Pi<V&&Ht>=V&&(pe=Y(ue,it,mt,vt,$t,V),Mi=!0),Pi>K&&Ht<=K&&(pe=Y(ue,it,mt,vt,$t,K),Mi=!0),!he&&Mi&&(ye&&(ue.end=fe+ve*pe),B.push(ue),ue=Cn(J)),ye&&(fe+=ve)}var Bi=J.length-3;it=J[Bi],mt=J[Bi+1],gt=J[Bi+2],(Ht=ee===0?it:mt)>=V&&Ht<=K&&Hn(ue,it,mt,gt),Bi=ue.length-3,he&&Bi>=3&&(ue[Bi]!==ue[0]||ue[Bi+1]!==ue[1])&&Hn(ue,ue[0],ue[1],ue[2]),ue.length&&B.push(ue)}function Cn(J){var B=[];return B.size=J.size,B.start=J.start,B.end=J.end,B}function fn(J,B,V,K,ee,he){for(var ye=0;ye<J.length;ye++)Ki(J[ye],B,V,K,ee,he,!1)}function Hn(J,B,V,K){J.push(B),J.push(V),J.push(K)}function An(J,B,V,K,ee,he){var ye=(he-B)/(K-B);return J.push(he),J.push(V+(ee-V)*ye),J.push(1),ye}function Ni(J,B,V,K,ee,he){var ye=(he-V)/(ee-V);return J.push(B+(K-B)*ye),J.push(he),J.push(1),ye}function Yt(J,B){for(var V=[],K=0;K<J.length;K++){var ee,he=J[K],ye=he.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")ee=Mn(he.geometry,B);else if(ye==="MultiLineString"||ye==="Polygon"){ee=[];for(var ve=0;ve<he.geometry.length;ve++)ee.push(Mn(he.geometry[ve],B))}else if(ye==="MultiPolygon")for(ee=[],ve=0;ve<he.geometry.length;ve++){for(var pe=[],ue=0;ue<he.geometry[ve].length;ue++)pe.push(Mn(he.geometry[ve][ue],B));ee.push(pe)}V.push(tt(he.id,ye,ee,he.tags))}return V}function Mn(J,B){var V=[];V.size=J.size,J.start!==void 0&&(V.start=J.start,V.end=J.end);for(var K=0;K<J.length;K+=3)V.push(J[K]+B,J[K+1],J[K+2]);return V}function ro(J,B){if(J.transformed)return J;var V,K,ee,he=1<<J.z,ye=J.x,ve=J.y;for(V=0;V<J.features.length;V++){var pe=J.features[V],ue=pe.geometry,Y=pe.type;if(pe.geometry=[],Y===1)for(K=0;K<ue.length;K+=2)pe.geometry.push(Xn(ue[K],ue[K+1],B,he,ye,ve));else for(K=0;K<ue.length;K++){var fe=[];for(ee=0;ee<ue[K].length;ee+=2)fe.push(Xn(ue[K][ee],ue[K][ee+1],B,he,ye,ve));pe.geometry.push(fe)}}return J.transformed=!0,J}function Xn(J,B,V,K,ee,he){return[Math.round(V*(J*K-ee)),Math.round(V*(B*K-he))]}function oo(J,B,V,K,ee){for(var he=B===ee.maxZoom?0:ee.tolerance/((1<<B)*ee.extent),ye={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:K,z:B,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ve=0;ve<J.length;ve++){ye.numFeatures++,Vr(ye,J[ve],he,ee);var pe=J[ve].minX,ue=J[ve].minY,Y=J[ve].maxX,fe=J[ve].maxY;pe<ye.minX&&(ye.minX=pe),ue<ye.minY&&(ye.minY=ue),Y>ye.maxX&&(ye.maxX=Y),fe>ye.maxY&&(ye.maxY=fe)}return ye}function Vr(J,B,V,K){var ee=B.geometry,he=B.type,ye=[];if(he==="Point"||he==="MultiPoint")for(var ve=0;ve<ee.length;ve+=3)ye.push(ee[ve]),ye.push(ee[ve+1]),J.numPoints++,J.numSimplified++;else if(he==="LineString")Kn(ye,ee,J,V,!1,!1);else if(he==="MultiLineString"||he==="Polygon")for(ve=0;ve<ee.length;ve++)Kn(ye,ee[ve],J,V,he==="Polygon",ve===0);else if(he==="MultiPolygon")for(var pe=0;pe<ee.length;pe++){var ue=ee[pe];for(ve=0;ve<ue.length;ve++)Kn(ye,ue[ve],J,V,!0,ve===0)}if(ye.length){var Y=B.tags||null;if(he==="LineString"&&K.lineMetrics){for(var fe in Y={},B.tags)Y[fe]=B.tags[fe];Y.mapbox_clip_start=ee.start/ee.size,Y.mapbox_clip_end=ee.end/ee.size}var Te={geometry:ye,type:he==="Polygon"||he==="MultiPolygon"?3:he==="LineString"||he==="MultiLineString"?2:1,tags:Y};B.id!==null&&(Te.id=B.id),J.features.push(Te)}}function Kn(J,B,V,K,ee,he){var ye=K*K;if(K>0&&B.size<(ee?ye:K))V.numPoints+=B.length/3;else{for(var ve=[],pe=0;pe<B.length;pe+=3)(K===0||B[pe+2]>ye)&&(V.numSimplified++,ve.push(B[pe]),ve.push(B[pe+1])),V.numPoints++;ee&&function(ue,Y){for(var fe=0,Te=0,it=ue.length,mt=it-2;Te<it;mt=Te,Te+=2)fe+=(ue[Te]-ue[mt])*(ue[Te+1]+ue[mt+1]);if(fe>0===Y)for(Te=0,it=ue.length;Te<it/2;Te+=2){var gt=ue[Te],vt=ue[Te+1];ue[Te]=ue[it-2-Te],ue[Te+1]=ue[it-1-Te],ue[it-2-Te]=gt,ue[it-1-Te]=vt}}(ve,he),J.push(ve)}}function jn(J,B){var V=(B=this.options=function(ee,he){for(var ye in he)ee[ye]=he[ye];return ee}(Object.create(this.options),B)).debug;if(V&&console.time("preprocess data"),B.maxZoom<0||B.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(B.promoteId&&B.generateId)throw new Error("promoteId and generateId cannot be used together.");var K=function(ee,he){var ye=[];if(ee.type==="FeatureCollection")for(var ve=0;ve<ee.features.length;ve++)Mt(ye,ee.features[ve],he,ve);else Mt(ye,ee.type==="Feature"?ee:{geometry:ee},he);return ye}(J,B);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",B.indexMaxZoom,B.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(K=function(ee,he){var ye=he.buffer/he.extent,ve=ee,pe=Wt(ee,1,-1-ye,ye,0,-1,2,he),ue=Wt(ee,1,1-ye,2+ye,0,-1,2,he);return(pe||ue)&&(ve=Wt(ee,1,-ye,1+ye,0,-1,2,he)||[],pe&&(ve=Yt(pe,1).concat(ve)),ue&&(ve=ve.concat(Yt(ue,-1)))),ve}(K,B)).length&&this.splitTile(K,0,0,0),V&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function $r(J,B,V){return 32*((1<<J)*V+B)+J}function un(J,B){const V=J.tileID.canonical;if(!this._geoJSONIndex)return B(null,null);const K=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!K)return B(null,null);const ee=new De(K.features);let he=lt(ee);he.byteOffset===0&&he.byteLength===he.buffer.byteLength||(he=new Uint8Array(he)),B(null,{vectorTile:ee,rawData:he.buffer})}jn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},jn.prototype.splitTile=function(J,B,V,K,ee,he,ye){for(var ve=[J,B,V,K],pe=this.options,ue=pe.debug;ve.length;){K=ve.pop(),V=ve.pop(),B=ve.pop(),J=ve.pop();var Y=1<<B,fe=$r(B,V,K),Te=this.tiles[fe];if(!Te&&(ue>1&&console.time("creation"),Te=this.tiles[fe]=oo(J,B,V,K,pe),this.tileCoords.push({z:B,x:V,y:K}),ue)){ue>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",B,V,K,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));var it="z"+B;this.stats[it]=(this.stats[it]||0)+1,this.total++}if(Te.source=J,ee){if(B===pe.maxZoom||B===ee)continue;var mt=1<<ee-B;if(V!==Math.floor(he/mt)||K!==Math.floor(ye/mt))continue}else if(B===pe.indexMaxZoom||Te.numPoints<=pe.indexMaxPoints)continue;if(Te.source=null,J.length!==0){ue>1&&console.time("clipping");var gt,vt,$t,Ht,Pi,Mi,Bi=.5*pe.buffer/pe.extent,Ao=.5-Bi,ao=.5+Bi,In=1+Bi;gt=vt=$t=Ht=null,Pi=Wt(J,Y,V-Bi,V+ao,0,Te.minX,Te.maxX,pe),Mi=Wt(J,Y,V+Ao,V+In,0,Te.minX,Te.maxX,pe),J=null,Pi&&(gt=Wt(Pi,Y,K-Bi,K+ao,1,Te.minY,Te.maxY,pe),vt=Wt(Pi,Y,K+Ao,K+In,1,Te.minY,Te.maxY,pe),Pi=null),Mi&&($t=Wt(Mi,Y,K-Bi,K+ao,1,Te.minY,Te.maxY,pe),Ht=Wt(Mi,Y,K+Ao,K+In,1,Te.minY,Te.maxY,pe),Mi=null),ue>1&&console.timeEnd("clipping"),ve.push(gt||[],B+1,2*V,2*K),ve.push(vt||[],B+1,2*V,2*K+1),ve.push($t||[],B+1,2*V+1,2*K),ve.push(Ht||[],B+1,2*V+1,2*K+1)}}},jn.prototype.getTile=function(J,B,V){var K=this.options,ee=K.extent,he=K.debug;if(J<0||J>24)return null;var ye=1<<J,ve=$r(J,B=(B%ye+ye)%ye,V);if(this.tiles[ve])return ro(this.tiles[ve],ee);he>1&&console.log("drilling down to z%d-%d-%d",J,B,V);for(var pe,ue=J,Y=B,fe=V;!pe&&ue>0;)ue--,Y=Math.floor(Y/2),fe=Math.floor(fe/2),pe=this.tiles[$r(ue,Y,fe)];return pe&&pe.source?(he>1&&console.log("found parent tile z%d-%d-%d",ue,Y,fe),he>1&&console.time("drilling down"),this.splitTile(pe.source,ue,Y,fe,J,B,V),he>1&&console.timeEnd("drilling down"),this.tiles[ve]?ro(this.tiles[ve],ee):null):null};class so extends s.VectorTileWorkerSource{constructor(B,V,K,ee,he){super(B,V,K,ee,un),he&&(this.loadGeoJSON=he)}loadData(B,V){const K=B&&B.request,ee=K&&K.collectResourceTiming;this.loadGeoJSON(B,(he,ye)=>{if(he||!ye)return V(he);if(typeof ye!="object")return V(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`));{U(ye,!0);try{if(B.filter){const pe=s.createExpression(B.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(pe.result==="error")throw new Error(pe.value.map(Y=>`${Y.key}: ${Y.message}`).join(", "));const ue=ye.features.filter(Y=>pe.value.evaluate({zoom:0},Y));ye={type:"FeatureCollection",features:ue}}this._geoJSONIndex=B.cluster?new At(function({superclusterOptions:pe,clusterProperties:ue}){if(!ue||!pe)return pe;const Y={},fe={},Te={accumulated:null,zoom:0},it={properties:null},mt=Object.keys(ue);for(const gt of mt){const[vt,$t]=ue[gt],Ht=s.createExpression($t),Pi=s.createExpression(typeof vt=="string"?[vt,["accumulated"],["get",gt]]:vt);Y[gt]=Ht.value,fe[gt]=Pi.value}return pe.map=gt=>{it.properties=gt;const vt={};for(const $t of mt)vt[$t]=Y[$t].evaluate(Te,it);return vt},pe.reduce=(gt,vt)=>{it.properties=vt;for(const $t of mt)Te.accumulated=gt[$t],gt[$t]=fe[$t].evaluate(Te,it)},pe}(B)).load(ye.features):function(pe,ue){return new jn(pe,ue)}(ye,B.geojsonVtOptions)}catch(pe){return V(pe)}this.loaded={};const ve={};if(ee){const pe=s.getPerformanceMeasurement(K);pe&&(ve.resourceTiming={},ve.resourceTiming[B.source]=JSON.parse(JSON.stringify(pe)))}V(null,ve)}})}reloadTile(B,V){const K=this.loaded;return K&&K[B.uid]?super.reloadTile(B,V):this.loadTile(B,V)}loadGeoJSON(B,V){if(B.request)s.getJSON(B.request,V);else{if(typeof B.data!="string")return V(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`));try{return V(null,JSON.parse(B.data))}catch{return V(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(B,V){try{V(null,this._geoJSONIndex.getClusterExpansionZoom(B.clusterId))}catch(K){V(K)}}getClusterChildren(B,V){try{V(null,this._geoJSONIndex.getChildren(B.clusterId))}catch(K){V(K)}}getClusterLeaves(B,V){try{V(null,this._geoJSONIndex.getLeaves(B.clusterId,B.limit,B.offset))}catch(K){V(K)}}}class Ln{constructor(B){this.self=B,this.actor=new s.Actor(B,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:so},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(V,K)=>{if(this.workerSourceTypes[V])throw new Error(`Worker source with name "${V}" already registered.`);this.workerSourceTypes[V]=K},this.self.registerRTLTextPlugin=V=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=V.applyArabicShaping,s.plugin.processBidirectionalText=V.processBidirectionalText,s.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}}clearCaches(B,V,K){delete this.layerIndexes[B],delete this.availableImages[B],delete this.workerSources[B],delete this.demWorkerSources[B],K()}checkIfReady(B,V,K){K()}setReferrer(B,V){this.referrer=V}spriteLoaded(B,V){this.isSpriteLoaded[B]=V;for(const K in this.workerSources[B]){const ee=this.workerSources[B][K];for(const he in ee)ee[he]instanceof s.VectorTileWorkerSource&&(ee[he].isSpriteLoaded=V,ee[he].fire(new s.Event("isSpriteLoaded")))}}setImages(B,V,K){this.availableImages[B]=V;for(const ee in this.workerSources[B]){const he=this.workerSources[B][ee];for(const ye in he)he[ye].availableImages=V}K()}enableTerrain(B,V,K){this.terrain=V,K()}setProjection(B,V){this.projections[B]=s.getProjection(V)}setLayers(B,V,K){this.getLayerIndex(B).replace(V),K()}updateLayers(B,V,K){this.getLayerIndex(B).update(V.layers,V.removedIds),K()}loadTile(B,V,K){const ee=this.enableTerrain?s.extend({enableTerrain:this.terrain},V):V;ee.projection=this.projections[B]||this.defaultProjection,this.getWorkerSource(B,V.type,V.source).loadTile(ee,K)}loadDEMTile(B,V,K){const ee=this.enableTerrain?s.extend({buildQuadTree:this.terrain},V):V;this.getDEMWorkerSource(B,V.source).loadTile(ee,K)}reloadTile(B,V,K){const ee=this.enableTerrain?s.extend({enableTerrain:this.terrain},V):V;ee.projection=this.projections[B]||this.defaultProjection,this.getWorkerSource(B,V.type,V.source).reloadTile(ee,K)}abortTile(B,V,K){this.getWorkerSource(B,V.type,V.source).abortTile(V,K)}removeTile(B,V,K){this.getWorkerSource(B,V.type,V.source).removeTile(V,K)}removeSource(B,V,K){if(!this.workerSources[B]||!this.workerSources[B][V.type]||!this.workerSources[B][V.type][V.source])return;const ee=this.workerSources[B][V.type][V.source];delete this.workerSources[B][V.type][V.source],ee.removeSource!==void 0?ee.removeSource(V,K):K()}loadWorkerSource(B,V,K){try{this.self.importScripts(V.url),K()}catch(ee){K(ee.toString())}}syncRTLPluginState(B,V,K){try{s.plugin.setState(V);const ee=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&ee!=null){this.self.importScripts(ee);const he=s.plugin.isParsed();K(he?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ee}`),he)}}catch(ee){K(ee.toString())}}getAvailableImages(B){let V=this.availableImages[B];return V||(V=[]),V}getLayerIndex(B){let V=this.layerIndexes[B];return V||(V=this.layerIndexes[B]=new M),V}getWorkerSource(B,V,K){return this.workerSources[B]||(this.workerSources[B]={}),this.workerSources[B][V]||(this.workerSources[B][V]={}),this.workerSources[B][V][K]||(this.workerSources[B][V][K]=new this.workerSourceTypes[V]({send:(ee,he,ye,ve,pe,ue)=>{this.actor.send(ee,he,ye,B,pe,ue)},scheduler:this.actor.scheduler},this.getLayerIndex(B),this.getAvailableImages(B),this.isSpriteLoaded[B])),this.workerSources[B][V][K]}getDEMWorkerSource(B,V){return this.demWorkerSources[B]||(this.demWorkerSources[B]={}),this.demWorkerSources[B][V]||(this.demWorkerSources[B][V]=new R),this.demWorkerSources[B][V]}enforceCacheSizeLimit(B,V){s.enforceCacheSizeLimit(V)}getWorkerPerformanceMetrics(B,V,K){K(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Ln(self)),Ln}),y(["./shared"],function(s){var C=k;function k(p){return!function(i){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var f,_,x=new Blob([""],{type:"text/javascript"}),w=URL.createObjectURL(x);try{_=new Worker(w),f=!0}catch{f=!1}return _&&_.terminate(),URL.revokeObjectURL(w),f}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var f=document.createElement("canvas");f.width=f.height=1;var _=f.getContext("2d");if(!_)return!1;var x=_.getImageData(0,0,1,1);return x&&x.width===f.width}()?(M[c=i&&i.failIfMajorPerformanceCaveat]===void 0&&(M[c]=function(f){var _,x=function(w){var S=document.createElement("canvas"),P=Object.create(k.webGLContextAttributes);return P.failIfMajorPerformanceCaveat=w,S.getContext("webgl",P)||S.getContext("experimental-webgl",P)}(f);if(!x)return!1;try{_=x.createShader(x.VERTEX_SHADER)}catch{return!1}return!(!_||x.isContextLost())&&(x.shaderSource(_,"void main() {}"),x.compileShader(_),x.getShaderParameter(_,x.COMPILE_STATUS)===!0)}(c)),M[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(p)}var M={};function D(p,i){var c=i[0],f=i[1],_=i[2],x=i[3],w=c*x-_*f;return w?(p[0]=x*(w=1/w),p[1]=-f*w,p[2]=-_*w,p[3]=c*w,p):null}function R(p,i){if(Array.isArray(p)){if(!Array.isArray(i)||p.length!==i.length)return!1;for(let c=0;c<p.length;c++)if(!R(p[c],i[c]))return!1;return!0}if(typeof p=="object"&&p!==null&&i!==null){if(typeof i!="object"||Object.keys(p).length!==Object.keys(i).length)return!1;for(const c in p)if(!R(p[c],i[c]))return!1;return!0}return p===i}k.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const U={create:function(p,i,c){const f=s.window.document.createElement(p);return i!==void 0&&(f.className=i),c&&c.appendChild(f),f},createSVG:function(p,i,c){const f=s.window.document.createElementNS("http://www.w3.org/2000/svg",p);for(const _ of Object.keys(i))f.setAttributeNS(null,_,i[_]);return c&&c.appendChild(f),f}},ge=s.window.document&&s.window.document.documentElement.style,Ee=ge&&ge.userSelect!==void 0?"userSelect":"WebkitUserSelect";let be;U.disableDrag=function(){ge&&Ee&&(be=ge[Ee],ge[Ee]="none")},U.enableDrag=function(){ge&&Ee&&(ge[Ee]=be)};const we=function(p){p.preventDefault(),p.stopPropagation(),s.window.removeEventListener("click",we,!0)};function De(p,i,c){const f=p.offsetWidth===i.width?1:p.offsetWidth/i.width;return new s.pointGeometry((c.clientX-i.left)*f,(c.clientY-i.top)*f)}function Xe(p){const{userImage:i}=p;return!!(i&&i.render&&i.render())&&(p.data.replace(new Uint8Array(i.data.buffer)),!0)}U.suppressClick=function(){s.window.addEventListener("click",we,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",we,!0)},0)},U.mousePos=function(p,i){const c=p.getBoundingClientRect();return De(p,c,i)},U.touchPos=function(p,i){const c=p.getBoundingClientRect(),f=[];for(let _=0;_<i.length;_++)f.push(De(p,c,i[_]));return f},U.mouseButton=function(p){return s.window.InstallTrigger!==void 0&&p.button===2&&p.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:p.button};class Ue extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:c,callback:f}of this.requestors)this._notify(c,f);this.requestors=[]}}getImage(i){return this.images[i]}addImage(i,c){this._validate(i,c)&&(this.images[i]=c)}_validate(i,c){let f=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),f=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),f=!1),this._validateContent(c.content,c)||(this.fire(new s.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),f=!1),f}_validateStretch(i,c){if(!i)return!0;let f=0;for(const _ of i){if(_[0]<f||_[1]<_[0]||c<_[1])return!1;f=_[1]}return!0}_validateContent(i,c){return!(i&&(i.length!==4||i[0]<0||c.data.width<i[0]||i[1]<0||c.data.height<i[1]||i[2]<0||c.data.width<i[2]||i[3]<0||c.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,c){c.version=this.images[i].version+1,this.images[i]=c,this.updatedImages[i]=!0}removeImage(i){const c=this.images[i];delete this.images[i],delete this.patterns[i],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,c){let f=!0;if(!this.isLoaded())for(const _ of i)this.images[_]||(f=!1);this.isLoaded()||f?this._notify(i,c):this.requestors.push({ids:i,callback:c})}_notify(i,c){const f={};for(const _ of i){this.images[_]||this.fire(new s.Event("styleimagemissing",{id:_}));const x=this.images[_];x?f[_]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:Boolean(x.userImage&&x.userImage.render)}:s.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,f)}getPixelSize(){const{width:i,height:c}=this.atlasImage;return{width:i,height:c}}getPattern(i){const c=this.patterns[i],f=this.getImage(i);if(!f)return null;if(c&&c.position.version===f.version)return c.position;if(c)c.position.version=f.version;else{const _={w:f.data.width+2,h:f.data.height+2,x:0,y:0},x=new s.ImagePosition(_,f);this.patterns[i]={bin:_,position:x}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const c=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(i,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const x in this.patterns)i.push(this.patterns[x].bin);const{w:c,h:f}=s.potpack(i),_=this.atlasImage;_.resize({width:c||1,height:f||1});for(const x in this.patterns){const{bin:w}=this.patterns[x],S=w.x+1,P=w.y+1,L=this.images[x].data,O=L.width,N=L.height;s.RGBAImage.copy(L,_,{x:0,y:0},{x:S,y:P},{width:O,height:N}),s.RGBAImage.copy(L,_,{x:0,y:N-1},{x:S,y:P-1},{width:O,height:1}),s.RGBAImage.copy(L,_,{x:0,y:0},{x:S,y:P+N},{width:O,height:1}),s.RGBAImage.copy(L,_,{x:O-1,y:0},{x:S-1,y:P},{width:1,height:N}),s.RGBAImage.copy(L,_,{x:0,y:0},{x:S+O,y:P},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const c of i){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const f=this.images[c];Xe(f)&&this.updateImage(c,f)}}}const st=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(p,i){return function([c,f,_]){const x=s.degToRad(f+90),w=s.degToRad(_);return{x:c*Math.cos(x)*Math.sin(w),y:c*Math.sin(x)*Math.sin(w),z:c*Math.cos(w),azimuthal:f,polar:_}}(p.expression.evaluate(i))}interpolate(p,i,c){return{x:s.number(p.x,i.x,c),y:s.number(p.y,i.y,c),z:s.number(p.z,i.z,c),azimuthal:s.number(p.azimuthal,i.azimuthal,c),polar:s.number(p.polar,i.polar,c)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),ut="-transition";class lt extends s.Evented{constructor(i){super(),this._transitionable=new s.Transitionable(st),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,c={}){if(!this._validate(s.validateLight,i,c))for(const f in i){const _=i[f];s.endsWith(f,ut)?this._transitionable.setTransition(f.slice(0,-ut.length),_):this._transitionable.setValue(f,_)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,f){return(!f||f.validate!==!1)&&s.emitValidationErrors(this,i.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const It=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),Ft="-transition";class Ct extends s.Evented{constructor(i,c){super(),this._transitionable=new s.Transitionable(It),this.set(i),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(i){for(const c in i){const f=i[c];s.endsWith(c,Ft)?this._transitionable.setTransition(c.slice(0,-Ft.length),f):this._transitionable.setValue(c,f)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}}function Tt(p,i,c,f){const _=s.smoothstep(45,65,c),[x,w]=ot(p,f),S=s.length(i);let P=1-Math.min(1,Math.exp((S-x)/(w-x)*-6));return P*=P*P,P=Math.min(1,1.00747*P),P*_*p.alpha}function ot(p,i){const c=.5/Math.tan(.5*i);return[p.range[0]+c,p.range[1]+c]}const Nt=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"])}),Ai="-transition";class Zi extends s.Evented{constructor(i,c){super(),this._transitionable=new s.Transitionable(Nt),this.set(i),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,c={}){if(!this._validate(s.validateFog,i,c))for(const f in i){const _=i[f];s.endsWith(f,Ai)?this._transitionable.setTransition(f.slice(0,-Ai.length),_):this._transitionable.setValue(f,_)}}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return s.smoothstep(45,65,i)*c.a}getOpacityAtLatLng(i,c){return this._transform.projection.supportsFog?function(f,_,x){const w=s.MercatorCoordinate.fromLngLat(_),S=x.elevation?x.elevation.getAtPointOrZero(w):0,P=[w.x,w.y,S];return s.transformMat4(P,P,x.mercatorFogMatrix),Tt(f,P,x.pitch,x._fov)}(this.state,i,c):0}getFovAdjustedRange(i){return this._transform.projection.supportsFog?ot(this.state,i):[0,1]}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,f){return(!f||f.validate!==!1)&&s.emitValidationErrors(this,i.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class ri{constructor(i,c){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const f=this.workerPool.acquire(this.id);for(let _=0;_<f.length;_++){const x=new ri.Actor(f[_],c,this.id);x.name=`Worker ${_}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,c,f){s.asyncAll(this.actors,(_,x)=>{_.send(i,c,x)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function qt(p,i,c){return i*(s.EXTENT/(p.tileSize*Math.pow(2,c-p.tileID.overscaledZ)))}ri.Actor=s.Actor;class ei{constructor(i,c,f){this.context=i;const _=i.gl;this.buffer=_.createBuffer(),this.dynamicDraw=Boolean(f),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Si={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Qi{constructor(i,c,f,_){this.length=c.length,this.attributes=f,this.itemSize=c.bytesPerElement,this.dynamicDraw=_,this.context=i;const x=i.gl;this.buffer=x.createBuffer(),i.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,c){for(let f=0;f<this.attributes.length;f++){const _=c.attributes[this.attributes[f].name];_!==void 0&&i.enableVertexAttribArray(_)}}setVertexAttribPointers(i,c,f){for(let _=0;_<this.attributes.length;_++){const x=this.attributes[_],w=c.attributes[x.name];w!==void 0&&i.vertexAttribPointer(w,x.components,i[Si[x.type]],!1,this.itemSize,x.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Et{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class en extends Et{getDefault(){return s.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class ti extends Et{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class Dn extends Et{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class Be extends Et{getDefault(){return[!0,!0,!0,!0]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class yt extends Et{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class rt extends Et{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class At extends Et{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const c=this.current;(i.func!==c.func||i.ref!==c.ref||i.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class ui extends Et{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class pi extends Et{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=i,this.dirty=!1}}class Le extends Et{getDefault(){return[0,1]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class We extends Et{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=i,this.dirty=!1}}class te extends Et{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class ae extends Et{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.BLEND):c.disable(c.BLEND),this.current=i,this.dirty=!1}}class Ce extends Et{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class Ie extends Et{getDefault(){return s.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Ve extends Et{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class Ke extends Et{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=i,this.dirty=!1}}class ht extends Et{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Ne extends Et{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class tt extends Et{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class Ze extends Et{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class Mt extends Et{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class wt extends Et{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class dt extends Et{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Lt extends Et{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Zt extends Et{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class hi extends Et{getDefault(){return null}set(i){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Wt extends Et{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class oi extends Et{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class Ki extends Et{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Cn extends Et{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class fn extends Et{constructor(i,c){super(i),this.context=i,this.parent=c}getDefault(){return null}}class Hn extends fn{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class An extends fn{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Ni extends An{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Yt{constructor(i,c,f,_){this.context=i,this.width=c,this.height=f;const x=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new Hn(i,x),_&&(this.depthAttachment=new An(i,x))}destroy(){const i=this.context.gl,c=this.colorAttachment.get();if(c&&i.deleteTexture(c),this.depthAttachment){const f=this.depthAttachment.get();f&&i.deleteRenderbuffer(f)}i.deleteFramebuffer(this.framebuffer)}}class Mn{constructor(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new en(this),this.clearDepth=new ti(this),this.clearStencil=new Dn(this),this.colorMask=new Be(this),this.depthMask=new yt(this),this.stencilMask=new rt(this),this.stencilFunc=new At(this),this.stencilOp=new ui(this),this.stencilTest=new pi(this),this.depthRange=new Le(this),this.depthTest=new We(this),this.depthFunc=new te(this),this.blend=new ae(this),this.blendFunc=new Ce(this),this.blendColor=new Ie(this),this.blendEquation=new Ve(this),this.cullFace=new Ke(this),this.cullFaceSide=new ht(this),this.frontFace=new Ne(this),this.program=new tt(this),this.activeTexture=new Ze(this),this.viewport=new Mt(this),this.bindFramebuffer=new wt(this),this.bindRenderbuffer=new dt(this),this.bindTexture=new Lt(this),this.bindVertexBuffer=new Zt(this),this.bindElementBuffer=new hi(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Wt(this),this.pixelStoreUnpack=new oi(this),this.pixelStoreUnpackPremultiplyAlpha=new Ki(this),this.pixelStoreUnpackFlipY=new Cn(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,c){return new ei(this,i,c)}createVertexBuffer(i,c,f){return new Qi(this,i,c,f)}createRenderbuffer(i,c,f){const _=this.gl,x=_.createRenderbuffer();return this.bindRenderbuffer.set(x),_.renderbufferStorage(_.RENDERBUFFER,i,c,f),this.bindRenderbuffer.set(null),x}createFramebuffer(i,c,f){return new Yt(this,i,c,f)}clear({color:i,depth:c,stencil:f}){const _=this.gl;let x=0;i&&(x|=_.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(x|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),f!==void 0&&(x|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),_.clear(x)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){R(i.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ro{constructor(i,c,f,_){this.screenBounds=i,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=f,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(x=>_.pointCoordinate3D(x)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(i,c){let f,_;if(i instanceof s.pointGeometry||typeof i[0]=="number"){const x=s.pointGeometry.convert(i);f=[s.pointGeometry.convert(i)],_=c.isPointAboveHorizon(x)}else{const x=s.pointGeometry.convert(i[0]),w=s.pointGeometry.convert(i[1]);f=[x,w],_=s.polygonizeBounds(x,w).every(S=>c.isPointAboveHorizon(S))}return new ro(f,c.getCameraPoint(),_,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(i){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const c=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],_=s.polygonizeBounds(c,f,0,!1);return this.cameraPoint.y>f.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<f.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=f.x?_[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(_[3]=this.cameraPoint)),s.bufferConvexPolygon(_,i)}containsTile(i,c,f){const _=i.queryPadding+1,x=i.tileID.wrap,w=f?this._bufferedCameraMercator(_,c).map(q=>s.getTilePoint(i.tileTransform,q,x)):this._bufferedScreenMercator(_,c).map(q=>s.getTilePoint(i.tileTransform,q,x)),S=this.screenGeometryMercator.map(q=>s.getTileVec3(i.tileTransform,q,x)),P=S.map(q=>new s.pointGeometry(q[0],q[1])),L=c.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),O=s.getTileVec3(i.tileTransform,L,x),N=S.map(q=>{const X=s.sub(q,q,O);return s.normalize(X,X),new s.Ray(O,X)}),$=qt(i,1,c.zoom);if(s.polygonIntersectsBox(w,0,0,s.EXTENT,s.EXTENT))return{queryGeometry:this,tilespaceGeometry:P,tilespaceRays:N,bufferedTilespaceGeometry:w,bufferedTilespaceBounds:(H=s.getBounds(w),H.min.x=s.clamp(H.min.x,0,s.EXTENT),H.min.y=s.clamp(H.min.y,0,s.EXTENT),H.max.x=s.clamp(H.max.x,0,s.EXTENT),H.max.y=s.clamp(H.max.y,0,s.EXTENT),H),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:$};var H}_bufferedScreenMercator(i,c){const f=Xn(i);if(this._screenRaycastCache[f])return this._screenRaycastCache[f];{const _=this.bufferedScreenGeometry(i).map(x=>c.pointCoordinate3D(x));return this._screenRaycastCache[f]=_,_}}_bufferedCameraMercator(i,c){const f=Xn(i);if(this._cameraRaycastCache[f])return this._cameraRaycastCache[f];{const _=this.bufferedCameraGeometry(i).map(x=>c.pointCoordinate3D(x));return this._cameraRaycastCache[f]=_,_}}}function Xn(p){return 100*p|0}function oo(p,i,c){const f=function(_,x){if(_)return c(_);if(x){const w=s.pick(s.extend(x,p),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);x.vector_layers&&(w.vectorLayers=x.vector_layers,w.vectorLayerIds=w.vectorLayers.map(S=>S.id)),w.tiles=i.canonicalizeTileset(w,p.url),c(null,w)}};return p.url?s.getJSON(i.transformRequest(i.normalizeSourceURL(p.url),s.ResourceType.Source),f):s.exported.frame(()=>f(null,p))}class Vr{constructor(i,c,f){this.bounds=s.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=c||0,this.maxzoom=f||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const c=Math.pow(2,i.z),f=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*c),_=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*c),x=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*c),w=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*c);return i.x>=f&&i.x<x&&i.y>=_&&i.y<w}}class Kn extends s.Evented{constructor(i,c,f,_){super(),this.id=i,this.dispatcher=f,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},c),s.extend(this,s.pick(c,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=oo(this._options,this.map._requestManager,(i,c)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new s.ErrorEvent(i)):c&&(s.extend(this,c),c.bounds&&(this.tileBounds=new Vr(c.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(c.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,c){const f=s.exported.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),f,this.tileSize);i.request=s.getImage(this.map._requestManager.transformRequest(_,s.ResourceType.Tile),(x,w,S,P)=>{if(delete i.request,i.aborted)i.state="unloaded",c(null);else if(x)i.state="errored",c(x);else if(w){this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:S,expires:P});const L=this.map.painter.context,O=L.gl;i.texture=this.map.painter.getTileTexture(w.width),i.texture?i.texture.update(w,{useMipmap:!0}):(i.texture=new s.Texture(L,w,O.RGBA,{useMipmap:!0}),i.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE),L.extTextureFilterAnisotropic&&O.texParameterf(O.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax)),i.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),c(null)}})}abortTile(i,c){i.request&&(i.request.cancel(),delete i.request),c()}unloadTile(i,c){i.texture&&this.map.painter.saveTileTexture(i.texture),c()}hasTransition(){return!1}}let jn;function $r(p,i,c,f,_,x,w,S){const P=[p,c,_,i,f,x,1,1,1],L=[w,S,1],O=s.adjoint([],P),[N,$,H]=s.transformMat3(L,L,s.transpose(O,O));return s.multiply(P,[N,0,0,0,$,0,0,0,H],P)}class un extends s.Evented{constructor(i,c,f,_){super(),this.id=i,this.dispatcher=f,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=c}load(i,c){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(f,_)=>{this._loaded=!0,f?this.fire(new s.ErrorEvent(f)):_&&(this.image=s.exported.getImageData(_),this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),c&&c(),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this.options.url=i.url,this.load(i.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}setCoordinates(i){this.coordinates=i,delete this._boundsArray;const c=i.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(f){let _=1/0,x=1/0,w=-1/0,S=-1/0;for(const N of f)_=Math.min(_,N.x),x=Math.min(x,N.y),w=Math.max(w,N.x),S=Math.max(S,N.y);const P=Math.max(w-_,S-x),L=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),O=Math.pow(2,L);return new s.CanonicalTileID(L,Math.floor((_+w)/2*O),Math.floor((x+S)/2*O))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){delete this._boundsArray}_makeBoundsArray(){const i=s.tileTransform(this.tileID,this.map.transform.projection),[c,f,_,x]=this.coordinates.map(w=>{const S=i.projection.project(w[0],w[1]);return s.getTilePoint(i,S)._round()});return this.perspectiveTransform=function(w,S,P,L,O,N,$,H,q,X){const le=$r(0,0,w,0,0,S,w,S),W=$r(P,L,O,N,$,H,q,X);return s.multiply(W,s.adjoint(le,le),W),[W[6]/W[8]*w/s.EXTENT,W[7]/W[8]*S/s.EXTENT]}(this.width,this.height,c.x,c.y,f.x,f.y,x.x,x.y,_.x,_.y),this._boundsArray=new s.StructArrayLayout4i8,this._boundsArray.emplaceBack(c.x,c.y,0,0),this._boundsArray.emplaceBack(f.x,f.y,s.EXTENT,0),this._boundsArray.emplaceBack(x.x,x.y,0,s.EXTENT),this._boundsArray.emplaceBack(_.x,_.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,c=i.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,s.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new s.Texture(i,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}loadTile(i,c){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},c(null)):(i.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const so={vector:class extends s.Evented{constructor(p,i,c,f){if(super(),this.id=p,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(i,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=oo(this._options,this.map._requestManager,(p,i)=>{this._tileJSONRequest=null,this._loaded=!0,p?this.fire(new s.ErrorEvent(p)):i&&(s.extend(this,i),i.bounds&&(this.tileBounds=new Vr(i.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(i.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)}onAdd(p){this.map=p,this.load()}setSourceProperty(p){this._tileJSONRequest&&this._tileJSONRequest.cancel(),p();const i=this.map.style._getSourceCaches(this.id);for(const c of i)c.clearTiles();this.load()}setTiles(p){return this.setSourceProperty(()=>{this._options.tiles=p}),this}setUrl(p){return this.setSourceProperty(()=>{this.url=p,this._options.url=p}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}loadTile(p,i){const c=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),f={request:this.map._requestManager.transformRequest(c,s.ResourceType.Tile),data:void 0,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:p.isSymbolTile};if(f.request.collectResourceTiming=this._collectResourceTiming,p.actor&&p.state!=="expired")p.state==="loading"?p.reloadCallback=i:p.request=p.actor.send("reloadTile",f,_.bind(this));else if(p.actor=this._tileWorkers[c]=this._tileWorkers[c]||this.dispatcher.getActor(),this.dispatcher.ready)p.request=p.actor.send("loadTile",f,_.bind(this),void 0,!0);else{const x=s.loadVectorTile.call({deduped:this._deduped},f,(w,S)=>{w||!S?_.call(this,w):(f.data={cacheControl:S.cacheControl,expires:S.expires,rawData:S.rawData.slice(0)},p.actor&&p.actor.send("loadTile",f,_.bind(this),void 0,!0))},!0);p.request={cancel:x}}function _(x,w){return delete p.request,p.aborted?i(null):x&&x.status!==404?i(x):(w&&w.resourceTiming&&(p.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&p.setExpiryData(w),p.loadVectorData(w,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(p.reloadCallback&&(this.loadTile(p,p.reloadCallback),p.reloadCallback=null)))}}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.actor&&p.actor.send("abortTile",{uid:p.uid,type:this.type,source:this.id})}unloadTile(p){p.unloadVectorData(),p.actor&&p.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Kn,"raster-dem":class extends Kn{constructor(p,i,c,f){super(p,i,c,f),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(p,i){const c=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function f(_,x){_&&(p.state="errored",i(_)),x&&(p.dem=x,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",i(null))}p.request=s.getImage(this.map._requestManager.transformRequest(c,s.ResourceType.Tile),function(_,x,w,S){if(delete p.request,p.aborted)p.state="unloaded",i(null);else if(_)p.state="errored",i(_);else if(x){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:w,expires:S});const P=s.window.ImageBitmap&&x instanceof s.window.ImageBitmap&&(jn==null&&(jn=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),jn),L=1-(x.width-s.prevPowerOfTwo(x.width))/2;L<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const O=P?x:s.exported.getImageData(x,L),N={uid:p.uid,coord:p.tileID,source:this.id,rawImageData:O,encoding:this.encoding,padding:L};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",N,f.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(p){const i=p.canonical,c=Math.pow(2,i.z),f=(i.x-1+c)%c,_=i.x===0?p.wrap-1:p.wrap,x=(i.x+1+c)%c,w=i.x+1===c?p.wrap+1:p.wrap,S={};return S[new s.OverscaledTileID(p.overscaledZ,_,i.z,f,i.y).key]={backfilled:!1},S[new s.OverscaledTileID(p.overscaledZ,w,i.z,x,i.y).key]={backfilled:!1},i.y>0&&(S[new s.OverscaledTileID(p.overscaledZ,_,i.z,f,i.y-1).key]={backfilled:!1},S[new s.OverscaledTileID(p.overscaledZ,p.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},S[new s.OverscaledTileID(p.overscaledZ,w,i.z,x,i.y-1).key]={backfilled:!1}),i.y+1<c&&(S[new s.OverscaledTileID(p.overscaledZ,_,i.z,f,i.y+1).key]={backfilled:!1},S[new s.OverscaledTileID(p.overscaledZ,p.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},S[new s.OverscaledTileID(p.overscaledZ,w,i.z,x,i.y+1).key]={backfilled:!1}),S}unloadTile(p){p.demTexture&&this.map.painter.saveTileTexture(p.demTexture),p.fbo&&(p.fbo.destroy(),delete p.fbo),p.dem&&delete p.dem,delete p.neighboringTiles,p.state="unloaded"}},geojson:class extends s.Evented{constructor(p,i,c,f){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(f),this._data=i.data,this._options=s.extend({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const _=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(i.buffer!==void 0?i.buffer:128)*_,tolerance:(i.tolerance!==void 0?i.tolerance:.375)*_,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:s.EXTENT,radius:(i.clusterRadius!==void 0?i.clusterRadius:50)*_,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}getClusterExpansionZoom(p,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id},i),this}getClusterChildren(p,i){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id},i),this}getClusterLeaves(p,i,c,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:p,limit:i,offset:c},f),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const p=s.extend({},this.workerOptions),i=this._data;typeof i=="string"?(p.request=this.map._requestManager.transformRequest(s.exported.resolveURL(i),s.ResourceType.Source),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,p,(c,f)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new s.ErrorEvent(c));else{const _={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&f&&f.resourceTiming&&f.resourceTiming[this.id]&&(_.resourceTiming=f.resourceTiming[this.id]),this.fire(new s.Event("data",_)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(p,i){const c=p.actor?"reloadTile":"loadTile";p.actor=this.actor,p.request=this.actor.send(c,{type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(f,_)=>(delete p.request,p.unloadVectorData(),p.aborted?i(null):f?i(f):(p.loadVectorData(_,this.map.painter,c==="reloadTile"),i(null))),void 0,c==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p){p.unloadVectorData(),this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends un{constructor(p,i,c,f){super(p,i,c,f),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const i of p.urls)this.urls.push(this.map._requestManager.transformRequest(i,s.ResourceType.Source).url);s.getVideo(this.urls,(i,c)=>{this._loaded=!0,i?this.fire(new s.ErrorEvent(i)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const i=this.video.seekable;p<i.start(0)||p>i.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,i=p.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(p,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,s.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2));for(const c in this.tiles){const f=this.tiles[c];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:un,canvas:class extends un{constructor(p,i,c,f){super(p,i,c,f),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(x=>typeof x!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context,c=i.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,s.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(p||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(i,this.canvas,c.RGBA,{premultiply:!0});for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}}},Ln=function(p,i,c,f){const _=new so[i.type](p,i,c,f);if(_.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${_.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],_),_};function J(p,i){const c=s.identity([]);return s.scale(c,c,[.5*p.width,.5*-p.height,1]),s.translate(c,c,[1,-1,0]),s.multiply$1(c,c,p.calculateProjMatrix(i.toUnwrapped()))}function B(p,i,c,f,_,x,w,S=!1){const P=p.tilesIn(f,w,S);P.sort(K);const L=[];for(const N of P)L.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(i,c,p._state,N,_,x,J(p.transform,N.tile.tileID),S)});const O=function(N){const $={},H={};for(const q of N){const X=q.queryResults,le=q.wrappedTileID,W=H[le]=H[le]||{};for(const re in X){const oe=X[re],ie=W[re]=W[re]||{},ne=$[re]=$[re]||[];for(const ce of oe)ie[ce.featureIndex]||(ie[ce.featureIndex]=!0,ne.push(ce))}}return $}(L);for(const N in O)O[N].forEach($=>{const H=$.feature,q=p.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=q});return O}function V(p,i){const c=p.getRenderableIds().map(x=>p.getTileByID(x)),f=[],_={};for(let x=0;x<c.length;x++){const w=c[x],S=w.tileID.canonical.key;_[S]||(_[S]=!0,w.querySourceFeatures(f,i))}return f}function K(p,i){const c=p.tileID,f=i.tileID;return c.overscaledZ-f.overscaledZ||c.canonical.y-f.canonical.y||c.wrap-f.wrap||c.canonical.x-f.canonical.x}function ee(){return Fo.workerClass!=null?new Fo.workerClass:new s.window.Worker(Fo.workerUrl)}const he="mapboxgl_preloaded_worker_pool";class ye{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<ye.workerCount;)this.workers.push(new ee);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[he]}numActive(){return Object.keys(this.active).length}}let ve;function pe(){return ve||(ve=new ye),ve}function ue(p,i){const c={};for(const f in p)f!=="ref"&&(c[f]=p[f]);return s.refProperties.forEach(f=>{f in i&&(c[f]=i[f])}),c}function Y(p){p=p.slice();const i=Object.create(null);for(let c=0;c<p.length;c++)i[p[c].id]=p[c];for(let c=0;c<p.length;c++)"ref"in p[c]&&(p[c]=ue(p[c],i[p[c].ref]));return p}ye.workerCount=2;const fe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Te(p,i,c){c.push({command:fe.addSource,args:[p,i[p]]})}function it(p,i,c){i.push({command:fe.removeSource,args:[p]}),c[p]=!0}function mt(p,i,c,f){it(p,c,f),Te(p,i,c)}function gt(p,i,c){let f;for(f in p[c])if(p[c].hasOwnProperty(f)&&f!=="data"&&!R(p[c][f],i[c][f]))return!1;for(f in i[c])if(i[c].hasOwnProperty(f)&&f!=="data"&&!R(p[c][f],i[c][f]))return!1;return!0}function vt(p,i,c,f,_,x){let w;for(w in i=i||{},p=p||{})p.hasOwnProperty(w)&&(R(p[w],i[w])||c.push({command:x,args:[f,w,i[w],_]}));for(w in i)i.hasOwnProperty(w)&&!p.hasOwnProperty(w)&&(R(p[w],i[w])||c.push({command:x,args:[f,w,i[w],_]}))}function $t(p){return p.id}function Ht(p,i){return p[i.id]=i,p}class Pi{constructor(i,c){this.reset(i,c)}reset(i,c){this.points=i||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=s.clamp(i,0,1);let c=1,f=this._distances[c];const _=i*this.paddedLength+this.padding;for(;f<_&&c<this._distances.length;)f=this._distances[++c];const x=c-1,w=this._distances[x],S=f-w,P=S>0?(_-w)/S:0;return this.points[x].mult(1-P).add(this.points[c].mult(P))}}class Mi{constructor(i,c,f){const _=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(i/f),this.yCellCount=Math.ceil(c/f);for(let w=0;w<this.xCellCount*this.yCellCount;w++)_.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=c,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,c,f,_,x){this._forEachCell(c,f,_,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(x)}insertCircle(i,c,f,_){this._forEachCell(c-_,f-_,c+_,f+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(c),this.circles.push(f),this.circles.push(_)}_insertBoxCell(i,c,f,_,x,w){this.boxCells[x].push(w)}_insertCircleCell(i,c,f,_,x,w){this.circleCells[x].push(w)}_query(i,c,f,_,x,w){if(f<0||i>this.width||_<0||c>this.height)return!x&&[];const S=[];if(i<=0&&c<=0&&this.width<=f&&this.height<=_){if(x)return!0;for(let P=0;P<this.boxKeys.length;P++)S.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const L=this.circles[3*P],O=this.circles[3*P+1],N=this.circles[3*P+2];S.push({key:this.circleKeys[P],x1:L-N,y1:O-N,x2:L+N,y2:O+N})}return w?S.filter(w):S}return this._forEachCell(i,c,f,_,this._queryCell,S,{hitTest:x,seenUids:{box:{},circle:{}}},w),x?S.length>0:S}_queryCircle(i,c,f,_,x){const w=i-f,S=i+f,P=c-f,L=c+f;if(S<0||w>this.width||L<0||P>this.height)return!_&&[];const O=[];return this._forEachCell(w,P,S,L,this._queryCellCircle,O,{hitTest:_,circle:{x:i,y:c,radius:f},seenUids:{box:{},circle:{}}},x),_?O.length>0:O}query(i,c,f,_,x){return this._query(i,c,f,_,!1,x)}hitTest(i,c,f,_,x){return this._query(i,c,f,_,!0,x)}hitTestCircle(i,c,f,_){return this._queryCircle(i,c,f,!0,_)}_queryCell(i,c,f,_,x,w,S,P){const L=S.seenUids,O=this.boxCells[x];if(O!==null){const $=this.bboxes;for(const H of O)if(!L.box[H]){L.box[H]=!0;const q=4*H;if(i<=$[q+2]&&c<=$[q+3]&&f>=$[q+0]&&_>=$[q+1]&&(!P||P(this.boxKeys[H]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[H],x1:$[q],y1:$[q+1],x2:$[q+2],y2:$[q+3]})}}}const N=this.circleCells[x];if(N!==null){const $=this.circles;for(const H of N)if(!L.circle[H]){L.circle[H]=!0;const q=3*H;if(this._circleAndRectCollide($[q],$[q+1],$[q+2],i,c,f,_)&&(!P||P(this.circleKeys[H]))){if(S.hitTest)return w.push(!0),!0;{const X=$[q],le=$[q+1],W=$[q+2];w.push({key:this.circleKeys[H],x1:X-W,y1:le-W,x2:X+W,y2:le+W})}}}}}_queryCellCircle(i,c,f,_,x,w,S,P){const L=S.circle,O=S.seenUids,N=this.boxCells[x];if(N!==null){const H=this.bboxes;for(const q of N)if(!O.box[q]){O.box[q]=!0;const X=4*q;if(this._circleAndRectCollide(L.x,L.y,L.radius,H[X+0],H[X+1],H[X+2],H[X+3])&&(!P||P(this.boxKeys[q])))return w.push(!0),!0}}const $=this.circleCells[x];if($!==null){const H=this.circles;for(const q of $)if(!O.circle[q]){O.circle[q]=!0;const X=3*q;if(this._circlesCollide(H[X],H[X+1],H[X+2],L.x,L.y,L.radius)&&(!P||P(this.circleKeys[q])))return w.push(!0),!0}}}_forEachCell(i,c,f,_,x,w,S,P){const L=this._convertToXCellCoord(i),O=this._convertToYCellCoord(c),N=this._convertToXCellCoord(f),$=this._convertToYCellCoord(_);for(let H=L;H<=N;H++)for(let q=O;q<=$;q++)if(x.call(this,i,c,f,_,this.xCellCount*q+H,w,S,P))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,c,f,_,x,w){const S=_-i,P=x-c,L=f+w;return L*L>S*S+P*P}_circleAndRectCollide(i,c,f,_,x,w,S){const P=(w-_)/2,L=Math.abs(i-(_+P));if(L>P+f)return!1;const O=(S-x)/2,N=Math.abs(c-(x+O));if(N>O+f)return!1;if(L<=P||N<=O)return!0;const $=L-P,H=N-O;return $*$+H*H<=f*f}}const Bi=Math.tan(85*Math.PI/180);function Ao(p,i,c,f,_,x){let w=s.create();if(c){if(_.projection.name==="globe")w=s.calculateGlobeMatrix(_,_.worldSize/_._projectionScaler,[0,0]),s.multiply$1(w,w,s.globeDenormalizeECEF(s.globeTileBounds(i)));else{const S=D([],x);w[0]=S[0],w[1]=S[1],w[4]=S[2],w[5]=S[3]}f||s.rotateZ(w,w,_.angle)}else s.multiply$1(w,_.labelPlaneMatrix,p);return w}function ao(p,i,c,f,_,x){if(c){if(_.projection.name==="globe"){const w=Ao(p,i,c,f,_,x);return s.invert(w,w),s.multiply$1(w,p,w),w}{const w=s.clone(p),S=s.identity([]);return S[0]=x[0],S[1]=x[1],S[4]=x[2],S[5]=x[3],s.multiply$1(w,w,S),f||s.rotateZ(w,w,-_.angle),w}}return _.glCoordMatrix}function In(p,i,c=0){const f=[p.x,p.y,c,1];c?s.transformMat4$1(f,f,i):ua(f,f,i);const _=f[3];return{point:new s.pointGeometry(f[0]/_,f[1]/_),signedDistanceFromCamera:_}}function Gr(p,i){return Math.min(.5+p/i*.5,1.5)}function cl(p,i){const c=p[0]/p[3],f=p[1]/p[3];return c>=-i[0]&&c<=i[0]&&f>=-i[1]&&f<=i[1]}function Ch(p,i,c,f,_,x,w,S,P,L){const O=c.transform,N=f?p.textSizeData:p.iconSizeData,$=s.evaluateSizeForZoom(N,c.transform.zoom),H=[256/c.width*2+1,256/c.height*2+1],q=f?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;q.clear();const X=p.lineVertexArray,le=f?p.text.placedSymbolArray:p.icon.placedSymbolArray,W=c.transform.width/c.transform.height;let re=!1;for(let oe=0;oe<le.length;oe++){const ie=le.get(oe);if(ie.writingMode!==s.WritingMode.vertical||re||oe!==0&&le.get(oe-1).writingMode===s.WritingMode.horizontal||(re=!0),ie.hidden||ie.writingMode===s.WritingMode.vertical&&!re){Cr(ie.numGlyphs,q);continue}re=!1;const ne=new s.pointGeometry(ie.tileAnchorX,ie.tileAnchorY),ce=P?P(ne):[0,0,0],Se=O.projection.projectTilePoint(ne.x,ne.y,L.canonical),Me=[Se.x+ce[0],Se.y+ce[1],Se.z+ce[2]],et=[...Me,1];if(s.transformMat4$1(et,et,i),!cl(et,H)){Cr(ie.numGlyphs,q);continue}const qe=Gr(c.transform.cameraToCenterDistance,et[3]),Ge=s.evaluateSizeForFeature(N,$,ie),ze=w?Ge/qe:Ge*qe,Ae=In(new s.pointGeometry(Me[0],Me[1]),_,Me[2]);if(Ae.signedDistanceFromCamera<=0){Cr(ie.numGlyphs,q);continue}let $e={};const Fe=w?null:P,St=Gc(ie,ze,!1,S,i,_,x,p.glyphOffsetArray,X,q,Ae.point,ne,$e,W,Fe,O.projection,L);re=St.useVertical,Fe&&St.needsFlipping&&($e={}),(St.notEnoughRoom||re||St.needsFlipping&&Gc(ie,ze,!0,S,i,_,x,p.glyphOffsetArray,X,q,Ae.point,ne,$e,W,Fe,O.projection,L).notEnoughRoom)&&Cr(ie.numGlyphs,q)}f?p.text.dynamicLayoutVertexBuffer.updateData(q):p.icon.dynamicLayoutVertexBuffer.updateData(q)}function $c(p,i,c,f,_,x,w,S,P,L,O,N,$,H,q){const X=S.glyphStartIndex+S.numGlyphs,le=S.lineStartIndex,W=S.lineStartIndex+S.lineLength,re=i.getoffsetX(S.glyphStartIndex),oe=i.getoffsetX(X-1),ie=ca(p*re,c,f,_,x,w,S.segment,le,W,P,L,O,N,$,!0,H,q);if(!ie)return null;const ne=ca(p*oe,c,f,_,x,w,S.segment,le,W,P,L,O,N,$,!0,H,q);return ne?{first:ie,last:ne}:null}function la(p,i,c,f){return p.writingMode===s.WritingMode.horizontal&&Math.abs(c.y-i.y)>Math.abs(c.x-i.x)*f?{useVertical:!0}:p.writingMode===s.WritingMode.vertical?i.y<c.y?{needsFlipping:!0}:null:p.flipState!==0&&function(_,x,w){const S=(x.x-_.x)*w;return S===0||Math.abs((x.y-_.y)/S)>Bi}(i,c,f)?p.flipState===1?{needsFlipping:!0}:null:i.x>c.x?{needsFlipping:!0}:null}function Gc(p,i,c,f,_,x,w,S,P,L,O,N,$,H,q,X,le){const W=i/24,re=p.lineOffsetX*W,oe=p.lineOffsetY*W;let ie;if(p.numGlyphs>1){const ne=p.glyphStartIndex+p.numGlyphs,ce=p.lineStartIndex,Se=p.lineStartIndex+p.lineLength,Me=$c(W,S,re,oe,c,O,N,p,P,x,$,q,!1,X,le);if(!Me)return{notEnoughRoom:!0};const et=In(Me.first.point,w).point,qe=In(Me.last.point,w).point;if(f&&!c){const Ge=la(p,et,qe,H);if(p.flipState=Ge&&Ge.needsFlipping?1:2,Ge)return Ge}ie=[Me.first];for(let Ge=p.glyphStartIndex+1;Ge<ne-1;Ge++)ie.push(ca(W*S.getoffsetX(Ge),re,oe,c,O,N,p.segment,ce,Se,P,x,$,q,!1,!1,X,le));ie.push(Me.last)}else{if(f&&!c){const ce=In(N,_).point,Se=p.lineStartIndex+p.segment+1,Me=new s.pointGeometry(P.getx(Se),P.gety(Se)),et=In(Me,_),qe=la(p,ce,et.signedDistanceFromCamera>0?et.point:hl(N,Me,ce,1,_,void 0,X,le.canonical),H);if(p.flipState=qe&&qe.needsFlipping?1:2,qe)return qe}const ne=ca(W*S.getoffsetX(p.glyphStartIndex),re,oe,c,O,N,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,P,x,$,q,!1,!1,X,le);if(!ne)return{notEnoughRoom:!0};ie=[ne]}for(const ne of ie)s.addDynamicAttributes(L,ne.point,ne.angle);return{}}function ul(p,i,c,f,_){const x=f.projectTilePoint(p.x,p.y,i);if(!_)return In(x,c,x.z);const w=_(p);return In(new s.pointGeometry(x.x+w[0],x.y+w[1]),c,x.z+w[2])}function hl(p,i,c,f,_,x,w,S){const P=ul(p.add(p.sub(i)._unit()),S,_,w,x).point,L=c.sub(P);return c.add(L._mult(f/L.mag()))}function ca(p,i,c,f,_,x,w,S,P,L,O,N,$,H,q,X,le){const W=f?p-i:p+i;let re=W>0?1:-1,oe=0;f&&(re*=-1,oe=Math.PI),re<0&&(oe+=Math.PI);let ie=re>0?S+w:S+w+1,ne=_,ce=_,Se=0,Me=0;const et=Math.abs(W),qe=[],Ge=[];let ze=x;const Ae=()=>{const Qe=ie-re;return Se===0?x:new s.pointGeometry(L.getx(Qe),L.gety(Qe))},$e=()=>hl(Ae(),ze,ce,et-Se+1,O,$,X,le.canonical);for(;Se+Me<=et;){if(ie+=re,ie<S||ie>=P)return null;if(ce=ne,qe.push(ne),H&&Ge.push(ze||Ae()),ne=N[ie],ne===void 0){ze=new s.pointGeometry(L.getx(ie),L.gety(ie));const Qe=ul(ze,le.canonical,O,X,$);ne=Qe.signedDistanceFromCamera>0?N[ie]=Qe.point:$e()}else ze=null;Se+=Me,Me=ce.dist(ne)}q&&$&&(ze=ze||new s.pointGeometry(L.getx(ie),L.gety(ie)),N[ie]=ne=N[ie]===void 0?ne:$e(),Me=ce.dist(ne));const Fe=(et-Se)/Me,St=ne.sub(ce),Dt=St.mult(Fe)._add(ce);c&&Dt._add(St._unit()._perp()._mult(c*re));const Xt=oe+Math.atan2(ne.y-ce.y,ne.x-ce.x);return qe.push(Dt),H&&(ze=ze||new s.pointGeometry(L.getx(ie),L.gety(ie)),Ge.push(function(Qe,zt,Ut){const Ci=1-Ut;return new s.pointGeometry(Qe.x*Ci+zt.x*Ut,Qe.y*Ci+zt.y*Ut)}(Ge.length>0?Ge[Ge.length-1]:ze,ze,Fe))),{point:Dt,angle:Xt,path:qe,tilePath:Ge}}const qc=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Cr(p,i){for(let c=0;c<p;c++){const f=i.length;i.resize(f+4),i.float32.set(qc,3*f)}}function ua(p,i,c){const f=i[0],_=i[1];return p[0]=c[0]*f+c[4]*_+c[12],p[1]=c[1]*f+c[5]*_+c[13],p[3]=c[3]*f+c[7]*_+c[15],p}const qr=100;class cf{constructor(i,c,f=new Mi(i.width+200,i.height+200,25),_=new Mi(i.width+200,i.height+200,25)){this.transform=i,this.grid=f,this.ignoredGrid=_,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+qr,this.screenBottomBoundary=i.height+qr,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=c}placeCollisionBox(i,c,f,_,x,w,S){let P=c.projectedAnchorX,L=c.projectedAnchorY,O=c.projectedAnchorZ;const N=c.elevation,$=c.tileID;if(N&&$){const ie=this.transform.projection.createTileTransform(this.transform,this.transform.worldSize),ne=ie.upVector($.canonical,c.tileAnchorX,c.tileAnchorY),ce=ie.upVectorScale($.canonical);P+=ne[0]*N*ce,L+=ne[1]*N*ce,O+=ne[2]*N*ce}const H=this.projectAndGetPerspectiveRatio(w,P,L,O,c.tileID),q=x*H.perspectiveRatio,X=(c.x1*i+f.x-c.padding)*q+H.point.x,le=(c.y1*i+f.y-c.padding)*q+H.point.y,W=(c.x2*i+f.x+c.padding)*q+H.point.x,re=(c.y2*i+f.y+c.padding)*q+H.point.y,oe=H.perspectiveRatio<=.55||H.aboveHorizon;return!this.isInsideGrid(X,le,W,re)||!_&&this.grid.hitTest(X,le,W,re,S)||oe?{box:[],offscreen:!1}:{box:[X,le,W,re],offscreen:this.isOffscreen(X,le,W,re)}}placeCollisionCircles(i,c,f,_,x,w,S,P,L,O,N,$,H,q){const X=[],le=this.transform.elevation,W=this.transform.projection.createTileTransform(this.transform,this.transform.worldSize),re=le?le.getAtTileOffsetFunc(q,W):Fe=>[0,0,0],oe=new s.pointGeometry(c.tileAnchorX,c.tileAnchorY),ie=this.transform.projection.projectTilePoint(c.tileAnchorX,c.tileAnchorY,q.canonical),ne=re(oe),ce=[ie.x+ne[0],ie.y+ne[1],ie.z+ne[2]],Se=this.projectAndGetPerspectiveRatio(w,ce[0],ce[1],ce[2],q),{perspectiveRatio:Me}=Se,et=(O?x/Me:x*Me)/s.ONE_EM,qe=In(new s.pointGeometry(ce[0],ce[1]),S,ce[2]).point,Ge=Se.signedDistanceFromCamera>0?$c(et,_,c.lineOffsetX*et,c.lineOffsetY*et,!1,qe,oe,c,f,S,{},le&&!O?re:null,O&&!!le,this.transform.projection,q):null;let ze=!1,Ae=!1,$e=!0;if(Ge&&!Se.aboveHorizon){const Fe=.5*$*Me+H,St=new s.pointGeometry(-100,-100),Dt=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Xt=new Pi,Qe=Ge.first,zt=Ge.last;let Ut=[];for(let Ot=Qe.path.length-1;Ot>=1;Ot--)Ut.push(Qe.path[Ot]);for(let Ot=1;Ot<zt.path.length;Ot++)Ut.push(zt.path[Ot]);const Ci=2.5*Fe;if(P){const Ot=Ut.map(le?(ii,Ui)=>{const hn=re(Ui<Qe.path.length-1?Qe.tilePath[Qe.path.length-1-Ui]:zt.tilePath[Ui-Qe.path.length+2]);return In(ii,P,hn[2])}:ii=>In(ii,P));Ut=Ot.some(ii=>ii.signedDistanceFromCamera<=0)?[]:Ot.map(ii=>ii.point)}let Di=[];if(Ut.length>0){const Ot=Ut[0].clone(),ii=Ut[0].clone();for(let Ui=1;Ui<Ut.length;Ui++)Ot.x=Math.min(Ot.x,Ut[Ui].x),Ot.y=Math.min(Ot.y,Ut[Ui].y),ii.x=Math.max(ii.x,Ut[Ui].x),ii.y=Math.max(ii.y,Ut[Ui].y);Di=Ot.x>=St.x&&ii.x<=Dt.x&&Ot.y>=St.y&&ii.y<=Dt.y?[Ut]:ii.x<St.x||Ot.x>Dt.x||ii.y<St.y||Ot.y>Dt.y?[]:s.clipLine([Ut],St.x,St.y,Dt.x,Dt.y)}for(const Ot of Di){Xt.reset(Ot,.25*Fe);let ii=0;ii=Xt.length<=.5*Fe?1:Math.ceil(Xt.paddedLength/Ci)+1;for(let Ui=0;Ui<ii;Ui++){const hn=Ui/Math.max(ii-1,1),Qn=Xt.lerp(hn),_r=Qn.x+qr,kr=Qn.y+qr;X.push(_r,kr,Fe,0);const fi=_r-Fe,jt=kr-Fe,ai=_r+Fe,Yi=kr+Fe;if($e=$e&&this.isOffscreen(fi,jt,ai,Yi),Ae=Ae||this.isInsideGrid(fi,jt,ai,Yi),!i&&this.grid.hitTestCircle(_r,kr,Fe,N)&&(ze=!0,!L))return{circles:[],offscreen:!1,collisionDetected:ze}}}}return{circles:!L&&ze||!Ae?[]:X,offscreen:$e,collisionDetected:ze}}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let f=1/0,_=1/0,x=-1/0,w=-1/0;for(const O of i){const N=new s.pointGeometry(O.x+qr,O.y+qr);f=Math.min(f,N.x),_=Math.min(_,N.y),x=Math.max(x,N.x),w=Math.max(w,N.y),c.push(N)}const S=this.grid.query(f,_,x,w).concat(this.ignoredGrid.query(f,_,x,w)),P={},L={};for(const O of S){const N=O.key;if(P[N.bucketInstanceId]===void 0&&(P[N.bucketInstanceId]={}),P[N.bucketInstanceId][N.featureIndex])continue;const $=[new s.pointGeometry(O.x1,O.y1),new s.pointGeometry(O.x2,O.y1),new s.pointGeometry(O.x2,O.y2),new s.pointGeometry(O.x1,O.y2)];s.polygonIntersectsPolygon(c,$)&&(P[N.bucketInstanceId][N.featureIndex]=!0,L[N.bucketInstanceId]===void 0&&(L[N.bucketInstanceId]=[]),L[N.bucketInstanceId].push(N.featureIndex))}return L}insertCollisionBox(i,c,f,_,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:x},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,c,f,_,x){const w=c?this.ignoredGrid:this.grid,S={bucketInstanceId:f,featureIndex:_,collisionGroupID:x};for(let P=0;P<i.length;P+=4)w.insertCircle(S,i[P],i[P+1],i[P+2])}projectAndGetPerspectiveRatio(i,c,f,_,x){const w=[c,f,_||0,1];let S=!1;if(_||this.transform.pitch>0){s.transformMat4$1(w,w,i);let P=!1;this.fogState&&x&&(P=function(L,O,N,$,H,q){const X=q.calculateFogTileMatrix(H),le=[O,N,$];return s.transformMat4(le,le,X),Tt(L,le,q.pitch,q._fov)}(this.fogState,c,f,_||0,x.toUnwrapped(),this.transform)>.9),S=w[2]>w[3]||P}else ua(w,w,i);return{point:new s.pointGeometry((w[0]/w[3]+1)/2*this.transform.width+qr,(-w[1]/w[3]+1)/2*this.transform.height+qr),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/w[3]*.5,1.5),signedDistanceFromCamera:w[3],aboveHorizon:S}}isOffscreen(i,c,f,_){return f<qr||i>=this.screenRightBoundary||_<qr||c>this.screenBottomBoundary}isInsideGrid(i,c,f,_){return f>=0&&i<this.gridRightBoundary&&_>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const i=s.identity([]);return s.translate(i,i,[-100,-100,0]),i}}class Ah{constructor(i,c,f,_){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?c:-c))):_&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class xs{constructor(i,c,f,_,x,w=!1){this.text=new Ah(i?i.text:null,c,f,x),this.icon=new Ah(i?i.icon:null,c,_,x),this.clipped=w}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class bs{constructor(i,c,f,_=!1){this.text=i,this.icon=c,this.skipFade=f,this.clipped=_}}class ha{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Mh{constructor(i,c,f,_,x){this.bucketInstanceId=i,this.featureIndex=c,this.sourceLayerIndex=f,this.bucketIndex=_,this.tileID=x}}class Ih{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const c=++this.maxGroupID;this.collisionGroups[i]={ID:c,predicate:f=>f.collisionGroupID===c}}return this.collisionGroups[i]}}function dl(p,i,c,f,_){const{horizontalAlign:x,verticalAlign:w}=s.getAnchorAlignment(p),S=-(x-.5)*i,P=-(w-.5)*c,L=s.evaluateVariableOffset(p,f);return new s.pointGeometry(S+L[0]*_,P+L[1]*_)}function Mo(p,i,c,f,_){const x=new s.pointGeometry(p,i);return c&&x._rotate(f?_:-_),x}class pl{constructor(i,c,f,_,x){this.transform=i.clone(),this.collisionIndex=new cf(this.transform,x),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Ih(f),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,c,f,_){const x=f.getBucket(c),w=f.latestFeatureIndex;if(!x||!w||c.id!==x.layerIds[0])return;const S=x.layers[0].layout,P=f.collisionBoxArray,L=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),O=f.tileSize/s.EXTENT,N=f.tileID.toUnwrapped(),$=this.transform.calculateProjMatrix(N),H=S.get("text-pitch-alignment")==="map",q=S.get("text-rotation-alignment")==="map";c.compileFilter();const X=c.dynamicFilter(),le=c.dynamicFilterNeedsFeature(),W=this.transform.calculatePixelsToTileUnitsMatrix(f),re=Ao($,f.tileID.canonical,H,q,this.transform,W);let oe=null;if(H){const ce=ao($,f.tileID.canonical,H,q,this.transform,W);oe=s.multiply$1([],this.transform.labelPlaneMatrix,ce)}let ie=null;X&&f.latestFeatureIndex&&(ie={unwrappedTileID:N,dynamicFilter:X,dynamicFilterNeedsFeature:le,featureIndex:f.latestFeatureIndex}),this.retainedQueryData[x.bucketInstanceId]=new Mh(x.bucketInstanceId,w,x.sourceLayerIndex,x.index,f.tileID);const ne={bucket:x,layout:S,posMatrix:$,textLabelPlaneMatrix:re,labelToScreenMatrix:oe,clippingData:ie,scale:L,textPixelRatio:O,holdingForFade:f.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(x.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(_)for(const ce of x.sortKeyRanges){const{sortKey:Se,symbolInstanceStart:Me,symbolInstanceEnd:et}=ce;i.push({sortKey:Se,symbolInstanceStart:Me,symbolInstanceEnd:et,parameters:ne})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:ne})}attemptAnchorPlacement(i,c,f,_,x,w,S,P,L,O,N,$,H,q,X,le,W,re){const oe=[$.textOffset0,$.textOffset1],ie=dl(i,f,_,oe,x),ne=this.collisionIndex.placeCollisionBox(x,c,Mo(ie.x,ie.y,w,S,this.transform.angle),N,P,L,O.predicate);if((!le||this.collisionIndex.placeCollisionBox(q.getSymbolInstanceIconSize(re,this.transform.zoom,H),le,Mo(ie.x,ie.y,w,S,this.transform.angle),N,P,L,O.predicate).box.length!==0)&&ne.box.length>0){let ce;return this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(ce=this.prevPlacement.variableOffsets[$.crossTileID].anchor),this.variableOffsets[$.crossTileID]={textOffset:oe,width:f,height:_,anchor:i,textScale:x,prevAnchor:ce},this.markUsedJustification(q,i,$,X),q.allowVerticalPlacement&&(this.markUsedOrientation(q,X,$),this.placedOrientations[$.crossTileID]=X),{shift:ie,placedGlyphBoxes:ne}}}placeLayerBucketPart(i,c,f,_){const{bucket:x,layout:w,posMatrix:S,textLabelPlaneMatrix:P,labelToScreenMatrix:L,clippingData:O,textPixelRatio:N,holdingForFade:$,collisionBoxArray:H,partiallyEvaluatedTextSize:q,partiallyEvaluatedIconSize:X,collisionGroup:le}=i.parameters,W=w.get("text-optional"),re=w.get("icon-optional"),oe=w.get("text-allow-overlap"),ie=w.get("icon-allow-overlap"),ne=w.get("text-rotation-alignment")==="map",ce=w.get("text-pitch-alignment")==="map",Se=w.get("icon-text-fit")!=="none",Me=w.get("symbol-z-order")==="viewport-y",et=oe&&(ie||!x.hasIconData()||re),qe=ie&&(oe||!x.hasTextData()||W);!x.collisionArrays&&H&&x.deserializeCollisionBoxes(H),f&&_&&x.updateCollisionDebugBuffers(this.transform.zoom,H);const Ge=(ze,Ae,$e)=>{if(O){const fi={zoom:this.transform.zoom,pitch:this.transform.pitch};let jt=null;if(O.dynamicFilterNeedsFeature){const ai=this.retainedQueryData[x.bucketInstanceId];jt=O.featureIndex.loadFeature({featureIndex:ze.featureIndex,bucketIndex:ai.bucketIndex,sourceLayerIndex:ai.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,O.dynamicFilter)(fi,jt,this.retainedQueryData[x.bucketInstanceId].tileID.canonical,new s.pointGeometry(ze.tileAnchorX,ze.tileAnchorY),this.transform.calculateDistanceTileData(O.unwrappedTileID)))return this.placements[ze.crossTileID]=new bs(!1,!1,!1,!0),void(c[ze.crossTileID]=!0)}if(c[ze.crossTileID])return;if($)return void(this.placements[ze.crossTileID]=new bs(!1,!1,!1));let Fe=!1,St=!1,Dt=!0,Xt=null,Qe={box:null,offscreen:null},zt={box:null,offscreen:null},Ut=null,Ci=null,Di=null,Ot=0,ii=0,Ui=0;$e.textFeatureIndex?Ot=$e.textFeatureIndex:ze.useRuntimeCollisionCircles&&(Ot=ze.featureIndex),$e.verticalTextFeatureIndex&&(ii=$e.verticalTextFeatureIndex);const hn=fi=>{fi.tileID=this.retainedQueryData[x.bucketInstanceId].tileID,(this.transform.elevation||fi.elevation)&&(fi.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[x.bucketInstanceId].tileID,fi.tileAnchorX,fi.tileAnchorY):0)},Qn=$e.textBox;if(Qn){hn(Qn);const fi=ai=>{let Yi=s.WritingMode.horizontal;if(x.allowVerticalPlacement&&!ai&&this.prevPlacement){const rr=this.prevPlacement.placedOrientations[ze.crossTileID];rr&&(this.placedOrientations[ze.crossTileID]=rr,Yi=rr,this.markUsedOrientation(x,Yi,ze))}return Yi},jt=(ai,Yi)=>{if(x.allowVerticalPlacement&&ze.numVerticalGlyphVertices>0&&$e.verticalTextBox){for(const rr of x.writingModes)if(rr===s.WritingMode.vertical?(Qe=Yi(),zt=Qe):Qe=ai(),Qe&&Qe.box&&Qe.box.length)break}else Qe=ai()};if(w.get("text-variable-anchor")){let ai=w.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ze.crossTileID]){const Fi=this.prevPlacement.variableOffsets[ze.crossTileID];ai.indexOf(Fi.anchor)>0&&(ai=ai.filter(or=>or!==Fi.anchor),ai.unshift(Fi.anchor))}const Yi=(Fi,or,Oa)=>{const er=x.getSymbolInstanceTextSize(q,ze,this.transform.zoom,Ae),ns=(Fi.x2-Fi.x1)*er+2*Fi.padding,xt=(Fi.y2-Fi.y1)*er+2*Fi.padding,Pt=Se&&!ie?or:null;Pt&&hn(Pt);let _n={box:[],offscreen:!1};const rs=oe?2*ai.length:ai.length;for(let No=0;No<rs;++No){const zn=this.attemptAnchorPlacement(ai[No%ai.length],Fi,ns,xt,er,ne,ce,N,S,le,No>=ai.length,ze,Ae,x,Oa,Pt,q,X);if(zn&&(_n=zn.placedGlyphBoxes,_n&&_n.box&&_n.box.length)){Fe=!0,Xt=zn.shift;break}}return _n};jt(()=>Yi(Qn,$e.iconBox,s.WritingMode.horizontal),()=>{const Fi=$e.verticalTextBox;return Fi&&hn(Fi),x.allowVerticalPlacement&&!(Qe&&Qe.box&&Qe.box.length)&&ze.numVerticalGlyphVertices>0&&Fi?Yi(Fi,$e.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null}}),Qe&&(Fe=Qe.box,Dt=Qe.offscreen);const rr=fi(Qe&&Qe.box);if(!Fe&&this.prevPlacement){const Fi=this.prevPlacement.variableOffsets[ze.crossTileID];Fi&&(this.variableOffsets[ze.crossTileID]=Fi,this.markUsedJustification(x,Fi.anchor,ze,rr))}}else{const ai=(Yi,rr)=>{const Fi=x.getSymbolInstanceTextSize(q,ze,this.transform.zoom,Ae),or=this.collisionIndex.placeCollisionBox(Fi,Yi,new s.pointGeometry(0,0),oe,N,S,le.predicate);return or&&or.box&&or.box.length&&(this.markUsedOrientation(x,rr,ze),this.placedOrientations[ze.crossTileID]=rr),or};jt(()=>ai(Qn,s.WritingMode.horizontal),()=>{const Yi=$e.verticalTextBox;return x.allowVerticalPlacement&&ze.numVerticalGlyphVertices>0&&Yi?(hn(Yi),ai(Yi,s.WritingMode.vertical)):{box:null,offscreen:null}}),fi(Qe&&Qe.box&&Qe.box.length)}}if(Ut=Qe,Fe=Ut&&Ut.box&&Ut.box.length>0,Dt=Ut&&Ut.offscreen,ze.useRuntimeCollisionCircles){const fi=x.text.placedSymbolArray.get(ze.centerJustifiedTextSymbolIndex>=0?ze.centerJustifiedTextSymbolIndex:ze.verticalPlacedTextSymbolIndex),jt=s.evaluateSizeForFeature(x.textSizeData,q,fi),ai=w.get("text-padding");Ci=this.collisionIndex.placeCollisionCircles(oe,fi,x.lineVertexArray,x.glyphOffsetArray,jt,S,P,L,f,ce,le.predicate,ze.collisionCircleDiameter*jt/s.ONE_EM,ai,this.retainedQueryData[x.bucketInstanceId].tileID),Fe=oe||Ci.circles.length>0&&!Ci.collisionDetected,Dt=Dt&&Ci.offscreen}if($e.iconFeatureIndex&&(Ui=$e.iconFeatureIndex),$e.iconBox){const fi=jt=>{hn(jt);const ai=Se&&Xt?Mo(Xt.x,Xt.y,ne,ce,this.transform.angle):new s.pointGeometry(0,0),Yi=x.getSymbolInstanceIconSize(X,this.transform.zoom,Ae);return this.collisionIndex.placeCollisionBox(Yi,jt,ai,ie,N,S,le.predicate)};zt&&zt.box&&zt.box.length&&$e.verticalIconBox?(Di=fi($e.verticalIconBox),St=Di.box.length>0):(Di=fi($e.iconBox),St=Di.box.length>0),Dt=Dt&&Di.offscreen}const _r=W||ze.numHorizontalGlyphVertices===0&&ze.numVerticalGlyphVertices===0,kr=re||ze.numIconVertices===0;if(_r||kr?kr?_r||(St=St&&Fe):Fe=St&&Fe:St=Fe=St&&Fe,Fe&&Ut&&Ut.box&&this.collisionIndex.insertCollisionBox(Ut.box,w.get("text-ignore-placement"),x.bucketInstanceId,zt&&zt.box&&ii?ii:Ot,le.ID),St&&Di&&this.collisionIndex.insertCollisionBox(Di.box,w.get("icon-ignore-placement"),x.bucketInstanceId,Ui,le.ID),Ci&&(Fe&&this.collisionIndex.insertCollisionCircles(Ci.circles,w.get("text-ignore-placement"),x.bucketInstanceId,Ot,le.ID),f)){const fi=x.bucketInstanceId;let jt=this.collisionCircleArrays[fi];jt===void 0&&(jt=this.collisionCircleArrays[fi]=new ha);for(let ai=0;ai<Ci.circles.length;ai+=4)jt.circles.push(Ci.circles[ai+0]),jt.circles.push(Ci.circles[ai+1]),jt.circles.push(Ci.circles[ai+2]),jt.circles.push(Ci.collisionDetected?1:0)}this.placements[ze.crossTileID]=new bs(Fe||et,St||qe,Dt||x.justReloaded),c[ze.crossTileID]=!0};if(Me){const ze=x.getSortedSymbolIndexes(this.transform.angle);for(let Ae=ze.length-1;Ae>=0;--Ae){const $e=ze[Ae];Ge(x.symbolInstances.get($e),$e,x.collisionArrays[$e])}}else for(let ze=i.symbolInstanceStart;ze<i.symbolInstanceEnd;ze++)Ge(x.symbolInstances.get(ze),ze,x.collisionArrays[ze]);if(f&&x.bucketInstanceId in this.collisionCircleArrays){const ze=this.collisionCircleArrays[x.bucketInstanceId];s.invert(ze.invProjMatrix,S),ze.viewportMatrix=this.collisionIndex.getViewportMatrix()}x.justReloaded=!1}markUsedJustification(i,c,f,_){let x;x=_===s.WritingMode.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(c)];const w=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const S of w)S>=0&&(i.text.placedSymbolArray.get(S).crossTileID=x>=0&&S!==x?0:f.crossTileID)}markUsedOrientation(i,c,f){const _=c===s.WritingMode.horizontal||c===s.WritingMode.horizontalOnly?c:0,x=c===s.WritingMode.vertical?c:0,w=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const S of w)i.text.placedSymbolArray.get(S).placedOrientation=_;f.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let f=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const _=c?c.symbolFadeChange(i):1,x=c?c.opacities:{},w=c?c.variableOffsets:{},S=c?c.placedOrientations:{};for(const P in this.placements){const L=this.placements[P],O=x[P];O?(this.opacities[P]=new xs(O,_,L.text,L.icon,null,L.clipped),f=f||L.text!==O.text.placed||L.icon!==O.icon.placed):(this.opacities[P]=new xs(null,_,L.text,L.icon,L.skipFade,L.clipped),f=f||L.text||L.icon)}for(const P in x){const L=x[P];if(!this.opacities[P]){const O=new xs(L,_,!1,!1);O.isHidden()||(this.opacities[P]=O,f=f||L.text.placed||L.icon.placed)}}for(const P in w)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=w[P]);for(const P in S)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=S[P]);f?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:i)}updateLayerOpacities(i,c){const f={};for(const _ of c){const x=_.getBucket(i);x&&_.latestFeatureIndex&&i.id===x.layerIds[0]&&this.updateBucketOpacities(x,f,_.collisionBoxArray)}}updateBucketOpacities(i,c,f){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const _=i.layers[0].layout,x=!!i.layers[0].dynamicFilter(),w=new xs(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),P=_.get("icon-allow-overlap"),L=_.get("text-variable-anchor"),O=_.get("text-rotation-alignment")==="map",N=_.get("text-pitch-alignment")==="map",$=_.get("icon-text-fit")!=="none",H=new xs(null,0,S&&(P||!i.hasIconData()||_.get("icon-optional")),P&&(S||!i.hasTextData()||_.get("text-optional")),!0);!i.collisionArrays&&f&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(f);const q=(le,W,re)=>{for(let oe=0;oe<W/4;oe++)le.opacityVertexArray.emplaceBack(re)};let X=0;for(let le=0;le<i.symbolInstances.length;le++){const W=i.symbolInstances.get(le),{numHorizontalGlyphVertices:re,numVerticalGlyphVertices:oe,crossTileID:ie}=W;let ne=this.opacities[ie];c[ie]?ne=w:ne||(ne=H,this.opacities[ie]=ne),c[ie]=!0;const ce=re>0||oe>0,Se=W.numIconVertices>0,Me=this.placedOrientations[W.crossTileID],et=Me===s.WritingMode.vertical,qe=Me===s.WritingMode.horizontal||Me===s.WritingMode.horizontalOnly;if(!ce&&!Se||ne.isHidden()||X++,ce){const Ge=fl(ne.text);q(i.text,re,et?zo:Ge),q(i.text,oe,qe?zo:Ge);const ze=ne.text.isHidden();[W.rightJustifiedTextSymbolIndex,W.centerJustifiedTextSymbolIndex,W.leftJustifiedTextSymbolIndex].forEach(Fe=>{Fe>=0&&(i.text.placedSymbolArray.get(Fe).hidden=ze||et?1:0)}),W.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(W.verticalPlacedTextSymbolIndex).hidden=ze||qe?1:0);const Ae=this.variableOffsets[W.crossTileID];Ae&&this.markUsedJustification(i,Ae.anchor,W,Me);const $e=this.placedOrientations[W.crossTileID];$e&&(this.markUsedJustification(i,"left",W,$e),this.markUsedOrientation(i,$e,W))}if(Se){const Ge=fl(ne.icon);W.placedIconSymbolIndex>=0&&(q(i.icon,W.numIconVertices,et?zo:Ge),i.icon.placedSymbolArray.get(W.placedIconSymbolIndex).hidden=ne.icon.isHidden()),W.verticalPlacedIconSymbolIndex>=0&&(q(i.icon,W.numVerticalIconVertices,qe?zo:Ge),i.icon.placedSymbolArray.get(W.verticalPlacedIconSymbolIndex).hidden=ne.icon.isHidden())}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Ge=i.collisionArrays[le];if(Ge){let ze=new s.pointGeometry(0,0),Ae=!0;if(Ge.textBox||Ge.verticalTextBox){if(L){const Fe=this.variableOffsets[ie];Fe?(ze=dl(Fe.anchor,Fe.width,Fe.height,Fe.textOffset,Fe.textScale),O&&ze._rotate(N?this.transform.angle:-this.transform.angle)):Ae=!1}x&&(Ae=!ne.clipped),Ge.textBox&&Io(i.textCollisionBox.collisionVertexArray,ne.text.placed,!Ae||et,ze.x,ze.y),Ge.verticalTextBox&&Io(i.textCollisionBox.collisionVertexArray,ne.text.placed,!Ae||qe,ze.x,ze.y)}const $e=Ae&&Boolean(!qe&&Ge.verticalIconBox);Ge.iconBox&&Io(i.iconCollisionBox.collisionVertexArray,ne.icon.placed,$e,$?ze.x:0,$?ze.y:0),Ge.verticalIconBox&&Io(i.iconCollisionBox.collisionVertexArray,ne.icon.placed,!$e,$?ze.x:0,$?ze.y:0)}}}if(i.fullyClipped=X===0,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const le=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=le.invProjMatrix,i.placementViewportMatrix=le.viewportMatrix,i.collisionCircleArray=le.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,c){const f=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*f>i}setStale(){this.stale=!0}}function Io(p,i,c,f,_){p.emplaceBack(i?1:0,c?1:0,f||0,_||0),p.emplaceBack(i?1:0,c?1:0,f||0,_||0),p.emplaceBack(i?1:0,c?1:0,f||0,_||0),p.emplaceBack(i?1:0,c?1:0,f||0,_||0)}const ke=Math.pow(2,25),pt=Math.pow(2,24),kh=Math.pow(2,17),ko=Math.pow(2,16),tn=Math.pow(2,9),lo=Math.pow(2,8),Zr=Math.pow(2,1);function fl(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const i=p.placed?1:0,c=Math.floor(127*p.opacity);return c*ke+i*pt+c*kh+i*ko+c*tn+i*lo+c*Zr+i}const zo=0;class ct{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&i.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,c,f,_,x){const w=this._bucketParts;for(;this._currentTileIndex<i.length;)if(c.getBucketParts(w,_,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((S,P)=>S.sortKey-P.sortKey));this._currentPartIndex<w.length;){const S=w[this._currentPartIndex];if(c.placeLayerBucketPart(S,this._seenCrossTileIDs,f,S.symbolInstanceStart===0),this._currentPartIndex++,x())return!0}return!1}}class si{constructor(i,c,f,_,x,w,S,P){this.placement=new pl(i,x,w,S,P),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(i,c,f){const _=s.exported.now(),x=()=>{const w=s.exported.now()-_;return!this._forceFullPlacement&&w>2};for(;this._currentPlacementIndex>=0;){const w=c[i[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=S)&&(!w.maxzoom||w.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new ct(w)),this._inProgressLayer.continuePlacement(f[w.source],this.placement,this._showCollisionBoxes,w,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const Jt=512/s.EXTENT/2;class Wr{constructor(i,c,f){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=f;for(let _=0;_<c.length;_++){const x=c.get(_),w=x.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:x.crossTileID,coord:this.getScaledCoordinates(x,i)})}}getScaledCoordinates(i,c){const f=Jt/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*s.EXTENT+i.tileAnchorX)*f),y:Math.floor((c.canonical.y*s.EXTENT+i.tileAnchorY)*f)}}findMatches(i,c,f){const _=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let x=0;x<i.length;x++){const w=i.get(x);if(w.crossTileID)continue;const S=this.indexedSymbolInstances[w.key];if(!S)continue;const P=this.getScaledCoordinates(w,c);for(const L of S)if(Math.abs(L.coord.x-P.x)<=_&&Math.abs(L.coord.y-P.y)<=_&&!f[L.crossTileID]){f[L.crossTileID]=!0,w.crossTileID=L.crossTileID;break}}}}class ws{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Qt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const c=Math.round((i-this.lng)/360);if(c!==0)for(const f in this.indexes){const _=this.indexes[f],x={};for(const w in _){const S=_[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+c),x[S.tileID.key]=S}this.indexes[f]=x}this.lng=i}addBucket(i,c,f){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let x=0;x<c.symbolInstances.length;x++)c.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const _=this.usedCrossTileIDs[i.overscaledZ];for(const x in this.indexes){const w=this.indexes[x];if(Number(x)>i.overscaledZ)for(const S in w){const P=w[S];P.tileID.isChildOf(i)&&P.findMatches(c.symbolInstances,i,_)}else{const S=w[i.scaledTo(Number(x)).key];S&&S.findMatches(c.symbolInstances,i,_)}}for(let x=0;x<c.symbolInstances.length;x++){const w=c.symbolInstances.get(x);w.crossTileID||(w.crossTileID=f.generate(),_[w.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new Wr(i,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(i,c){for(const f in c.indexedSymbolInstances)for(const _ of c.indexedSymbolInstances[f])delete this.usedCrossTileIDs[i][_.crossTileID]}removeStaleBuckets(i){let c=!1;for(const f in this.indexes){const _=this.indexes[f];for(const x in _)i[_[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,_[x]),delete _[x],c=!0)}return c}}class da{constructor(){this.layerIndexes={},this.crossTileIDs=new ws,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,c,f,_){let x=this.layerIndexes[i.id];x===void 0&&(x=this.layerIndexes[i.id]=new Qt);let w=!1;const S={};_.name!=="globe"&&x.handleWrapJump(f);for(const P of c){const L=P.getBucket(i);L&&i.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(P.tileID,L,this.crossTileIDs)&&(w=!0),S[L.bucketInstanceId]=!0)}return x.removeStaleBuckets(S)&&(w=!0),w}pruneUnusedLayers(i){const c={};i.forEach(f=>{c[f]=!0});for(const f in this.layerIndexes)c[f]||delete this.layerIndexes[f]}}const Po=(p,i)=>s.emitValidationErrors(p,i&&i.filter(c=>c.identifier!=="source.canvas")),pa=s.pick(fe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),pr=s.pick(fe,["setCenter","setZoom","setBearing","setPitch"]),Wi=function(){const p={},i=s.spec.$version;for(const c in s.spec.$root){const f=s.spec.$root[c];if(f.required){let _=null;_=c==="version"?i:f.type==="array"?[]:{},_!=null&&(p[c]=_)}}return p}(),uf={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Yn extends s.Evented{constructor(i,c={}){super(),this.map=i,this.dispatcher=new ri(pe(),this),this.imageManager=new Ue,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(i._requestManager,c.localFontFamily?s.LocalGlyphMode.all:c.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.lineAtlas=new s.LineAtlas(256,512),this.crossTileSymbolIndex=new da,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const f=this;this._rtlTextPluginCallback=Yn.registerForPluginStateChange(_=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(x,w)=>{if(s.triggerPluginCompletionEvent(x),w&&w.every(S=>S))for(const S in f._sourceCaches){const P=f._sourceCaches[S],L=P.getSource().type;L!=="vector"&&L!=="geojson"||P.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const x=this.getSource(_.sourceId);if(x&&x.vectorLayerIds)for(const w in this._layers){const S=this._layers[w];S.source===x.id&&this._validateLayer(S)}})}loadURL(i,c={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const f=typeof c.validate=="boolean"?c.validate:!s.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,c.accessToken);const _=this.map._requestManager.transformRequest(i,s.ResourceType.Style);this._request=s.getJSON(_,(x,w)=>{this._request=null,x?this.fire(new s.ErrorEvent(x)):w&&this._load(w,f)})}loadJSON(i,c={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(i,c.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Wi,!1)}_updateLayerCount(i,c){const f=c?1:-1;i.is3D()&&(this._num3DLayers+=f),i.type==="circle"&&(this._numCircleLayers+=f),i.type==="symbol"&&(this._numSymbolLayers+=f)}_load(i,c){if(c&&Po(this,s.validateStyle(i)))return;this._loaded=!0,this.stylesheet=i,this.updateProjection();for(const _ in i.sources)this.addSource(_,i.sources[_],{validate:!1});this._changed=!1,i.sprite?this._loadSprite(i.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(i.glyphs);const f=Y(this.stylesheet.layers);this._order=f.map(_=>_.id),this._layers={},this._serializedLayers={};for(let _ of f)_=s.createStyleLayer(_),_.setEventedParent(this,{layer:{id:_.id}}),this._layers[_.id]=_,this._serializedLayers[_.id]=_.serialize(),this._updateLayerCount(_,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new lt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return this.terrain&&this.terrain.drapeRenderMode===0}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this.updateProjection()}updateProjection(){const i=this.map.transform.projection,c=this.map.transform.setProjection(this.map._runtimeProjection||(this.stylesheet?this.stylesheet.projection:void 0)),f=this.map.transform.projection;if(this._loaded&&(f.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null)),this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),c){if(f.isReprojectedInTileSpace||i.isReprojectedInTileSpace){this.map.painter.clearBackgroundTiles();for(const _ in this._sourceCaches)this._sourceCaches[_].clearTiles()}else this._forceSymbolLayerUpdate();this.map._update(!0)}}_loadSprite(i){this._spriteRequest=function(c,f,_){let x,w,S;const P=s.exported.devicePixelRatio>1?"@2x":"";let L=s.getJSON(f.transformRequest(f.normalizeSpriteURL(c,P,".json"),s.ResourceType.SpriteJSON),($,H)=>{L=null,S||(S=$,x=H,N())}),O=s.getImage(f.transformRequest(f.normalizeSpriteURL(c,P,".png"),s.ResourceType.SpriteImage),($,H)=>{O=null,S||(S=$,w=H,N())});function N(){if(S)_(S);else if(x&&w){const $=s.exported.getImageData(w),H={};for(const q in x){const{width:X,height:le,x:W,y:re,sdf:oe,pixelRatio:ie,stretchX:ne,stretchY:ce,content:Se}=x[q],Me=new s.RGBAImage({width:X,height:le});s.RGBAImage.copy($,Me,{x:W,y:re},{x:0,y:0},{width:X,height:le}),H[q]={data:Me,pixelRatio:ie,sdf:oe,stretchX:ne,stretchY:ce,content:Se}}_(null,H)}}return{cancel(){L&&(L.cancel(),L=null),O&&(O.cancel(),O=null)}}}(i,this.map._requestManager,(c,f)=>{if(this._spriteRequest=null,c)this.fire(new s.ErrorEvent(c));else if(f)for(const _ in f)this.imageManager.addImage(_,f[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(i){const c=this.getSource(i.source);if(!c)return;const f=i.sourceLayer;f&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(f)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${f}" does not exist on source "${c.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const c=[];for(const f of i){const _=this._layers[f];_.type!=="custom"&&c.push(_.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(i){return!!this.terrain&&uf[i.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(i){if(!this._loaded)return;const c=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(_.length||x.length)&&this._updateWorkerLayers(_,x);for(const w in this._updatedSources){const S=this._updatedSources[w];S==="reload"?this._reloadSource(w):S==="clear"&&this._clearSource(w)}this._updateTilesForChangedImages();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(i);this.light.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this._resetUpdates()}const f={};for(const _ in this._sourceCaches){const x=this._sourceCaches[_];f[_]=x.used,x.used=!1}for(const _ of this._order){const x=this._layers[_];if(x.recalculate(i,this._availableImages),!x.isHidden(i.zoom)){const S=this._getLayerSourceCache(x);S&&(S.used=!0)}const w=this.map.painter;if(w){const S=x.getProgramIds();if(!S)continue;const P=x.getProgramConfiguration(i.zoom);for(const L of S)w.useProgram(L,P)}}for(const _ in f){const x=this._sourceCaches[_];f[_]!==x.used&&x.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:x.getSource().id}))}this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),Po(this,s.validateStyle(i)))return!1;(i=s.clone$1(i)).layers=Y(i.layers);const c=function(_,x){if(!_)return[{command:fe.setStyle,args:[x]}];let w=[];try{if(!R(_.version,x.version))return[{command:fe.setStyle,args:[x]}];R(_.center,x.center)||w.push({command:fe.setCenter,args:[x.center]}),R(_.zoom,x.zoom)||w.push({command:fe.setZoom,args:[x.zoom]}),R(_.bearing,x.bearing)||w.push({command:fe.setBearing,args:[x.bearing]}),R(_.pitch,x.pitch)||w.push({command:fe.setPitch,args:[x.pitch]}),R(_.sprite,x.sprite)||w.push({command:fe.setSprite,args:[x.sprite]}),R(_.glyphs,x.glyphs)||w.push({command:fe.setGlyphs,args:[x.glyphs]}),R(_.transition,x.transition)||w.push({command:fe.setTransition,args:[x.transition]}),R(_.light,x.light)||w.push({command:fe.setLight,args:[x.light]}),R(_.fog,x.fog)||w.push({command:fe.setFog,args:[x.fog]}),R(_.projection,x.projection)||w.push({command:fe.setProjection,args:[x.projection]});const S={},P=[];(function(N,$,H,q){let X;for(X in $=$||{},N=N||{})N.hasOwnProperty(X)&&($.hasOwnProperty(X)||it(X,H,q));for(X in $)$.hasOwnProperty(X)&&(N.hasOwnProperty(X)?R(N[X],$[X])||(N[X].type==="geojson"&&$[X].type==="geojson"&&gt(N,$,X)?H.push({command:fe.setGeoJSONSourceData,args:[X,$[X].data]}):mt(X,$,H,q)):Te(X,$,H))})(_.sources,x.sources,P,S);const L=[];_.layers&&_.layers.forEach(N=>{S[N.source]?w.push({command:fe.removeLayer,args:[N.id]}):L.push(N)});let O=_.terrain;O&&S[O.source]&&(w.push({command:fe.setTerrain,args:[void 0]}),O=void 0),w=w.concat(P),R(O,x.terrain)||w.push({command:fe.setTerrain,args:[x.terrain]}),function(N,$,H){$=$||[];const q=(N=N||[]).map($t),X=$.map($t),le=N.reduce(Ht,{}),W=$.reduce(Ht,{}),re=q.slice(),oe=Object.create(null);let ie,ne,ce,Se,Me,et,qe;for(ie=0,ne=0;ie<q.length;ie++)ce=q[ie],W.hasOwnProperty(ce)?ne++:(H.push({command:fe.removeLayer,args:[ce]}),re.splice(re.indexOf(ce,ne),1));for(ie=0,ne=0;ie<X.length;ie++)ce=X[X.length-1-ie],re[re.length-1-ie]!==ce&&(le.hasOwnProperty(ce)?(H.push({command:fe.removeLayer,args:[ce]}),re.splice(re.lastIndexOf(ce,re.length-ne),1)):ne++,et=re[re.length-ie],H.push({command:fe.addLayer,args:[W[ce],et]}),re.splice(re.length-ie,0,ce),oe[ce]=!0);for(ie=0;ie<X.length;ie++)if(ce=X[ie],Se=le[ce],Me=W[ce],!oe[ce]&&!R(Se,Me))if(R(Se.source,Me.source)&&R(Se["source-layer"],Me["source-layer"])&&R(Se.type,Me.type)){for(qe in vt(Se.layout,Me.layout,H,ce,null,fe.setLayoutProperty),vt(Se.paint,Me.paint,H,ce,null,fe.setPaintProperty),R(Se.filter,Me.filter)||H.push({command:fe.setFilter,args:[ce,Me.filter]}),R(Se.minzoom,Me.minzoom)&&R(Se.maxzoom,Me.maxzoom)||H.push({command:fe.setLayerZoomRange,args:[ce,Me.minzoom,Me.maxzoom]}),Se)Se.hasOwnProperty(qe)&&qe!=="layout"&&qe!=="paint"&&qe!=="filter"&&qe!=="metadata"&&qe!=="minzoom"&&qe!=="maxzoom"&&(qe.indexOf("paint.")===0?vt(Se[qe],Me[qe],H,ce,qe.slice(6),fe.setPaintProperty):R(Se[qe],Me[qe])||H.push({command:fe.setLayerProperty,args:[ce,qe,Me[qe]]}));for(qe in Me)Me.hasOwnProperty(qe)&&!Se.hasOwnProperty(qe)&&qe!=="layout"&&qe!=="paint"&&qe!=="filter"&&qe!=="metadata"&&qe!=="minzoom"&&qe!=="maxzoom"&&(qe.indexOf("paint.")===0?vt(Se[qe],Me[qe],H,ce,qe.slice(6),fe.setPaintProperty):R(Se[qe],Me[qe])||H.push({command:fe.setLayerProperty,args:[ce,qe,Me[qe]]}))}else H.push({command:fe.removeLayer,args:[ce]}),et=re[re.lastIndexOf(ce)+1],H.push({command:fe.addLayer,args:[Me,et]})}(L,x.layers,w)}catch(S){console.warn("Unable to compute style diff:",S),w=[{command:fe.setStyle,args:[x]}]}return w}(this.serialize(),i).filter(_=>!(_.command in pr));if(c.length===0)return!1;const f=c.filter(_=>!(_.command in pa));if(f.length>0)throw new Error(`Unimplemented: ${f.map(_=>_.command).join(", ")}.`);return c.forEach(_=>{_.command!=="setTransition"&&this[_.command].apply(this,_.args)}),this.stylesheet=i,this.updateProjection(),!0}addImage(i,c){if(this.getImage(i))return this.fire(new s.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(i,c),this._afterImageUpdated(i)}updateImage(i,c){this.imageManager.updateImage(i,c)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new s.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(i,c,f={}){if(this._checkLoaded(),this.getSource(i)!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(s.validateStyle.source,`sources.${i}`,c,null,f))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const _=Ln(i,c,this.dispatcher,this);_.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:_.serialize(),sourceId:i}));const x=w=>{const S=(w?"symbol:":"other:")+i,P=this._sourceCaches[S]=new s.SourceCache(S,_,w);(w?this._symbolSourceCaches:this._otherSourceCaches)[i]=P,P.style=this,P.onAdd(this.map)};x(!1),c.type!=="vector"&&c.type!=="geojson"||x(!0),_.onAdd&&_.onAdd(this.map),this._changed=!0}removeSource(i){this._checkLoaded();const c=this.getSource(i);if(c===void 0)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===i)return this.fire(new s.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.get().source===i)return this.fire(new s.ErrorEvent(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const f=this._getSourceCaches(i);for(const _ of f)delete this._sourceCaches[_.id],delete this._updatedSources[_.id],_.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles();delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,c){this._checkLoaded(),this.getSource(i).setData(c),this._changed=!0}getSource(i){const c=this._getSourceCache(i);return c&&c.getSource()}addLayer(i,c,f={}){this._checkLoaded();const _=i.id;if(this.getLayer(_))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${_}" already exists on this map`)));let x;if(i.type==="custom"){if(Po(this,s.validateCustomStyleLayer(i)))return;x=s.createStyleLayer(i)}else{if(typeof i.source=="object"&&(this.addSource(_,i.source),i=s.clone$1(i),i=s.extend(i,{source:_})),this._validate(s.validateStyle.layer,`layers.${_}`,i,{arrayIndex:-1},f))return;x=s.createStyleLayer(i),this._validateLayer(x),x.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0)}const w=c?this._order.indexOf(c):this._order.length;if(c&&w===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(w,0,_),this._layerOrderChanged=!0,this._layers[_]=x;const S=this._getLayerSourceCache(x);if(this._removedLayers[_]&&x.source&&S&&x.type!=="custom"){const P=this._removedLayers[_];delete this._removedLayers[_],P.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",S.pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(i,c){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new s.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===c)return;const f=this._order.indexOf(i);this._order.splice(f,1);const _=c?this._order.indexOf(c):this._order.length;c&&_===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(_,0,i),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(i){this._checkLoaded();const c=this._layers[i];if(!c)return void this.fire(new s.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const f=this._order.indexOf(i);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=c,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}hasLayerType(i){for(const c in this._layers)if(this._layers[c].type===i)return!0;return!1}setLayerZoomRange(i,c,f){this._checkLoaded();const _=this.getLayer(i);_?_.minzoom===c&&_.maxzoom===f||(c!=null&&(_.minzoom=c),f!=null&&(_.maxzoom=f),this._updateLayer(_)):this.fire(new s.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(i,c,f={}){this._checkLoaded();const _=this.getLayer(i);if(_){if(!R(_.filter,c))return c==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(s.validateStyle.filter,`layers.${_.id}.filter`,c,{layerType:_.type},f)||(_.filter=s.clone$1(c),this._updateLayer(_)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be filtered.`)))}getFilter(i){return s.clone$1(this.getLayer(i).filter)}setLayoutProperty(i,c,f,_={}){this._checkLoaded();const x=this.getLayer(i);x?R(x.getLayoutProperty(c),f)||(x.setLayoutProperty(c,f,_),this._updateLayer(x)):this.fire(new s.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(i,c){const f=this.getLayer(i);if(f)return f.getLayoutProperty(c);this.fire(new s.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style.`)))}setPaintProperty(i,c,f,_={}){this._checkLoaded();const x=this.getLayer(i);x?R(x.getPaintProperty(c),f)||(x.setPaintProperty(c,f,_)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(i,c){return this.getLayer(i).getPaintProperty(c)}setFeatureState(i,c){this._checkLoaded();const f=i.source,_=i.sourceLayer,x=this.getSource(f);if(x===void 0)return void this.fire(new s.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const w=x.type;if(w==="geojson"&&_)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(w==="vector"&&!_)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));i.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const S=this._getSourceCaches(f);for(const P of S)P.setFeatureState(_,i.id,c)}removeFeatureState(i,c){this._checkLoaded();const f=i.source,_=this.getSource(f);if(_===void 0)return void this.fire(new s.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const x=_.type,w=x==="vector"?i.sourceLayer:void 0;if(x==="vector"&&!w)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof i.id!="string"&&typeof i.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const S=this._getSourceCaches(f);for(const P of S)P.removeFeatureState(w,i.id,c)}getFeatureState(i){this._checkLoaded();const c=i.source,f=i.sourceLayer,_=this.getSource(c);if(_!==void 0){if(_.type!=="vector"||f)return i.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(f,i.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const i={};for(const c in this._sourceCaches){const f=this._sourceCaches[c].getSource();i[f.id]||(i[f.id]=f.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:i,layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0;const c=this._getLayerSourceCache(i);i.source&&!this._updatedSources[i.source]&&c&&c.getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",c.pause()),this._changed=!0,i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const c=w=>this._layers[w].type==="fill-extrusion",f={},_=[];for(let w=this._order.length-1;w>=0;w--){const S=this._order[w];if(c(S)){f[S]=w;for(const P of i){const L=P[S];if(L)for(const O of L)_.push(O)}}}_.sort((w,S)=>S.intersectionZ-w.intersectionZ);const x=[];for(let w=this._order.length-1;w>=0;w--){const S=this._order[w];if(c(S))for(let P=_.length-1;P>=0;P--){const L=_[P].feature;if(f[L.layer.id]<w)break;x.push(L),_.pop()}else for(const P of i){const L=P[S];if(L)for(const O of L)x.push(O.feature)}}return x}queryRenderedFeatures(i,c,f){c&&c.filter&&this._validate(s.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);const _={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const P of c.layers){const L=this._layers[P];if(!L)return this.fire(new s.ErrorEvent(new Error(`The layer '${P}' does not exist in the map's style and cannot be queried for features.`))),[];_[L.source]=!0}}const x=[];c.availableImages=this._availableImages;const w=c&&c.layers?c.layers.some(P=>{const L=this.getLayer(P);return L&&L.is3D()}):this.has3DLayers(),S=ro.createFromScreenPoints(i,f);for(const P in this._sourceCaches){const L=this._sourceCaches[P].getSource().id;c.layers&&!_[L]||x.push(B(this._sourceCaches[P],this._layers,this._serializedLayers,S,c,f,w,!!this.map._showQueryGeometry))}return this.placement&&x.push(function(P,L,O,N,$,H,q){const X={},le=H.queryRenderedSymbols(N),W=[];for(const re of Object.keys(le).map(Number))W.push(q[re]);W.sort(K);for(const re of W){const oe=re.featureIndex.lookupSymbolFeatures(le[re.bucketInstanceId],L,re.bucketIndex,re.sourceLayerIndex,$.filter,$.layers,$.availableImages,P);for(const ie in oe){const ne=X[ie]=X[ie]||[],ce=oe[ie];ce.sort((Se,Me)=>{const et=re.featureSortOrder;if(et){const qe=et.indexOf(Se.featureIndex);return et.indexOf(Me.featureIndex)-qe}return Me.featureIndex-Se.featureIndex});for(const Se of ce)ne.push(Se)}}for(const re in X)X[re].forEach(oe=>{const ie=oe.feature,ne=O(P[re]).getFeatureState(ie.layer["source-layer"],ie.id);ie.source=ie.layer.source,ie.layer["source-layer"]&&(ie.sourceLayer=ie.layer["source-layer"]),ie.state=ne});return X}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),S.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(i,c){c&&c.filter&&this._validate(s.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);const f=this._getSourceCaches(i);let _=[];for(const x of f)_=_.concat(V(x,c));return _}addSourceType(i,c,f){return Yn.getSourceType(i)?f(new Error(`A source type called "${i}" already exists.`)):(Yn.setSourceType(i,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:c.workerSourceURL},f):f(null,null))}getLight(){return this.light.getLight()}setLight(i,c={}){this._checkLoaded();const f=this.light.getLight();let _=!1;for(const w in i)if(!R(i[w],f[w])){_=!0;break}if(!_)return;const x={now:s.exported.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,c),this.light.updateTransitions(x)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i,c=1){if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(c===1){if(typeof i.source=="object"){const f="terrain-dem-src";this.addSource(f,i.source),i=s.clone$1(i),i=s.extend(i,{source:f})}if(this._validate(s.validateStyle.terrain,"terrain",i))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode)this._createTerrain(i,c);else{const f=this.terrain,_=f.get();for(const x in i)if(!R(i[x],_[x])){f.set(i),this.stylesheet.terrain=i;const w={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};f.updateTransitions(w);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const c=this.fog=new Zi(i,this.map.transform);this.stylesheet.fog=i;const f={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};c.updateTransitions(f)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,f=c.get();for(const _ in i)if(!R(i[_],f[_])){c.set(i),this.stylesheet.fog=i;const x={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};c.updateTransitions(x);break}}else this._createFog(i);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const i=this._order.filter(f=>this.isLayerDraped(this._layers[f])),c=this._order.filter(f=>!this.isLayerDraped(this._layers[f]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...c)}_createTerrain(i,c){const f=this.terrain=new Ct(i,c);this.stylesheet.terrain=i,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const _={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};f.updateTransitions(_)}_force3DLayerUpdate(){for(const i in this._layers){const c=this._layers[i];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const c=this._layers[i];c.type==="symbol"&&this._updateLayer(c)}}_validate(i,c,f,_,x={}){return(!x||x.validate!==!1)&&Po(this,i.call(s.validateStyle,s.extend({key:c,style:this.serialize(),value:f,styleSpec:s.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this._sourceCaches)this._sourceCaches[i].clearTiles(),this._sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){const c=this._getSourceCaches(i);for(const f of c)f.clearTiles()}_reloadSource(i){const c=this._getSourceCaches(i);for(const f of c)f.resume(),f.reload()}_updateSources(i){for(const c in this._sourceCaches)this._sourceCaches[c].update(i)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const c=this._sourceCaches[i];c.resume(),c.reload()}}_updatePlacement(i,c,f,_,x=!1){let w=!1,S=!1;const P={};for(const L of this._order){const O=this._layers[L];if(O.type!=="symbol")continue;if(!P[O.source]){const $=this._getLayerSourceCache(O);if(!$)continue;P[O.source]=$.getRenderableIds(!0).map(H=>$.getTileByID(H)).sort((H,q)=>q.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(q.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(O,P[O.source],i.center.lng,i.projection);w=w||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),x=x||this._layerOrderChanged||f===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(x||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),i.zoom))&&(this.pauseablePlacement=new si(i,this._order,x,c,f,_,this.placement,this.fog&&i.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),S=!0),w&&this.pauseablePlacement.placement.setStale()),S||w)for(const L of this._order){const O=this._layers[L];O.type==="symbol"&&this.placement.updateLayerOpacities(O,P[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,c,f){this.imageManager.getImages(c.icons,f),this._updateTilesForChangedImages();const _=x=>{x&&x.setDependencies(c.tileID.key,c.type,c.icons)};_(this._otherSourceCaches[c.source]),_(this._symbolSourceCaches[c.source])}getGlyphs(i,c,f){this.glyphManager.getGlyphs(c.stacks,f)}getResource(i,c,f){return s.makeRequest(c,f)}_getSourceCache(i){return this._otherSourceCaches[i]}_getLayerSourceCache(i){return i.type==="symbol"?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}_getSourceCaches(i){const c=[];return this._otherSourceCaches[i]&&c.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&c.push(this._symbolSourceCaches[i]),c}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Yn.getSourceType=function(p){return so[p]},Yn.setSourceType=function(p,i){so[p]=i},Yn.registerForPluginStateChange=s.registerForPluginStateChange;var ml=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,Ts="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Es={},Ss={};Es=Gt("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),Ss=Gt(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const yi=Gt(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {
#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)
return mix(globe,mercator,t);
#else
return globe;
#endif
}
#ifdef PROJECTION_GLOBE_VIEW
mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),gl=ml;var Zc={background:Gt(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Gt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Gt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec2 scaled_extrude=extrude*a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=scaled_extrude.x*surface_vectors[0]+scaled_extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
#if defined(SCALE_WITH_MAP) && defined(PROJECTION_GLOBE_VIEW)
view_scale*=a_scale;
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Gt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Gt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
extrude*=a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Gt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Gt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Gt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Gt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Gt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Gt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Gt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Gt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Gt(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Gt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Gt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Gt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Gt(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Gt(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Gt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Gt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Gt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Gt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Gt(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:Gt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Gt(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ts),skyboxGradient:Gt(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ts),skyboxCapture:Gt(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Gt(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying vec2 v_pos0;const float wireframeOffset=1e3;void main() {v_pos0=a_uv;vec2 uv=a_uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}`),globeAtmosphere:Gt(`uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {highp vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)
discard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}")};function Gt(p,i,c){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,x=i.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w=p.match(_),S=i.match(_),P=ml.match(_);let L=S?S.concat(w):w;c||(Es.staticUniforms&&(L=Es.staticUniforms.concat(L)),Ss.staticUniforms&&(L=Ss.staticUniforms.concat(L))),L&&(L=L.concat(P));const O={};return{fragmentSource:p=p.replace(f,(N,$,H,q,X)=>(O[X]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${X}
varying ${H} ${q} ${X};
#else
uniform ${H} ${q} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${H} ${q} ${X} = u_${X};
#endif
`)),vertexSource:i=i.replace(f,(N,$,H,q,X)=>{const le=q==="float"?"vec2":"vec4",W=X.match(/color/)?"color":le;return O[X]?$==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${H} ${le} a_${X};
varying ${H} ${q} ${X};
#else
uniform ${H} ${q} u_${X};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${H} ${q} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${W}(a_${X}, u_${X}_t);
#else
    ${H} ${q} ${X} = u_${X};
#endif
`:$==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${H} ${le} a_${X};
#else
uniform ${H} ${q} u_${X};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${H} ${q} ${X} = a_${X};
#else
    ${H} ${q} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${H} ${q} ${X} = unpack_mix_${W}(a_${X}, u_${X}_t);
#else
    ${H} ${q} ${X} = u_${X};
#endif
`}),staticAttributes:x,staticUniforms:L}}class fr{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,c,f,_,x,w,S,P){this.context=i;let L=this.boundPaintVertexBuffers.length!==_.length;for(let O=0;!L&&O<_.length;O++)this.boundPaintVertexBuffers[O]!==_[O]&&(L=!0);i.extVertexArrayObject&&this.vao&&this.boundProgram===c&&this.boundLayoutVertexBuffer===f&&!L&&this.boundIndexBuffer===x&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===P?(i.bindVertexArrayOES.set(this.vao),S&&S.bind(),x&&x.dynamicDraw&&x.bind(),P&&P.bind()):this.freshBind(c,f,_,x,w,S,P)}freshBind(i,c,f,_,x,w,S){let P;const L=i.numAttributes,O=this.context,N=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),P=0,this.boundProgram=i,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=_,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{P=O.currentNumAttributes||0;for(let $=L;$<P;$++)N.disableVertexAttribArray($)}c.enableAttributes(N,i);for(const $ of f)$.enableAttributes(N,i);w&&w.enableAttributes(N,i),S&&S.enableAttributes(N,i),c.bind(),c.setVertexAttribPointers(N,i,x);for(const $ of f)$.bind(),$.setVertexAttribPointers(N,i,x);w&&(w.bind(),w.setVertexAttribPointers(N,i,x)),_&&_.bind(),S&&(S.bind(),S.setVertexAttribPointers(N,i,x)),O.currentNumAttributes=L}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function zh(p,i){const c=Math.pow(2,i.canonical.z),f=i.canonical.y;return[new s.MercatorCoordinate(0,f/c).toLngLat().lat,new s.MercatorCoordinate(0,(f+1)/c).toLngLat().lat]}function _l(p,i,c,f,_,x,w){const S=p.context,P=S.gl,L=c.fbo;if(!L)return;p.prepareDrawTile(i);const O=p.useProgram("hillshade");S.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,L.colorAttachment.get());const N=((X,le,W,re)=>{const oe=W.paint.get("hillshade-shadow-color"),ie=W.paint.get("hillshade-highlight-color"),ne=W.paint.get("hillshade-accent-color");let ce=W.paint.get("hillshade-illumination-direction")*(Math.PI/180);W.paint.get("hillshade-illumination-anchor")==="viewport"&&(ce-=X.transform.angle);const Se=!X.options.moving;return{u_matrix:re||X.transform.calculateProjMatrix(le.tileID.toUnwrapped(),Se),u_image:0,u_latrange:zh(0,le.tileID),u_light:[W.paint.get("hillshade-exaggeration"),ce],u_shadow:oe,u_highlight:ie,u_accent:ne}})(p,c,f,p.terrain?i.projMatrix:null);p.prepareDrawProgram(S,O,i.toUnwrapped());const{tileBoundsBuffer:$,tileBoundsIndexBuffer:H,tileBoundsSegments:q}=p.getTileBoundsBuffers(c);O.draw(S,P.TRIANGLES,_,x,w,s.CullFaceMode.disabled,N,f.id,$,H,q)}function rn(p,i,c){if(!i.needsDEMTextureUpload)return;const f=p.context,_=f.gl;f.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||p.getTileTexture(c.stride);const x=c.getPixels();i.demTexture?i.demTexture.update(x,{premultiply:!1}):i.demTexture=new s.Texture(f,x,_.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function fa(p,i,c,f,_,x){const w=p.context,S=w.gl;if(!i.dem)return;const P=i.dem;if(w.activeTexture.set(S.TEXTURE1),rn(p,i,P),!i.demTexture)return;i.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const L=P.dim;w.activeTexture.set(S.TEXTURE0);let O=i.fbo;if(!O){const q=new s.Texture(w,{width:L,height:L,data:null},S.RGBA);q.bind(S.LINEAR,S.CLAMP_TO_EDGE),O=i.fbo=w.createFramebuffer(L,L,!0),O.colorAttachment.set(q.texture)}w.bindFramebuffer.set(O.framebuffer),w.viewport.set([0,0,L,L]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:$,tileBoundsSegments:H}=p.getMercatorTileBoundsBuffers();p.useProgram("hillshadePrepare").draw(w,S.TRIANGLES,f,_,x,s.CullFaceMode.disabled,((q,X)=>{const le=X.stride,W=s.create();return s.ortho(W,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(W,W,[0,-s.EXTENT,0]),{u_matrix:W,u_image:1,u_dimension:[le,le],u_zoom:q.overscaledZ,u_unpack:X.unpackVector}})(i.tileID,P),c.id,N,$,H),i.needsHillshadePrepare=!1}const Do=(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_image0:new s.Uniform1i(p,i.u_image0),u_skirt_height:new s.Uniform1f(p,i.u_skirt_height)}),mn=(p,i)=>({u_matrix:p,u_image0:0,u_skirt_height:i}),yl=(p,i,c,f,_)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:i,u_merc_matrix:c,u_zoom_transition:f,u_merc_center:_,u_image0:0});function mr(p,i){return p!=null&&i!=null&&!(!p.hasData()||!i.hasData())&&p.demTexture!=null&&i.demTexture!=null&&p.tileID.key!==i.tileID.key}const Hr=new class{constructor(){this.operations={}}newMorphing(p,i,c,f,_){if(p in this.operations){const x=this.operations[p];x.to.tileID.key!==c.tileID.key&&(x.queued=c)}else this.operations[p]={startTime:f,phase:0,duration:_,from:i,to:c,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const i=this.operations[p];return{from:i.from,to:i.to,phase:i.phase}}update(p){for(const i in this.operations){const c=this.operations[i];for(c.phase=(p-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,p)){delete this.operations[i];break}}}_nextOp(p,i){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=i,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},es={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function hf(p,i){const c=1<<p.z;return!i&&(p.x===0||p.x===c-1)||p.y===0||p.y===c-1}const Xr=p=>({u_matrix:p});function Ph(p,i,c,f,_){if(_>0){const x=s.exported.now(),w=(x-p.timeAdded)/_,S=i?(x-i.timeAdded)/_:-1,P=c.getSource(),L=f.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),O=!i||Math.abs(i.tileID.overscaledZ-L)>Math.abs(p.tileID.overscaledZ-L),N=O&&p.refreshedUponExpiration?1:s.clamp(O?w:1-S,0,1);return p.refreshedUponExpiration&&w>=1&&(p.refreshedUponExpiration=!1),i?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}class Dh extends s.SourceCache{constructor(i){const c={type:"raster-dem",maxzoom:i.transform.maxZoom},f=new ri(pe(),null),_=Ln("mock-dem",c,f,i.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,c){i.state="loaded",c(null)}}class nr extends s.SourceCache{constructor(i){const c=Ln("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new ri(pe(),null),i.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,c,f){if(i.freezeTileCoverage)return;this.transform=i;const _=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((x,w)=>{if(x[w.key]="",!this._tiles[w.key]){const S=new s.Tile(w,this._source.tileSize*w.overscaleFactor(),i.tileZoom);S.state="loaded",this._tiles[w.key]=S}return x},{});for(const x in this._tiles)x in _||(this.freeFBO(x),this._tiles[x].unloadVectorData(),delete this._tiles[x])}freeFBO(i){const c=this.proxyCachedFBO[i];if(c!==void 0){const f=Object.values(c);this.renderCachePool.push(...f),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ma extends s.OverscaledTileID{constructor(i,c,f){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=c,this.projMatrix=f}}class Lo extends s.Elevation{constructor(i,c){super(),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[f,_,x]=function(P){const L=new s.StructArrayLayout4i8,O=new s.StructArrayLayout3ui6,N=131;L.reserve(17161),O.reserve(33800);const $=s.EXTENT/128,H=s.EXTENT+$/2,q=H+$;for(let le=-$;le<q;le+=$)for(let W=-$;W<q;W+=$){const re=W<0||W>H||le<0||le>H?24575:0,oe=s.clamp(Math.round(W),0,s.EXTENT),ie=s.clamp(Math.round(le),0,s.EXTENT);L.emplaceBack(oe+re,ie,oe,ie)}const X=(le,W)=>{const re=W*N+le;O.emplaceBack(re+1,re,re+N),O.emplaceBack(re+N,re+N+1,re+1)};for(let le=1;le<129;le++)for(let W=1;W<129;W++)X(W,le);return[0,129].forEach(le=>{for(let W=0;W<130;W++)X(W,le),X(le,W)}),[L,O,32768]}(),w=i.context;this.gridBuffer=w.createVertexBuffer(f,s.boundsAttributes.members),this.gridIndexBuffer=w.createIndexBuffer(_),this.gridSegments=s.SegmentVector.simpleSegment(0,0,f.length,_.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,f.length,x),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new nr(c.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,0,s.EXTENT,0,s.EXTENT,0,1);const S=w.gl;this._overlapStencilMode=new s.StencilMode({func:S.GEQUAL,mask:255},0,255,S.KEEP,S.KEEP,S.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Dh(c.map)}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),i.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=i,this._checkRenderCacheEfficiency()}update(i,c,f){if(i&&i.terrain){this._style!==i&&(this.style=i),this.enabled=!0;const _=i.terrain.properties;this.sourceCache=i.terrain.drapeRenderMode===0?this._mockSourceCache:i._getSourceCache(_.get("source")),this._exaggeration=_.get("exaggeration");const x=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const w=this.getScaledDemTileSize();this.sourceCache.update(c,w,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,x(),this._initializing=!0),x(),c.updateElevation(!f),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const i=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||i.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${i.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${i.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(i){i.coord&&i.dataType==="source"?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):i.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._sourceCaches)this._style._sourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,f=this.painter.transform;this._initializing&&(this._initializing=f._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(f.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=c.getIds().map(P=>{const L=c.getTileByID(P).tileID;return L.projMatrix=f.calculateProjMatrix(L.toUnwrapped()),L});(function(P,L){const O=L.transform.pointCoordinate(L.transform.getCameraPoint()),N=new s.pointGeometry(O.x,O.y);P.sort(($,H)=>{if(H.overscaledZ-$.overscaledZ)return H.overscaledZ-$.overscaledZ;const q=new s.pointGeometry($.canonical.x+(1<<$.canonical.z)*$.wrap,$.canonical.y),X=new s.pointGeometry(H.canonical.x+(1<<H.canonical.z)*H.wrap,H.canonical.y),le=N.mult(1<<$.canonical.z);return le.x-=.5,le.y-=.5,le.distSqr(q)-le.distSqr(X)})})(_,this.painter),this._previousZoom=f.zoom;const x=this.proxyToSource||{};this.proxyToSource={},_.forEach(P=>{this.proxyToSource[P.key]={}}),this.terrainTileForTile={};const w=this._style._sourceCaches;for(const P in w){const L=w[P];if(!L.used||(L!==this.sourceCache&&this.resetTileLookupCache(L.id),this._setupProxiedCoordsForOrtho(L,i[P],x),L.usedForTerrain))continue;const O=i[P];L.getSource().reparseOverscaled&&this._assignTerrainTiles(O)}this.proxiedCoords[c.id]=_.map(P=>new ma(P,P.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(x),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const S={};this._visibleDemTiles=[];for(const P of this.proxyCoords){const L=this.terrainTileForTile[P.key];if(!L)continue;const O=L.tileID.key;O in S||(this._visibleDemTiles.push(L),S[O]=O)}}_assignTerrainTiles(i){this._initializing||i.forEach(c=>{if(this.terrainTileForTile[c.key])return;const f=this._findTileCoveringTileID(c,this.sourceCache);f&&(this.terrainTileForTile[c.key]=f)})}_prepareDEMTextures(){const i=this.painter.context,c=i.gl;for(const f in this.terrainTileForTile){const _=this.terrainTileForTile[f],x=_.dem;!x||_.demTexture&&!_.needsDEMTextureUpload||(i.activeTexture.set(c.TEXTURE1),rn(this.painter,_,x))}}_prepareDemTileUniforms(i,c,f,_){if(!c||c.demTexture==null)return!1;const x=i.tileID.canonical,w=Math.pow(2,c.tileID.canonical.z-x.z),S=_||"";return f[`u_dem_tl${S}`]=[x.x*w%1,x.y*w%1],f[`u_dem_scale${S}`]=w,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const i=this.painter.context,c=i.gl;if(!this._emptyDepthBufferTexture){const f={width:1,height:1,data:new Uint8Array([255,255,255,255])};this._emptyDepthBufferTexture=new s.Texture(i,f,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let i=0;const c=this._visibleDemTiles.reduce((f,_)=>{if(!_.dem)return f;const x=_.dem.tree.minimums[0];return x>0&&i++,f+x},0);return i?c/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,c=i.gl;i.activeTexture.set(c.TEXTURE2);const f=this._getLoadedAreaMinimum(),_={width:1,height:1,data:new Uint8Array(s.DEMData.pack(f,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let x=this._emptyDEMTexture;return x?x.update(_,{premultiply:!1}):x=this._emptyDEMTexture=new s.Texture(i,_,c.RGBA,{premultiply:!1}),x}setupElevationDraw(i,c,f){const _=this.painter.context,x=_.gl,w=(S=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(S),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var S;w.u_dem_size=this.sourceCache.getSource().tileSize,w.u_exaggeration=this.exaggeration();const P=this.painter.transform,L=P.projection.createTileTransform(P,P.worldSize),O=i.tileID.canonical;w.u_tile_tl_up=L.upVector(O,0,0),w.u_tile_tr_up=L.upVector(O,s.EXTENT,0),w.u_tile_br_up=L.upVector(O,s.EXTENT,s.EXTENT),w.u_tile_bl_up=L.upVector(O,0,s.EXTENT),w.u_tile_up_scale=L.upVectorScale(O);let N=null,$=null,H=1;if(f&&f.morphing&&this._useVertexMorphing){const q=f.morphing.srcDemTile,X=f.morphing.dstDemTile;H=f.morphing.phase,q&&X&&(this._prepareDemTileUniforms(i,q,w,"_prev")&&($=q),this._prepareDemTileUniforms(i,X,w)&&(N=X))}if($&&N?(_.activeTexture.set(x.TEXTURE2),N.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),_.activeTexture.set(x.TEXTURE4),$.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),w.u_dem_lerp=H):(N=this.terrainTileForTile[i.tileID.key],_.activeTexture.set(x.TEXTURE2),(this._prepareDemTileUniforms(i,N,w)?N.demTexture:this.emptyDEMTexture).bind(x.NEAREST,x.CLAMP_TO_EDGE)),_.activeTexture.set(x.TEXTURE3),f&&f.useDepthForOcclusion?(this._depthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),w.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]):(this.emptyDepthBufferTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),w.u_depth_size_inv=[1,1]),f&&f.useMeterToDem&&N){const q=(1<<N.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;w.u_meter_to_dem=q}f&&f.labelPlaneMatrixInv&&(w.u_label_plane_matrix_inv=f.labelPlaneMatrixInv),c.setTerrainUniformValues(_,w)}renderToBackBuffer(i){const c=this.painter,f=this.painter.context;i.length!==0&&(f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),this.renderingToTexture=!1,function(_,x,w,S,P){if(_.transform.projection.name==="globe")(function(L,O,N,$,H){const q=L.context,X=q.gl;let le,W;const re=L.options.showTerrainWireframe?2:0,oe=(Ge,ze)=>{if(W===Ge)return;const Ae=[];ze&&Ae.push(es[re]),Ae.push(es[Ge]),Ae.push("PROJECTION_GLOBE_VIEW"),le=L.useProgram("globeRaster",null,Ae),W=Ge},ie=L.colorModeForRenderPass(),ne=new s.DepthMode(X.LEQUAL,s.DepthMode.ReadWrite,L.depthRangeFor3D);Hr.update(H);const ce=L.transform,Se=s.calculateGlobeMatrix(ce,ce.worldSize),Me=s.calculateGlobeMercatorMatrix(ce),et=[s.mercatorXfromLng(ce.center.lng),s.mercatorYfromLat(ce.center.lat)],qe=L.globeSharedBuffers;(re?[!1,!0]:[!1]).forEach(Ge=>{W=-1;const ze=Ge?X.LINES:X.TRIANGLES;for(const Ae of $){const $e=N.getTile(Ae),Fe=Math.pow(2,Ae.canonical.z),[St,Dt]=s.globeBuffersForTileMesh(L,$e,Ae,Fe),Xt=s.StencilMode.disabled,Qe=O.prevTerrainTileForTile[Ae.key],zt=O.terrainTileForTile[Ae.key];mr(Qe,zt)&&Hr.newMorphing(Ae.key,Qe,zt,H,250),q.activeTexture.set(X.TEXTURE0),$e.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE);const Ut=Hr.getMorphValuesForProxy(Ae.key),Ci=Ut?1:0,Di={};Ut&&s.extend$1(Di,{morphing:{srcDemTile:Ut.from,dstDemTile:Ut.to,phase:s.easeCubicInOut(Ut.phase)}});const Ot=s.globeMatrixForTile(Ae.canonical,Se),ii=yl(ce.projMatrix,Ot,Me,s.globeToMercatorTransition(ce.zoom),et);if(oe(Ci,Ge),O.setupElevationDraw($e,le,Di),L.prepareDrawProgram(q,le,Ae.toUnwrapped()),qe){const[Ui,hn]=Ge?qe.getWirefameBuffer(L.context):[qe.gridIndexBuffer,qe.gridSegments];le.draw(q,ze,ne,Xt,ie,s.CullFaceMode.backCCW,ii,"globe_raster",St,Ui,hn)}if(!Ge){const Ui=[Ae.canonical.y===0?s.globePoleMatrixForTile(Ae.canonical,!1,ce):null,Ae.canonical.y===Fe-1?s.globePoleMatrixForTile(Ae.canonical,!0,ce):null];for(const hn of Ui){if(!hn)continue;const Qn=yl(ce.projMatrix,hn,hn,0,et);qe&&le.draw(q,ze,ne,Xt,ie,s.CullFaceMode.disabled,Qn,"globe_pole_raster",Dt,qe.poleIndexBuffer,qe.poleSegments)}}}})})(_,x,w,S,P);else{const L=_.context,O=L.gl;let N,$;const H=_.options.showTerrainWireframe?2:0,q=(oe,ie)=>{if($===oe)return;const ne=[es[oe]];ie&&ne.push(es[H]),N=_.useProgram("terrainRaster",null,ne),$=oe},X=_.colorModeForRenderPass(),le=new s.DepthMode(O.LEQUAL,s.DepthMode.ReadWrite,_.depthRangeFor3D);Hr.update(P);const W=_.transform,re=6*Math.pow(1.5,22-W.zoom)*x.exaggeration();(H?[!1,!0]:[!1]).forEach(oe=>{$=-1;const ie=oe?O.LINES:O.TRIANGLES,[ne,ce]=oe?x.getWirefameBuffer():[x.gridIndexBuffer,x.gridSegments];for(const Se of S){const Me=w.getTile(Se),et=s.StencilMode.disabled,qe=x.prevTerrainTileForTile[Se.key],Ge=x.terrainTileForTile[Se.key];mr(qe,Ge)&&Hr.newMorphing(Se.key,qe,Ge,P,250),L.activeTexture.set(O.TEXTURE0),Me.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);const ze=Hr.getMorphValuesForProxy(Se.key),Ae=ze?1:0;let $e;ze&&($e={morphing:{srcDemTile:ze.from,dstDemTile:ze.to,phase:s.easeCubicInOut(ze.phase)}});const Fe=mn(Se.projMatrix,hf(Se.canonical,W.renderWorldCopies)?re/10:re);q(Ae,oe),x.setupElevationDraw(Me,N,$e),_.prepareDrawProgram(L,N,Se.toUnwrapped()),N.draw(L,ie,le,et,X,s.CullFaceMode.backCCW,Fe,"terrain_raster",x.gridBuffer,ne,ce)}})}}(c,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,i.splice(0,i.length))}renderBatch(i){if(this._drapedRenderBatches.length===0)return i+1;this.renderingToTexture=!0;const c=this.painter,f=this.painter.context,_=this.proxySourceCache,x=this.proxiedCoords[_.id],w=this._drapedRenderBatches.shift(),S=[],P=c.style.order;let L=0;for(const O of x){const N=_.getTileByID(O.proxyTileKey),$=_.proxyCachedFBO[O.key]?_.proxyCachedFBO[O.key][i]:void 0,H=$!==void 0?_.renderCache[$]:this.pool[L++],q=$!==void 0;if(N.texture=H.tex,q&&!H.dirty){S.push(N.tileID);continue}let X;f.bindFramebuffer.set(H.fb.framebuffer),this.renderedToTile=!1,H.dirty&&(f.clear({color:s.Color.transparent,stencil:0}),H.dirty=!1);for(let le=w.start;le<=w.end;++le){const W=c.style._layers[P[le]];if(W.isHidden(c.transform.zoom))continue;const re=c.style._getLayerSourceCache(W),oe=re?this.proxyToSource[O.key][re.id]:[O];if(!oe)continue;const ie=oe;f.viewport.set([0,0,H.fb.width,H.fb.height]),X!==(re?re.id:null)&&(this._setupStencil(H,oe,W,re),X=re?re.id:null),c.renderLayer(c,re,W,ie)}this.renderedToTile?(H.dirty=!0,S.push(N.tileID)):q||--L,L===5&&(L=0,this.renderToBackBuffer(S))}return this.renderToBackBuffer(S),this.renderingToTexture=!1,f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),w.end+1}postRender(){}renderCacheEfficiency(i){const c=i.order.length;if(c===0)return{efficiency:100};let f,_=0,x=0,w=!1;for(let S=0;S<c;++S){const P=i._layers[i.order[S]];this._style.isLayerDraped(P)?(w&&++_,++x):w||(w=!0,f=P.id)}return x===0?{efficiency:100}:{efficiency:100*(1-_/x),firstUndrapedLayer:f}}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{i=Math.min(i,c.dem.tree.minimums[0])}),i===0?i:(i-30)*this._exaggeration}raycast(i,c,f){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(x=>x.dem).map(x=>{const w=x.tileID,S=Math.pow(2,w.overscaledZ),{x:P,y:L}=w.canonical,O=P/S,N=(P+1)/S,$=L/S,H=(L+1)/S;return{minx:O,miny:$,maxx:N,maxy:H,t:x.dem.tree.raycastRoot(O,$,N,H,i,c,f),tile:x}});_.sort((x,w)=>(x.t!==null?x.t:Number.MAX_VALUE)-(w.t!==null?w.t:Number.MAX_VALUE));for(const x of _){if(x.t==null)return null;const w=x.tile.dem.tree.raycast(x.minx,x.miny,x.maxx,x.maxy,i,c,f);if(w!=null)return w}return null}_createFBO(){const i=this.painter.context,c=i.gl,f=this.drapeBufferSize;i.activeTexture.set(c.TEXTURE0);const _=new s.Texture(i,{width:f[0],height:f[1],data:null},c.RGBA);_.bind(c.LINEAR,c.CLAMP_TO_EDGE);const x=i.createFramebuffer(f[0],f[1],!1);return x.colorAttachment.set(_.texture),x.depthAttachment=new Ni(i,x.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,f[0],f[1]),this._stencilRef=0,x.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):x.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&!i.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:x,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const c=this._style._layers[i],f=c.isHidden(this.painter.transform.zoom),_=c.getCrossfadeParameters(),x=!!_&&_.t!==1,w=c.hasTransition();return c.type!=="custom"&&!f&&(x||w)})}_clearRasterFadeFromRenderCache(){let i=!1;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c]._source instanceof Kn){i=!0;break}if(i)for(let c=0;c<this._style.order.length;++c){const f=this._style._layers[this._style.order[c]],_=f.isHidden(this.painter.transform.zoom),x=this._style._getLayerSourceCache(f);if(f.type!=="raster"||_||!x)continue;const w=f.paint.get("raster-fade-duration");for(const S of this.proxyCoords){const P=this.proxyToSource[S.key][x.id];if(P)for(const L of P){const O=Ph(x.getTile(L),x.findLoadedParent(L,0),x,this.painter.transform,w);(O.opacity!==1||O.mix!==0)&&this._clearRenderCacheForTile(x.id,L)}}}}_setupDrapedRenderBatches(){const i=this._style.order,c=i.length;if(c===0)return;const f=[];let _,x=0,w=this._style._layers[i[x]];for(;!this._style.isLayerDraped(w)&&w.isHidden(this.painter.transform.zoom)&&++x<c;)w=this._style._layers[i[x]];for(;x<c;++x){const S=this._style._layers[i[x]];S.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(S)?_===void 0&&(_=x):_!==void 0&&(f.push({start:_,end:x-1}),_=void 0))}_!==void 0&&f.push({start:_,end:x-1}),this._drapedRenderBatches=f}_setupRenderCache(i){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const w=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let S=0;S<w.length;++S){const P=Object.values(w[S]);c.renderCachePool.push(...P)}}return}this._clearRasterFadeFromRenderCache();const f=this.proxyCoords,_=this._tilesDirty;for(let w=f.length-1;w>=0;w--){const S=f[w];if(c.getTileByID(S.key),c.proxyCachedFBO[S.key]!==void 0){const P=i[S.key],L=this.proxyToSource[S.key];let O=0;for(const N in L){const $=L[N],H=P[N];if(!H||H.length!==$.length||$.some((q,X)=>q!==H[X]||_[N]&&_[N].hasOwnProperty(q.key))){O=-1;break}++O}for(const N in c.proxyCachedFBO[S.key])c.renderCache[c.proxyCachedFBO[S.key][N]].dirty=O<0||O!==Object.values(P).length}}const x=[...this._drapedRenderBatches];x.sort((w,S)=>S.end-S.start-(w.end-w.start));for(const w of x)for(const S of f){if(c.proxyCachedFBO[S.key])continue;let P=c.renderCachePool.pop();P===void 0&&c.renderCache.length<50&&(P=c.renderCache.length,c.renderCache.push(this._createFBO())),P!==void 0&&(c.proxyCachedFBO[S.key]={},c.proxyCachedFBO[S.key][w.start]=P,c.renderCache[P].dirty=!0)}this._tilesDirty={}}_setupStencil(i,c,f,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const x=this.painter.context,w=x.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let S;if(f.isTileClipped())S=c.length,this._overlapStencilMode.test={func:w.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);S=1,this._overlapStencilMode.test={func:w.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+S>255&&(x.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=S,this._overlapStencilMode.ref=this._stencilRef,f.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(i,c){const f=this.painter,_=this.painter.context,x=_.gl;f._tileClippingMaskIDs={},_.setColorMode(s.ColorMode.disabled),_.setDepthMode(s.DepthMode.disabled);const w=f.useProgram("clippingMask");for(const S of i){const P=f._tileClippingMaskIDs[S.key]=--c;w.draw(_,x.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:x.ALWAYS,mask:0},P,255,x.KEEP,x.KEEP,x.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Xr(S.projMatrix),"$clipping",f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}pointCoordinate(i){const c=this.painter.transform;if(i.x<0||i.x>c.width||i.y<0||i.y>c.height)return null;const f=[i.x,i.y,1,1];s.transformMat4$1(f,f,c.pixelMatrixInverse),s.scale$1(f,f,1/f[3]),f[0]/=c.worldSize,f[1]/=c.worldSize;const _=c._camera.position,x=s.mercatorZfromAltitude(1,c.center.lat),w=[_[0],_[1],_[2]/x,0],S=s.subtract([],f.slice(0,3),w);s.normalize(S,S);const P=this.raycast(w,S,this._exaggeration);return P!==null&&P?(s.scaleAndAdd(w,w,S,P),w[3]=w[2],w[2]*=x,w):null}drawDepth(){const i=this.painter,c=i.context,f=this.proxySourceCache,_=Math.ceil(i.width),x=Math.ceil(i.height);if(!this._depthFBO||this._depthFBO.width===_&&this._depthFBO.height===x||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const w=c.gl,S=c.createFramebuffer(_,x,!0);c.activeTexture.set(w.TEXTURE0);const P=new s.Texture(c,{width:_,height:x,data:null},w.RGBA);P.bind(w.NEAREST,w.CLAMP_TO_EDGE),S.colorAttachment.set(P.texture);const L=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,_,x);S.depthAttachment.set(L),this._depthFBO=S,this._depthTexture=P}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,_,x]),function(w,S,P,L){if(w.transform.projection.name==="globe")return;const O=w.context,N=O.gl;O.clear({depth:1});const $=w.useProgram("terrainDepth"),H=new s.DepthMode(N.LESS,s.DepthMode.ReadWrite,w.depthRangeFor3D);for(const q of L){const X=P.getTile(q),le=mn(q.projMatrix,0);S.setupElevationDraw(X,$),$.draw(O,N.TRIANGLES,H,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,le,"terrain_depth",S.gridBuffer,S.gridIndexBuffer,S.gridNoSkirtSegments)}}(i,this,f,this.proxyCoords)}_setupProxiedCoordsForOrtho(i,c,f){if(i.getSource()instanceof un)return this._setupProxiedCoordsForImageSource(i,c,f);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const _=this.proxiedCoords[i.id]=[],x=this.proxyCoords;for(let S=0;S<x.length;S++){const P=x[S],L=this._findTileCoveringTileID(P,i);if(L){const O=this._createProxiedId(P,L,f[P.key]&&f[P.key][i.id]);_.push(O),this.proxyToSource[P.key][i.id]=[O]}}let w=!1;for(let S=0;S<c.length;S++){const P=i.getTile(c[S]);if(!P||!P.hasData())continue;const L=this._findTileCoveringTileID(P.tileID,this.proxySourceCache);if(L&&L.tileID.canonical.z!==P.tileID.canonical.z){const O=this.proxyToSource[L.tileID.key][i.id],N=this._createProxiedId(L.tileID,P,f[L.tileID.key]&&f[L.tileID.key][i.id]);O?O.splice(O.length-1,0,N):this.proxyToSource[L.tileID.key][i.id]=[N],_.push(N),w=!0}}this._sourceTilesOverlap[i.id]=w}_setupProxiedCoordsForImageSource(i,c,f){if(!i.getSource().loaded())return;const _=this.proxiedCoords[i.id]=[],x=this.proxyCoords,w=i.getSource(),S=new s.pointGeometry(w.tileID.x,w.tileID.y)._div(1<<w.tileID.z),P=w.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((O,N)=>(O.min.x=Math.min(O.min.x,N.x-S.x),O.min.y=Math.min(O.min.y,N.y-S.y),O.max.x=Math.max(O.max.x,N.x-S.x),O.max.y=Math.max(O.max.y,N.y-S.y),O),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),L=(O,N)=>{const $=O.wrap+O.canonical.x/(1<<O.canonical.z),H=O.canonical.y/(1<<O.canonical.z),q=s.EXTENT/(1<<O.canonical.z),X=N.wrap+N.canonical.x/(1<<N.canonical.z),le=N.canonical.y/(1<<N.canonical.z);return $+q<X+P.min.x||$>X+P.max.x||H+q<le+P.min.y||H>le+P.max.y};for(let O=0;O<x.length;O++){const N=x[O];for(let $=0;$<c.length;$++){const H=i.getTile(c[$]);if(!H||!H.hasData()||L(N,H.tileID))continue;const q=this._createProxiedId(N,H,f[N.key]&&f[N.key][i.id]),X=this.proxyToSource[N.key][i.id];X?X.push(q):this.proxyToSource[N.key][i.id]=[q],_.push(q)}}}_createProxiedId(i,c,f){let _=this.orthoMatrix;if(f){const x=f.find(w=>w.key===c.tileID.key);if(x)return x}if(c.tileID.key!==i.key){const x=i.canonical.z-c.tileID.canonical.z;let w,S,P;_=s.create();const L=c.tileID.wrap-i.wrap<<i.overscaledZ;x>0?(w=s.EXTENT>>x,S=w*((c.tileID.canonical.x<<x)-i.canonical.x+L),P=w*((c.tileID.canonical.y<<x)-i.canonical.y)):(w=s.EXTENT<<-x,S=s.EXTENT*(c.tileID.canonical.x-(i.canonical.x+L<<-x)),P=s.EXTENT*(c.tileID.canonical.y-(i.canonical.y<<-x))),s.ortho(_,0,w,0,w,0,1),s.translate(_,_,[S,P,0])}return new ma(c.tileID,i.key,_)}_findTileCoveringTileID(i,c){let f=c.getTile(i);if(f&&f.hasData())return f;const _=this._findCoveringTileCache[c.id],x=_[i.key];if(f=x?c.getTileByID(x):null,f&&f.hasData()||x===null)return f;let w=f?f.tileID:i,S=w.overscaledZ;const P=c.getSource().minzoom,L=[];if(!x){const N=c.getSource().maxzoom;if(i.canonical.z>=N){const $=i.canonical.z-N;c.getSource().reparseOverscaled?(S=Math.max(i.canonical.z+2,c.transform.tileZoom),w=new s.OverscaledTileID(S,i.wrap,N,i.canonical.x>>$,i.canonical.y>>$)):$!==0&&(S=N,w=new s.OverscaledTileID(S,i.wrap,N,i.canonical.x>>$,i.canonical.y>>$))}w.key!==i.key&&(L.push(w.key),f=c.getTile(w))}const O=N=>{L.forEach($=>{_[$]=N}),L.length=0};for(S-=1;S>=P&&(!f||!f.hasData());S--){f&&O(f.tileID.key);const N=w.calculateScaledKey(S);if(f=c.getTileByID(N),f&&f.hasData())break;const $=_[N];if($===null)break;$===void 0?L.push(N):f=c.getTileByID($)}return O(f?f.tileID.key:null),f&&f.hasData()?f:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(i){this.renderedToTile=!0}_clearRenderCacheForTile(i,c){let f=this._tilesDirty[i];f||(f=this._tilesDirty[i]={}),f[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const i=function(c){let f,_,x;const w=new s.StructArrayLayout2ui4,S=131;for(_=1;_<129;_++){for(f=1;f<129;f++)x=_*S+f,w.emplaceBack(x,x+1),w.emplaceBack(x,x+S),w.emplaceBack(x+1,x+S),_===128&&w.emplaceBack(x+S,x+S+1);w.emplaceBack(x+1,x+1+S)}return w}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(i),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,i.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function vl(p){const i=[];for(let c=0;c<p.length;c++){if(p[c]===null)continue;const f=p[c].split(" ");i.push(f.pop())}return i}class ga{static cacheKey(i,c,f){let _=`${i}${f?f.cacheKey:""}`;for(const x of c)_+=`/${x}`;return _}constructor(i,c,f,_,x,w){const S=i.gl;this.program=S.createProgram();const P=vl(f.staticAttributes),L=_?_.getBinderAttributes():[],O=P.concat(L),N=f.staticUniforms?vl(f.staticUniforms):[],$=_?_.getBinderUniforms():[],H=N.concat($),q=[];for(const ne of H)q.indexOf(ne)<0&&q.push(ne);let X=_?_.defines():[];X=X.concat(w.map(ne=>`#define ${ne}`));const le=X.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,gl,yi.fragmentSource,Ss.fragmentSource,f.fragmentSource).join(`
`),W=X.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,gl,yi.vertexSource,Ss.vertexSource,Es.vertexSource,f.vertexSource).join(`
`),re=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(re,le),S.compileShader(re),S.attachShader(this.program,re);const oe=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(oe,W),S.compileShader(oe),S.attachShader(this.program,oe),this.attributes={};const ie={};this.numAttributes=O.length;for(let ne=0;ne<this.numAttributes;ne++)O[ne]&&(S.bindAttribLocation(this.program,ne,O[ne]),this.attributes[O[ne]]=ne);S.linkProgram(this.program),S.deleteShader(oe),S.deleteShader(re);for(let ne=0;ne<q.length;ne++){const ce=q[ne];if(ce&&!ie[ce]){const Se=S.getUniformLocation(this.program,ce);Se&&(ie[ce]=Se)}}this.fixedUniforms=x(i,ie),this.binderUniforms=_?_.getUniforms(i,ie):[],w.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((ne,ce)=>({u_dem:new s.Uniform1i(ne,ce.u_dem),u_dem_prev:new s.Uniform1i(ne,ce.u_dem_prev),u_dem_unpack:new s.Uniform4f(ne,ce.u_dem_unpack),u_dem_tl:new s.Uniform2f(ne,ce.u_dem_tl),u_dem_scale:new s.Uniform1f(ne,ce.u_dem_scale),u_dem_tl_prev:new s.Uniform2f(ne,ce.u_dem_tl_prev),u_dem_scale_prev:new s.Uniform1f(ne,ce.u_dem_scale_prev),u_dem_size:new s.Uniform1f(ne,ce.u_dem_size),u_dem_lerp:new s.Uniform1f(ne,ce.u_dem_lerp),u_exaggeration:new s.Uniform1f(ne,ce.u_exaggeration),u_depth:new s.Uniform1i(ne,ce.u_depth),u_depth_size_inv:new s.Uniform2f(ne,ce.u_depth_size_inv),u_meter_to_dem:new s.Uniform1f(ne,ce.u_meter_to_dem),u_label_plane_matrix_inv:new s.UniformMatrix4f(ne,ce.u_label_plane_matrix_inv),u_tile_tl_up:new s.Uniform3f(ne,ce.u_tile_tl_up),u_tile_tr_up:new s.Uniform3f(ne,ce.u_tile_tr_up),u_tile_br_up:new s.Uniform3f(ne,ce.u_tile_br_up),u_tile_bl_up:new s.Uniform3f(ne,ce.u_tile_bl_up),u_tile_up_scale:new s.Uniform1f(ne,ce.u_tile_up_scale)}))(i,ie)),w.indexOf("FOG")!==-1&&(this.fogUniforms=((ne,ce)=>({u_fog_matrix:new s.UniformMatrix4f(ne,ce.u_fog_matrix),u_fog_range:new s.Uniform2f(ne,ce.u_fog_range),u_fog_color:new s.Uniform4f(ne,ce.u_fog_color),u_fog_horizon_blend:new s.Uniform1f(ne,ce.u_fog_horizon_blend),u_fog_temporal_offset:new s.Uniform1f(ne,ce.u_fog_temporal_offset)}))(i,ie))}setTerrainUniformValues(i,c){if(!this.terrainUniforms)return;const f=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const _ in c)f[_].set(c[_])}}setFogUniformValues(i,c){if(!this.fogUniforms)return;const f=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const _ in c)f[_].location&&f[_].set(c[_])}}draw(i,c,f,_,x,w,S,P,L,O,N,$,H,q,X,le){const W=i.gl;if(this.failedToCreate)return;i.program.set(this.program),i.setDepthMode(f),i.setStencilMode(_),i.setColorMode(x),i.setCullFace(w);for(const oe of Object.keys(this.fixedUniforms))this.fixedUniforms[oe].set(S[oe]);q&&q.setUniforms(i,this.binderUniforms,$,{zoom:H});const re={[W.LINES]:2,[W.TRIANGLES]:3,[W.LINE_STRIP]:1}[c];for(const oe of N.get()){const ie=oe.vaos||(oe.vaos={});(ie[P]||(ie[P]=new fr)).bind(i,this,L,q?q.getPaintVertexBuffers():[],O,oe.vertexOffset,X,le),W.drawElements(c,oe.primitiveLength*re,W.UNSIGNED_SHORT,oe.primitiveOffset*re*2)}}}function Lh(p,i,c){const f=1/qt(c,1,i.transform.tileZoom),_=Math.pow(2,c.tileID.overscaledZ),x=c.tileSize*Math.pow(2,i.transform.tileZoom)/_,w=x*(c.tileID.canonical.x+c.tileID.wrap*_),S=x*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[f,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[w>>16,S>>16],u_pixel_coord_lower:[65535&w,65535&S]}}const Rh=(p,i,c,f)=>{const _=i.style.light,x=_.properties.get("position"),w=[x.x,x.y,x.z],S=s.create$1();_.properties.get("anchor")==="viewport"&&(s.fromRotation(S,-i.transform.angle),s.transformMat3(w,w,S));const P=_.properties.get("color");return{u_matrix:p,u_lightpos:w,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+c,u_opacity:f}},Wc=(p,i,c,f,_,x,w)=>s.extend(Rh(p,i,c,f),Lh(x,i,w),{u_height_factor:-Math.pow(2,_.overscaledZ)/w.tileSize/8}),Oh=p=>({u_matrix:p}),Hc=(p,i,c,f)=>s.extend(Oh(p),Lh(c,i,f)),df=(p,i)=>({u_matrix:p,u_world:i}),Bh=(p,i,c,f,_)=>s.extend(Hc(p,i,c,f),{u_world:_}),pf=(p,i,c,f)=>{const _=p.transform;let x;return x=f.paint.get("circle-pitch-alignment")==="map"?_.calculatePixelsToTileUnitsMatrix(c):new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]),{u_camera_to_center_distance:_.cameraToCenterDistance,u_matrix:p.translatePosMatrix(i.projMatrix,c,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:x}},Xc=p=>{const i=[];return p.paint.get("circle-pitch-alignment")==="map"&&i.push("PITCH_WITH_MAP"),p.paint.get("circle-pitch-scale")==="map"&&i.push("SCALE_WITH_MAP"),i},Fh=(p,i,c)=>{const f=s.EXTENT/c.tileSize;return{u_matrix:p,u_camera_to_center_distance:i.cameraToCenterDistance,u_extrude_scale:[i.pixelsToGLUnits[0]/f,i.pixelsToGLUnits[1]/f]}},Kc=(p,i,c=1)=>({u_matrix:p,u_color:i,u_overlay:0,u_overlay_scale:c}),Nh=(p,i,c,f)=>({u_matrix:p,u_extrude_scale:qt(i,1,c),u_intensity:f}),Uh=(p,i,c,f,_,x)=>{const w=p.transform,S=w.calculatePixelsToTileUnitsMatrix(i),P={u_matrix:_a(p,i,c,_),u_pixels_to_tile_units:S,u_device_pixel_ratio:s.exported.devicePixelRatio,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:x,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0};if(ya(c)){const L=Cs(i,p.transform);P.u_texsize=i.lineAtlasTexture.size,P.u_scale=[L,f.fromScale,f.toScale],P.u_mix=f.t}return P},ts=(p,i,c,f,_)=>{const x=p.transform,w=Cs(i,x);return{u_matrix:_a(p,i,c,_),u_texsize:i.imageAtlasTexture.size,u_pixels_to_tile_units:x.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:s.exported.devicePixelRatio,u_image:0,u_scale:[w,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Cs(p,i){return 1/qt(p,1,i.tileZoom)}function _a(p,i,c,f){return p.translatePosMatrix(f||i.tileID.projMatrix,i,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function ya(p){const i=p.paint.get("line-dasharray").value;return i.value||i.kind!=="constant"}const xl=(p,i,c,f,_,x)=>{return{u_matrix:p,u_tl_parent:i,u_scale_parent:c,u_fade_t:f.mix,u_opacity:f.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(S=_.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=_.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:bl(_.paint.get("raster-hue-rotate")),u_perspective_transform:x};var w,S};function bl(p){p*=Math.PI/180;const i=Math.sin(p),c=Math.cos(p);return[(2*c+1)/3,(-Math.sqrt(3)*i-c+1)/3,(Math.sqrt(3)*i-c+1)/3]}const wl=(p,i,c,f,_,x,w,S,P,L,O,N,$,H)=>{const q=_.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:q.cameraToCenterDistance,u_pitch:q.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:q.width/q.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:w,u_coord_matrix:S,u_is_text:+P,u_pitch_with_map:+f,u_texsize:L,u_tile_id:O,u_zoom_transition:N,u_inv_rot_matrix:$,u_merc_center:H,u_texture:0}},va=(p,i,c,f,_,x,w,S,P,L,O,N,$,H,q)=>{const{cameraToCenterDistance:X,_pitch:le}=_.transform;return s.extend(wl(p,i,c,f,_,x,w,S,P,L,N,$,H,q),{u_gamma_scale:f?X*Math.cos(_.terrain?0:le):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+O})},xa=(p,i,c,f,_,x,w,S,P,L,O,N,$,H)=>s.extend(va(p,i,c,f,_,x,w,S,!0,P,!0,O,N,$,H),{u_texsize_icon:L,u_texture_icon:1}),Ei=(p,i,c)=>({u_matrix:p,u_opacity:i,u_color:c}),Tl=(p,i,c,f,_,x)=>s.extend(function(w,S,P,L){const O=P.imageManager.getPattern(w.from.toString()),N=P.imageManager.getPattern(w.to.toString()),{width:$,height:H}=P.imageManager.getPixelSize(),q=Math.pow(2,L.tileID.overscaledZ),X=L.tileSize*Math.pow(2,P.transform.tileZoom)/q,le=X*(L.tileID.canonical.x+L.tileID.wrap*q),W=X*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:N.tl,u_pattern_br_b:N.br,u_texsize:[$,H],u_mix:S.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:N.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/qt(L,1,P.transform.tileZoom),u_pixel_coord_upper:[le>>16,W>>16],u_pixel_coord_lower:[65535&le,65535&W]}}(f,x,c,_),{u_matrix:p,u_opacity:i}),jh={fillExtrusion:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_lightpos:new s.Uniform3f(p,i.u_lightpos),u_lightintensity:new s.Uniform1f(p,i.u_lightintensity),u_lightcolor:new s.Uniform3f(p,i.u_lightcolor),u_vertical_gradient:new s.Uniform1f(p,i.u_vertical_gradient),u_opacity:new s.Uniform1f(p,i.u_opacity)}),fillExtrusionPattern:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_lightpos:new s.Uniform3f(p,i.u_lightpos),u_lightintensity:new s.Uniform1f(p,i.u_lightintensity),u_lightcolor:new s.Uniform3f(p,i.u_lightcolor),u_vertical_gradient:new s.Uniform1f(p,i.u_vertical_gradient),u_height_factor:new s.Uniform1f(p,i.u_height_factor),u_image:new s.Uniform1i(p,i.u_image),u_texsize:new s.Uniform2f(p,i.u_texsize),u_pixel_coord_upper:new s.Uniform2f(p,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(p,i.u_pixel_coord_lower),u_scale:new s.Uniform3f(p,i.u_scale),u_fade:new s.Uniform1f(p,i.u_fade),u_opacity:new s.Uniform1f(p,i.u_opacity)}),fill:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix)}),fillPattern:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_image:new s.Uniform1i(p,i.u_image),u_texsize:new s.Uniform2f(p,i.u_texsize),u_pixel_coord_upper:new s.Uniform2f(p,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(p,i.u_pixel_coord_lower),u_scale:new s.Uniform3f(p,i.u_scale),u_fade:new s.Uniform1f(p,i.u_fade)}),fillOutline:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_world:new s.Uniform2f(p,i.u_world)}),fillOutlinePattern:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_world:new s.Uniform2f(p,i.u_world),u_image:new s.Uniform1i(p,i.u_image),u_texsize:new s.Uniform2f(p,i.u_texsize),u_pixel_coord_upper:new s.Uniform2f(p,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(p,i.u_pixel_coord_lower),u_scale:new s.Uniform3f(p,i.u_scale),u_fade:new s.Uniform1f(p,i.u_fade)}),circle:(p,i)=>({u_camera_to_center_distance:new s.Uniform1f(p,i.u_camera_to_center_distance),u_extrude_scale:new s.UniformMatrix2f(p,i.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(p,i.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(p,i.u_matrix)}),collisionBox:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_camera_to_center_distance:new s.Uniform1f(p,i.u_camera_to_center_distance),u_extrude_scale:new s.Uniform2f(p,i.u_extrude_scale)}),collisionCircle:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_inv_matrix:new s.UniformMatrix4f(p,i.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(p,i.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(p,i.u_viewport_size)}),debug:(p,i)=>({u_color:new s.UniformColor(p,i.u_color),u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_overlay:new s.Uniform1i(p,i.u_overlay),u_overlay_scale:new s.Uniform1f(p,i.u_overlay_scale)}),clippingMask:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix)}),heatmap:(p,i)=>({u_extrude_scale:new s.Uniform1f(p,i.u_extrude_scale),u_intensity:new s.Uniform1f(p,i.u_intensity),u_matrix:new s.UniformMatrix4f(p,i.u_matrix)}),heatmapTexture:(p,i)=>({u_image:new s.Uniform1i(p,i.u_image),u_color_ramp:new s.Uniform1i(p,i.u_color_ramp),u_opacity:new s.Uniform1f(p,i.u_opacity)}),hillshade:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_image:new s.Uniform1i(p,i.u_image),u_latrange:new s.Uniform2f(p,i.u_latrange),u_light:new s.Uniform2f(p,i.u_light),u_shadow:new s.UniformColor(p,i.u_shadow),u_highlight:new s.UniformColor(p,i.u_highlight),u_accent:new s.UniformColor(p,i.u_accent)}),hillshadePrepare:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_image:new s.Uniform1i(p,i.u_image),u_dimension:new s.Uniform2f(p,i.u_dimension),u_zoom:new s.Uniform1f(p,i.u_zoom),u_unpack:new s.Uniform4f(p,i.u_unpack)}),line:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_pixels_to_tile_units:new s.UniformMatrix2f(p,i.u_pixels_to_tile_units),u_device_pixel_ratio:new s.Uniform1f(p,i.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(p,i.u_units_to_pixels),u_dash_image:new s.Uniform1i(p,i.u_dash_image),u_gradient_image:new s.Uniform1i(p,i.u_gradient_image),u_image_height:new s.Uniform1f(p,i.u_image_height),u_texsize:new s.Uniform2f(p,i.u_texsize),u_scale:new s.Uniform3f(p,i.u_scale),u_mix:new s.Uniform1f(p,i.u_mix),u_alpha_discard_threshold:new s.Uniform1f(p,i.u_alpha_discard_threshold)}),linePattern:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_texsize:new s.Uniform2f(p,i.u_texsize),u_pixels_to_tile_units:new s.UniformMatrix2f(p,i.u_pixels_to_tile_units),u_device_pixel_ratio:new s.Uniform1f(p,i.u_device_pixel_ratio),u_image:new s.Uniform1i(p,i.u_image),u_units_to_pixels:new s.Uniform2f(p,i.u_units_to_pixels),u_scale:new s.Uniform3f(p,i.u_scale),u_fade:new s.Uniform1f(p,i.u_fade),u_alpha_discard_threshold:new s.Uniform1f(p,i.u_alpha_discard_threshold)}),raster:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_tl_parent:new s.Uniform2f(p,i.u_tl_parent),u_scale_parent:new s.Uniform1f(p,i.u_scale_parent),u_fade_t:new s.Uniform1f(p,i.u_fade_t),u_opacity:new s.Uniform1f(p,i.u_opacity),u_image0:new s.Uniform1i(p,i.u_image0),u_image1:new s.Uniform1i(p,i.u_image1),u_brightness_low:new s.Uniform1f(p,i.u_brightness_low),u_brightness_high:new s.Uniform1f(p,i.u_brightness_high),u_saturation_factor:new s.Uniform1f(p,i.u_saturation_factor),u_contrast_factor:new s.Uniform1f(p,i.u_contrast_factor),u_spin_weights:new s.Uniform3f(p,i.u_spin_weights),u_perspective_transform:new s.Uniform2f(p,i.u_perspective_transform)}),symbolIcon:(p,i)=>({u_is_size_zoom_constant:new s.Uniform1i(p,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(p,i.u_is_size_feature_constant),u_size_t:new s.Uniform1f(p,i.u_size_t),u_size:new s.Uniform1f(p,i.u_size),u_camera_to_center_distance:new s.Uniform1f(p,i.u_camera_to_center_distance),u_pitch:new s.Uniform1f(p,i.u_pitch),u_rotate_symbol:new s.Uniform1i(p,i.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(p,i.u_aspect_ratio),u_fade_change:new s.Uniform1f(p,i.u_fade_change),u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(p,i.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(p,i.u_coord_matrix),u_is_text:new s.Uniform1i(p,i.u_is_text),u_pitch_with_map:new s.Uniform1i(p,i.u_pitch_with_map),u_texsize:new s.Uniform2f(p,i.u_texsize),u_tile_id:new s.Uniform3f(p,i.u_tile_id),u_zoom_transition:new s.Uniform1f(p,i.u_zoom_transition),u_inv_rot_matrix:new s.UniformMatrix4f(p,i.u_inv_rot_matrix),u_merc_center:new s.Uniform2f(p,i.u_merc_center),u_texture:new s.Uniform1i(p,i.u_texture)}),symbolSDF:(p,i)=>({u_is_size_zoom_constant:new s.Uniform1i(p,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(p,i.u_is_size_feature_constant),u_size_t:new s.Uniform1f(p,i.u_size_t),u_size:new s.Uniform1f(p,i.u_size),u_camera_to_center_distance:new s.Uniform1f(p,i.u_camera_to_center_distance),u_pitch:new s.Uniform1f(p,i.u_pitch),u_rotate_symbol:new s.Uniform1i(p,i.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(p,i.u_aspect_ratio),u_fade_change:new s.Uniform1f(p,i.u_fade_change),u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(p,i.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(p,i.u_coord_matrix),u_is_text:new s.Uniform1i(p,i.u_is_text),u_pitch_with_map:new s.Uniform1i(p,i.u_pitch_with_map),u_texsize:new s.Uniform2f(p,i.u_texsize),u_texture:new s.Uniform1i(p,i.u_texture),u_gamma_scale:new s.Uniform1f(p,i.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(p,i.u_device_pixel_ratio),u_tile_id:new s.Uniform3f(p,i.u_tile_id),u_zoom_transition:new s.Uniform1f(p,i.u_zoom_transition),u_inv_rot_matrix:new s.UniformMatrix4f(p,i.u_inv_rot_matrix),u_merc_center:new s.Uniform2f(p,i.u_merc_center),u_is_halo:new s.Uniform1i(p,i.u_is_halo)}),symbolTextAndIcon:(p,i)=>({u_is_size_zoom_constant:new s.Uniform1i(p,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(p,i.u_is_size_feature_constant),u_size_t:new s.Uniform1f(p,i.u_size_t),u_size:new s.Uniform1f(p,i.u_size),u_camera_to_center_distance:new s.Uniform1f(p,i.u_camera_to_center_distance),u_pitch:new s.Uniform1f(p,i.u_pitch),u_rotate_symbol:new s.Uniform1i(p,i.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(p,i.u_aspect_ratio),u_fade_change:new s.Uniform1f(p,i.u_fade_change),u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(p,i.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(p,i.u_coord_matrix),u_is_text:new s.Uniform1i(p,i.u_is_text),u_pitch_with_map:new s.Uniform1i(p,i.u_pitch_with_map),u_texsize:new s.Uniform2f(p,i.u_texsize),u_texsize_icon:new s.Uniform2f(p,i.u_texsize_icon),u_texture:new s.Uniform1i(p,i.u_texture),u_texture_icon:new s.Uniform1i(p,i.u_texture_icon),u_gamma_scale:new s.Uniform1f(p,i.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(p,i.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(p,i.u_is_halo)}),background:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_opacity:new s.Uniform1f(p,i.u_opacity),u_color:new s.UniformColor(p,i.u_color)}),backgroundPattern:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_opacity:new s.Uniform1f(p,i.u_opacity),u_image:new s.Uniform1i(p,i.u_image),u_pattern_tl_a:new s.Uniform2f(p,i.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(p,i.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(p,i.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(p,i.u_pattern_br_b),u_texsize:new s.Uniform2f(p,i.u_texsize),u_mix:new s.Uniform1f(p,i.u_mix),u_pattern_size_a:new s.Uniform2f(p,i.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(p,i.u_pattern_size_b),u_scale_a:new s.Uniform1f(p,i.u_scale_a),u_scale_b:new s.Uniform1f(p,i.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(p,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(p,i.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(p,i.u_tile_units_to_pixels)}),terrainRaster:Do,terrainDepth:Do,skybox:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_sun_direction:new s.Uniform3f(p,i.u_sun_direction),u_cubemap:new s.Uniform1i(p,i.u_cubemap),u_opacity:new s.Uniform1f(p,i.u_opacity),u_temporal_offset:new s.Uniform1f(p,i.u_temporal_offset)}),skyboxGradient:(p,i)=>({u_matrix:new s.UniformMatrix4f(p,i.u_matrix),u_color_ramp:new s.Uniform1i(p,i.u_color_ramp),u_center_direction:new s.Uniform3f(p,i.u_center_direction),u_radius:new s.Uniform1f(p,i.u_radius),u_opacity:new s.Uniform1f(p,i.u_opacity),u_temporal_offset:new s.Uniform1f(p,i.u_temporal_offset)}),skyboxCapture:(p,i)=>({u_matrix_3f:new s.UniformMatrix3f(p,i.u_matrix_3f),u_sun_direction:new s.Uniform3f(p,i.u_sun_direction),u_sun_intensity:new s.Uniform1f(p,i.u_sun_intensity),u_color_tint_r:new s.Uniform4f(p,i.u_color_tint_r),u_color_tint_m:new s.Uniform4f(p,i.u_color_tint_m),u_luminance:new s.Uniform1f(p,i.u_luminance)}),globeRaster:(p,i)=>({u_proj_matrix:new s.UniformMatrix4f(p,i.u_proj_matrix),u_globe_matrix:new s.UniformMatrix4f(p,i.u_globe_matrix),u_merc_matrix:new s.UniformMatrix4f(p,i.u_merc_matrix),u_zoom_transition:new s.Uniform1f(p,i.u_zoom_transition),u_merc_center:new s.Uniform2f(p,i.u_merc_center),u_image0:new s.Uniform1i(p,i.u_image0)}),globeAtmosphere:(p,i)=>({u_center:new s.Uniform2f(p,i.u_center),u_radius:new s.Uniform1f(p,i.u_radius),u_screen_size:new s.Uniform2f(p,i.u_screen_size),u_pixel_ratio:new s.Uniform1f(p,i.u_pixel_ratio),u_opacity:new s.Uniform1f(p,i.u_opacity),u_fadeout_range:new s.Uniform1f(p,i.u_fadeout_range),u_start_color:new s.Uniform3f(p,i.u_start_color),u_end_color:new s.Uniform3f(p,i.u_end_color)})};let ba;function Yc(p,i,c,f,_,x,w){const S=p.context,P=S.gl,L=p.useProgram("collisionBox"),O=[];let N=0,$=0;for(let oe=0;oe<f.length;oe++){const ie=f[oe],ne=i.getTile(ie),ce=ne.getBucket(c);if(!ce)continue;let Se=ie.projMatrix;_[0]===0&&_[1]===0||(Se=p.translatePosMatrix(ie.projMatrix,ne,_,x));const Me=w?ce.textCollisionBox:ce.iconCollisionBox,et=ce.collisionCircleArray;if(et.length>0){const qe=s.create(),Ge=Se;s.mul(qe,ce.placementInvProjMatrix,p.transform.glCoordMatrix),s.mul(qe,qe,ce.placementViewportMatrix),O.push({circleArray:et,circleOffset:$,transform:Ge,invTransform:qe}),N+=et.length/4,$=N}Me&&(p.terrain&&p.terrain.setupElevationDraw(ne,L),L.draw(S,P.LINES,s.DepthMode.disabled,s.StencilMode.disabled,p.colorModeForRenderPass(),s.CullFaceMode.disabled,Fh(Se,p.transform,ne),c.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,null,p.transform.zoom,null,Me.collisionVertexBuffer,Me.collisionVertexBufferExt))}if(!w||!O.length)return;const H=p.useProgram("collisionCircle"),q=new s.StructArrayLayout2f1f2i16;q.resize(4*N),q._trim();let X=0;for(const oe of O)for(let ie=0;ie<oe.circleArray.length/4;ie++){const ne=4*ie,ce=oe.circleArray[ne+0],Se=oe.circleArray[ne+1],Me=oe.circleArray[ne+2],et=oe.circleArray[ne+3];q.emplace(X++,ce,Se,Me,et,0),q.emplace(X++,ce,Se,Me,et,1),q.emplace(X++,ce,Se,Me,et,2),q.emplace(X++,ce,Se,Me,et,3)}(!ba||ba.length<2*N)&&(ba=function(oe){const ie=2*oe,ne=new s.StructArrayLayout3ui6;ne.resize(ie),ne._trim();for(let ce=0;ce<ie;ce++){const Se=6*ce;ne.uint16[Se+0]=4*ce+0,ne.uint16[Se+1]=4*ce+1,ne.uint16[Se+2]=4*ce+2,ne.uint16[Se+3]=4*ce+2,ne.uint16[Se+4]=4*ce+3,ne.uint16[Se+5]=4*ce+0}return ne}(N));const le=S.createIndexBuffer(ba,!0),W=S.createVertexBuffer(q,s.collisionCircleLayout.members,!0);for(const oe of O){const ie={u_matrix:oe.transform,u_inv_matrix:oe.invTransform,u_camera_to_center_distance:(re=p.transform).cameraToCenterDistance,u_viewport_size:[re.width,re.height]};H.draw(S,P.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,p.colorModeForRenderPass(),s.CullFaceMode.disabled,ie,c.id,W,le,s.SegmentVector.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,p.transform.zoom,null,null,null)}var re;W.destroy(),le.destroy()}const El=s.identity(new Float32Array(16));function Vh(p,i,c,f,_,x){const{horizontalAlign:w,verticalAlign:S}=s.getAnchorAlignment(p),P=-(w-.5)*i,L=-(S-.5)*c,O=s.evaluateVariableOffset(p,f);return new s.pointGeometry((P/_+O[0])*x,(L/_+O[1])*x)}function ff(p,i,c,f,_,x,w,S,P,L,O,N){const $=p.text.placedSymbolArray,H=p.text.dynamicLayoutVertexArray,q=p.icon.dynamicLayoutVertexArray,X={},le=S.projMatrix,W=x.elevation,re=W?W.getAtTileOffsetFunc(S,N):oe=>[0,0,0];H.clear();for(let oe=0;oe<$.length;oe++){const ie=$.get(oe),ne=p.allowVerticalPlacement&&!ie.placedOrientation,ce=ie.hidden||!ie.crossTileID||ne?null:f[ie.crossTileID];if(ce){const Se=new s.pointGeometry(ie.tileAnchorX,ie.tileAnchorY),Me=re(Se),et=In(Se,c?le:w,Me[2]),qe=Gr(x.cameraToCenterDistance,et.signedDistanceFromCamera);let Ge=_.evaluateSizeForFeature(p.textSizeData,L,ie)*qe/s.ONE_EM;c&&(Ge*=p.tilePixelRatio/P);const{width:ze,height:Ae,anchor:$e,textOffset:Fe,textScale:St}=ce,Dt=Vh($e,ze,Ae,Fe,St,Ge),Xt=c?In(Se.add(Dt),w,Me[2]).point:et.point.add(i?Dt.rotate(-x.angle):Dt),Qe=p.allowVerticalPlacement&&ie.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let zt=0;zt<ie.numGlyphs;zt++)s.addDynamicAttributes(H,Xt,Qe);O&&ie.associatedIconIndex>=0&&(X[ie.associatedIconIndex]={shiftedAnchor:Xt,angle:Qe})}else Cr(ie.numGlyphs,H)}if(O){q.clear();const oe=p.icon.placedSymbolArray;for(let ie=0;ie<oe.length;ie++){const ne=oe.get(ie);if(ne.hidden)Cr(ne.numGlyphs,q);else{const ce=X[ie];if(ce)for(let Se=0;Se<ne.numGlyphs;Se++)s.addDynamicAttributes(q,ce.shiftedAnchor,ce.angle);else Cr(ne.numGlyphs,q)}}p.icon.dynamicLayoutVertexBuffer.updateData(q)}p.text.dynamicLayoutVertexBuffer.updateData(H)}function mf(p,i,c){return c.iconsInText&&i?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function Sl(p,i,c,f,_,x,w,S,P,L,O,N){const $=p.context,H=$.gl,q=p.transform,X=q.projection.createTileTransform(q,q.worldSize),le=S==="map",W=P==="map",re=le&&c.layout.get("symbol-placement")!=="point",oe=le&&!W&&!re,ie=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ne=!1;const ce=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),Se=[s.mercatorXfromLng(q.center.lng),s.mercatorYfromLat(q.center.lat)],Me=c.layout.get("text-variable-anchor"),et=q.projection.name==="globe",qe=et?s.globeToMercatorTransition(q.zoom):0,Ge=[],ze=[];p.terrain&&W&&ze.push("PITCH_WITH_MAP_TERRAIN"),et&&ze.push("PROJECTION_GLOBE_VIEW"),re&&ze.push("PROJECTED_POS_ON_VIEWPORT");for(const Ae of f){const $e=i.getTile(Ae),Fe=$e.getBucket(c);if(!Fe||Fe.projection!==q.projection.name)continue;const St=_?Fe.text:Fe.icon;if(!St||Fe.fullyClipped||!St.segments.get().length)continue;const Dt=St.programConfigurations.get(c.id),Xt=_||Fe.sdfIcons,Qe=_?Fe.textSizeData:Fe.iconSizeData,zt=W||q.pitch!==0,Ut=p.useProgram(mf(Xt,_,Fe),Dt,ze),Ci=s.evaluateSizeForZoom(Qe,q.zoom),Di=[Ae.canonical.x,Ae.canonical.y,1<<Ae.canonical.z];let Ot,ii,Ui,hn,Qn=[0,0],_r=null;if(_){if(ii=$e.glyphAtlasTexture,Ui=H.LINEAR,Ot=$e.glyphAtlasTexture.size,Fe.iconsInText){Qn=$e.imageAtlasTexture.size,_r=$e.imageAtlasTexture;const _n=Qe.kind==="composite"||Qe.kind==="camera";hn=zt||p.options.rotating||p.options.zooming||_n?H.LINEAR:H.NEAREST}}else{const _n=c.layout.get("icon-size").constantOr(0)!==1||Fe.iconsNeedLinear;ii=$e.imageAtlasTexture,Ui=Xt||p.options.rotating||p.options.zooming||_n||zt?H.LINEAR:H.NEAREST,Ot=$e.imageAtlasTexture.size}const kr=p.transform.calculatePixelsToTileUnitsMatrix($e),fi=Ao(Ae.projMatrix,$e.tileID.canonical,W,le,p.transform,kr),jt=p.terrain&&W&&re?s.invert(new Float32Array(16),fi):El,ai=ao(Ae.projMatrix,$e.tileID.canonical,W,le,p.transform,kr),Yi=Me&&Fe.hasTextData(),rr=c.layout.get("icon-text-fit")!=="none"&&Yi&&Fe.hasIconData();if(re){const _n=q.elevation,rs=_n?_n.getAtTileOffsetFunc(Ae,X):No=>[0,0,0];Ch(Fe,Ae.projMatrix,p,_,fi,ai,W,L,rs,Ae)}const Fi=p.translatePosMatrix(Ae.projMatrix,$e,x,w),or=re||_&&Me||rr?El:fi,Oa=p.translatePosMatrix(ai,$e,x,w,!0),er=Xt&&c.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ns;const xt=X.createInversionMatrix(Ae.toUnwrapped());ns=Xt?Fe.iconsInText?xa(Qe.kind,Ci,oe,W,p,Fi,or,Oa,Ot,Qn,Di,qe,xt,Se):va(Qe.kind,Ci,oe,W,p,Fi,or,Oa,_,Ot,!0,Di,qe,xt,Se):wl(Qe.kind,Ci,oe,W,p,Fi,or,Oa,_,Ot,Di,qe,xt,Se);const Pt={program:Ut,buffers:St,uniformValues:ns,atlasTexture:ii,atlasTextureIcon:_r,atlasInterpolation:Ui,atlasInterpolationIcon:hn,isSDF:Xt,hasHalo:er,tile:$e,labelPlaneMatrixInv:jt};if(ie&&Fe.canOverlap){ne=!0;const _n=St.segments.get();for(const rs of _n)Ge.push({segments:new s.SegmentVector([rs]),sortKey:rs.sortKey,state:Pt})}else Ge.push({segments:St.segments,sortKey:0,state:Pt})}ne&&Ge.sort((Ae,$e)=>Ae.sortKey-$e.sortKey);for(const Ae of Ge){const $e=Ae.state;if(p.terrain&&p.terrain.setupElevationDraw($e.tile,$e.program,{useDepthForOcclusion:!et,labelPlaneMatrixInv:$e.labelPlaneMatrixInv}),$.activeTexture.set(H.TEXTURE0),$e.atlasTexture.bind($e.atlasInterpolation,H.CLAMP_TO_EDGE),$e.atlasTextureIcon&&($.activeTexture.set(H.TEXTURE1),$e.atlasTextureIcon&&$e.atlasTextureIcon.bind($e.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),$e.isSDF){const Fe=$e.uniformValues;$e.hasHalo&&(Fe.u_is_halo=1,Cl($e.buffers,Ae.segments,c,p,$e.program,ce,O,N,Fe)),Fe.u_is_halo=0}Cl($e.buffers,Ae.segments,c,p,$e.program,ce,O,N,$e.uniformValues)}}function Cl(p,i,c,f,_,x,w,S,P){const L=f.context;_.draw(L,L.gl.TRIANGLES,x,w,S,s.CullFaceMode.disabled,P,c.id,p.layoutVertexBuffer,p.indexBuffer,i,c.paint,f.transform.zoom,p.programConfigurations.get(c.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function Al(p,i,c,f,_,x,w){const S=p.context.gl,P=c.paint.get("fill-pattern"),L=P&&P.constantOr(1),O=c.getCrossfadeParameters();let N,$,H,q,X;w?($=L&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=S.LINES):($=L?"fillPattern":"fill",N=S.TRIANGLES);for(const le of f){const W=i.getTile(le);if(L&&!W.patternsLoaded())continue;const re=W.getBucket(c);if(!re)continue;p.prepareDrawTile(le);const oe=re.programConfigurations.get(c.id),ie=p.useProgram($,oe);L&&(p.context.activeTexture.set(S.TEXTURE0),W.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),oe.updatePaintBuffers(O));const ne=P.constantOr(null);if(ne&&W.imageAtlas){const Se=W.imageAtlas,Me=Se.patternPositions[ne.to.toString()],et=Se.patternPositions[ne.from.toString()];Me&&et&&oe.setConstantPatternPositions(Me,et)}const ce=p.translatePosMatrix(le.projMatrix,W,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(w){q=re.indexBuffer2,X=re.segments2;const Se=p.terrain&&p.terrain.renderingToTexture?p.terrain.drapeBufferSize:[S.drawingBufferWidth,S.drawingBufferHeight];H=$==="fillOutlinePattern"&&L?Bh(ce,p,O,W,Se):df(ce,Se)}else q=re.indexBuffer,X=re.segments,H=L?Hc(ce,p,O,W):Oh(ce);p.prepareDrawProgram(p.context,ie,le.toUnwrapped()),ie.draw(p.context,N,_,p.stencilModeForClipping(le),x,s.CullFaceMode.disabled,H,c.id,re.layoutVertexBuffer,q,X,c.paint,p.transform.zoom,oe)}}function wa(p,i,c,f,_,x,w){const S=p.context,P=S.gl,L=c.paint.get("fill-extrusion-pattern"),O=L.constantOr(1),N=c.getCrossfadeParameters(),$=c.paint.get("fill-extrusion-opacity");for(const H of f){const q=i.getTile(H),X=q.getBucket(c);if(!X)continue;const le=X.programConfigurations.get(c.id),W=p.useProgram(O?"fillExtrusionPattern":"fillExtrusion",le);if(p.terrain){const ce=p.terrain;if(!X.enableTerrain)continue;if(ce.setupElevationDraw(q,W,{useMeterToDem:!0}),$h(S,i,H,X,c,ce),!X.centroidVertexBuffer){const Se=W.attributes.a_centroid_pos;Se!==void 0&&P.vertexAttrib2f(Se,0,0)}}O&&(p.context.activeTexture.set(P.TEXTURE0),q.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),le.updatePaintBuffers(N));const re=L.constantOr(null);if(re&&q.imageAtlas){const ce=q.imageAtlas,Se=ce.patternPositions[re.to.toString()],Me=ce.patternPositions[re.from.toString()];Se&&Me&&le.setConstantPatternPositions(Se,Me)}const oe=p.translatePosMatrix(H.projMatrix,q,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),ie=c.paint.get("fill-extrusion-vertical-gradient"),ne=O?Wc(oe,p,ie,$,H,N,q):Rh(oe,p,ie,$);p.prepareDrawProgram(S,W,H.toUnwrapped()),W.draw(S,S.gl.TRIANGLES,_,x,w,s.CullFaceMode.backCCW,ne,c.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,c.paint,p.transform.zoom,le,p.terrain?X.centroidVertexBuffer:null)}}function $h(p,i,c,f,_,x){const w=[W=>{let re=W.canonical.x-1,oe=W.wrap;return re<0&&(re=(1<<W.canonical.z)-1,oe--),new s.OverscaledTileID(W.overscaledZ,oe,W.canonical.z,re,W.canonical.y)},W=>{let re=W.canonical.x+1,oe=W.wrap;return re===1<<W.canonical.z&&(re=0,oe++),new s.OverscaledTileID(W.overscaledZ,oe,W.canonical.z,re,W.canonical.y)},W=>new s.OverscaledTileID(W.overscaledZ,W.wrap,W.canonical.z,W.canonical.x,(W.canonical.y===0?1<<W.canonical.z:W.canonical.y)-1),W=>new s.OverscaledTileID(W.overscaledZ,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y===(1<<W.canonical.z)-1?0:W.canonical.y+1)],S=W=>{const re=i.getSource().maxzoom,oe=Se=>{const Me=i.getTileByID(Se);if(Me&&Me.hasData())return Me.getBucket(_)};let ie,ne,ce;return(W.overscaledZ===W.canonical.z||W.overscaledZ>=re)&&(ie=oe(W.key)),W.overscaledZ>=re&&(ne=oe(W.calculateScaledKey(W.overscaledZ+1))),W.overscaledZ>re&&(ce=oe(W.calculateScaledKey(W.overscaledZ-1))),ie||ne||ce},P=[0,0,0],L=(W,re)=>(P[0]=Math.min(W.min.y,re.min.y),P[1]=Math.max(W.max.y,re.max.y),P[2]=s.EXTENT-re.min.x>W.max.x?re.min.x-s.EXTENT:W.max.x,P),O=(W,re)=>(P[0]=Math.min(W.min.x,re.min.x),P[1]=Math.max(W.max.x,re.max.x),P[2]=s.EXTENT-re.min.y>W.max.y?re.min.y-s.EXTENT:W.max.y,P),N=[(W,re)=>L(W,re),(W,re)=>L(re,W),(W,re)=>O(W,re),(W,re)=>O(re,W)],$=new s.pointGeometry(0,0);let H,q,X;const le=(W,re,oe,ie,ne)=>{const ce=[[ie?oe:W,ie?W:oe,0],[ie?oe:re,ie?re:oe,0]],Se=ne<0?s.EXTENT+ne:ne,Me=[ie?Se:(W+re)/2,ie?(W+re)/2:Se,0];return oe===0&&ne<0||oe!==0&&ne>0?x.getForTilePoints(X,[Me],!0,q):ce.push(Me),x.getForTilePoints(c,ce,!0,H),Math.max(ce[0][2],ce[1][2],Me[2])/x.exaggeration()};for(let W=0;W<4;W++){const re=f.borders[W];if(re.length===0&&(f.borderDone[W]=!0),f.borderDone[W])continue;const oe=X=w[W](c),ie=S(oe);if(!ie||!ie.enableTerrain||(q=x.findDEMTileFor(oe),!q||!q.dem))continue;if(!H){const Me=x.findDEMTileFor(c);if(!Me||!Me.dem)return;H=Me}const ne=(W<2?1:5)-W,ce=ie.borders[ne];let Se=0;for(let Me=0;Me<re.length;Me++){const et=f.featuresOnBorder[re[Me]],qe=et.borders[W];let Ge;for(;Se<ce.length&&(Ge=ie.featuresOnBorder[ce[Se]],!(Ge.borders[ne][1]>qe[0]+3));)ie.borderDone[ne]||ie.encodeCentroid(void 0,Ge,!1),Se++;if(Ge&&Se<ce.length){const ze=Se;let Ae=0;for(;!(Ge.borders[ne][0]>qe[1]-3)&&(Ae++,++Se!==ce.length);)Ge=ie.featuresOnBorder[ce[Se]];if(Ge=ie.featuresOnBorder[ce[ze]],et.intersectsCount()>1||Ge.intersectsCount()>1||Ae!==1){Ae!==1&&(Se=ze),f.encodeCentroid(void 0,et,!1),ie.borderDone[ne]||ie.encodeCentroid(void 0,Ge,!1);continue}const $e=N[W](et,Ge),Fe=W%2?s.EXTENT-1:0;$.x=le($e[0],Math.min(s.EXTENT-1,$e[1]),Fe,W<2,$e[2]),$.y=0,f.encodeCentroid($,et,!1),ie.borderDone[ne]||ie.encodeCentroid($,Ge,!1)}else f.encodeCentroid(void 0,et,!1)}f.borderDone[W]=f.needsCentroidUpdate=!0,ie.borderDone[ne]||(ie.borderDone[ne]=ie.needsCentroidUpdate=!0)}(f.needsCentroidUpdate||!f.centroidVertexBuffer&&f.centroidVertexArray.length!==0)&&f.uploadCentroid(p)}const Gh=new s.Color(1,0,0,1),gf=new s.Color(0,1,0,1),Ta=new s.Color(0,0,1,1),Ea=new s.Color(1,0,1,1),qh=new s.Color(0,1,1,1);function Jn(p,i,c,f){is(p,0,i+c/2,p.transform.width,c,f)}function Ml(p,i,c,f){is(p,i-c/2,0,c,p.transform.height,f)}function is(p,i,c,f,_,x){const w=p.context,S=w.gl;S.enable(S.SCISSOR_TEST),S.scissor(i*s.exported.devicePixelRatio,c*s.exported.devicePixelRatio,f*s.exported.devicePixelRatio,_*s.exported.devicePixelRatio),w.clear({color:x}),S.disable(S.SCISSOR_TEST)}function Il(p,i,c){const f=p.context,_=f.gl,x=c.projMatrix,w=p.useProgram("debug"),S=i.getTileByID(c.key);p.terrain&&p.terrain.setupElevationDraw(S,w);const P=s.DepthMode.disabled,L=s.StencilMode.disabled,O=p.colorModeForRenderPass(),N="$debug";f.activeTexture.set(_.TEXTURE0),p.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),S._makeDebugTileBoundsBuffers(p.context,p.transform.projection);const $=S._tileDebugBuffer||p.debugBuffer,H=S._tileDebugIndexBuffer||p.debugIndexBuffer,q=S._tileDebugSegments||p.debugSegments;w.draw(f,_.LINE_STRIP,P,L,O,s.CullFaceMode.disabled,Kc(x,s.Color.red),N,$,H,q);const X=S.latestRawTileData,le=Math.floor((X&&X.byteLength||0)/1024),W=i.getTile(c).tileSize,re=512/Math.min(W,512)*(c.overscaledZ/p.transform.zoom)*.5;let oe=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(oe+=` => ${c.overscaledZ}`),function(ie,ne){ie.initDebugOverlayCanvas();const ce=ie.debugOverlayCanvas,Se=ie.context.gl,Me=ie.debugOverlayCanvas.getContext("2d");Me.clearRect(0,0,ce.width,ce.height),Me.shadowColor="white",Me.shadowBlur=2,Me.lineWidth=1.5,Me.strokeStyle="white",Me.textBaseline="top",Me.font="bold 36px Open Sans, sans-serif",Me.fillText(ne,5,5),Me.strokeText(ne,5,5),ie.debugOverlayTexture.update(ce),ie.debugOverlayTexture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE)}(p,`${oe} ${le}kb`),w.draw(f,_.TRIANGLES,P,L,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,Kc(x,s.Color.transparent,re),N,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments)}const Jc=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Qc}=Jc;function Ar(p,i,c,f){p.emplaceBack(i,c,f)}class kl{constructor(i){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,Ar(this.vertexArray,-1,-1,1),Ar(this.vertexArray,1,-1,1),Ar(this.vertexArray,-1,1,1),Ar(this.vertexArray,1,1,1),Ar(this.vertexArray,-1,-1,-1),Ar(this.vertexArray,1,-1,-1),Ar(this.vertexArray,-1,1,-1),Ar(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,Qc),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function Ro(p,i,c,f,_,x){const w=p.gl,S=i.paint.get("sky-atmosphere-color"),P=i.paint.get("sky-atmosphere-halo-color"),L=i.paint.get("sky-atmosphere-sun-intensity"),O=((N,$,H,q,X)=>({u_matrix_3f:N,u_sun_direction:$,u_sun_intensity:H,u_color_tint_r:[q.r,q.g,q.b,q.a],u_color_tint_m:[X.r,X.g,X.b,X.a],u_luminance:5e-5}))(s.fromMat4([],f),_,L,S,P);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+x,i.skyboxTexture,0),c.draw(p,w.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,O,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const Sa={symbol:function(p,i,c,f,_){if(p.renderPass!=="translucent")return;const x=s.StencilMode.disabled,w=p.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(S,P,L,O,N,$,H){const q=P.transform,X=N==="map",le=$==="map",W=q.projection.createTileTransform(q,q.worldSize);for(const re of S){const oe=O.getTile(re),ie=oe.getBucket(L);if(!ie||ie.projection!==q.projection.name||!ie.text||!ie.text.segments.get().length)continue;const ne=s.evaluateSizeForZoom(ie.textSizeData,q.zoom),ce=P.transform.calculatePixelsToTileUnitsMatrix(oe),Se=Ao(re.projMatrix,oe.tileID.canonical,le,X,P.transform,ce),Me=L.layout.get("icon-text-fit")!=="none"&&ie.hasIconData();if(ne){const et=Math.pow(2,q.zoom-oe.tileID.overscaledZ);ff(ie,X,le,H,s.symbolSize,q,Se,re,et,ne,Me,W)}}}(f,p,c,i,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),_),c.paint.get("icon-opacity").constantOr(1)!==0&&Sl(p,i,c,f,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),x,w),c.paint.get("text-opacity").constantOr(1)!==0&&Sl(p,i,c,f,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),x,w),i.map.showCollisionBoxes&&(Yc(p,i,c,f,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Yc(p,i,c,f,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(p,i,c,f){if(p.renderPass!=="translucent")return;const _=c.paint.get("circle-opacity"),x=c.paint.get("circle-stroke-width"),w=c.paint.get("circle-stroke-opacity"),S=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)===0&&(x.constantOr(1)===0||w.constantOr(1)===0))return;const P=p.context,L=P.gl,O=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),N=s.StencilMode.disabled,$=p.colorModeForRenderPass(),H=[];for(let X=0;X<f.length;X++){const le=f[X],W=i.getTile(le),re=W.getBucket(c);if(!re)continue;const oe=re.programConfigurations.get(c.id),ie=Xc(c),ne={programConfiguration:oe,program:p.useProgram("circle",oe,ie),layoutVertexBuffer:re.layoutVertexBuffer,indexBuffer:re.indexBuffer,uniformValues:pf(p,le,W,c),tile:W};if(S){const ce=re.segments.get();for(const Se of ce)H.push({segments:new s.SegmentVector([Se]),sortKey:Se.sortKey,state:ne})}else H.push({segments:re.segments,sortKey:0,state:ne})}S&&H.sort((X,le)=>X.sortKey-le.sortKey);const q={useDepthForOcclusion:p.transform.projection.name!=="globe"};for(const X of H){const{programConfiguration:le,program:W,layoutVertexBuffer:re,indexBuffer:oe,uniformValues:ie,tile:ne}=X.state,ce=X.segments;p.terrain&&p.terrain.setupElevationDraw(ne,W,q),p.prepareDrawProgram(P,W,ne.tileID.toUnwrapped()),W.draw(P,L.TRIANGLES,O,N,$,s.CullFaceMode.disabled,ie,c.id,re,oe,ce,c.paint,p.transform.zoom,le)}},heatmap:function(p,i,c,f){if(c.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const _=p.context,x=_.gl,w=s.StencilMode.disabled,S=new s.ColorMode([x.ONE,x.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(P,L,O){const N=P.gl;P.activeTexture.set(N.TEXTURE1),P.viewport.set([0,0,L.width/4,L.height/4]);let $=O.heatmapFbo;if($)N.bindTexture(N.TEXTURE_2D,$.colorAttachment.get()),P.bindFramebuffer.set($.framebuffer);else{const H=N.createTexture();N.bindTexture(N.TEXTURE_2D,H),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,N.LINEAR),$=O.heatmapFbo=P.createFramebuffer(L.width/4,L.height/4,!1),function(q,X,le,W){const re=q.gl;re.texImage2D(re.TEXTURE_2D,0,re.RGBA,X.width/4,X.height/4,0,re.RGBA,q.extRenderToTextureHalfFloat?q.extTextureHalfFloat.HALF_FLOAT_OES:re.UNSIGNED_BYTE,null),W.colorAttachment.set(le)}(P,L,H,$)}})(_,p,c),_.clear({color:s.Color.transparent});for(let P=0;P<f.length;P++){const L=f[P];if(i.hasRenderableParent(L))continue;const O=i.getTile(L),N=O.getBucket(c);if(!N)continue;const $=N.programConfigurations.get(c.id),H=p.useProgram("heatmap",$),{zoom:q}=p.transform;p.terrain&&p.terrain.setupElevationDraw(O,H),p.prepareDrawProgram(_,H,L.toUnwrapped()),H.draw(_,x.TRIANGLES,s.DepthMode.disabled,w,S,s.CullFaceMode.disabled,Nh(L.projMatrix,O,q,c.paint.get("heatmap-intensity")),c.id,N.layoutVertexBuffer,N.indexBuffer,N.segments,c.paint,p.transform.zoom,$)}_.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),function(_,x){const w=_.context,S=w.gl,P=x.heatmapFbo;if(!P)return;w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,P.colorAttachment.get()),w.activeTexture.set(S.TEXTURE1);let L=x.colorRampTexture;L||(L=x.colorRampTexture=new s.Texture(w,x.colorRamp,S.RGBA)),L.bind(S.LINEAR,S.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(w,S.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,_.colorModeForRenderPass(),s.CullFaceMode.disabled,((O,N,$,H)=>({u_image:0,u_color_ramp:1,u_opacity:N.paint.get("heatmap-opacity")}))(0,x),x.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,x.paint,_.transform.zoom)}(p,c))},line:function(p,i,c,f){if(p.renderPass!=="translucent")return;const _=c.paint.get("line-opacity"),x=c.paint.get("line-width");if(_.constantOr(1)===0||x.constantOr(1)===0)return;const w=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),S=p.colorModeForRenderPass(),P=c.paint.get("line-dasharray"),L=P.constantOr(1),O=c.layout.get("line-cap"),N=c.paint.get("line-pattern"),$=N.constantOr(1),H=c.paint.get("line-gradient"),q=c.getCrossfadeParameters(),X=$?"linePattern":"line",le=p.context,W=le.gl,re=(ie=>{const ne=[];ya(ie)&&ne.push("RENDER_LINE_DASH"),ie.paint.get("line-gradient")&&ne.push("RENDER_LINE_GRADIENT");const ce=ie.paint.get("line-pattern").constantOr(1),Se=ie.paint.get("line-opacity").constantOr(1)!==1;return!ce&&Se&&ne.push("RENDER_LINE_ALPHA_DISCARD"),ne})(c);let oe=re.includes("RENDER_LINE_ALPHA_DISCARD");p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(oe=!1);for(const ie of f){const ne=i.getTile(ie);if($&&!ne.patternsLoaded())continue;const ce=ne.getBucket(c);if(!ce)continue;p.prepareDrawTile(ie);const Se=ce.programConfigurations.get(c.id),Me=p.useProgram(X,Se,re),et=N.constantOr(null);if(et&&ne.imageAtlas){const Fe=ne.imageAtlas,St=Fe.patternPositions[et.to.toString()],Dt=Fe.patternPositions[et.from.toString()];St&&Dt&&Se.setConstantPatternPositions(St,Dt)}const qe=P.constantOr(null),Ge=O.constantOr(null);if(!$&&qe&&Ge&&ne.lineAtlas){const Fe=ne.lineAtlas,St=Fe.getDash(qe.to,Ge),Dt=Fe.getDash(qe.from,Ge);St&&Dt&&Se.setConstantPatternPositions(St,Dt)}const ze=p.terrain?ie.projMatrix:null,Ae=$?ts(p,ne,c,q,ze):Uh(p,ne,c,q,ze,ce.lineClipsArray.length);if(H){const Fe=ce.gradients[c.id];let St=Fe.texture;if(c.gradientVersion!==Fe.version){let Dt=256;if(c.stepInterpolant){const Xt=i.getSource().maxzoom,Qe=ie.canonical.z===Xt?Math.ceil(1<<p.transform.maxZoom-ie.canonical.z):1;Dt=s.clamp(s.nextPowerOfTwo(ce.maxLineLength/s.EXTENT*1024*Qe),256,le.maxTextureSize)}Fe.gradient=s.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:Dt,image:Fe.gradient||void 0,clips:ce.lineClipsArray}),Fe.texture?Fe.texture.update(Fe.gradient):Fe.texture=new s.Texture(le,Fe.gradient,W.RGBA),Fe.version=c.gradientVersion,St=Fe.texture}le.activeTexture.set(W.TEXTURE1),St.bind(c.stepInterpolant?W.NEAREST:W.LINEAR,W.CLAMP_TO_EDGE)}L&&(le.activeTexture.set(W.TEXTURE0),ne.lineAtlasTexture.bind(W.LINEAR,W.REPEAT),Se.updatePaintBuffers(q)),$&&(le.activeTexture.set(W.TEXTURE0),ne.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Se.updatePaintBuffers(q)),p.prepareDrawProgram(le,Me,ie.toUnwrapped());const $e=Fe=>{Me.draw(le,W.TRIANGLES,w,Fe,S,s.CullFaceMode.disabled,Ae,c.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,c.paint,p.transform.zoom,Se,ce.layoutVertexBuffer2)};if(oe){const Fe=p.stencilModeForClipping(ie).ref;Fe===0&&p.terrain&&le.clear({stencil:0});const St={func:W.EQUAL,mask:255};Ae.u_alpha_discard_threshold=.8,$e(new s.StencilMode(St,Fe,255,W.KEEP,W.KEEP,W.INVERT)),Ae.u_alpha_discard_threshold=0,$e(new s.StencilMode(St,Fe,255,W.KEEP,W.KEEP,W.KEEP))}else $e(p.stencilModeForClipping(ie))}oe&&(p.resetStencilClippingMasks(),p.terrain&&le.clear({stencil:0}))},fill:function(p,i,c,f){const _=c.paint.get("fill-color"),x=c.paint.get("fill-opacity");if(x.constantOr(1)===0)return;const w=p.colorModeForRenderPass(),S=c.paint.get("fill-pattern"),P=p.opaquePassEnabledForLayer()&&!S.constantOr(1)&&_.constantOr(s.Color.transparent).a===1&&x.constantOr(0)===1?"opaque":"translucent";if(p.renderPass===P){const L=p.depthModeForSublayer(1,p.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Al(p,i,c,f,L,w,!1)}if(p.renderPass==="translucent"&&c.paint.get("fill-antialias")){const L=p.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Al(p,i,c,f,L,w,!0)}},"fill-extrusion":function(p,i,c,f){const _=c.paint.get("fill-extrusion-opacity");if(_!==0&&p.renderPass==="translucent"){const x=new s.DepthMode(p.context.gl.LEQUAL,s.DepthMode.ReadWrite,p.depthRangeFor3D);if(_!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))wa(p,i,c,f,x,s.StencilMode.disabled,s.ColorMode.disabled),wa(p,i,c,f,x,p.stencilModeFor3D(),p.colorModeForRenderPass()),p.resetStencilClippingMasks();else{const w=p.colorModeForRenderPass();wa(p,i,c,f,x,s.StencilMode.disabled,w)}}},hillshade:function(p,i,c,f){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent")return;const _=p.context,x=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),w=p.colorModeForRenderPass(),S=p.terrain&&p.terrain.renderingToTexture,[P,L]=p.renderPass!=="translucent"||S?[{},f]:p.stencilConfigForOverlap(f);for(const O of L){const N=i.getTile(O);if(N.needsHillshadePrepare&&p.renderPass==="offscreen")fa(p,N,c,x,s.StencilMode.disabled,w);else if(p.renderPass==="translucent"){const $=S&&p.terrain?p.terrain.stencilModeForRTTOverlap(O):P[O.overscaledZ];_l(p,O,N,c,x,$,w)}}_.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,i,c,f,_,x){if(p.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!f.length)return;const w=p.context,S=w.gl,P=i.getSource(),L=p.useProgram("raster"),O=p.colorModeForRenderPass(),N=p.terrain&&p.terrain.renderingToTexture,[$,H]=P instanceof un||N?[{},f]:p.stencilConfigForOverlap(f),q=H[H.length-1].overscaledZ,X=!p.options.moving;for(const le of H){const W=N?s.DepthMode.disabled:p.depthModeForSublayer(le.overscaledZ-q,c.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,S.LESS),re=le.toUnwrapped(),oe=i.getTile(le);if(N&&(!oe||!oe.hasData()))continue;const ie=N?le.projMatrix:p.transform.calculateProjMatrix(re,X),ne=p.terrain&&N?p.terrain.stencilModeForRTTOverlap(le):$[le.overscaledZ],ce=x?0:c.paint.get("raster-fade-duration");oe.registerFadeDuration(ce);const Se=i.findLoadedParent(le,0),Me=Ph(oe,Se,i,p.transform,ce);let et,qe;p.terrain&&p.terrain.prepareDrawTile(le);const Ge=c.paint.get("raster-resampling")==="nearest"?S.NEAREST:S.LINEAR;w.activeTexture.set(S.TEXTURE0),oe.texture.bind(Ge,S.CLAMP_TO_EDGE),w.activeTexture.set(S.TEXTURE1),Se?(Se.texture.bind(Ge,S.CLAMP_TO_EDGE),et=Math.pow(2,Se.tileID.overscaledZ-oe.tileID.overscaledZ),qe=[oe.tileID.canonical.x*et%1,oe.tileID.canonical.y*et%1]):oe.texture.bind(Ge,S.CLAMP_TO_EDGE);const ze=xl(ie,qe||[0,0],et||1,Me,c,P instanceof un?P.perspectiveTransform:[0,0]);if(p.prepareDrawProgram(w,L,re),P instanceof un)L.draw(w,S.TRIANGLES,W,s.StencilMode.disabled,O,s.CullFaceMode.disabled,ze,c.id,P.boundsBuffer,p.quadTriangleIndexBuffer,P.boundsSegments);else{const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:$e,tileBoundsSegments:Fe}=p.getTileBoundsBuffers(oe);L.draw(w,S.TRIANGLES,W,ne,O,s.CullFaceMode.disabled,ze,c.id,Ae,$e,Fe)}}p.resetStencilClippingMasks()},background:function(p,i,c,f){const _=c.paint.get("background-color"),x=c.paint.get("background-opacity");if(x===0)return;const w=p.context,S=w.gl,P=p.transform,L=P.tileSize,O=c.paint.get("background-pattern");if(p.isPatternMissing(O))return;const N=!O&&_.a===1&&x===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==N)return;const $=s.StencilMode.disabled,H=p.depthModeForSublayer(0,N==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),q=p.colorModeForRenderPass(),X=p.useProgram(O?"backgroundPattern":"background");let le,W=f;W||(le=p.getBackgroundTiles(),W=Object.values(le).map(oe=>oe.tileID)),O&&(w.activeTexture.set(S.TEXTURE0),p.imageManager.bind(p.context));const re=c.getCrossfadeParameters();for(const oe of W){const ie=oe.toUnwrapped(),ne=f?oe.projMatrix:p.transform.calculateProjMatrix(ie);p.prepareDrawTile(oe);const ce=i?i.getTile(oe):le?le[oe.key]:new s.Tile(oe,L,P.zoom,p),Se=O?Tl(ne,x,p,O,{tileID:oe,tileSize:L},re):Ei(ne,x,_);p.prepareDrawProgram(w,X,ie);const{tileBoundsBuffer:Me,tileBoundsIndexBuffer:et,tileBoundsSegments:qe}=p.getTileBoundsBuffers(ce);X.draw(w,S.TRIANGLES,H,$,q,s.CullFaceMode.disabled,Se,c.id,Me,et,qe)}},sky:function(p,i,c){const f=p.transform,_=f.projection.name==="mercator"||f.projection.name==="globe"?1:s.smoothstep(7,8,f.zoom),x=c.paint.get("sky-opacity")*_;if(x===0)return;const w=p.context,S=c.paint.get("sky-type"),P=new s.DepthMode(w.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),L=p.frameCounter/1e3%1;S==="atmosphere"?p.renderPass==="offscreen"?c.needsSkyboxCapture(p)&&(function(O,N,$,H){const q=O.context,X=q.gl;let le=N.skyboxFbo;if(!le){le=N.skyboxFbo=q.createFramebuffer(32,32,!1),N.skyboxGeometry=new kl(q),N.skyboxTexture=q.gl.createTexture(),X.bindTexture(X.TEXTURE_CUBE_MAP,N.skyboxTexture),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MAG_FILTER,X.LINEAR);for(let ie=0;ie<6;++ie)X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+ie,0,X.RGBA,32,32,0,X.RGBA,X.UNSIGNED_BYTE,null)}q.bindFramebuffer.set(le.framebuffer),q.viewport.set([0,0,32,32]);const W=N.getCenter(O,!0),re=O.useProgram("skyboxCapture"),oe=new Float64Array(16);s.identity(oe),s.rotateY(oe,oe,.5*-Math.PI),Ro(q,N,re,oe,W,0),s.identity(oe),s.rotateY(oe,oe,.5*Math.PI),Ro(q,N,re,oe,W,1),s.identity(oe),s.rotateX(oe,oe,.5*-Math.PI),Ro(q,N,re,oe,W,2),s.identity(oe),s.rotateX(oe,oe,.5*Math.PI),Ro(q,N,re,oe,W,3),s.identity(oe),Ro(q,N,re,oe,W,4),s.identity(oe),s.rotateY(oe,oe,Math.PI),Ro(q,N,re,oe,W,5),q.viewport.set([0,0,O.width,O.height])}(p,c),c.markSkyboxValid(p)):p.renderPass==="sky"&&function(O,N,$,H,q){const X=O.context,le=X.gl,W=O.transform,re=O.useProgram("skybox");X.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_CUBE_MAP,N.skyboxTexture);const oe=((ie,ne,ce,Se,Me)=>({u_matrix:ie,u_sun_direction:ne,u_cubemap:0,u_opacity:Se,u_temporal_offset:Me}))(W.skyboxMatrix,N.getCenter(O,!1),0,H,q);O.prepareDrawProgram(X,re),re.draw(X,le.TRIANGLES,$,s.StencilMode.disabled,O.colorModeForRenderPass(),s.CullFaceMode.backCW,oe,"skybox",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(p,c,P,x,L):S==="gradient"&&p.renderPass==="sky"&&function(O,N,$,H,q){const X=O.context,le=X.gl,W=O.transform,re=O.useProgram("skyboxGradient");N.skyboxGeometry||(N.skyboxGeometry=new kl(X)),X.activeTexture.set(le.TEXTURE0);let oe=N.colorRampTexture;oe||(oe=N.colorRampTexture=new s.Texture(X,N.colorRamp,le.RGBA)),oe.bind(le.LINEAR,le.CLAMP_TO_EDGE);const ie=((ne,ce,Se,Me,et)=>({u_matrix:ne,u_color_ramp:0,u_center_direction:ce,u_radius:s.degToRad(Se),u_opacity:Me,u_temporal_offset:et}))(W.skyboxMatrix,N.getCenter(O,!1),N.paint.get("sky-gradient-radius"),H,q);O.prepareDrawProgram(X,re),re.draw(X,le.TRIANGLES,$,s.StencilMode.disabled,O.colorModeForRenderPass(),s.CullFaceMode.backCW,ie,"skyboxGradient",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(p,c,P,x,L)},debug:function(p,i,c){for(let f=0;f<c.length;f++)Il(p,i,c[f])},custom:function(p,i,c){const f=p.context,_=c.implementation;if(p.transform.projection.unsupportedLayers&&p.transform.projection.unsupportedLayers.includes("custom"))s.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(p.renderPass==="offscreen"){const x=_.prerender;x&&(p.setCustomLayerDefaults(),f.setColorMode(p.colorModeForRenderPass()),x.call(_,f.gl,p.transform.customLayerMatrix()),f.setDirty(),p.setBaseState())}else if(p.renderPass==="translucent"){p.setCustomLayerDefaults(),f.setColorMode(p.colorModeForRenderPass()),f.setStencilMode(s.StencilMode.disabled);const x=_.renderingMode==="3d"?new s.DepthMode(p.context.gl.LEQUAL,s.DepthMode.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,s.DepthMode.ReadOnly);f.setDepthMode(x),_.render(f.gl,p.transform.customLayerMatrix()),f.setDirty(),p.setBaseState(),f.bindFramebuffer.set(null)}}};class Zh{constructor(i,c){this.context=new Mn(i),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new da,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(i,c){const f=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(f||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Lo(this,i));const _=this._terrain;this.transform.elevation=f?_:null,_.update(i,this.transform,c)}_updateFog(i){const c=i.fog;if(!c||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[f,_]=c.getFovAdjustedRange(this.transform._fov);if(f>_)return void(this.transform.fogCullDistSq=null);const x=f+.78*(_-f);this.transform.fogCullDistSq=x*x}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(i,c){if(this.width=i*s.exported.devicePixelRatio,this.height=c*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style.order)this.style._layers[f].resize()}setup(){const i=this.context,c=new s.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(s.EXTENT,0),c.emplaceBack(0,s.EXTENT),c.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(c,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const f=new s.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(s.EXTENT,0),f.emplaceBack(0,s.EXTENT),f.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=i.createVertexBuffer(f,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const _=new s.StructArrayLayout2i4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(_,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const x=new s.StructArrayLayout4i8;x.emplaceBack(0,0,0,0),x.emplaceBack(s.EXTENT,0,s.EXTENT,0),x.emplaceBack(0,s.EXTENT,0,s.EXTENT),x.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=i.createVertexBuffer(x,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const w=new s.StructArrayLayout3ui6;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(w);const S=new s.StructArrayLayout1ui2;for(const L of[0,1,3,2,0])S.emplaceBack(L);this.debugIndexBuffer=i.createIndexBuffer(S),this.emptyTexture=new s.Texture(i,{width:1,height:1,data:new Uint8Array([0,0,0,0])},i.gl.RGBA),this.identityMat=s.create();const P=this.context.gl;this.stencilClearMode=new s.StencilMode({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO),this.loadTimeStamps.push(s.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context,c=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(i,c.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,Xr(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(i,c,f){if(!c||this.currentStencilSource===c.id||!i.isTileClipped()||!f||f.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let S=!1;for(const P of f)if(this._tileClippingMaskIDs[P.key]===void 0){S=!0;break}if(!S)return}this.currentStencilSource=c.id;const _=this.context,x=_.gl;this.nextStencilID+f.length>256&&this.clearStencil(),_.setColorMode(s.ColorMode.disabled),_.setDepthMode(s.DepthMode.disabled);const w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of f){const P=c.getTile(S),L=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,{tileBoundsBuffer:O,tileBoundsIndexBuffer:N,tileBoundsSegments:$}=this.getTileBoundsBuffers(P);w.draw(_,x.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:x.ALWAYS,mask:0},L,255,x.KEEP,x.KEEP,x.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Xr(S.projMatrix),"$clipping",O,N,$)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,c=this.context.gl;return new s.StencilMode({func:c.NOTEQUAL,mask:255},i,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const c=this.context.gl;return new s.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(i){const c=this.context.gl,f=i.sort((w,S)=>S.overscaledZ-w.overscaledZ),_=f[f.length-1].overscaledZ,x=f[0].overscaledZ-_+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const w={};for(let S=0;S<x;S++)w[S+_]=new s.StencilMode({func:c.GEQUAL,mask:255},S+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=x,[w,f]}return[{[_]:s.StencilMode.disabled},f]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([i.CONSTANT_COLOR,i.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(i,c,f){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new s.DepthMode(f||this.context.gl.LEQUAL,c,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,c){this.style=i,this.options=c,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const f=this.style.order,_=this.style._sourceCaches;for(const L in _){const O=_[L];O.used&&O.prepare(this.context)}const x={},w={},S={};for(const L in _){const O=_[L];x[L]=O.getVisibleCoordinates(),w[L]=x[L].slice().reverse(),S[L]=O.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<f.length;L++)if(this.style._layers[f[L]].is3D()){this.opaquePassCutoff=L;break}if(this.terrain&&(this.terrain.updateTileBinding(S),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const L of f){const O=this.style._layers[L],N=i._getLayerSourceCache(O);if(!O.hasOffscreenPass()||O.isHidden(this.transform.zoom))continue;const $=N?w[N.id]:void 0;(O.type==="custom"||O.isSky()||$&&$.length)&&this.renderLayer(this,N,O,$)}this.depthRangeFor3D=[0,1-(i.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let P=s.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(P=this.style.fog.properties.get("color")),this.context.clear({color:c.showOverdrawInspector?s.Color.black:P,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[f[this.currentLayer]],O=i._getLayerSourceCache(L);if(L.isSky())continue;const N=O?w[O.id]:void 0;this._renderTileClippingMasks(L,O,N),this.renderLayer(this,O,L,N)}if(this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const L=this.style._layers[f[this.currentLayer]],O=i._getLayerSourceCache(L);L.isSky()&&this.renderLayer(this,O,L,O?w[O.id]:void 0)}for(this.transform.projection.name==="globe"&&function(L){const O=L.context,N=O.gl,$=L.transform,H=new s.DepthMode(N.LEQUAL,s.DepthMode.ReadOnly,[0,1]),q=L.useProgram("globeAtmosphere"),X=$._camera.getWorldToCamera($.worldSize,1),le=$._camera.getCameraToClipPerspective($._fov,$.width/$.height,$._nearZ,$._farZ),W=s.mul([],X,s.calculateGlobeMatrix($,$.worldSize)),re=s.mul([],$.labelPlaneMatrix,le),oe=s.transformMat4([],[0,0,0],W),ie=s.add([],oe,[$.worldSize/Math.PI/2,0,0]),ne=s.transformMat4([],oe,re),ce=s.transformMat4([],ie,re),Se=s.length(s.sub([],ce,ne)),Me=1-s.globeToMercatorTransition($.zoom),et={u_center:ne,u_radius:Se,u_screen_size:[$.width,$.height],u_pixel_ratio:s.exported.devicePixelRatio,u_opacity:Me,u_fadeout_range:2,u_start_color:[1,1,1],u_end_color:[.0118,.7451,.9882]};L.prepareDrawProgram(O,q);const qe=L.globeSharedBuffers;qe&&q.draw(O,N.TRIANGLES,H,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,et,"skybox",qe.atmosphereVertexBuffer,qe.atmosphereIndexBuffer,qe.atmosphereSegments)}(this),this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;){const L=this.style._layers[f[this.currentLayer]],O=i._getLayerSourceCache(L);if(L.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(L)){if(L.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const N=O?(L.type==="symbol"?S:w)[O.id]:void 0;this._renderTileClippingMasks(L,O,O?x[O.id]:void 0),this.renderLayer(this,O,L,N),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let L=null;s.values(this.style._layers).forEach(O=>{const N=i._getLayerSourceCache(O);N&&!O.isHidden(this.transform.zoom)&&(!L||L.getSource().maxzoom<N.getSource().maxzoom)&&(L=N)}),L&&this.options.showTileBoundaries&&Sa.debug(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const O=L.transform.padding;Jn(L,L.transform.height-(O.top||0),3,Gh),Jn(L,O.bottom||0,3,gf),Ml(L,O.left||0,3,Ta),Ml(L,L.transform.width-(O.right||0),3,Ea);const N=L.transform.centerPoint;(function($,H,q,X){is($,H-1,q-10,2,20,X),is($,H-10,q-1,20,2,X)})(L,N.x,L.transform.height-N.y,qh)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(i,c,f,_){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="sky"||f.type==="custom"||_&&_.length)&&(this.id=f.id,this.gpuTimingStart(f),i.transform.projection.unsupportedLayers&&i.transform.projection.unsupportedLayers.includes(f.type)||Sa[f.type](i,c,f,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let f=this.gpuTimers[i.id];f||(f=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),f.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,f.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}queryGpuTimers(i){const c={};for(const f in i){const _=i[f],x=this.context.extTimerQuery,w=x.getQueryObjectEXT(_.query,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(_.query),c[f]=w}return c}translatePosMatrix(i,c,f,_,x){if(!f[0]&&!f[1])return i;const w=x?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(w){const L=Math.sin(w),O=Math.cos(w);f=[f[0]*O-f[1]*L,f[0]*L+f[1]*O]}const S=[x?f[0]:qt(c,f[0],this.transform.zoom),x?f[1]:qt(c,f[1],this.transform.zoom),0],P=new Float32Array(16);return s.translate(P,i,S),P}saveTileTexture(i){const c=this._tileTextures[i.size[0]];c?c.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const c=this._tileTextures[i];return c&&c.length>0?c.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const c=this.imageManager.getPattern(i.from.toString()),f=this.imageManager.getPattern(i.to.toString());return!c||!f}currentGlobalDefines(){const i=this.terrain&&this.terrain.renderingToTexture,c=this.style&&this.style.fog,f=[];return this.terrain&&!this.terrain.renderingToTexture&&f.push("TERRAIN"),c&&!i&&c.getOpacity(this.transform.pitch)!==0&&f.push("FOG"),i&&f.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&f.push("OVERDRAW_INSPECTOR"),f}useProgram(i,c,f){this.cache=this.cache||{};const _=f||[],x=this.currentGlobalDefines().concat(_),w=ga.cacheKey(i,x,c);return this.cache[w]||(this.cache[w]=new ga(this.context,i,Zc[i],c,jh[i],x)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(i){this.terrain&&this.terrain.prepareDrawTile(i)}prepareDrawProgram(i,c,f){if(this.terrain&&this.terrain.renderingToTexture)return;const _=this.style.fog;if(_){const x=_.getOpacity(this.transform.pitch);x!==0&&c.setFogUniformValues(i,((w,S,P,L)=>{const O=S.properties.get("color"),N=w.frameCounter/1e3%1,$=[O.r/O.a,O.g/O.a,O.b/O.a,L];return{u_fog_matrix:P?w.transform.calculateFogTileMatrix(P):w.identityMat,u_fog_range:S.getFovAdjustedRange(w.transform._fov),u_fog_color:$,u_fog_horizon_blend:S.properties.get("horizon-blend"),u_fog_temporal_offset:N}})(this,_,f,x))}}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const i=this.context.gl,c=i.createTexture();return i.bindTexture(i.TEXTURE_2D,c),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&i.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const i=this._backgroundTiles,c=this._backgroundTiles={},f=this.transform.coveringTiles({tileSize:512});for(const _ of f)c[_.key]=i[_.key]||new s.Tile(_,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class zl{constructor(i=0,c=0,f=0,_=0){if(isNaN(i)||i<0||isNaN(c)||c<0||isNaN(f)||f<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=c,this.left=f,this.right=_}interpolate(i,c,f){return c.top!=null&&i.top!=null&&(this.top=s.number(i.top,c.top,f)),c.bottom!=null&&i.bottom!=null&&(this.bottom=s.number(i.bottom,c.bottom,f)),c.left!=null&&i.left!=null&&(this.left=s.number(i.left,c.left,f)),c.right!=null&&i.right!=null&&(this.right=s.number(i.right,c.right,f)),this}getCenter(i,c){const f=s.clamp((this.left+i-this.right)/2,0,i),_=s.clamp((this.top+c-this.bottom)/2,0,c);return new s.pointGeometry(f,_)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new zl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Oo(p,i){const c=s.getColumn(p,3);s.fromQuat(p,i),s.setColumn(p,3,c)}function Wh(p,i){s.setColumn(p,3,[i[0],i[1],i[2],1])}function eu(p,i){const c=s.identity$1([]);return s.rotateZ$1(c,c,-i),s.rotateX$1(c,c,-p),c}function tu(p,i){const c=[p[0],p[1],0],f=[i[0],i[1],0];if(s.length(c)>=1e-15){const w=s.normalize([],c);s.scale$2(f,w,s.dot(f,w)),i[0]=f[0],i[1]=f[1]}const _=s.cross([],i,p);if(s.len(_)<1e-15)return null;const x=Math.atan2(-_[1],_[0]);return eu(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),x)}class Hh{constructor(i,c){this.position=i,this.orientation=c}get position(){return this._position}set position(i){this._position=this._renderWorldCopies?function(c){if(!c)return;const f=Array.isArray(c)?new s.MercatorCoordinate(c[0],c[1],c[2]):c;return f.x=s.wrap(f.x,0,1),f}(i):i}lookAtPoint(i,c){if(this.orientation=null,!this.position)return;const f=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(i)):0,_=this.position,x=s.MercatorCoordinate.fromLngLat(i,f),w=[x.x-_.x,x.y-_.y,x.z-_.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=tu(w,c)}setPitchBearing(i,c){this.orientation=eu(s.degToRad(i),s.degToRad(-c))}}class iu{constructor(i,c){this._transform=s.identity([]),this._orientation=s.identity$1([]),c&&(this._orientation=c,Oo(this._transform,this._orientation)),i&&Wh(this._transform,i)}get mercatorPosition(){const i=this.position;return new s.MercatorCoordinate(i[0],i[1],i[2])}get position(){const i=s.getColumn(this._transform,3);return[i[0],i[1],i[2]]}set position(i){Wh(this._transform,i)}get orientation(){return this._orientation}set orientation(i){this._orientation=i,Oo(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,c){this._orientation=eu(i,c),Oo(this._transform,this._orientation)}forward(){const i=s.getColumn(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=s.getColumn(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=s.getColumn(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,c){const f=new Float64Array(16);return s.invert(f,this.getWorldToCamera(i,c)),f}getWorldToCameraPosition(i,c,f){const _=this.position;s.scale$2(_,_,-i);const x=new Float64Array(16);return s.fromScaling(x,[f,f,f]),s.translate(x,x,_),x[10]*=c,x}getWorldToCamera(i,c){const f=new Float64Array(16),_=new Float64Array(4),x=this.position;return s.conjugate(_,this._orientation),s.scale$2(x,x,-i),s.fromQuat(f,_),s.translate(f,f,x),f[1]*=-1,f[5]*=-1,f[9]*=-1,f[13]*=-1,f[8]*=c,f[9]*=c,f[10]*=c,f[11]*=c,f}getCameraToClipPerspective(i,c,f,_){const x=new Float64Array(16);return s.perspective(x,i,c,f,_),x}getDistanceToElevation(i){const c=i===0?0:s.mercatorZfromAltitude(i,this.position[1]),f=this.forward();return(c-this.position[2])/f[2]}clone(){return new iu([...this.position],[...this.orientation])}}function Xh(p,i){const c=Dl(p),f=function(x,w,S,P,L){const O=new s.LngLat(S.lng-180*Mr,S.lat),N=new s.LngLat(S.lng+180*Mr,S.lat),$=x.project(O.lng,O.lat),H=x.project(N.lng,N.lat),q=-Math.atan2(H.y-$.y,H.x-$.x),X=s.MercatorCoordinate.fromLngLat(S);X.y=s.clamp(X.y,-.999975,.999975);const le=X.toLngLat(),W=x.project(le.lng,le.lat),re=s.MercatorCoordinate.fromLngLat(le);re.x+=Mr;const oe=re.toLngLat(),ie=x.project(oe.lng,oe.lat),ne=ru(ie.x-W.x,ie.y-W.y,q),ce=s.MercatorCoordinate.fromLngLat(le);ce.y+=Mr;const Se=ce.toLngLat(),Me=x.project(Se.lng,Se.lat),et=ru(Me.x-W.x,Me.y-W.y,q),qe=Math.abs(ne.x)/Math.abs(et.y),Ge=s.identity([]);s.rotateZ(Ge,Ge,-q*(1-(L?0:P)));const ze=s.identity([]);return s.scale(ze,ze,[1,1-(1-qe)*P,1]),ze[4]=-et.x/et.y*P,s.rotateZ(ze,ze,q),s.multiply$1(ze,Ge,ze),ze}(p.projection,0,p.center,c,i),_=Pl(p);return s.scale(f,f,[_,_,1]),f}function Pl(p){const i=p.projection,c=Dl(p),f=nu(i,p.center),_=nu(i,s.LngLat.convert(i.center));return Math.pow(2,f*c+(1-c)*_)}function Dl(p){const i=p.projection.range;if(!i)return 0;const c=Math.max(p.width,p.height),f=Math.log(c/1024)/Math.LN2;return s.smoothstep(i[0]+f,i[1]+f,p.zoom)}const Mr=1/4e4;function nu(p,i){const c=s.clamp(i.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),f=new s.LngLat(i.lng-180*Mr,c),_=new s.LngLat(i.lng+180*Mr,c),x=p.project(f.lng,c),w=p.project(_.lng,c),S=s.MercatorCoordinate.fromLngLat(f),P=s.MercatorCoordinate.fromLngLat(_),L=w.x-x.x,O=w.y-x.y,N=P.x-S.x,$=P.y-S.y,H=Math.sqrt((N*N+$*$)/(L*L+O*O));return Math.log(H)/Math.LN2}function ru(p,i,c){const f=Math.cos(c),_=Math.sin(c);return{x:p*f-i*_,y:p*_+i*f}}class Ca{constructor(i,c,f,_,x){this.tileSize=512,this._renderWorldCopies=x===void 0||x,this._minZoom=i||0,this._maxZoom=c||22,this._minPitch=f==null?0:f,this._maxPitch=_==null?60:_,this.setProjection(),this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new zl,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new iu,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this._horizonShift=.1}clone(){const i=new Ca(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.setProjection(this.getProjection()),i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i.tileSize=this.tileSize,i.setMaxBounds(this.getMaxBounds()),i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._cameraZoom=this._cameraZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,i?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(i){this._terrainEnabled()&&this._cameraZoom==null&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),i&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(i){i==null&&(i={name:"mercator"}),this.projectionOptions=i;const c=this.projection?this.getProjection():void 0;return this.projection=s.getProjection(i),!R(c,this.getProjection())&&(this._calcMatrices(),!0)}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const c=-i*Math.PI/180;var f;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(f=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f),function(_,x,w){var S=x[0],P=x[1],L=x[2],O=x[3],N=Math.sin(w),$=Math.cos(w);_[0]=S*$+L*N,_[1]=P*$+O*N,_[2]=S*-N+L*$,_[3]=P*-N+O*$}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const c=s.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(i){const c=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const i=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center),-1);return i===-1?(this._cameraZoom=null,!1):(this._centerAltitude=i,!0)}_updateCameraOnTerrain(){this._cameraZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize)}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],f=this.horizonLineFromTop();let _=0,x=0;for(let w=0;w<c.length;w++){const S=new s.pointGeometry(c[w][0]*this.width,f+c[w][1]*(this.height-f)),P=i.pointCoordinate(S);if(!P)continue;const L=1/Math.hypot(P[0]-this._camera.position[0],P[1]-this._camera.position[1]);_+=P[3]*L,x+=L}return x===0?NaN:_/x}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._cameraZoom==null||!this._elevation)return;const i=this._cameraZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),f=this.pixelsPerMeter/this.worldSize*c,_=this._mercatorZfromZoom(i),x=this._mercatorZfromZoom(this._maxZoom),w=Math.max(_-f,x);this._setZoom(this._zoomFromMercatorZ(w))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let f;f=i.z<this._camera.position[2]?[c.x,c.y,c.z]:[i.x,i.y,i.z];const _=s.length(s.sub([],this._camera.position,f));return s.clamp(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let c=!1;if(i.orientation&&!s.exactEquals(i.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(i.orientation)),i.position){const f=[i.position.x,i.position.y,i.position.z];s.exactEquals$1(f,this._camera.position)||(this._setCameraPosition(f),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,c=new Hh;return c.position=new s.MercatorCoordinate(i[0],i[1],i[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(i){if(!s.length$1(i))return!1;s.normalize$1(i,i);const c=s.transformQuat([],[0,0,-1],i),f=s.transformQuat([],[0,-1,0],i);if(f[2]<0)return!1;const _=tu(c,f);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(i){const c=this.zoomScale(this.minZoom)*this.tileSize,f=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;i[2]=s.clamp(i[2],_/f,_/c),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,c,f){this._unmodified=!1,this._edgeInsets.interpolate(i,c,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const c=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(i){const c=[new s.UnwrappedTileID(0,i)];if(this.renderWorldCopies){const f=this.pointCoordinate(new s.pointGeometry(0,0)),_=this.pointCoordinate(new s.pointGeometry(this.width,0)),x=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),w=this.pointCoordinate(new s.pointGeometry(0,this.height)),S=Math.floor(Math.min(f.x,_.x,x.x,w.x)),P=Math.floor(Math.max(f.x,_.x,x.x,w.x)),L=1;for(let O=S-L;O<=P+L;O++)O!==0&&c.push(new s.UnwrappedTileID(O,i))}return c}coveringTiles(i){let c=this.coveringZoomLevel(i);const f=c,_=this.elevation&&!i.isTerrainDEM,x=this.projection.name==="mercator";if(i.minzoom!==void 0&&c<i.minzoom)return[];i.maxzoom!==void 0&&c>i.maxzoom&&(c=i.maxzoom);const w=this.locationCoordinate(this.center),S=1<<c,P=[S*w.x,S*w.y,0],L=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,this.projection.name!=="globe"),O=this.pointCoordinate(this.getCameraPoint()),N=S*s.mercatorZfromAltitude(1,this.center.lat),$=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),H=[S*O.x,S*O.y,$],q=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),X=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,le=i.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,W=i.isTerrainDEM?-le:this._elevation?this._elevation.getMinElevationBelowMSL():0,re=this.projection.isReprojectedInTileSpace?Pl(this):1,oe=Ae=>{const Fe=new s.MercatorCoordinate(Ae.x+25e-6,Ae.y,Ae.z),St=new s.MercatorCoordinate(Ae.x,Ae.y+25e-6,Ae.z),Dt=Ae.toLngLat(),Xt=Fe.toLngLat(),Qe=St.toLngLat(),zt=this.locationCoordinate(Dt),Ut=this.locationCoordinate(Xt),Ci=this.locationCoordinate(Qe),Di=Math.hypot(Ut.x-zt.x,Ut.y-zt.y),Ot=Math.hypot(Ci.x-zt.x,Ci.y-zt.y);return Math.sqrt(Di*Ot)*re/25e-6},ie=Ae=>{const $e=le,Fe=W;return{aabb:s.tileAABB(this,S,0,0,0,Ae,Fe,$e,this.projection),zoom:0,x:0,y:0,minZ:Fe,maxZ:$e,wrap:Ae,fullyVisible:!1}},ne=[];let ce=[];const Se=c,Me=i.reparseOverscaled?f:c,et=Ae=>Ae*Ae,qe=et(($-this._centerAltitude)*N),Ge=Ae=>{if(!this._elevation||!Ae.tileID||!x)return;const $e=this._elevation.getMinMaxForTile(Ae.tileID),Fe=Ae.aabb;$e?(Fe.min[2]=$e.min,Fe.max[2]=$e.max,Fe.center[2]=(Fe.min[2]+Fe.max[2])/2):(Ae.shouldSplit=ze(Ae),Ae.shouldSplit||(Fe.min[2]=Fe.max[2]=Fe.center[2]=this._centerAltitude))},ze=Ae=>{if(Ae.zoom<X)return!0;if(Ae.zoom===Se)return!1;if(Ae.shouldSplit!=null)return Ae.shouldSplit;const $e=Ae.aabb.distanceX(H),Fe=Ae.aabb.distanceY(H);let St=qe;_&&(St=et(Ae.aabb.distanceZ(H)*N));let Dt=1;if(this.projection.isReprojectedInTileSpace&&f<=5){const Qe=Math.pow(2,Ae.zoom),zt=oe(new s.MercatorCoordinate((Ae.x+.5)/Qe,(Ae.y+.5)/Qe));Dt=zt>.85?1:zt}const Xt=$e*$e+Fe*Fe+St;return Xt<et((1<<Se-Ae.zoom)*q*Dt*((Qe,zt)=>{if(zt*et(.707)<Qe)return 1;const Ut=Math.sqrt(zt/Qe);return Ut/(1.4144271570014144+(Math.pow(1.1,Ut-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(St,qe),Xt))};if(this.renderWorldCopies)for(let Ae=1;Ae<=3;Ae++)ne.push(ie(-Ae)),ne.push(ie(Ae));for(ne.push(ie(0));ne.length>0;){const Ae=ne.pop(),$e=Ae.x,Fe=Ae.y;let St=Ae.fullyVisible;if(!St){const Dt=Ae.aabb.intersects(L);if(Dt===0)continue;St=Dt===2}if(Ae.zoom!==Se&&ze(Ae))for(let Dt=0;Dt<4;Dt++){const Xt=($e<<1)+Dt%2,Qe=(Fe<<1)+(Dt>>1),zt={aabb:x?Ae.aabb.quadrant(Dt):s.tileAABB(this,S,Ae.zoom+1,Xt,Qe,Ae.wrap,Ae.minZ,Ae.maxZ,this.projection),zoom:Ae.zoom+1,x:Xt,y:Qe,wrap:Ae.wrap,fullyVisible:St,tileID:void 0,shouldSplit:void 0,minZ:Ae.minZ,maxZ:Ae.maxZ};_&&(zt.tileID=new s.OverscaledTileID(Ae.zoom+1===Se?Me:Ae.zoom+1,Ae.wrap,Ae.zoom+1,Xt,Qe),Ge(zt)),ne.push(zt)}else{const Dt=Ae.zoom===Se?Me:Ae.zoom;if(i.minzoom&&i.minzoom>Dt)continue;const Xt=P[0]-(.5+$e+(Ae.wrap<<Ae.zoom))*(1<<c-Ae.zoom),Qe=P[1]-.5-Fe,zt=Ae.tileID?Ae.tileID:new s.OverscaledTileID(Dt,Ae.wrap,Ae.zoom,$e,Fe);ce.push({tileID:zt,distanceSq:Xt*Xt+Qe*Qe})}}if(this.fogCullDistSq){const Ae=this.fogCullDistSq,$e=this.horizonLineFromTop();ce=ce.filter(Fe=>{const St=[0,0,0,1],Dt=[s.EXTENT,s.EXTENT,0,1],Xt=this.calculateFogTileMatrix(Fe.tileID.toUnwrapped());s.transformMat4$1(St,St,Xt),s.transformMat4$1(Dt,Dt,Xt);const Qe=s.getAABBPointSquareDist(St,Dt);if(Qe===0)return!0;let zt=!1;const Ut=this._elevation;if(Ut&&Qe>Ae&&$e!==0){const Ci=this.calculateProjMatrix(Fe.tileID.toUnwrapped());let Di;i.isTerrainDEM||(Di=Ut.getMinMaxForTile(Fe.tileID)),Di||(Di={min:W,max:le});const Ot=s.furthestTileCorner(this.rotation),ii=[Ot[0]*s.EXTENT,Ot[1]*s.EXTENT,Di.max];s.transformMat4(ii,ii,Ci),zt=(1-ii[1])*this.height*.5<$e}return Qe<Ae||zt})}return ce.sort((Ae,$e)=>Ae.distanceSq-$e.distanceSq).map(Ae=>Ae.tileID)}resize(i,c){this.width=i,this.height=c,this.pixelsToGLUnits=[2/i,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const c=s.clamp(i.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),f=this.projection.project(i.lng,c);return new s.pointGeometry(f.x*this.worldSize,f.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(i,c){const f=this.pointCoordinate(c),_=this.pointCoordinate(this.centerPoint),x=this.locationCoordinate(i);this.setLocation(new s.MercatorCoordinate(x.x-(f.x-_.x),x.y-(f.y-_.y)))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i){return this.projection.locationPoint(this,i)}locationPoint3D(i){return this._coordinatePoint(this.locationCoordinate(i),!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i,c){const f=c?s.mercatorZfromAltitude(c,i.lat):void 0,_=this.projection.project(i.lng,i.lat);return new s.MercatorCoordinate(_.x,_.y,f)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,c){const f=c!=null?c:this._centerAltitude,_=[i.x,i.y,0,1],x=[i.x,i.y,1,1];s.transformMat4$1(_,_,this.pixelMatrixInverse),s.transformMat4$1(x,x,this.pixelMatrixInverse);const w=x[3];s.scale$1(_,_,1/_[3]),s.scale$1(x,x,1/w);const S=_[2],P=x[2];return{p0:_,p1:x,t:S===P?0:(f-S)/(P-S)}}screenPointToMercatorRay(i){const c=[i.x,i.y,0,1],f=[i.x,i.y,1,1];return s.transformMat4$1(c,c,this.pixelMatrixInverse),s.transformMat4$1(f,f,this.pixelMatrixInverse),s.scale$1(c,c,1/c[3]),s.scale$1(f,f,1/f[3]),c[2]=s.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,f[2]=s.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,s.scale$1(c,c,1/this.worldSize),s.scale$1(f,f,1/this.worldSize),new s.Ray([c[0],c[1],c[2]],s.normalize([],s.sub([],f,c)))}rayIntersectionCoordinate(i){const{p0:c,p1:f,t:_}=i,x=s.mercatorZfromAltitude(c[2],this._center.lat),w=s.mercatorZfromAltitude(f[2],this._center.lat);return new s.MercatorCoordinate(s.number(c[0],f[0],_)/this.worldSize,s.number(c[1],f[1],_)/this.worldSize,s.number(x,w,_))}pointCoordinate(i,c=this._centerAltitude){return this.projection.createTileTransform(this,this.worldSize).pointCoordinate(i.x,i.y,c)}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);const c=this.elevation;let f=this.elevation.pointCoordinate(i);if(f)return new s.MercatorCoordinate(f[0],f[1],f[2]);let _=0,x=this.horizonLineFromTop();if(i.y>x)return this.pointCoordinate(i);const w=.02*x,S=i.clone();for(let P=0;P<10&&x-_>w;P++){S.y=s.number(_,x,.66);const L=c.pointCoordinate(S);L?(x=S.y,f=L):_=S.y}return f?new s.MercatorCoordinate(f[0],f[1],f[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){if(this.elevation)return!this.elevation.pointCoordinate(i);{const c=this.horizonLineFromTop();return i.y<c}}_coordinatePoint(i,c){const f=c&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,_=[i.x*this.worldSize,i.y*this.worldSize,f+i.toAltitude(),1];return s.transformMat4$1(_,_,this.pixelMatrix),_[3]>0?new s.pointGeometry(_[0]/_[3],_[1]/_[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(i,c){const f=new s.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),_=new s.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),x=new s.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),w=new s.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let S=this.pointCoordinate(f,i),P=this.pointCoordinate(_,i);const L=this.pointCoordinate(x,c),O=this.pointCoordinate(w,c),N=($,H)=>(H.y-$.y)/(H.x-$.x);return S.y>1&&P.y>=0?S=new s.MercatorCoordinate((1-O.y)/N(O,S)+O.x,1):S.y<0&&P.y<=1&&(S=new s.MercatorCoordinate(-O.y/N(O,S)+O.x,0)),P.y>1&&S.y>=0?P=new s.MercatorCoordinate((1-L.y)/N(L,P)+L.x,1):P.y<0&&S.y<=1&&(P=new s.MercatorCoordinate(-L.y/N(L,P)+L.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(S)).extend(this.coordinateLocation(P)).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(L))}_getBounds3D(){const i=this.elevation;if(!i.visibleDemTiles.length)return this._getBounds(0,0);const c=i.visibleDemTiles.reduce((f,_)=>{if(_.dem){const x=_.dem.tree;f.min=Math.min(f.min,x.minimums[0]),f.max=Math.max(f.max,x.maximums[0])}return f},{min:Number.MAX_VALUE,max:0});return this._getBounds(c.min*i.exaggeration(),c.max*i.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(i=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,f=this.height/2-c*(1-this._horizonShift);return i?Math.max(0,f):f}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,c){return this.projection.createTileTransform(this,c).createTileMatrix(i)}calculateDistanceTileData(i){const c=i.key,f=this._distanceTileDataCache;if(f[c])return f[c];const _=i.canonical,x=1/this.height,w=this.cameraWorldSize/this.zoomScale(_.z),S=(_.x+Math.pow(2,_.z)*i.wrap)*w,P=_.y*w,L=this.point,O=this.angle,N=Math.sin(-O),$=-Math.cos(-O);return f[c]={bearing:[N,$],center:[(L.x-S)*x,(L.y-P)*x],scale:w/s.EXTENT*x},f[c]}calculateFogTileMatrix(i){const c=i.key,f=this._fogTileMatrixCache;if(f[c])return f[c];const _=this.calculatePosMatrix(i,this.cameraWorldSize);return s.multiply$1(_,this.worldToFogMatrix,_),f[c]=new Float32Array(_),f[c]}calculateProjMatrix(i,c=!1){const f=i.key,_=c?this._alignedProjMatrixCache:this._projMatrixCache;if(_[f])return _[f];const x=this.calculatePosMatrix(i,this.worldSize);return s.multiply$1(x,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,x),_[f]=new Float32Array(x),_[f]}calculatePixelsToTileUnitsMatrix(i){const c=i.tileID.key,f=this._pixelsToTileUnitsCache;if(f[c])return f[c];const _=function(x,w){const{scale:S}=x.tileTransform,P=S*s.EXTENT/(x.tileSize*Math.pow(2,w.zoom-x.tileID.overscaledZ+x.tileID.canonical.z));return L=new Float32Array(4),$=(O=w.inverseAdjustmentMatrix)[1],H=O[2],q=O[3],le=(N=[P,P])[1],L[0]=O[0]*(X=N[0]),L[1]=$*X,L[2]=H*le,L[3]=q*le,L;var L,O,N,$,H,q,X,le}(i,this);return f[c]=_,f[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const i=this._elevation;this._updateCameraState();const c=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,f=this._computeCameraPosition(c),_=this._camera.forward(),x=s.mercatorZfromAltitude(1,this._center.lat);f[2]/=x,_[2]/=x,s.normalize(_,_);const w=i.raycast(f,_,i.exaggeration());if(w){const S=s.scaleAndAdd([],f,_,w),P=new s.MercatorCoordinate(S[0],S[1],s.mercatorZfromAltitude(S[2],s.latFromMercatorY(S[1]))),L=(P.z+s.length([P.x-f[0],P.y-f[1],P.z-f[2]*x]))*this._projectionScaler;this._cameraZoom=this._zoomFromMercatorZ(L),this._centerAltitude=P.toAltitude(),this._center=this.coordinateLocation(P),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const i=this._elevation;this._updateCameraState();const c=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,f=this._computeCameraPosition(c),_=i.getAtPointOrZero(new s.MercatorCoordinate(...f)),x=this._minimumHeightOverTerrain()*Math.cos(s.degToRad(this._maxPitch)),w=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*_;if(w<x){const S=this.locationCoordinate(this._center,this._centerAltitude),P=[S.x-f[0],S.y-f[1],S.z-f[2]],L=s.length(P);P[2]-=(x-w)/this._projectionScaler;const O=s.length(P);if(O===0)return;s.scale$2(P,P,L/O*this._projectionScaler),this._camera.position=[S.x-P[0],S.y-P[1],S.z*this._projectionScaler-P[2]],this._camera.orientation=tu(P,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const N=this.center;return N.lat=s.clamp(N.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(N.lng=s.clamp(N.lng,this.minLng,this.maxLng)),this.center=N,void(this._constraining=!1)}const i=this._unmodified,{x:c,y:f}=this.point;let _=0,x=c,w=f;const S=this.width/2,P=this.height/2,L=this.worldMinY*this.scale,O=this.worldMaxY*this.scale;if(f-P<L&&(w=L+P),f+P>O&&(w=O-P),O-L<this.height&&(_=Math.max(_,this.height/(O-L)),w=(O+L)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const N=this.worldMinX*this.scale,$=this.worldMaxX*this.scale,H=this.worldSize/2-(N+$)/2;x=(c+H+this.worldSize)%this.worldSize-H,x-S<N&&(x=N+S),x+S>$&&(x=$-S),$-N<this.width&&(_=Math.max(_,this.width/($-N)),x=($+N)/2)}x===c&&w===f||(this.center=this.unproject(new s.pointGeometry(x,w))),_&&(this.zoom+=this.scaleZoom(_)),this._constrainCameraAltitude(),this._unmodified=i,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this._fov/2,c=this.centerOffset,f=this.pixelsPerMeter;this._projectionScaler=f/(s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize),this.cameraToCenterDistance=.5/Math.tan(i)*this.height*this._projectionScaler,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const _=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?f:1),x=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);x[8]=2*-c.x/this.width,x[9]=2*c.y/this.height;let w=s.mul([],x,_);if(this.projection.isReprojectedInTileSpace){const ie=this.locationCoordinate(this.center),ne=s.identity([]);s.translate(ne,ne,[ie.x*this.worldSize,ie.y*this.worldSize,0]),s.multiply$1(ne,ne,Xh(this)),s.translate(ne,ne,[-ie.x*this.worldSize,-ie.y*this.worldSize,0]),s.multiply$1(w,w,ne),this.inverseAdjustmentMatrix=function(ce){const Se=Xh(ce,!0);return D([],[Se[0],Se[1],Se[4],Se[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],w,[this.worldSize,this.worldSize,this.worldSize/f,1]),this.projMatrix=w,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const S=new Float32Array(16);s.identity(S),s.scale(S,S,[1,-1,1]),s.rotateX(S,S,this._pitch),s.rotateZ(S,S,this.angle);const P=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),L=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;P[8]=2*-c.x/this.width,P[9]=2*(c.y+L)/this.height,this.skyboxMatrix=s.multiply$1(S,P,S);const O=this.point,N=O.x,$=O.y,H=this.width%2/2,q=this.height%2/2,X=Math.cos(this.angle),le=Math.sin(this.angle),W=N-Math.round(N)+X*H+le*q,re=$-Math.round($)+X*q+le*H,oe=new Float64Array(w);if(s.translate(oe,oe,[W>.5?W-1:W,re>.5?re-1:re,0]),this.alignedProjMatrix=oe,w=s.create(),s.scale(w,w,[this.width/2,-this.height/2,1]),s.translate(w,w,[1,-1,0]),this.labelPlaneMatrix=w,w=s.create(),s.scale(w,w,[1,-1,1]),s.translate(w,w,[-1,-1,0]),s.scale(w,w,[2/this.width,2/this.height,1]),this.glCoordMatrix=w,this.pixelMatrix=s.multiply$1(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},w=s.invert(new Float64Array(16),this.pixelMatrix),!w)throw new Error("failed to invert matrix");this.pixelMatrixInverse=w,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSize,c=this.cameraPixelsPerMeter,f=this._camera.position,_=1/this.height,x=[i,i,c];s.scale$2(x,x,_),s.scale$2(f,f,-1),s.multiply$2(f,f,x);const w=s.create();s.translate(w,w,f),s.scale(w,w,x),this.mercatorFogMatrix=w,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,c,_)}_computeCameraPosition(i){const c=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,f=this._camera.forward(),_=this.point,x=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)*c-i/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-f[0]*x,_.y/this.worldSize-f[1]*x,i/this.worldSize*this._centerAltitude-f[2]*x]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),f=i[2];let _=1;f>0&&(_=Math.min((c-this._camera.position[2])/f,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,i,_),this._updateStateFromCamera()}_updateStateFromCamera(){const i=this._camera.position,c=this._camera.forward(),{pitch:f,bearing:_}=this._camera.getPitchBearing(),x=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,w=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),S=Math.max((i[2]-x)/Math.cos(f),w),P=this._zoomFromMercatorZ(S);s.scaleAndAdd(i,i,c,S),this._pitch=s.clamp(f,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(_,-Math.PI,Math.PI),this._setZoom(s.clamp(P,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=this.coordinateLocation(new s.MercatorCoordinate(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min((this._cameraZoom!=null?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(i,c){const f=Math.min(i.x,c.x),_=Math.max(i.x,c.x),x=Math.min(i.y,c.y),w=Math.max(i.y,c.y);if(x<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const S=[new s.pointGeometry(f,x),new s.pointGeometry(_,w),new s.pointGeometry(f,w),new s.pointGeometry(_,x)],P=this.renderWorldCopies?-3:0,L=this.renderWorldCopies?4:1;for(const O of S){const N=this.pointRayIntersection(O);if(N.t<0)return!0;const $=this.rayIntersectionCoordinate(N);if($.x<P||$.y<0||$.x>L||$.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(i,c){const f=s.length(s.sub([],this._camera.position,i)),_=this._zoomFromMercatorZ(f)+c;return f-this._mercatorZfromZoom(_)}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,i))}}function Bo(p,i){let c=!1,f=null;const _=()=>{f=null,c&&(p(),f=setTimeout(_,i),c=!1)};return()=>(c=!0,f||_(),f)}class Kh{constructor(i){this._hashName=i&&encodeURIComponent(i),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Bo(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,s.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return s.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(i){const c=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,_=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,_),w=Math.round(c.lng*x)/x,S=Math.round(c.lat*x)/x,P=this._map.getBearing(),L=this._map.getPitch();let O="";if(O+=i?`/${w}/${S}/${f}`:`${f}/${S}/${w}`,(P||L)&&(O+="/"+Math.round(10*P)/10),L&&(O+=`/${Math.round(L)}`),this._hashName){const N=this._hashName;let $=!1;const H=s.window.location.hash.slice(1).split("&").map(q=>{const X=q.split("=")[0];return X===N?($=!0,`${X}=${O}`):q}).filter(q=>q);return $||H.push(`${N}=${O}`),`#${H.join("&")}`}return`#${O}`}_getCurrentHash(){const i=s.window.location.hash.replace("#","");if(this._hashName){let c;return i.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._getCurrentHash();if(i.length>=3&&!i.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:c,pitch:+(i[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,i)}}const co={linearity:.3,easing:s.bezier(0,0,.3,1)},As=s.extend({deceleration:2500,maxSpeed:1400},co),Yh=s.extend({deceleration:20,maxSpeed:1400},co),ou=s.extend({deceleration:1e3,maxSpeed:360},co),bi=s.extend({deceleration:1e3,maxSpeed:90},co);class Ll{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,c=s.exported.now();for(;i.length>0&&c-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)c.zoom+=x.zoomDelta||0,c.bearing+=x.bearingDelta||0,c.pitch+=x.pitchDelta||0,x.panDelta&&c.pan._add(x.panDelta),x.around&&(c.around=x.around),x.pinchAround&&(c.pinchAround=x.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(c.pan.mag()){const x=Aa(c.pan.mag(),f,s.extend({},As,i||{}));_.offset=c.pan.mult(x.amount/c.pan.mag()),_.center=this._map.transform.center,Rl(_,x)}if(c.zoom){const x=Aa(c.zoom,f,Yh);_.zoom=this._map.transform.zoom+x.amount,Rl(_,x)}if(c.bearing){const x=Aa(c.bearing,f,ou);_.bearing=this._map.transform.bearing+s.clamp(x.amount,-179,179),Rl(_,x)}if(c.pitch){const x=Aa(c.pitch,f,bi);_.pitch=this._map.transform.pitch+x.amount,Rl(_,x)}if(_.zoom||_.bearing){const x=c.pinchAround===void 0?c.around:c.pinchAround;_.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),s.extend(_,{noMoveStart:!0})}}function Rl(p,i){(!p.duration||p.duration<i.duration)&&(p.duration=i.duration,p.easing=i.easing)}function Aa(p,i,c){const{maxSpeed:f,linearity:_,deceleration:x}=c,w=s.clamp(p*_/(i/1e3),-f,f),S=Math.abs(w)/(x*_);return{easing:c.easing,duration:1e3*S,amount:w*(S/2)}}class kn extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,f,_={}){const x=U.mousePos(c.getCanvasContainer(),f),w=c.unproject(x);super(i,s.extend({point:x,lngLat:w,originalEvent:f},_)),this._defaultPrevented=!1,this.target=c}}class Ol extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,f){const _=i==="touchend"?f.changedTouches:f.touches,x=U.touchPos(c.getCanvasContainer(),_),w=x.map(P=>c.unproject(P)),S=x.reduce((P,L,O,N)=>P.add(L.div(N.length)),new s.pointGeometry(0,0));super(i,{points:x,point:S,lngLats:w,lngLat:c.unproject(S),originalEvent:f}),this._defaultPrevented=!1}}class _f extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,f){super(i,{originalEvent:f}),this._defaultPrevented=!1}}class Jh{constructor(i,c){this._map=i,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new _f(i.type,this._map,i))}mousedown(i,c){return this._mousedownPos=c,this._firePreventable(new kn(i.type,this._map,i))}mouseup(i){this._map.fire(new kn(i.type,this._map,i))}preclick(i){const c=s.extend({},i);c.type="preclick",this._map.fire(new kn(c.type,this._map,c))}click(i,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(i),this._map.fire(new kn(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new kn(i.type,this._map,i))}mouseover(i){this._map.fire(new kn(i.type,this._map,i))}mouseout(i){this._map.fire(new kn(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Ol(i.type,this._map,i))}touchmove(i){this._map.fire(new Ol(i.type,this._map,i))}touchend(i){this._map.fire(new Ol(i.type,this._map,i))}touchcancel(i){this._map.fire(new Ol(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class yf{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(i){this._map.fire(new kn(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new kn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new kn(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class su{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,c){this.isEnabled()&&i.shiftKey&&i.button===0&&(U.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(i,c){if(!this._active)return;const f=c;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=f,this._box||(this._box=U.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const x=Math.min(_.x,f.x),w=Math.max(_.x,f.x),S=Math.min(_.y,f.y),P=Math.max(_.y,f.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${x}px,${S}px)`,this._box.style.width=w-x+"px",this._box.style.height=P-S+"px")})}mouseupWindow(i,c){if(!this._active||i.button!==0)return;const f=this._startPos,_=c;if(this.reset(),U.suppressClick(),f.x!==_.x||f.y!==_.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:x=>x.fitScreenCoordinates(f,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),U.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,c){return this._map.fire(new s.Event(i,{originalEvent:c}))}}function Ms(p,i){const c={};for(let f=0;f<p.length;f++)c[p[f].identifier]=i[f];return c}class Ma{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,c,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),f.length===this.numTouches&&(this.centroid=function(_){const x=new s.pointGeometry(0,0);for(const w of _)x._add(w);return x.div(_.length)}(c),this.touches=Ms(f,c)))}touchmove(i,c,f){if(this.aborted||!this.centroid)return;const _=Ms(f,c);for(const x in this.touches){const w=this.touches[x],S=_[x];(!S||S.dist(w)>30)&&(this.aborted=!0)}}touchend(i,c,f){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Ia{constructor(i){this.singleTap=new Ma(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,c,f){this.singleTap.touchstart(i,c,f)}touchmove(i,c,f){this.singleTap.touchmove(i,c,f)}touchend(i,c,f){const _=this.singleTap.touchend(i,c,f);if(_){const x=i.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(_)<30;if(x&&w||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class au{constructor(){this._zoomIn=new Ia({numTouches:1,numTaps:2}),this._zoomOut=new Ia({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,c,f){this._zoomIn.touchstart(i,c,f),this._zoomOut.touchstart(i,c,f)}touchmove(i,c,f){this._zoomIn.touchmove(i,c,f),this._zoomOut.touchmove(i,c,f)}touchend(i,c,f){const _=this._zoomIn.touchend(i,c,f),x=this._zoomOut.touchend(i,c,f);return _?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(_)},{originalEvent:i})}):x?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(x)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Qh={0:1,2:2};class Is{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(i,c){return!1}_move(i,c){return{}}mousedown(i,c){if(this._lastPoint)return;const f=U.mouseButton(i);this._correctButton(i,f)&&(this._lastPoint=c,this._eventButton=f)}mousemoveWindow(i,c){const f=this._lastPoint;if(f){if(i.preventDefault(),function(_,x){const w=Qh[x];return _.buttons===void 0||(_.buttons&w)!==w}(i,this._eventButton))this.reset();else if(this._moved||!(c.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(f,c)}}mouseupWindow(i){this._lastPoint&&U.mouseButton(i)===this._eventButton&&(this._moved&&U.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bl extends Is{mousedown(i,c){super.mousedown(i,c),this._lastPoint&&(this._active=!0)}_correctButton(i,c){return c===0&&!i.ctrlKey}_move(i,c){return{around:c,panDelta:c.sub(i)}}}class gr extends Is{_correctButton(i,c){return c===0&&i.ctrlKey||c===2}_move(i,c){const f=.8*(c.x-i.x);if(f)return this._active=!0,{bearingDelta:f}}contextmenu(i){i.preventDefault()}}class lu extends Is{_correctButton(i,c){return c===0&&i.ctrlKey||c===2}_move(i,c){const f=-.5*(c.y-i.y);if(f)return this._active=!0,{pitchDelta:f}}contextmenu(i){i.preventDefault()}}class ed{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(i,c,f){return this._calculateTransform(i,c,f)}touchmove(i,c,f){if(this._active&&!(f.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(f.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.preventDefault(),this._calculateTransform(i,c,f)}}touchend(i,c,f){this._calculateTransform(i,c,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,c,f){f.length>0&&(this._active=!0);const _=Ms(f,c),x=new s.pointGeometry(0,0),w=new s.pointGeometry(0,0);let S=0;for(const L in _){const O=_[L],N=this._touches[L];N&&(x._add(O),w._add(O.sub(N)),S++,_[L]=O)}if(this._touches=_,S<this._minTouches||!w.mag())return;const P=w.div(S);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(S),panDelta:P}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=U.create("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class Fl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(i){}_move(i,c,f){return{}}touchstart(i,c,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([c[0],c[1]]))}touchmove(i,c,f){if(!this._firstTwoTouches)return;i.preventDefault();const[_,x]=this._firstTwoTouches,w=uo(f,c,_),S=uo(f,c,x);if(!w||!S)return;const P=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],P,i)}touchend(i,c,f){if(!this._firstTwoTouches)return;const[_,x]=this._firstTwoTouches,w=uo(f,c,_),S=uo(f,c,x);w&&S||(this._active&&U.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function uo(p,i,c){for(let f=0;f<p.length;f++)if(p[f].identifier===c)return i[f]}function cu(p,i){return Math.log(p/i)/Math.LN2}class Nl extends Fl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,c){const f=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(cu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:cu(this._distance,f),pinchAround:c}}}function Ul(p,i){return 180*p.angleWith(i)/Math.PI}class jl extends Fl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,c){const f=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ul(this._vector,f),pinchAround:c}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const c=25/(Math.PI*this._minDiameter)*360,f=Ul(i,this._startVector);return Math.abs(f)<c}}function Vl(p){return Math.abs(p.y)>Math.abs(p.x)}class td extends Fl{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(i){this._lastPoints=i,Vl(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,c,f){const _=i[0].sub(this._lastPoints[0]),x=i[1].sub(this._lastPoints[1]);if(!(this._map._cooperativeGestures&&f.touches.length<3)&&(this._valid=this.gestureBeginsVertically(_,x,f.timeStamp),this._valid))return this._lastPoints=i,this._active=!0,{pitchDelta:(_.y+x.y)/2*-.5}}gestureBeginsVertically(i,c,f){if(this._valid!==void 0)return this._valid;const _=i.mag()>=2,x=c.mag()>=2;if(!_&&!x)return;if(!_||!x)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const w=i.y>0==c.y>0;return Vl(i)&&Vl(c)&&w}}const ks={panStep:100,bearingStep:15,pitchStep:10};class vf{constructor(){const i=ks;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let c=0,f=0,_=0,x=0,w=0;switch(i.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:i.shiftKey?f=-1:(i.preventDefault(),x=-1);break;case 39:i.shiftKey?f=1:(i.preventDefault(),x=1);break;case 38:i.shiftKey?_=1:(i.preventDefault(),w=-1);break;case 40:i.shiftKey?_=-1:(i.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(f=0,_=0),{cameraAnimation:S=>{const P=S.getZoom();S.easeTo({duration:300,easeId:"keyboardHandler",easing:xf,zoom:c?Math.round(P)+c*(i.shiftKey?2:1):P,bearing:S.getBearing()+f*this._bearingStep,pitch:S.getPitch()+_*this._pitchStep,offset:[-x*this._panStep,-w*this._panStep],center:S.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function xf(p){return p*(2-p)}const uu=4.000244140625;class $l{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=i.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const f=s.exported.now(),_=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,c!==0&&c%uu==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(_*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),i.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=i,this._delta-=c,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=U.mousePos(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform,c=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(this._delta!==0){const P=this._type==="wheel"&&Math.abs(this._delta)>uu?this._wheelZoomRate:this._defaultZoomRate;let L=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&L!==0&&(L=1/L);const O=c(),N=Math.pow(2,O),$=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):N;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom($*L))),this._type==="wheel"&&(this._startZoom=c(),this._easing=this._smoothOutEasing(200)),this._delta=0}const f=typeof this._targetZoom=="number"?this._targetZoom:c(),_=this._startZoom,x=this._easing;let w,S=!1;if(this._type==="wheel"&&_&&x){const P=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),L=x(P);w=s.number(_,f,L),P<1?this._frameId||(this._frameId=!0):S=!0}else w=f,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:w-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let c=s.ease;if(this._prevEase){const f=this._prevEase,_=(s.exported.now()-f.start)/f.duration,x=f.easing(_+.01)-f.easing(_),w=.27/Math.sqrt(x*x+1e-4)*.01,S=Math.sqrt(.0729-w*w);c=s.bezier(w,S,.25,1)}return this._prevEase={start:s.exported.now(),duration:i,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=U.create("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!s.window.document.fullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class hu{constructor(i,c){this._clickZoom=i,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class id{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,c){return i.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:f.getZoom()+(i.shiftKey?-1:1),around:f.unproject(c)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nd{constructor(){this._tap=new Ia({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(i,c,f){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=c[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(i,c,f))}touchmove(i,c,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const _=c[0],x=_.y-this._swipePoint.y;return this._swipePoint=_,i.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(i,c,f)}touchend(i,c,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(i,c,f)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gl{constructor(i,c,f){this._el=i,this._mousePan=c,this._touchPan=f}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class du{constructor(i,c,f){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=c,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class rd{constructor(i,c,f,_){this._el=i,this._touchZoom=c,this._touchRotate=f,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ka=p=>p.zoom||p.drag||p.pitch||p.rotate;class od extends s.Event{}class sd{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,c){const f=s.sub([],c,i);this.radius=s.length(f[2]<0?s.div([],f,this.constants):[f[0],f[1],0])}projectRay(i){s.div(i,i,this.constants),s.normalize(i,i),s.mul$1(i,i,this.constants);const c=s.scale$2([],i,this.radius);if(c[2]>0){const f=s.scale$2([],[0,0,1],s.dot(c,[0,0,1])),_=s.scale$2([],s.normalize([],[c[0],c[1],0]),this.radius),x=s.add([],c,s.scale$2([],s.sub([],s.add([],_,f),c),2));c[0]=x[0],c[1]=x[1]}return c}}function za(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class zs{constructor(i,c){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ll(i),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new sd,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),s.bindAll(["handleEvent","handleWindowEvent"],this);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[_,x,w]of this._listeners)_.addEventListener(x,_===s.window.document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[i,c,f]of this._listeners)i.removeEventListener(c,i===s.window.document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(i){const c=this._map,f=c.getCanvasContainer();this._add("mapEvent",new Jh(c,i));const _=c.boxZoom=new su(c,i);this._add("boxZoom",_);const x=new au,w=new id;c.doubleClickZoom=new hu(w,x),this._add("tapZoom",x),this._add("clickZoom",w);const S=new nd;this._add("tapDragZoom",S);const P=c.touchPitch=new td(c);this._add("touchPitch",P);const L=new gr(i),O=new lu(i);c.dragRotate=new du(i,L,O),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const N=new Bl(i),$=new ed(c,i);c.dragPan=new Gl(f,N,$),this._add("mousePan",N),this._add("touchPan",$,["touchZoom","touchRotate"]);const H=new jl,q=new Nl;c.touchZoomRotate=new rd(f,q,H,S),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",q,["touchPan","touchRotate"]),this._add("blockableMapEvent",new yf(c));const X=c.scrollZoom=new $l(c,this);this._add("scrollZoom",X,["mousePan"]);const le=c.keyboard=new vf;this._add("keyboard",le);for(const W of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[W]&&c[W].enable(i[W])}_add(i,c,f){this._handlers.push({handlerName:i,handler:c,allowed:f}),this._handlersById[i]=c}stop(i){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(ka(this._eventsInProgress))||this.isZooming()}_blockedByActive(i,c,f){for(const _ in i)if(_!==f&&(!c||c.indexOf(_)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const c=[];for(const f of i)this._el.contains(f.target)&&c.push(f);return c}handleEvent(i,c){this._updatingCamera=!0;const f=i.type==="renderFrame",_=f?void 0:i,x={needsRenderFrame:!1},w={},S={},P=i.touches?this._getMapTouches(i.touches):void 0,L=P?U.touchPos(this._el,P):f?void 0:U.mousePos(this._el,i);for(const{handlerName:$,handler:H,allowed:q}of this._handlers){if(!H.isEnabled())continue;let X;this._blockedByActive(S,q,$)?H.reset():H[c||i.type]&&(X=H[c||i.type](i,L,P),this.mergeHandlerResult(x,w,X,$,_),X&&X.needsRenderFrame&&this._triggerRenderFrame()),(X||H.isActive())&&(S[$]=H)}const O={};for(const $ in this._previousActiveHandlers)S[$]||(O[$]=_);this._previousActiveHandlers=S,(Object.keys(O).length||za(x))&&(this._changes.push([x,w,O]),this._triggerRenderFrame()),(Object.keys(S).length||za(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=x;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))}mergeHandlerResult(i,c,f,_,x){if(!f)return;s.extend(i,f);const w={handlerName:_,originalEvent:f.originalEvent||x};f.zoomDelta!==void 0&&(c.zoom=w),f.panDelta!==void 0&&(c.drag=w),f.pitchDelta!==void 0&&(c.pitch=w),f.bearingDelta!==void 0&&(c.rotate=w)}_applyChanges(){const i={},c={},f={};for(const[_,x,w]of this._changes)_.panDelta&&(i.panDelta=(i.panDelta||new s.pointGeometry(0,0))._add(_.panDelta)),_.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(i.around=_.around),_.aroundCoord!==void 0&&(i.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(i.pinchAround=_.pinchAround),_.noInertia&&(i.noInertia=_.noInertia),s.extend(c,x),s.extend(f,w);this._updateMapTransform(i,c,f),this._changes=[]}_updateMapTransform(i,c,f){const _=this._map,x=_.transform,w=re=>[re.x,re.y,re.z];if((re=>{const oe=this._eventsInProgress.drag;return oe&&!this._handlersById[oe.handlerName].isActive()})()&&!za(i)){const re=x.zoom;x.cameraElevationReference="sea",x.recenterOnTerrain(),x.cameraElevationReference="ground",re!==x.zoom&&this._map._update(!0)}if(!za(i))return this._fireEvents(c,f,!0);let{panDelta:S,zoomDelta:P,bearingDelta:L,pitchDelta:O,around:N,aroundCoord:$,pinchAround:H}=i;H!==void 0&&(N=H),(re=>c.drag&&!this._eventsInProgress.drag)()&&N&&(this._dragOrigin=w(x.pointCoordinate3D(N)),this._trackingEllipsoid.setup(x._camera.position,this._dragOrigin)),x.cameraElevationReference="sea",_._stop(!0),N=N||_.transform.centerPoint,L&&(x.bearing+=L),O&&(x.pitch+=O),x._updateCameraState();const q=[0,0,0];if(S){const re=x.pointCoordinate(N),oe=x.pointCoordinate(N.sub(S));re&&oe&&(q[0]=oe.x-re.x,q[1]=oe.y-re.y)}const X=x.zoom,le=[0,0,0];if(P){const re=w($||x.pointCoordinate3D(N)),oe={dir:s.normalize([],s.sub([],re,x._camera.position))};if(oe.dir[2]<0){const ie=x.zoomDeltaToMovement(re,P);s.scale$2(le,oe.dir,ie)}}const W=s.add(q,q,le);x._translateCameraConstrained(W),P&&Math.abs(x.zoom-X)>1e-4&&x.recenterOnTerrain(),x.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(c,f,!0)}_fireEvents(i,c,f){const _=ka(this._eventsInProgress),x=ka(i),w={};for(const O in i){const{originalEvent:N}=i[O];this._eventsInProgress[O]||(w[`${O}start`]=N),this._eventsInProgress[O]=i[O]}!_&&x&&this._fireEvent("movestart",x.originalEvent);for(const O in w)this._fireEvent(O,w[O]);x&&this._fireEvent("move",x.originalEvent);for(const O in i){const{originalEvent:N}=i[O];this._fireEvent(O,N)}const S={};let P;for(const O in this._eventsInProgress){const{handlerName:N,originalEvent:$}=this._eventsInProgress[O];this._handlersById[N].isActive()||(delete this._eventsInProgress[O],P=c[N]||$,S[`${O}end`]=P)}for(const O in S)this._fireEvent(O,S[O]);const L=ka(this._eventsInProgress);if(f&&(_||x)&&!L){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;O?(N(O.bearing||this._map.getBearing())&&(O.bearing=0),this._map.easeTo(O,{originalEvent:P})):(this._map.fire(new s.Event("moveend",{originalEvent:P})),N(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,c){this._map.fire(new s.Event(i,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new od("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const pu="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class ad extends s.Evented{constructor(i,c){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=c.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,c){return this.jumpTo({center:i},c)}panBy(i,c,f){return i=s.pointGeometry.convert(i).mult(-1),this.panTo(this.transform.center,s.extend({offset:i},c),f)}panTo(i,c,f){return this.easeTo(s.extend({center:i},c),f)}getZoom(){return this.transform.zoom}setZoom(i,c){return this.jumpTo({zoom:i},c),this}zoomTo(i,c,f){return this.easeTo(s.extend({zoom:i},c),f)}zoomIn(i,c){return this.zoomTo(this.getZoom()+1,i,c),this}zoomOut(i,c){return this.zoomTo(this.getZoom()-1,i,c),this}getBearing(){return this.transform.bearing}setBearing(i,c){return this.jumpTo({bearing:i},c),this}getPadding(){return this.transform.padding}setPadding(i,c){return this.jumpTo({padding:i},c),this}rotateTo(i,c,f){return this.easeTo(s.extend({bearing:i},c),f)}resetNorth(i,c){return this.rotateTo(0,s.extend({duration:1e3},i),c),this}resetNorthPitch(i,c){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},i),c),this}snapToNorth(i,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,c):this}getPitch(){return this.transform.pitch}setPitch(i,c){return this.jumpTo({pitch:i},c),this}cameraForBounds(i,c){i=s.LngLatBounds.convert(i);const f=c&&c.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),f,c)}_extendCameraOptions(i){const c={top:0,bottom:0,right:0,left:0};if(typeof(i=s.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding=="number"){const f=i.padding;i.padding={top:f,bottom:f,right:f,left:f}}return i.padding=s.extend(c,i.padding),i}_cameraForBoxAndBearing(i,c,f,_){const x=this._extendCameraOptions(_),w=this.transform,S=w.padding,P=w.project(s.LngLat.convert(i)),L=w.project(s.LngLat.convert(c)),O=P.rotate(-s.degToRad(f)),N=L.rotate(-s.degToRad(f)),$=new s.pointGeometry(Math.max(O.x,N.x),Math.max(O.y,N.y)),H=new s.pointGeometry(Math.min(O.x,N.x),Math.min(O.y,N.y)),q=$.sub(H),X=(w.width-(S.left+S.right+x.padding.left+x.padding.right))/q.x,le=(w.height-(S.top+S.bottom+x.padding.top+x.padding.bottom))/q.y;if(le<0||X<0)return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const W=Math.min(w.scaleZoom(w.scale*Math.min(X,le)),x.maxZoom),re=typeof x.offset.x=="number"?new s.pointGeometry(x.offset.x,x.offset.y):s.pointGeometry.convert(x.offset),oe=new s.pointGeometry((x.padding.left-x.padding.right)/2,(x.padding.top-x.padding.bottom)/2).rotate(f*Math.PI/180),ie=re.add(oe).mult(w.scale/w.zoomScale(W));return{center:w.unproject(P.add(L).div(2).sub(ie)),zoom:W,bearing:f}}_cameraForBox(i,c,f,_,x){const w=this._extendCameraOptions(x);f=f||0,_=_||0,i=s.LngLat.convert(i),c=s.LngLat.convert(c);const S=this.transform.clone();S.padding=w.padding;const P=this.getFreeCameraOptions(),L=new s.LngLat(.5*(i.lng+c.lng),.5*(i.lat+c.lat)),O=.5*(f+_);if(S._camera.position[2]<s.mercatorZfromAltitude(O,L.lat))return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");P.lookAtPoint(L),S.setFreeCameraOptions(P);const N=s.MercatorCoordinate.fromLngLat(i),$=s.MercatorCoordinate.fromLngLat(c),H=S.pointRayIntersection(S.centerPoint,O),q=[(X=S.rayIntersectionCoordinate(H)).x,X.y,X.z];var X;const le=S.screenPointToMercatorRay(S.centerPoint),W=S.projection.name!=="globe";let re,oe=0;do{const ie=Math.floor(S.zoom),ne=1<<ie,ce=Math.min(ne*N.x,ne*$.x),Se=Math.min(ne*N.y,ne*$.y),Me=Math.max(ne*N.x,ne*$.x),et=Math.max(ne*N.y,ne*$.y),qe=new s.Aabb([ce,Se,f],[Me,et,_]),Ge=s.Frustum.fromInvProjectionMatrix(S.invProjMatrix,S.worldSize,ie,W);if(qe.intersects(Ge)!==2){re&&(S._camera.position=s.scaleAndAdd([],S._camera.position,le.dir,-re),S._updateStateFromCamera());break}const ze=s.sub([],S._camera.position,q);re=.5*s.length(ze),S._camera.position=s.scaleAndAdd([],S._camera.position,le.dir,re);try{S._updateStateFromCamera()}catch{return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++oe<10);return{center:S.center,zoom:S.zoom,bearing:S.bearing,pitch:S.pitch}}fitBounds(i,c,f){return this._fitInternal(this.cameraForBounds(i,c),c,f)}_raycastElevationBox(i,c){const f=this.transform.elevation;if(!f)return;const _=new s.pointGeometry(i.x,c.y),x=new s.pointGeometry(c.x,i.y),w=f.pointCoordinate(i);if(!w)return;const S=f.pointCoordinate(c);if(!S)return;const P=f.pointCoordinate(_);if(!P)return;const L=f.pointCoordinate(x);if(!L)return;const O=new s.MercatorCoordinate(w[0],w[1]).toLngLat(),N=new s.MercatorCoordinate(S[0],S[1]).toLngLat(),$=new s.MercatorCoordinate(P[0],P[1]).toLngLat(),H=new s.MercatorCoordinate(L[0],L[1]).toLngLat(),q=Math.min(O.lng,Math.min(N.lng,Math.min($.lng,H.lng))),X=Math.min(O.lat,Math.min(N.lat,Math.min($.lat,H.lat))),le=Math.max(O.lng,Math.max(N.lng,Math.max($.lng,H.lng))),W=Math.max(O.lat,Math.max(N.lat,Math.max($.lat,H.lat))),re=Math.min(w[3],Math.min(S[3],Math.min(P[3],L[3]))),oe=Math.max(w[3],Math.max(S[3],Math.max(P[3],L[3])));return{minLngLat:new s.LngLat(q,X),maxLngLat:new s.LngLat(le,W),minAltitude:re,maxAltitude:oe}}fitScreenCoordinates(i,c,f,_,x){let w,S,P,L;const O=s.pointGeometry.convert(i),N=s.pointGeometry.convert(c),$=this._raycastElevationBox(O,N);if($)w=$.minLngLat,S=$.maxLngLat,P=$.minAltitude,L=$.maxAltitude;else{if(this.transform.anyCornerOffEdge(O,N))return this;w=this.transform.pointLocation(O),S=this.transform.pointLocation(N)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(s.pointGeometry.convert(i)),this.transform.pointLocation(s.pointGeometry.convert(c)),f,_):this._cameraForBox(w,S,P,L,_),_,x)}_fitInternal(i,c,f){return i?(delete(c=s.extend(i,c)).padding,c.linear?this.easeTo(c,f):this.flyTo(c,f)):this}jumpTo(i,c){this.stop();const f=i.preloadOnly?this.transform.clone():this.transform;let _=!1,x=!1,w=!1;return"zoom"in i&&f.zoom!==+i.zoom&&(_=!0,f.zoom=+i.zoom),i.center!==void 0&&(f.center=s.LngLat.convert(i.center)),"bearing"in i&&f.bearing!==+i.bearing&&(x=!0,f.bearing=+i.bearing),"pitch"in i&&f.pitch!==+i.pitch&&(w=!0,f.pitch=+i.pitch),i.padding==null||f.isPaddingEqual(i.padding)||(f.padding=i.padding),i.preloadOnly?(this._preloadTiles(f),this):(this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),_&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),x&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),w&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(pu),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,c){const f=this.transform;if(!f.projection.supportsFreeCamera)return void s.warnOnce(pu);this.stop();const _=f.zoom,x=f.pitch,w=f.bearing;f.setFreeCameraOptions(i);const S=_!==f.zoom,P=x!==f.pitch,L=w!==f.bearing;return this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),S&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),L&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),P&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)),this}easeTo(i,c){this._stop(!1,i.easeId),((i=s.extend({offset:[0,0],duration:500,easing:s.ease},i)).animate===!1||!i.essential&&s.exported.prefersReducedMotion)&&(i.duration=0);const f=this.transform,_=this.getZoom(),x=this.getBearing(),w=this.getPitch(),S=this.getPadding(),P="zoom"in i?+i.zoom:_,L="bearing"in i?this._normalizeBearing(i.bearing,x):x,O="pitch"in i?+i.pitch:w,N="padding"in i?i.padding:f.padding,$=s.pointGeometry.convert(i.offset);let H=f.centerPoint.add($);const q=f.projection.name==="globe"?f.pointCoordinate(H).toLngLat():f.pointLocation(H),X=s.LngLat.convert(i.center||q);this._normalizeCenter(X);const le=f.project(q),W=f.project(X).sub(le),re=f.zoomScale(P-_);let oe,ie;i.around&&(oe=s.LngLat.convert(i.around),ie=f.locationPoint(oe));const ne=this._zooming||P!==_,ce=this._rotating||x!==L,Se=this._pitching||O!==w,Me=!f.isPaddingEqual(N),et=Ge=>ze=>{if(ne&&(Ge.zoom=s.number(_,P,ze)),ce&&(Ge.bearing=s.number(x,L,ze)),Se&&(Ge.pitch=s.number(w,O,ze)),Me&&(Ge.interpolatePadding(S,N,ze),H=Ge.centerPoint.add($)),oe)Ge.setLocationAtPoint(oe,ie);else{const Ae=Ge.zoomScale(Ge.zoom-_),$e=P>_?Math.min(2,re):Math.max(.5,re),Fe=Math.pow($e,1-ze),St=Ge.unproject(le.add(W.mult(ze*Fe)).mult(Ae));Ge.setLocationAtPoint(Ge.renderWorldCopies?St.wrap():St,H)}return i.preloadOnly||this._fireMoveEvents(c),Ge};if(i.preloadOnly){const Ge=this._emulate(et,i.duration,f);return this._preloadTiles(Ge),this}const qe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ne,this._rotating=ce,this._pitching=Se,this._padding=Me,this._easeId=i.easeId,this._prepareEase(c,i.noMoveStart,qe),this._ease(et(f),Ge=>{f.recenterOnTerrain(),this._afterEase(c,Ge)},i),this}_prepareEase(i,c,f={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||f.moving||this.fire(new s.Event("movestart",i)),this._zooming&&!f.zooming&&this.fire(new s.Event("zoomstart",i)),this._rotating&&!f.rotating&&this.fire(new s.Event("rotatestart",i)),this._pitching&&!f.pitching&&this.fire(new s.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new s.Event("move",i)),this._zooming&&this.fire(new s.Event("zoom",i)),this._rotating&&this.fire(new s.Event("rotate",i)),this._pitching&&this.fire(new s.Event("pitch",i))}_afterEase(i,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId,this.transform.cameraElevationReference="ground";const f=this._zooming,_=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new s.Event("zoomend",i)),_&&this.fire(new s.Event("rotateend",i)),x&&this.fire(new s.Event("pitchend",i)),this.fire(new s.Event("moveend",i))}flyTo(i,c){if(!i.essential&&s.exported.prefersReducedMotion){const Qe=s.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Qe,c)}this.stop(),i=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},i);const f=this.transform,_=this.getZoom(),x=this.getBearing(),w=this.getPitch(),S=this.getPadding(),P="zoom"in i?s.clamp(+i.zoom,f.minZoom,f.maxZoom):_,L="bearing"in i?this._normalizeBearing(i.bearing,x):x,O="pitch"in i?+i.pitch:w,N="padding"in i?i.padding:f.padding,$=f.zoomScale(P-_),H=s.pointGeometry.convert(i.offset);let q=f.centerPoint.add(H);const X=f.pointLocation(q),le=s.LngLat.convert(i.center||X);this._normalizeCenter(le);const W=f.project(X),re=f.project(le).sub(W);let oe=i.curve;const ie=Math.max(f.width,f.height),ne=ie/$,ce=re.mag();if("minZoom"in i){const Qe=s.clamp(Math.min(i.minZoom,_,P),f.minZoom,f.maxZoom),zt=ie/f.zoomScale(Qe-_);oe=Math.sqrt(zt/ce*2)}const Se=oe*oe;function Me(Qe){const zt=(ne*ne-ie*ie+(Qe?-1:1)*Se*Se*ce*ce)/(2*(Qe?ne:ie)*Se*ce);return Math.log(Math.sqrt(zt*zt+1)-zt)}function et(Qe){return(Math.exp(Qe)-Math.exp(-Qe))/2}function qe(Qe){return(Math.exp(Qe)+Math.exp(-Qe))/2}const Ge=Me(0);let ze=function(Qe){return qe(Ge)/qe(Ge+oe*Qe)},Ae=function(Qe){return ie*((qe(Ge)*(et(zt=Ge+oe*Qe)/qe(zt))-et(Ge))/Se)/ce;var zt},$e=(Me(1)-Ge)/oe;if(Math.abs(ce)<1e-6||!isFinite($e)){if(Math.abs(ie-ne)<1e-6)return this.easeTo(i,c);const Qe=ne<ie?-1:1;$e=Math.abs(Math.log(ne/ie))/oe,Ae=function(){return 0},ze=function(zt){return Math.exp(Qe*oe*zt)}}i.duration="duration"in i?+i.duration:1e3*$e/("screenSpeed"in i?+i.screenSpeed/oe:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const Fe=x!==L,St=O!==w,Dt=!f.isPaddingEqual(N),Xt=Qe=>zt=>{const Ut=zt*$e,Ci=1/ze(Ut);Qe.zoom=zt===1?P:_+Qe.scaleZoom(Ci),Fe&&(Qe.bearing=s.number(x,L,zt)),St&&(Qe.pitch=s.number(w,O,zt)),Dt&&(Qe.interpolatePadding(S,N,zt),q=Qe.centerPoint.add(H));const Di=zt===1?le:Qe.unproject(W.add(re.mult(Ae(Ut))).mult(Ci));return Qe.setLocationAtPoint(Qe.renderWorldCopies?Di.wrap():Di,q),Qe._updateCenterElevation(),i.preloadOnly||this._fireMoveEvents(c),Qe};if(i.preloadOnly){const Qe=this._emulate(Xt,i.duration,f);return this._preloadTiles(Qe),this}return this._zooming=!0,this._rotating=Fe,this._pitching=St,this._padding=Dt,this._prepareEase(c,!1),this._ease(Xt(f),()=>this._afterEase(c),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,c)}if(!i){const f=this.handlers;f&&f.stop(!1)}return this}_ease(i,c,f){f.animate===!1||f.duration===0?(i(1),c()):(this._easeStart=s.exported.now(),this._easeOptions=f,this._onEaseFrame=i,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,c){i=s.wrap(i,-180,180);const f=Math.abs(i-c);return Math.abs(i-360-c)<f&&(i-=360),Math.abs(i+360-c)<f&&(i+=360),i}_normalizeCenter(i){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const f=i.lng-c.center.lng;i.lng+=f>180?-360:f<-180?360:0}_emulate(i,c,f){const _=Math.ceil(15*c/1e3),x=[],w=i(f.clone());for(let S=0;S<=_;S++){const P=w(S/_);x.push(P.clone())}return x}}class fu{constructor(i={}){this.options=i,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const c=this.options&&this.options.compact;return this._map=i,this._container=U.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=U.create("button","mapboxgl-ctrl-attrib-button",this._container),U.create("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden",!0),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=U.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(i,c){const f=this._map._getUIString(`AttributionControl.${c}`);i.setAttribute("aria-label",f),i.removeAttribute("title"),i.firstElementChild&&i.firstElementChild.setAttribute("title",f)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(i){const f=c.reduce((_,x,w)=>(x.value&&(_+=`${x.key}=${x.value}${w<c.length-1?"&":""}`),_),"?");i.href=`${s.config.FEEDBACK_URL}/${f}${this._map._hash?this._map._hash.getHashString(!0):""}`,i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}}_updateData(i){!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const c=this._map.style._sourceCaches;for(const _ in c){const x=c[_];if(x.used){const w=x.getSource();w.attribution&&i.indexOf(w.attribution)<0&&i.push(w.attribution)}}i.sort((_,x)=>_.length-x.length),i=i.filter((_,x)=>{for(let w=x+1;w<i.length;w++)if(i[w].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const f=i.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,i.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class mu{constructor(){s.bindAll(["_updateLogo"],this),s.bindAll(["_updateCompact"],this)}onAdd(i){this._map=i,this._container=U.create("div","mapboxgl-ctrl");const c=U.create("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&i.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(Object.entries(i).length===0)return!0;for(const c in i){const f=i[c].getSource();if(f.hasOwnProperty("mapbox_logo")&&!f.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const c=i[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class gu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const c=++this._id;return this._queue.push({callback:i,id:c,cancelled:!1}),c}remove(i){const c=this._currentlyRunning,f=c?this._queue.concat(c):this._queue;for(const _ of f)if(_.id===i)return void(_.cancelled=!0)}run(i=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const f of c)if(!f.cancelled&&(f.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function _u(p,i,c){if(p=new s.LngLat(p.lng,p.lat),i){const f=new s.LngLat(p.lng-360,p.lat),_=new s.LngLat(p.lng+360,p.lat),x=360*Math.ceil(Math.abs(p.lng-c.center.lng)/360),w=c.locationPoint(p).distSqr(i),S=i.x<0||i.y<0||i.x>c.width||i.y>c.height;c.locationPoint(f).distSqr(i)<w&&(S||Math.abs(f.lng-c.center.lng)<x)?p=f:c.locationPoint(_).distSqr(i)<w&&(S||Math.abs(_.lng-c.center.lng)<x)&&(p=_)}for(;Math.abs(p.lng-c.center.lng)>180;){const f=c.locationPoint(p);if(f.x>=0&&f.y>=0&&f.x<=c.width&&f.y<=c.height)break;p.lng>c.center.lng?p.lng-=360:p.lng+=360}return p}const gn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class yu extends s.Evented{constructor(i,c){if(super(),(i instanceof s.window.HTMLElement||c)&&(i=s.extend({element:i},c)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this._updateMoving=()=>this._update(!0),i&&i.element)this._element=i.element,this._offset=s.pointGeometry.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=U.create("div");const _=41,x=27,w=U.createSVG("svg",{display:"block",height:_*this._scale+"px",width:x*this._scale+"px",viewBox:`0 0 ${x} ${_}`},this._element),S=U.createSVG("radialGradient",{id:"shadowGradient"},U.createSVG("defs",{},w));U.createSVG("stop",{offset:"10%","stop-opacity":.4},S),U.createSVG("stop",{offset:"100%","stop-opacity":.05},S),U.createSVG("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},w),U.createSVG("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},w),U.createSVG("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},w),U.createSVG("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},w),this._offset=s.pointGeometry.convert(i&&i.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",_=>{_.preventDefault()}),this._element.addEventListener("mousedown",_=>{_.preventDefault()});const f=this._element.classList;for(const _ in gn)f.remove(`mapboxgl-marker-anchor-${_}`);f.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick)),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._updateMoving),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=s.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const c=i.code,f=i.charCode||i.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()}_onMapClick(i){const c=i.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const i=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(i))return void this._clearFadeTimer();const c=this._map.unproject(i);let f=!1;if(this._map.transform._terrainEnabled()&&this._map.getTerrain()){const x=this._map.getFreeCameraOptions();if(x.position){const w=x.position.toLngLat();f=w.distanceTo(c)<.9*w.distanceTo(this._lngLat)}}const _=(1-this._map._queryFogOpacity(c))*(f?.2:1);this._element.style.opacity=`${_}`,this._popup&&this._popup._setOpacity(`${_}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(i){const c=this._map.transform;return!!i&&i.x>=0&&i.x<c.width&&i.y>=0&&i.y<c.height}_updateDOM(){const i=this._pos||new s.pointGeometry(0,0),c=this._calculatePitch(),f=this._calculateRotation();this._element.style.transform=`${gn[this._anchor]} translate(${i.x}px, ${i.y}px) rotateX(${c}deg) rotateZ(${f}deg)`}_calculatePitch(){return this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?0:this._pitchAlignment==="map"?this._map.getPitch():0}_calculateRotation(){return this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?this._rotation:this._rotationAlignment==="map"?this._rotation-this._map.getBearing():0}_update(i){s.window.cancelAnimationFrame(this._updateFrameId),this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=_u(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset()),i===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}_transformedOffset(){if(!this._defaultMarker)return this._offset;const i=this._map.transform,c=this._offset.mult(this._scale);return this._rotationAlignment==="map"&&c._rotate(i.angle),this._pitchAlignment==="map"&&(c.y*=Math.cos(i._pitch)),c}getOffset(){return this._offset}setOffset(i){return this._offset=s.pointGeometry.convert(i),this._update(),this}_onMove(i){if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(i){this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class ho{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const c=s.easeCubicInOut((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,c,f){this._start=this.getValue(c),this._end=i,this._startTime=c,this._endTime=c+f}}const ld={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},{HTMLImageElement:Ir,HTMLElement:Ps,ImageBitmap:Ds}=s.window,bf={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function vu(p){p.parentNode&&p.parentNode.removeChild(p)}const wf={showCompass:!0,showZoom:!0,visualizePitch:!1};class cd{constructor(i,c,f=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new gr({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,f&&(this.mousePitch=new lu({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(i,c){this.mouseRotate.mousedown(i,c),this.mousePitch&&this.mousePitch.mousedown(i,c),U.disableDrag()}move(i,c){const f=this.map,_=this.mouseRotate.mousemoveWindow(i,c);if(_&&_.bearingDelta&&f.setBearing(f.getBearing()+_.bearingDelta),this.mousePitch){const x=this.mousePitch.mousemoveWindow(i,c);x&&x.pitchDelta&&f.setPitch(f.getPitch()+x.pitchDelta)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart,{passive:!1}),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){U.enableDrag(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(s.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),U.mousePos(this.element,i)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,U.mousePos(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){i.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=U.touchPos(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){i.targetTouches.length!==1?this.reset():(this._lastPos=U.touchPos(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){i.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Pa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let Vn,Da=0,Ls=!1;const La={maxWidth:100,unit:"metric"};function _t(p,i,c){const f=c&&c.maxWidth||100,_=p._containerHeight/2,x=p.unproject([0,_]),w=p.unproject([f,_]),S=x.distanceTo(w);if(c&&c.unit==="imperial"){const P=3.2808*S;P>5280?Rs(i,f,P/5280,p._getUIString("ScaleControl.Miles"),p):Rs(i,f,P,p._getUIString("ScaleControl.Feet"),p)}else c&&c.unit==="nautical"?Rs(i,f,S/1852,p._getUIString("ScaleControl.NauticalMiles"),p):S>=1e3?Rs(i,f,S/1e3,p._getUIString("ScaleControl.Kilometers"),p):Rs(i,f,S,p._getUIString("ScaleControl.Meters"),p)}function Rs(p,i,c,f,_){const x=function(S){const P=Math.pow(10,`${Math.floor(S)}`.length-1);let L=S/P;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(O){const N=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*N)/N}(L),P*L}(c),w=x/c;_._requestDomTask(()=>{p.style.width=i*w+"px",p.innerHTML=`${x}&nbsp;${f}`})}const ud={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ra=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Fo={version:s.version,supported:C,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends ad{constructor(p){if((p=s.extend({},bf,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ca(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),p),this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._optimizeForTerrain=p.optimizeForTerrain,this._renderTaskQueue=new gu,this._domRenderTaskQueue=new gu,this._controls=[],this._markers=[],this._mapId=s.uniqueId(),this._locale=s.extend({},ld,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new ho(0),this._requestManager=new s.RequestManager(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,typeof p.container=="string"){if(this._container=s.window.document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof Ps))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new zs(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,p.style&&this.setStyle(p.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this._hash=p.hash&&new Kh(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,s.extend({},p.fitBoundsOptions,{duration:0})))),this.resize(),p.attributionControl&&this.addControl(new fu({customAttribution:p.customAttribution})),this._logoControl=new mu,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update(i.dataType==="style"),this.fire(new s.Event(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new s.Event(`${i.dataType}dataloading`,i))})}_getMapId(){return this._mapId}addControl(p,i){if(i===void 0&&(i=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=p.onAdd(this);this._controls.push(p);const f=this._controlPositions[i];return i.indexOf("bottom")!==-1?f.insertBefore(c,f.firstChild):f.appendChild(c),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(p);return i>-1&&this._controls.splice(i,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new s.Event("movestart",p)).fire(new s.Event("move",p)),this.fire(new s.Event("resize",p)),i&&this.fire(new s.Event("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(s.LngLatBounds.convert(p)),this._update()}setMinZoom(p){if((p=p==null?-2:p)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p==null?22:p)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p==null?0:p)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p==null?85:p)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this._update()}getProjection(){return this.transform.getProjection()}setProjection(p){return this._lazyInitEmptyStyle(),typeof p=="string"&&(p={name:p}),this._runtimeProjection=p,this.style.updateProjection(),this._transitionFromGlobe=!1,this}project(p){return this.transform.locationPoint3D(s.LngLat.convert(p))}unproject(p){return this.transform.pointLocation3D(s.pointGeometry.convert(p))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(p,i,c){if(p==="mouseenter"||p==="mouseover"){let f=!1;const _=w=>{const S=i.filter(L=>this.getLayer(L)),P=S.length?this.queryRenderedFeatures(w.point,{layers:S}):[];P.length?f||(f=!0,c.call(this,new kn(p,this,w.originalEvent,{features:P}))):f=!1},x=()=>{f=!1};return{layers:new Set(i),listener:c,delegates:{mousemove:_,mouseout:x}}}if(p==="mouseleave"||p==="mouseout"){let f=!1;const _=w=>{const S=i.filter(P=>this.getLayer(P));(S.length?this.queryRenderedFeatures(w.point,{layers:S}):[]).length?f=!0:f&&(f=!1,c.call(this,new kn(p,this,w.originalEvent)))},x=w=>{f&&(f=!1,c.call(this,new kn(p,this,w.originalEvent)))};return{layers:new Set(i),listener:c,delegates:{mousemove:_,mouseout:x}}}{const f=_=>{const x=i.filter(S=>this.getLayer(S)),w=x.length?this.queryRenderedFeatures(_.point,{layers:x}):[];w.length&&(_.features=w,c.call(this,_),delete _.features)};return{layers:new Set(i),listener:c,delegates:{[p]:f}}}}on(p,i,c){if(c===void 0)return super.on(p,i);Array.isArray(i)||(i=[i]);const f=this._createDelegatedListener(p,i,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(f);for(const _ in f.delegates)this.on(_,f.delegates[_]);return this}once(p,i,c){if(c===void 0)return super.once(p,i);Array.isArray(i)||(i=[i]);const f=this._createDelegatedListener(p,i,c);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(p,i,c){if(c===void 0)return super.off(p,i);i=new Set(Array.isArray(i)?i:[i]);const f=(x,w)=>{if(x.size!==w.size)return!1;for(const S of x)if(!w.has(S))return!1;return!0},_=this._delegatedListeners?this._delegatedListeners[p]:void 0;return _&&(x=>{for(let w=0;w<x.length;w++){const S=x[w];if(S.listener===c&&f(S.layers,i)){for(const P in S.delegates)this.off(P,S.delegates[P]);return x.splice(w,1),this}}})(_),this}queryRenderedFeatures(p,i){return this.style?(i!==void 0||p===void 0||p instanceof s.pointGeometry||Array.isArray(p)||(i=p,p=void 0),this.style.queryRenderedFeatures(p=p||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(p,i){return this.style.querySourceFeatures(p,i)}queryTerrainElevation(p,i){const c=this.transform.elevation;return c?(i=s.extend({},{exaggerated:!0},i),c.getAtPoint(s.MercatorCoordinate.fromLngLat(p),null,i.exaggerated)):null}setStyle(p,i){return(i=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&p?(this._diffStyle(p,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(p,i))}_getUIString(p){const i=this._locale[p];if(i==null)throw new Error(`Missing UI string '${p}'`);return i}_updateStyle(p,i){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),p&&(this.style=new Yn(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p):this.style.loadJSON(p)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Yn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,i){if(typeof p=="string"){const c=this._requestManager.normalizeStyleURL(p),f=this._requestManager.transformRequest(c,s.ResourceType.Style);s.getJSON(f,(_,x)=>{_?this.fire(new s.ErrorEvent(_)):x&&this._updateDiff(x,i)})}else typeof p=="object"&&this._updateDiff(p,i)}_updateDiff(p,i){try{this.style.setState(p)&&this._update(!0)}catch(c){s.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(p,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.warnOnce("There is no style added to the map.")}addSource(p,i){return this._lazyInitEmptyStyle(),this.style.addSource(p,i),this._update(!0)}isSourceLoaded(p){const i=this.style&&this.style._getSourceCaches(p);if(i.length!==0)return i.every(c=>c.loaded());this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${p}'`)))}areTilesLoaded(){const p=this.style&&this.style._sourceCaches;for(const i in p){const c=p[i]._tiles;for(const f in c){const _=c[f];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(p,i,c){return this._lazyInitEmptyStyle(),this.style.addSourceType(p,i,c)}removeSource(p){return this.style.removeSource(p),this._updateTerrain(),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,i,{pixelRatio:c=1,sdf:f=!1,stretchX:_,stretchY:x,content:w}={}){if(this._lazyInitEmptyStyle(),i instanceof Ir||Ds&&i instanceof Ds){const{width:S,height:P,data:L}=s.exported.getImageData(i);this.style.addImage(p,{data:new s.RGBAImage({width:S,height:P},L),pixelRatio:c,stretchX:_,stretchY:x,content:w,sdf:f,version:0})}else{if(i.width===void 0||i.height===void 0)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:S,height:P,data:L}=i,O=i;this.style.addImage(p,{data:new s.RGBAImage({width:S,height:P},new Uint8Array(L)),pixelRatio:c,stretchX:_,stretchY:x,content:w,sdf:f,version:0,userImage:O}),O.onAdd&&O.onAdd(this,p)}}}updateImage(p,i){const c=this.style.getImage(p);if(!c)return this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=i instanceof Ir||Ds&&i instanceof Ds?s.exported.getImageData(i):i,{width:_,height:x,data:w}=f;return _===void 0||x===void 0?this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):_!==c.data.width||x!==c.data.height?this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(c.data.replace(w,!(i instanceof Ir||Ds&&i instanceof Ds)),void this.style.updateImage(p,c))}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,i){s.getImage(this._requestManager.transformRequest(p,s.ResourceType.Image),(c,f)=>{i(c,f instanceof Ir?s.exported.getImageData(f):f)})}listImages(){return this.style.listImages()}addLayer(p,i){return this._lazyInitEmptyStyle(),this.style.addLayer(p,i),this._update(!0)}moveLayer(p,i){return this.style.moveLayer(p,i),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}setLayerZoomRange(p,i,c){return this.style.setLayerZoomRange(p,i,c),this._update(!0)}setFilter(p,i,c={}){return this.style.setFilter(p,i,c),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,i,c,f={}){return this.style.setPaintProperty(p,i,c,f),this._update(!0)}getPaintProperty(p,i){return this.style.getPaintProperty(p,i)}setLayoutProperty(p,i,c,f={}){return this.style.setLayoutProperty(p,i,c,f),this._update(!0)}getLayoutProperty(p,i){return this.style.getLayoutProperty(p,i)}setLight(p,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,i),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}_updateProjection(){this.transform.projection.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX&&!this._transitionFromGlobe&&(this.setProjection({name:"mercator"}),this._transitionFromGlobe=!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(p),this.transform):0}setFeatureState(p,i){return this.style.setFeatureState(p,i),this._update()}removeFeatureState(p,i){return this.style.removeFeatureState(p,i),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let c,f=this._container;for(;f&&!c;){const _=s.window.getComputedStyle(f).transform;_&&_!=="none"&&(c=_.match(/matrix.*\((.+)\)/)[1].split(", ")),f=f.parentElement}c?(this._containerWidth=c[0]&&c[0]!=="0"?Math.abs(p/c[0]):p,this._containerHeight=c[3]&&c[3]!=="0"?Math.abs(i/c[3]):i):(this._containerWidth=p,this._containerHeight=i)}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=U.create("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=U.create("div","mapboxgl-canvas-container",p);this._interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=U.create("canvas","mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=U.create("div","mapboxgl-control-container",p),f=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{f[_]=U.create("div",`mapboxgl-ctrl-${_}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,i){const c=s.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(p),this._canvas.height=c*Math.ceil(i),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${i}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const i=this._markers.indexOf(p);i!==-1&&this._markers.splice(i,1)}_setupPainter(){const p=s.extend({},C.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",p)||this._canvas.getContext("experimental-webgl",p);i?(s.storeAuthState(i,!0),this.painter=new Zh(i,this.transform),this.on("data",c=>{c.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(i)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let i;const c=this.painter.context.extTimerQuery,f=s.exported.now();this.listens("gpu-timing-frame")&&(i=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,i));let _=this._updateAverageElevation(f);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjection();let x=!1;const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const P=this.transform.zoom,L=this.transform.pitch,O=s.exported.now();this.style.zoomHistory.update(P,O);const N=new s.EvaluationParameters(P,{now:O,fadeDuration:w,pitch:L,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),$=N.crossFadingFactor();$===1&&$===this._crossFadingFactor||(x=!0,this._crossFadingFactor=$),this.style.update(N)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||x)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const P=s.exported.now()-f;c.endQueryEXT(c.TIME_ELAPSED_EXT,i),setTimeout(()=>{const L=c.getQueryObjectEXT(i,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(i),this.fire(new s.Event("gpu-timing-frame",{cpuTime:P,gpuTime:L}))},50)}if(this.listens("gpu-timing-layer")){const P=this.painter.collectGpuTimers();setTimeout(()=>{const L=this.painter.queryGpuTimers(P);this.fire(new s.Event("gpu-timing-layer",{layerTimes:L}))},50)}const S=this._sourcesDirty||this._styleDirty||this._placementDirty||_;if(S||this._repaint)this.triggerRepaint();else{const P=!this.isMoving()&&this.loaded();if(P&&(_=this._updateAverageElevation(f,!0)),_)this.triggerRepaint();else if(this._triggerFrame(!1),P&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const L=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:L})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||S||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const p of this._markers)p._update()}_updateAverageElevation(p,i=!1){const c=f=>(this.transform.averageElevation=f,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);if((i||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const f=this.transform.averageElevation;let _=this.transform.sampleAverageElevation();isNaN(_)?_=0:this._averageElevationLastSampledAt=p;const x=Math.abs(f-_);if(x>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(_),c(_);this._averageElevation.easeTo(_,p,300)}else if(x>1e-4)return this._averageElevation.jumpTo(_),c(_)}return!!this._averageElevation.isEasing(p)&&c(this._averageElevation.getValue(p))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===s.AUTH_ERR_MSG||p.status===401)){const i=this.painter.context.gl;s.storeAuthState(i,!1),this._logoControl instanceof mu&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const c=this.painter.context.gl,f=c.createFramebuffer();function _(x){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,x,0);const w=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,w),w}return c.bindFramebuffer(c.FRAMEBUFFER,f),this._canvasPixelComparison(_(p),i.canvasCopies.map(_),i.timeStamps)}_canvasPixelComparison(p,i,c){let f=c[1]-c[0];const _=p.length/4;for(let x=0;x<i.length;x++){const w=i[x];let S=0;for(let P=0;P<w.length;P+=4)w[P]===p[P]&&w[P+1]===p[P+1]&&w[P+2]===p[P+2]&&w[P+3]===p[P+3]&&(S+=1);f+=(c[x+2]-c[x+1])*(1-S/_)}return f}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),vu(this._canvasContainer),vu(this._controlContainer),vu(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=s.exported.frame(i=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(i)}))}_preloadTiles(p){const i=this.style&&Object.values(this.style._sourceCaches)||[];return s.asyncAll(i,(c,f)=>c._preloadTiles(p,f),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}_setCacheLimits(p,i){s.setCacheLimits(p,i)}get version(){return s.version}},NavigationControl:class{constructor(p){this.options=s.extend({},wf,p),this._container=U.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),U.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),U.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=U.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const p=this._map.getZoom(),i=p===this._map.getMaxZoom(),c=p===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())}_rotateCompassArrow(){const p=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=p)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new cd(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){this._container.remove(),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,i){const c=U.create("button",p,this._container);return c.type="button",c.addEventListener("click",i),c}_setButtonTitle(p,i){const c=this._map._getUIString(`NavigationControl.${i}`);p.setAttribute("aria-label",c),p.firstElementChild&&p.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends s.Evented{constructor(p){super(),this.options=s.extend({},Pa,p),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=Bo(this._updateMarkerRotation,20)}onAdd(p){var i;return this._map=p,this._container=U.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,Vn!==void 0?i(Vn):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(c=>{Vn=c.state!=="denied",i(Vn)}):(Vn=!!s.window.navigator.geolocation,i(Vn)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,Da=0,Ls=!1}_isOutOfMapMaxBounds(p){const i=this._map.getMaxBounds(),c=p.coords;return i&&(c.longitude<i.getWest()||c.longitude>i.getEast()||c.latitude<i.getSouth()||c.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",p)),this._finish()}}_updateCamera(p){const i=new s.LngLat(p.coords.longitude,p.coords.latitude),c=p.coords.accuracy,f=this._map.getBearing(),_=s.extend({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(c),_,{geolocateSource:!0})}_updateMarker(p){if(p){const i=new s.LngLat(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map._containerHeight/2,i=this._map.unproject([0,p]),c=this._map.unproject([100,p]),f=i.distanceTo(c)/100,_=Math.ceil(2*this._accuracy/f);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&Ls)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=U.create("button","mapboxgl-ctrl-geolocate",this._container),U.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",p===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=U.create("div","mapboxgl-user-location"),this._dotElement.appendChild(U.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(U.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new yu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=U.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new yu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Da--,Ls=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Da++,Da>1?(p={maximumAge:6e5,timeout:0},Ls=!0):(p=this.options.positionOptions,Ls=!1),this._geolocationWatchID=s.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else s.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(i=>{i==="granted"&&p()}).catch(console.error):p()}_clearWatch(){s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:fu,ScaleControl:class{constructor(p){this.options=s.extend({},La,p),s.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){_t(this._map,this._container,this.options)}onAdd(p){return this._map=p,this._container=U.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._onMove),this._map=void 0}setUnit(p){this.options.unit=p,_t(this._map,this._container,this.options)}},FullscreenControl:class{constructor(p){this._fullscreen=!1,p&&p.container&&(p.container instanceof s.window.HTMLElement?this._container=p.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=U.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=U.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);U.create("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden",!0),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(p){super(),this.options=s.extend(Object.create(ud),p),s.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&this._content.remove(),this._container&&(this._container.remove(),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=s.LngLat.convert(p),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(s.window.document.createTextNode(p))}setHTML(p){const i=s.window.document.createDocumentFragment(),c=s.window.document.createElement("body");let f;for(c.innerHTML=p;f=c.firstChild,f;)i.appendChild(f);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=U.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._container&&this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._container&&this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let i;return this._classList.delete(p)?i=!1:(this._classList.add(p),i=!0),this._container&&this._updateClassList(),i}_createCloseButton(){this.options.closeButton&&(this._closeButton=U.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.setAttribute("aria-hidden","true"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(p){this._update(p.point)}_onMouseMove(p){this._update(p.point)}_onDrag(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const i=this._pos,c=this._container.offsetWidth,f=this._container.offsetHeight;let _;return _=i.y+p.bottom.y<f?["top"]:i.y>this._map.transform.height-f?["bottom"]:[],i.x<c/2?_.push("left"):i.x>this._map.transform.width-c/2&&_.push("right"),_.length===0?"bottom":_.join("-")}_updateClassList(){const p=[...this._classList];p.push("mapboxgl-popup"),this._anchor&&p.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&p.push("mapboxgl-popup-track-pointer"),this._container.className=p.join(" ")}_update(p){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=U.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=U.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=_u(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||p){const i=this._pos=this._trackPointer&&p?p:this._map.project(this._lngLat),c=function(x){if(x||(x=new s.pointGeometry(0,0)),typeof x=="number"){const w=Math.round(Math.sqrt(.5*Math.pow(x,2)));return{center:new s.pointGeometry(0,0),top:new s.pointGeometry(0,x),"top-left":new s.pointGeometry(w,w),"top-right":new s.pointGeometry(-w,w),bottom:new s.pointGeometry(0,-x),"bottom-left":new s.pointGeometry(w,-w),"bottom-right":new s.pointGeometry(-w,-w),left:new s.pointGeometry(x,0),right:new s.pointGeometry(-x,0)}}if(x instanceof s.pointGeometry||Array.isArray(x)){const w=s.pointGeometry.convert(x);return{center:w,top:w,"top-left":w,"top-right":w,bottom:w,"bottom-left":w,"bottom-right":w,left:w,right:w}}return{center:s.pointGeometry.convert(x.center||[0,0]),top:s.pointGeometry.convert(x.top||[0,0]),"top-left":s.pointGeometry.convert(x["top-left"]||[0,0]),"top-right":s.pointGeometry.convert(x["top-right"]||[0,0]),bottom:s.pointGeometry.convert(x.bottom||[0,0]),"bottom-left":s.pointGeometry.convert(x["bottom-left"]||[0,0]),"bottom-right":s.pointGeometry.convert(x["bottom-right"]||[0,0]),left:s.pointGeometry.convert(x.left||[0,0]),right:s.pointGeometry.convert(x.right||[0,0])}}(this.options.offset),f=this._anchor=this._getAnchor(c),_=i.add(c[f]).round();this._map._requestDomTask(()=>{this._container&&f&&(this._container.style.transform=`${gn[f]} translate(${_.x}px,${_.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Ra);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._content&&(this._content.style.opacity=p),this._tip&&(this._tip.style.opacity=p)}},Marker:yu,Style:Yn,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:Hh,Evented:s.Evented,config:s.config,prewarm:function(){pe().acquire(he)},clearPrewarmedResources:function(){const p=ve;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(he),ve=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(p){s.config.ACCESS_TOKEN=p},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(p){s.config.API_URL=p},get workerCount(){return ye.workerCount},set workerCount(p){ye.workerCount=p},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){s.config.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){s.clearTileCache(p)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Fo});var E=g;return E})})(l3);function vx(r){return r!==null&&typeof r=="object"&&"constructor"in r&&r.constructor===Object}function L_(r={},o={}){Object.keys(o).forEach(l=>{typeof r[l]=="undefined"?r[l]=o[l]:vx(o[l])&&vx(r[l])&&Object.keys(o[l]).length>0&&L_(r[l],o[l])})}const sw={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function jr(){const r=typeof document!="undefined"?document:{};return L_(r,sw),r}const c3={document:sw,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(r){return typeof setTimeout=="undefined"?(r(),null):setTimeout(r,0)},cancelAnimationFrame(r){typeof setTimeout!="undefined"&&clearTimeout(r)}};function Un(){const r=typeof window!="undefined"?window:{};return L_(r,c3),r}function u3(r){const o=r.__proto__;Object.defineProperty(r,"__proto__",{get(){return o},set(l){o.__proto__=l}})}class na extends Array{constructor(o){if(typeof o=="number")super(o);else{super(...o||[]);u3(this)}}}function Th(r=[]){const o=[];return r.forEach(l=>{Array.isArray(l)?o.push(...Th(l)):o.push(l)}),o}function aw(r,o){return Array.prototype.filter.call(r,o)}function h3(r){const o=[];for(let l=0;l<r.length;l+=1)o.indexOf(r[l])===-1&&o.push(r[l]);return o}function d3(r,o){if(typeof r!="string")return[r];const l=[],h=o.querySelectorAll(r);for(let g=0;g<h.length;g+=1)l.push(h[g]);return l}function Rt(r,o){const l=Un(),h=jr();let g=[];if(!o&&r instanceof na)return r;if(!r)return new na(g);if(typeof r=="string"){const y=r.trim();if(y.indexOf("<")>=0&&y.indexOf(">")>=0){let E="div";y.indexOf("<li")===0&&(E="ul"),y.indexOf("<tr")===0&&(E="tbody"),(y.indexOf("<td")===0||y.indexOf("<th")===0)&&(E="tr"),y.indexOf("<tbody")===0&&(E="table"),y.indexOf("<option")===0&&(E="select");const s=h.createElement(E);s.innerHTML=y;for(let C=0;C<s.childNodes.length;C+=1)g.push(s.childNodes[C])}else g=d3(r.trim(),o||h)}else if(r.nodeType||r===l||r===h)g.push(r);else if(Array.isArray(r)){if(r instanceof na)return r;g=r}return new na(h3(g))}Rt.fn=na.prototype;function p3(...r){const o=Th(r.map(l=>l.split(" ")));return this.forEach(l=>{l.classList.add(...o)}),this}function f3(...r){const o=Th(r.map(l=>l.split(" ")));return this.forEach(l=>{l.classList.remove(...o)}),this}function m3(...r){const o=Th(r.map(l=>l.split(" ")));this.forEach(l=>{o.forEach(h=>{l.classList.toggle(h)})})}function g3(...r){const o=Th(r.map(l=>l.split(" ")));return aw(this,l=>o.filter(h=>l.classList.contains(h)).length>0).length>0}function _3(r,o){if(arguments.length===1&&typeof r=="string")return this[0]?this[0].getAttribute(r):void 0;for(let l=0;l<this.length;l+=1)if(arguments.length===2)this[l].setAttribute(r,o);else for(const h in r)this[l][h]=r[h],this[l].setAttribute(h,r[h]);return this}function y3(r){for(let o=0;o<this.length;o+=1)this[o].removeAttribute(r);return this}function v3(r){for(let o=0;o<this.length;o+=1)this[o].style.transform=r;return this}function x3(r){for(let o=0;o<this.length;o+=1)this[o].style.transitionDuration=typeof r!="string"?`${r}ms`:r;return this}function b3(...r){let[o,l,h,g]=r;typeof r[1]=="function"&&([o,h,g]=r,l=void 0),g||(g=!1);function y(k){const M=k.target;if(!M)return;const D=k.target.dom7EventData||[];if(D.indexOf(k)<0&&D.unshift(k),Rt(M).is(l))h.apply(M,D);else{const R=Rt(M).parents();for(let U=0;U<R.length;U+=1)Rt(R[U]).is(l)&&h.apply(R[U],D)}}function E(k){const M=k&&k.target?k.target.dom7EventData||[]:[];M.indexOf(k)<0&&M.unshift(k),h.apply(this,M)}const s=o.split(" ");let C;for(let k=0;k<this.length;k+=1){const M=this[k];if(l)for(C=0;C<s.length;C+=1){const D=s[C];M.dom7LiveListeners||(M.dom7LiveListeners={}),M.dom7LiveListeners[D]||(M.dom7LiveListeners[D]=[]),M.dom7LiveListeners[D].push({listener:h,proxyListener:y}),M.addEventListener(D,y,g)}else for(C=0;C<s.length;C+=1){const D=s[C];M.dom7Listeners||(M.dom7Listeners={}),M.dom7Listeners[D]||(M.dom7Listeners[D]=[]),M.dom7Listeners[D].push({listener:h,proxyListener:E}),M.addEventListener(D,E,g)}}return this}function w3(...r){let[o,l,h,g]=r;typeof r[1]=="function"&&([o,h,g]=r,l=void 0),g||(g=!1);const y=o.split(" ");for(let E=0;E<y.length;E+=1){const s=y[E];for(let C=0;C<this.length;C+=1){const k=this[C];let M;if(!l&&k.dom7Listeners?M=k.dom7Listeners[s]:l&&k.dom7LiveListeners&&(M=k.dom7LiveListeners[s]),M&&M.length)for(let D=M.length-1;D>=0;D-=1){const R=M[D];h&&R.listener===h||h&&R.listener&&R.listener.dom7proxy&&R.listener.dom7proxy===h?(k.removeEventListener(s,R.proxyListener,g),M.splice(D,1)):h||(k.removeEventListener(s,R.proxyListener,g),M.splice(D,1))}}}return this}function T3(...r){const o=Un(),l=r[0].split(" "),h=r[1];for(let g=0;g<l.length;g+=1){const y=l[g];for(let E=0;E<this.length;E+=1){const s=this[E];if(o.CustomEvent){const C=new o.CustomEvent(y,{detail:h,bubbles:!0,cancelable:!0});s.dom7EventData=r.filter((k,M)=>M>0),s.dispatchEvent(C),s.dom7EventData=[],delete s.dom7EventData}}}return this}function E3(r){const o=this;function l(h){h.target===this&&(r.call(this,h),o.off("transitionend",l))}return r&&o.on("transitionend",l),this}function S3(r){if(this.length>0){if(r){const o=this.styles();return this[0].offsetWidth+parseFloat(o.getPropertyValue("margin-right"))+parseFloat(o.getPropertyValue("margin-left"))}return this[0].offsetWidth}return null}function C3(r){if(this.length>0){if(r){const o=this.styles();return this[0].offsetHeight+parseFloat(o.getPropertyValue("margin-top"))+parseFloat(o.getPropertyValue("margin-bottom"))}return this[0].offsetHeight}return null}function A3(){if(this.length>0){const r=Un(),o=jr(),l=this[0],h=l.getBoundingClientRect(),g=o.body,y=l.clientTop||g.clientTop||0,E=l.clientLeft||g.clientLeft||0,s=l===r?r.scrollY:l.scrollTop,C=l===r?r.scrollX:l.scrollLeft;return{top:h.top+s-y,left:h.left+C-E}}return null}function M3(){const r=Un();return this[0]?r.getComputedStyle(this[0],null):{}}function I3(r,o){const l=Un();let h;if(arguments.length===1)if(typeof r=="string"){if(this[0])return l.getComputedStyle(this[0],null).getPropertyValue(r)}else{for(h=0;h<this.length;h+=1)for(const g in r)this[h].style[g]=r[g];return this}if(arguments.length===2&&typeof r=="string"){for(h=0;h<this.length;h+=1)this[h].style[r]=o;return this}return this}function k3(r){return r?(this.forEach((o,l)=>{r.apply(o,[o,l])}),this):this}function z3(r){const o=aw(this,r);return Rt(o)}function P3(r){if(typeof r=="undefined")return this[0]?this[0].innerHTML:null;for(let o=0;o<this.length;o+=1)this[o].innerHTML=r;return this}function D3(r){if(typeof r=="undefined")return this[0]?this[0].textContent.trim():null;for(let o=0;o<this.length;o+=1)this[o].textContent=r;return this}function L3(r){const o=Un(),l=jr(),h=this[0];let g,y;if(!h||typeof r=="undefined")return!1;if(typeof r=="string"){if(h.matches)return h.matches(r);if(h.webkitMatchesSelector)return h.webkitMatchesSelector(r);if(h.msMatchesSelector)return h.msMatchesSelector(r);for(g=Rt(r),y=0;y<g.length;y+=1)if(g[y]===h)return!0;return!1}if(r===l)return h===l;if(r===o)return h===o;if(r.nodeType||r instanceof na){for(g=r.nodeType?[r]:r,y=0;y<g.length;y+=1)if(g[y]===h)return!0;return!1}return!1}function R3(){let r=this[0],o;if(r){for(o=0;(r=r.previousSibling)!==null;)r.nodeType===1&&(o+=1);return o}}function O3(r){if(typeof r=="undefined")return this;const o=this.length;if(r>o-1)return Rt([]);if(r<0){const l=o+r;return l<0?Rt([]):Rt([this[l]])}return Rt([this[r]])}function B3(...r){let o;const l=jr();for(let h=0;h<r.length;h+=1){o=r[h];for(let g=0;g<this.length;g+=1)if(typeof o=="string"){const y=l.createElement("div");for(y.innerHTML=o;y.firstChild;)this[g].appendChild(y.firstChild)}else if(o instanceof na)for(let y=0;y<o.length;y+=1)this[g].appendChild(o[y]);else this[g].appendChild(o)}return this}function F3(r){const o=jr();let l,h;for(l=0;l<this.length;l+=1)if(typeof r=="string"){const g=o.createElement("div");for(g.innerHTML=r,h=g.childNodes.length-1;h>=0;h-=1)this[l].insertBefore(g.childNodes[h],this[l].childNodes[0])}else if(r instanceof na)for(h=0;h<r.length;h+=1)this[l].insertBefore(r[h],this[l].childNodes[0]);else this[l].insertBefore(r,this[l].childNodes[0]);return this}function N3(r){return this.length>0?r?this[0].nextElementSibling&&Rt(this[0].nextElementSibling).is(r)?Rt([this[0].nextElementSibling]):Rt([]):this[0].nextElementSibling?Rt([this[0].nextElementSibling]):Rt([]):Rt([])}function U3(r){const o=[];let l=this[0];if(!l)return Rt([]);for(;l.nextElementSibling;){const h=l.nextElementSibling;r?Rt(h).is(r)&&o.push(h):o.push(h),l=h}return Rt(o)}function j3(r){if(this.length>0){const o=this[0];return r?o.previousElementSibling&&Rt(o.previousElementSibling).is(r)?Rt([o.previousElementSibling]):Rt([]):o.previousElementSibling?Rt([o.previousElementSibling]):Rt([])}return Rt([])}function V3(r){const o=[];let l=this[0];if(!l)return Rt([]);for(;l.previousElementSibling;){const h=l.previousElementSibling;r?Rt(h).is(r)&&o.push(h):o.push(h),l=h}return Rt(o)}function $3(r){const o=[];for(let l=0;l<this.length;l+=1)this[l].parentNode!==null&&(r?Rt(this[l].parentNode).is(r)&&o.push(this[l].parentNode):o.push(this[l].parentNode));return Rt(o)}function G3(r){const o=[];for(let l=0;l<this.length;l+=1){let h=this[l].parentNode;for(;h;)r?Rt(h).is(r)&&o.push(h):o.push(h),h=h.parentNode}return Rt(o)}function q3(r){let o=this;return typeof r=="undefined"?Rt([]):(o.is(r)||(o=o.parents(r).eq(0)),o)}function Z3(r){const o=[];for(let l=0;l<this.length;l+=1){const h=this[l].querySelectorAll(r);for(let g=0;g<h.length;g+=1)o.push(h[g])}return Rt(o)}function W3(r){const o=[];for(let l=0;l<this.length;l+=1){const h=this[l].children;for(let g=0;g<h.length;g+=1)(!r||Rt(h[g]).is(r))&&o.push(h[g])}return Rt(o)}function H3(){for(let r=0;r<this.length;r+=1)this[r].parentNode&&this[r].parentNode.removeChild(this[r]);return this}const xx={addClass:p3,removeClass:f3,hasClass:g3,toggleClass:m3,attr:_3,removeAttr:y3,transform:v3,transition:x3,on:b3,off:w3,trigger:T3,transitionEnd:E3,outerWidth:S3,outerHeight:C3,styles:M3,offset:A3,css:I3,each:k3,html:P3,text:D3,is:L3,index:R3,eq:O3,append:B3,prepend:F3,next:N3,nextAll:U3,prev:j3,prevAll:V3,parent:$3,parents:G3,closest:q3,find:Z3,children:W3,filter:z3,remove:H3};Object.keys(xx).forEach(r=>{Object.defineProperty(Rt.fn,r,{value:xx[r],writable:!0})});function X3(r){const o=r;Object.keys(o).forEach(l=>{try{o[l]=null}catch{}try{delete o[l]}catch{}})}function Ug(r,o=0){return setTimeout(r,o)}function yh(){return Date.now()}function K3(r){const o=Un();let l;return o.getComputedStyle&&(l=o.getComputedStyle(r,null)),!l&&r.currentStyle&&(l=r.currentStyle),l||(l=r.style),l}function Y3(r,o="x"){const l=Un();let h,g,y;const E=K3(r);return l.WebKitCSSMatrix?(g=E.transform||E.webkitTransform,g.split(",").length>6&&(g=g.split(", ").map(s=>s.replace(",",".")).join(", ")),y=new l.WebKitCSSMatrix(g==="none"?"":g)):(y=E.MozTransform||E.OTransform||E.MsTransform||E.msTransform||E.transform||E.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),h=y.toString().split(",")),o==="x"&&(l.WebKitCSSMatrix?g=y.m41:h.length===16?g=parseFloat(h[12]):g=parseFloat(h[4])),o==="y"&&(l.WebKitCSSMatrix?g=y.m42:h.length===16?g=parseFloat(h[13]):g=parseFloat(h[5])),g||0}function rp(r){return typeof r=="object"&&r!==null&&r.constructor&&Object.prototype.toString.call(r).slice(8,-1)==="Object"}function J3(r){return typeof window!="undefined"&&typeof window.HTMLElement!="undefined"?r instanceof HTMLElement:r&&(r.nodeType===1||r.nodeType===11)}function Rr(...r){const o=Object(r[0]),l=["__proto__","constructor","prototype"];for(let h=1;h<r.length;h+=1){const g=r[h];if(g!=null&&!J3(g)){const y=Object.keys(Object(g)).filter(E=>l.indexOf(E)<0);for(let E=0,s=y.length;E<s;E+=1){const C=y[E],k=Object.getOwnPropertyDescriptor(g,C);k!==void 0&&k.enumerable&&(rp(o[C])&&rp(g[C])?g[C].__swiper__?o[C]=g[C]:Rr(o[C],g[C]):!rp(o[C])&&rp(g[C])?(o[C]={},g[C].__swiper__?o[C]=g[C]:Rr(o[C],g[C])):o[C]=g[C])}}}return o}function op(r,o,l){r.style.setProperty(o,l)}function lw({swiper:r,targetPosition:o,side:l}){const h=Un(),g=-r.translate;let y=null,E;const s=r.params.speed;r.wrapperEl.style.scrollSnapType="none",h.cancelAnimationFrame(r.cssModeFrameID);const C=o>g?"next":"prev",k=(D,R)=>C==="next"&&D>=R||C==="prev"&&D<=R,M=()=>{E=new Date().getTime(),y===null&&(y=E);const D=Math.max(Math.min((E-y)/s,1),0),R=.5-Math.cos(D*Math.PI)/2;let U=g+R*(o-g);if(k(U,o)&&(U=o),r.wrapperEl.scrollTo({[l]:U}),k(U,o)){r.wrapperEl.style.overflow="hidden",r.wrapperEl.style.scrollSnapType="",setTimeout(()=>{r.wrapperEl.style.overflow="",r.wrapperEl.scrollTo({[l]:U})}),h.cancelAnimationFrame(r.cssModeFrameID);return}r.cssModeFrameID=h.requestAnimationFrame(M)};M()}let Xm;function Q3(){const r=Un(),o=jr();return{smoothScroll:o.documentElement&&"scrollBehavior"in o.documentElement.style,touch:!!("ontouchstart"in r||r.DocumentTouch&&o instanceof r.DocumentTouch),passiveListener:function(){let h=!1;try{const g=Object.defineProperty({},"passive",{get(){h=!0}});r.addEventListener("testPassiveListener",null,g)}catch{}return h}(),gestures:function(){return"ongesturestart"in r}()}}function cw(){return Xm||(Xm=Q3()),Xm}let Km;function ez({userAgent:r}={}){const o=cw(),l=Un(),h=l.navigator.platform,g=r||l.navigator.userAgent,y={ios:!1,android:!1},E=l.screen.width,s=l.screen.height,C=g.match(/(Android);?[\s\/]+([\d.]+)?/);let k=g.match(/(iPad).*OS\s([\d_]+)/);const M=g.match(/(iPod)(.*OS\s([\d_]+))?/),D=!k&&g.match(/(iPhone\sOS|iOS)\s([\d_]+)/),R=h==="Win32";let U=h==="MacIntel";const ge=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!k&&U&&o.touch&&ge.indexOf(`${E}x${s}`)>=0&&(k=g.match(/(Version)\/([\d.]+)/),k||(k=[0,1,"13_0_0"]),U=!1),C&&!R&&(y.os="android",y.android=!0),(k||D||M)&&(y.os="ios",y.ios=!0),y}function tz(r={}){return Km||(Km=ez(r)),Km}let Ym;function iz(){const r=Un();function o(){const l=r.navigator.userAgent.toLowerCase();return l.indexOf("safari")>=0&&l.indexOf("chrome")<0&&l.indexOf("android")<0}return{isSafari:o(),isWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(r.navigator.userAgent)}}function nz(){return Ym||(Ym=iz()),Ym}function rz({swiper:r,on:o,emit:l}){const h=Un();let g=null;const y=()=>{!r||r.destroyed||!r.initialized||(l("beforeResize"),l("resize"))},E=()=>{!r||r.destroyed||!r.initialized||(g=new ResizeObserver(k=>{const{width:M,height:D}=r;let R=M,U=D;k.forEach(({contentBoxSize:ge,contentRect:Ee,target:be})=>{be&&be!==r.el||(R=Ee?Ee.width:(ge[0]||ge).inlineSize,U=Ee?Ee.height:(ge[0]||ge).blockSize)}),(R!==M||U!==D)&&y()}),g.observe(r.el))},s=()=>{g&&g.unobserve&&r.el&&(g.unobserve(r.el),g=null)},C=()=>{!r||r.destroyed||!r.initialized||l("orientationchange")};o("init",()=>{if(r.params.resizeObserver&&typeof h.ResizeObserver!="undefined"){E();return}h.addEventListener("resize",y),h.addEventListener("orientationchange",C)}),o("destroy",()=>{s(),h.removeEventListener("resize",y),h.removeEventListener("orientationchange",C)})}function oz({swiper:r,extendParams:o,on:l,emit:h}){const g=[],y=Un(),E=(k,M={})=>{const D=y.MutationObserver||y.WebkitMutationObserver,R=new D(U=>{if(U.length===1){h("observerUpdate",U[0]);return}const ge=function(){h("observerUpdate",U[0])};y.requestAnimationFrame?y.requestAnimationFrame(ge):y.setTimeout(ge,0)});R.observe(k,{attributes:typeof M.attributes=="undefined"?!0:M.attributes,childList:typeof M.childList=="undefined"?!0:M.childList,characterData:typeof M.characterData=="undefined"?!0:M.characterData}),g.push(R)},s=()=>{if(!!r.params.observer){if(r.params.observeParents){const k=r.$el.parents();for(let M=0;M<k.length;M+=1)E(k[M])}E(r.$el[0],{childList:r.params.observeSlideChildren}),E(r.$wrapperEl[0],{attributes:!1})}},C=()=>{g.forEach(k=>{k.disconnect()}),g.splice(0,g.length)};o({observer:!1,observeParents:!1,observeSlideChildren:!1}),l("init",s),l("destroy",C)}var sz={on(r,o,l){const h=this;if(typeof o!="function")return h;const g=l?"unshift":"push";return r.split(" ").forEach(y=>{h.eventsListeners[y]||(h.eventsListeners[y]=[]),h.eventsListeners[y][g](o)}),h},once(r,o,l){const h=this;if(typeof o!="function")return h;function g(...y){h.off(r,g),g.__emitterProxy&&delete g.__emitterProxy,o.apply(h,y)}return g.__emitterProxy=o,h.on(r,g,l)},onAny(r,o){const l=this;if(typeof r!="function")return l;const h=o?"unshift":"push";return l.eventsAnyListeners.indexOf(r)<0&&l.eventsAnyListeners[h](r),l},offAny(r){const o=this;if(!o.eventsAnyListeners)return o;const l=o.eventsAnyListeners.indexOf(r);return l>=0&&o.eventsAnyListeners.splice(l,1),o},off(r,o){const l=this;return l.eventsListeners&&r.split(" ").forEach(h=>{typeof o=="undefined"?l.eventsListeners[h]=[]:l.eventsListeners[h]&&l.eventsListeners[h].forEach((g,y)=>{(g===o||g.__emitterProxy&&g.__emitterProxy===o)&&l.eventsListeners[h].splice(y,1)})}),l},emit(...r){const o=this;if(!o.eventsListeners)return o;let l,h,g;return typeof r[0]=="string"||Array.isArray(r[0])?(l=r[0],h=r.slice(1,r.length),g=o):(l=r[0].events,h=r[0].data,g=r[0].context||o),h.unshift(g),(Array.isArray(l)?l:l.split(" ")).forEach(E=>{o.eventsAnyListeners&&o.eventsAnyListeners.length&&o.eventsAnyListeners.forEach(s=>{s.apply(g,[E,...h])}),o.eventsListeners&&o.eventsListeners[E]&&o.eventsListeners[E].forEach(s=>{s.apply(g,h)})}),o}};function az(){const r=this;let o,l;const h=r.$el;typeof r.params.width!="undefined"&&r.params.width!==null?o=r.params.width:o=h[0].clientWidth,typeof r.params.height!="undefined"&&r.params.height!==null?l=r.params.height:l=h[0].clientHeight,!(o===0&&r.isHorizontal()||l===0&&r.isVertical())&&(o=o-parseInt(h.css("padding-left")||0,10)-parseInt(h.css("padding-right")||0,10),l=l-parseInt(h.css("padding-top")||0,10)-parseInt(h.css("padding-bottom")||0,10),Number.isNaN(o)&&(o=0),Number.isNaN(l)&&(l=0),Object.assign(r,{width:o,height:l,size:r.isHorizontal()?o:l}))}function lz(){const r=this;function o(Ct){return r.isHorizontal()?Ct:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[Ct]}function l(Ct,Tt){return parseFloat(Ct.getPropertyValue(o(Tt))||0)}const h=r.params,{$wrapperEl:g,size:y,rtlTranslate:E,wrongRTL:s}=r,C=r.virtual&&h.virtual.enabled,k=C?r.virtual.slides.length:r.slides.length,M=g.children(`.${r.params.slideClass}`),D=C?r.virtual.slides.length:M.length;let R=[];const U=[],ge=[];let Ee=h.slidesOffsetBefore;typeof Ee=="function"&&(Ee=h.slidesOffsetBefore.call(r));let be=h.slidesOffsetAfter;typeof be=="function"&&(be=h.slidesOffsetAfter.call(r));const we=r.snapGrid.length,De=r.slidesGrid.length;let Xe=h.spaceBetween,Ue=-Ee,st=0,ut=0;if(typeof y=="undefined")return;typeof Xe=="string"&&Xe.indexOf("%")>=0&&(Xe=parseFloat(Xe.replace("%",""))/100*y),r.virtualSize=-Xe,E?M.css({marginLeft:"",marginBottom:"",marginTop:""}):M.css({marginRight:"",marginBottom:"",marginTop:""}),h.centeredSlides&&h.cssMode&&(op(r.wrapperEl,"--swiper-centered-offset-before",""),op(r.wrapperEl,"--swiper-centered-offset-after",""));const lt=h.grid&&h.grid.rows>1&&r.grid;lt&&r.grid.initSlides(D);let It;const Ft=h.slidesPerView==="auto"&&h.breakpoints&&Object.keys(h.breakpoints).filter(Ct=>typeof h.breakpoints[Ct].slidesPerView!="undefined").length>0;for(let Ct=0;Ct<D;Ct+=1){It=0;const Tt=M.eq(Ct);if(lt&&r.grid.updateSlide(Ct,Tt,D,o),Tt.css("display")!=="none"){if(h.slidesPerView==="auto"){Ft&&(M[Ct].style[o("width")]="");const ot=getComputedStyle(Tt[0]),Nt=Tt[0].style.transform,Ai=Tt[0].style.webkitTransform;if(Nt&&(Tt[0].style.transform="none"),Ai&&(Tt[0].style.webkitTransform="none"),h.roundLengths)It=r.isHorizontal()?Tt.outerWidth(!0):Tt.outerHeight(!0);else{const Zi=l(ot,"width"),ri=l(ot,"padding-left"),qt=l(ot,"padding-right"),ei=l(ot,"margin-left"),Si=l(ot,"margin-right"),Qi=ot.getPropertyValue("box-sizing");if(Qi&&Qi==="border-box")It=Zi+ei+Si;else{const{clientWidth:Et,offsetWidth:en}=Tt[0];It=Zi+ri+qt+ei+Si+(en-Et)}}Nt&&(Tt[0].style.transform=Nt),Ai&&(Tt[0].style.webkitTransform=Ai),h.roundLengths&&(It=Math.floor(It))}else It=(y-(h.slidesPerView-1)*Xe)/h.slidesPerView,h.roundLengths&&(It=Math.floor(It)),M[Ct]&&(M[Ct].style[o("width")]=`${It}px`);M[Ct]&&(M[Ct].swiperSlideSize=It),ge.push(It),h.centeredSlides?(Ue=Ue+It/2+st/2+Xe,st===0&&Ct!==0&&(Ue=Ue-y/2-Xe),Ct===0&&(Ue=Ue-y/2-Xe),Math.abs(Ue)<1/1e3&&(Ue=0),h.roundLengths&&(Ue=Math.floor(Ue)),ut%h.slidesPerGroup===0&&R.push(Ue),U.push(Ue)):(h.roundLengths&&(Ue=Math.floor(Ue)),(ut-Math.min(r.params.slidesPerGroupSkip,ut))%r.params.slidesPerGroup===0&&R.push(Ue),U.push(Ue),Ue=Ue+It+Xe),r.virtualSize+=It+Xe,st=It,ut+=1}}if(r.virtualSize=Math.max(r.virtualSize,y)+be,E&&s&&(h.effect==="slide"||h.effect==="coverflow")&&g.css({width:`${r.virtualSize+h.spaceBetween}px`}),h.setWrapperSize&&g.css({[o("width")]:`${r.virtualSize+h.spaceBetween}px`}),lt&&r.grid.updateWrapperSize(It,R,o),!h.centeredSlides){const Ct=[];for(let Tt=0;Tt<R.length;Tt+=1){let ot=R[Tt];h.roundLengths&&(ot=Math.floor(ot)),R[Tt]<=r.virtualSize-y&&Ct.push(ot)}R=Ct,Math.floor(r.virtualSize-y)-Math.floor(R[R.length-1])>1&&R.push(r.virtualSize-y)}if(R.length===0&&(R=[0]),h.spaceBetween!==0){const Ct=r.isHorizontal()&&E?"marginLeft":o("marginRight");M.filter((Tt,ot)=>h.cssMode?ot!==M.length-1:!0).css({[Ct]:`${Xe}px`})}if(h.centeredSlides&&h.centeredSlidesBounds){let Ct=0;ge.forEach(ot=>{Ct+=ot+(h.spaceBetween?h.spaceBetween:0)}),Ct-=h.spaceBetween;const Tt=Ct-y;R=R.map(ot=>ot<0?-Ee:ot>Tt?Tt+be:ot)}if(h.centerInsufficientSlides){let Ct=0;if(ge.forEach(Tt=>{Ct+=Tt+(h.spaceBetween?h.spaceBetween:0)}),Ct-=h.spaceBetween,Ct<y){const Tt=(y-Ct)/2;R.forEach((ot,Nt)=>{R[Nt]=ot-Tt}),U.forEach((ot,Nt)=>{U[Nt]=ot+Tt})}}if(Object.assign(r,{slides:M,snapGrid:R,slidesGrid:U,slidesSizesGrid:ge}),h.centeredSlides&&h.cssMode&&!h.centeredSlidesBounds){op(r.wrapperEl,"--swiper-centered-offset-before",`${-R[0]}px`),op(r.wrapperEl,"--swiper-centered-offset-after",`${r.size/2-ge[ge.length-1]/2}px`);const Ct=-r.snapGrid[0],Tt=-r.slidesGrid[0];r.snapGrid=r.snapGrid.map(ot=>ot+Ct),r.slidesGrid=r.slidesGrid.map(ot=>ot+Tt)}D!==k&&r.emit("slidesLengthChange"),R.length!==we&&(r.params.watchOverflow&&r.checkOverflow(),r.emit("snapGridLengthChange")),U.length!==De&&r.emit("slidesGridLengthChange"),h.watchSlidesProgress&&r.updateSlidesOffset()}function cz(r){const o=this,l=[],h=o.virtual&&o.params.virtual.enabled;let g=0,y;typeof r=="number"?o.setTransition(r):r===!0&&o.setTransition(o.params.speed);const E=s=>h?o.slides.filter(C=>parseInt(C.getAttribute("data-swiper-slide-index"),10)===s)[0]:o.slides.eq(s)[0];if(o.params.slidesPerView!=="auto"&&o.params.slidesPerView>1)if(o.params.centeredSlides)o.visibleSlides.each(s=>{l.push(s)});else for(y=0;y<Math.ceil(o.params.slidesPerView);y+=1){const s=o.activeIndex+y;if(s>o.slides.length&&!h)break;l.push(E(s))}else l.push(E(o.activeIndex));for(y=0;y<l.length;y+=1)if(typeof l[y]!="undefined"){const s=l[y].offsetHeight;g=s>g?s:g}(g||g===0)&&o.$wrapperEl.css("height",`${g}px`)}function uz(){const r=this,o=r.slides;for(let l=0;l<o.length;l+=1)o[l].swiperSlideOffset=r.isHorizontal()?o[l].offsetLeft:o[l].offsetTop}function hz(r=this&&this.translate||0){const o=this,l=o.params,{slides:h,rtlTranslate:g,snapGrid:y}=o;if(h.length===0)return;typeof h[0].swiperSlideOffset=="undefined"&&o.updateSlidesOffset();let E=-r;g&&(E=r),h.removeClass(l.slideVisibleClass),o.visibleSlidesIndexes=[],o.visibleSlides=[];for(let s=0;s<h.length;s+=1){const C=h[s];let k=C.swiperSlideOffset;l.cssMode&&l.centeredSlides&&(k-=h[0].swiperSlideOffset);const M=(E+(l.centeredSlides?o.minTranslate():0)-k)/(C.swiperSlideSize+l.spaceBetween),D=(E-y[0]+(l.centeredSlides?o.minTranslate():0)-k)/(C.swiperSlideSize+l.spaceBetween),R=-(E-k),U=R+o.slidesSizesGrid[s];(R>=0&&R<o.size-1||U>1&&U<=o.size||R<=0&&U>=o.size)&&(o.visibleSlides.push(C),o.visibleSlidesIndexes.push(s),h.eq(s).addClass(l.slideVisibleClass)),C.progress=g?-M:M,C.originalProgress=g?-D:D}o.visibleSlides=Rt(o.visibleSlides)}function dz(r){const o=this;if(typeof r=="undefined"){const k=o.rtlTranslate?-1:1;r=o&&o.translate&&o.translate*k||0}const l=o.params,h=o.maxTranslate()-o.minTranslate();let{progress:g,isBeginning:y,isEnd:E}=o;const s=y,C=E;h===0?(g=0,y=!0,E=!0):(g=(r-o.minTranslate())/h,y=g<=0,E=g>=1),Object.assign(o,{progress:g,isBeginning:y,isEnd:E}),(l.watchSlidesProgress||l.centeredSlides&&l.autoHeight)&&o.updateSlidesProgress(r),y&&!s&&o.emit("reachBeginning toEdge"),E&&!C&&o.emit("reachEnd toEdge"),(s&&!y||C&&!E)&&o.emit("fromEdge"),o.emit("progress",g)}function pz(){const r=this,{slides:o,params:l,$wrapperEl:h,activeIndex:g,realIndex:y}=r,E=r.virtual&&l.virtual.enabled;o.removeClass(`${l.slideActiveClass} ${l.slideNextClass} ${l.slidePrevClass} ${l.slideDuplicateActiveClass} ${l.slideDuplicateNextClass} ${l.slideDuplicatePrevClass}`);let s;E?s=r.$wrapperEl.find(`.${l.slideClass}[data-swiper-slide-index="${g}"]`):s=o.eq(g),s.addClass(l.slideActiveClass),l.loop&&(s.hasClass(l.slideDuplicateClass)?h.children(`.${l.slideClass}:not(.${l.slideDuplicateClass})[data-swiper-slide-index="${y}"]`).addClass(l.slideDuplicateActiveClass):h.children(`.${l.slideClass}.${l.slideDuplicateClass}[data-swiper-slide-index="${y}"]`).addClass(l.slideDuplicateActiveClass));let C=s.nextAll(`.${l.slideClass}`).eq(0).addClass(l.slideNextClass);l.loop&&C.length===0&&(C=o.eq(0),C.addClass(l.slideNextClass));let k=s.prevAll(`.${l.slideClass}`).eq(0).addClass(l.slidePrevClass);l.loop&&k.length===0&&(k=o.eq(-1),k.addClass(l.slidePrevClass)),l.loop&&(C.hasClass(l.slideDuplicateClass)?h.children(`.${l.slideClass}:not(.${l.slideDuplicateClass})[data-swiper-slide-index="${C.attr("data-swiper-slide-index")}"]`).addClass(l.slideDuplicateNextClass):h.children(`.${l.slideClass}.${l.slideDuplicateClass}[data-swiper-slide-index="${C.attr("data-swiper-slide-index")}"]`).addClass(l.slideDuplicateNextClass),k.hasClass(l.slideDuplicateClass)?h.children(`.${l.slideClass}:not(.${l.slideDuplicateClass})[data-swiper-slide-index="${k.attr("data-swiper-slide-index")}"]`).addClass(l.slideDuplicatePrevClass):h.children(`.${l.slideClass}.${l.slideDuplicateClass}[data-swiper-slide-index="${k.attr("data-swiper-slide-index")}"]`).addClass(l.slideDuplicatePrevClass)),r.emitSlidesClasses()}function fz(r){const o=this,l=o.rtlTranslate?o.translate:-o.translate,{slidesGrid:h,snapGrid:g,params:y,activeIndex:E,realIndex:s,snapIndex:C}=o;let k=r,M;if(typeof k=="undefined"){for(let R=0;R<h.length;R+=1)typeof h[R+1]!="undefined"?l>=h[R]&&l<h[R+1]-(h[R+1]-h[R])/2?k=R:l>=h[R]&&l<h[R+1]&&(k=R+1):l>=h[R]&&(k=R);y.normalizeSlideIndex&&(k<0||typeof k=="undefined")&&(k=0)}if(g.indexOf(l)>=0)M=g.indexOf(l);else{const R=Math.min(y.slidesPerGroupSkip,k);M=R+Math.floor((k-R)/y.slidesPerGroup)}if(M>=g.length&&(M=g.length-1),k===E){M!==C&&(o.snapIndex=M,o.emit("snapIndexChange"));return}const D=parseInt(o.slides.eq(k).attr("data-swiper-slide-index")||k,10);Object.assign(o,{snapIndex:M,realIndex:D,previousIndex:E,activeIndex:k}),o.emit("activeIndexChange"),o.emit("snapIndexChange"),s!==D&&o.emit("realIndexChange"),(o.initialized||o.params.runCallbacksOnInit)&&o.emit("slideChange")}function mz(r){const o=this,l=o.params,h=Rt(r).closest(`.${l.slideClass}`)[0];let g=!1,y;if(h){for(let E=0;E<o.slides.length;E+=1)if(o.slides[E]===h){g=!0,y=E;break}}if(h&&g)o.clickedSlide=h,o.virtual&&o.params.virtual.enabled?o.clickedIndex=parseInt(Rt(h).attr("data-swiper-slide-index"),10):o.clickedIndex=y;else{o.clickedSlide=void 0,o.clickedIndex=void 0;return}l.slideToClickedSlide&&o.clickedIndex!==void 0&&o.clickedIndex!==o.activeIndex&&o.slideToClickedSlide()}var gz={updateSize:az,updateSlides:lz,updateAutoHeight:cz,updateSlidesOffset:uz,updateSlidesProgress:hz,updateProgress:dz,updateSlidesClasses:pz,updateActiveIndex:fz,updateClickedSlide:mz};function _z(r=this.isHorizontal()?"x":"y"){const o=this,{params:l,rtlTranslate:h,translate:g,$wrapperEl:y}=o;if(l.virtualTranslate)return h?-g:g;if(l.cssMode)return g;let E=Y3(y[0],r);return h&&(E=-E),E||0}function yz(r,o){const l=this,{rtlTranslate:h,params:g,$wrapperEl:y,wrapperEl:E,progress:s}=l;let C=0,k=0;const M=0;l.isHorizontal()?C=h?-r:r:k=r,g.roundLengths&&(C=Math.floor(C),k=Math.floor(k)),g.cssMode?E[l.isHorizontal()?"scrollLeft":"scrollTop"]=l.isHorizontal()?-C:-k:g.virtualTranslate||y.transform(`translate3d(${C}px, ${k}px, ${M}px)`),l.previousTranslate=l.translate,l.translate=l.isHorizontal()?C:k;let D;const R=l.maxTranslate()-l.minTranslate();R===0?D=0:D=(r-l.minTranslate())/R,D!==s&&l.updateProgress(r),l.emit("setTranslate",l.translate,o)}function vz(){return-this.snapGrid[0]}function xz(){return-this.snapGrid[this.snapGrid.length-1]}function bz(r=0,o=this.params.speed,l=!0,h=!0,g){const y=this,{params:E,wrapperEl:s}=y;if(y.animating&&E.preventInteractionOnTransition)return!1;const C=y.minTranslate(),k=y.maxTranslate();let M;if(h&&r>C?M=C:h&&r<k?M=k:M=r,y.updateProgress(M),E.cssMode){const D=y.isHorizontal();if(o===0)s[D?"scrollLeft":"scrollTop"]=-M;else{if(!y.support.smoothScroll)return lw({swiper:y,targetPosition:-M,side:D?"left":"top"}),!0;s.scrollTo({[D?"left":"top"]:-M,behavior:"smooth"})}return!0}return o===0?(y.setTransition(0),y.setTranslate(M),l&&(y.emit("beforeTransitionStart",o,g),y.emit("transitionEnd"))):(y.setTransition(o),y.setTranslate(M),l&&(y.emit("beforeTransitionStart",o,g),y.emit("transitionStart")),y.animating||(y.animating=!0,y.onTranslateToWrapperTransitionEnd||(y.onTranslateToWrapperTransitionEnd=function(R){!y||y.destroyed||R.target===this&&(y.$wrapperEl[0].removeEventListener("transitionend",y.onTranslateToWrapperTransitionEnd),y.$wrapperEl[0].removeEventListener("webkitTransitionEnd",y.onTranslateToWrapperTransitionEnd),y.onTranslateToWrapperTransitionEnd=null,delete y.onTranslateToWrapperTransitionEnd,l&&y.emit("transitionEnd"))}),y.$wrapperEl[0].addEventListener("transitionend",y.onTranslateToWrapperTransitionEnd),y.$wrapperEl[0].addEventListener("webkitTransitionEnd",y.onTranslateToWrapperTransitionEnd))),!0}var wz={getTranslate:_z,setTranslate:yz,minTranslate:vz,maxTranslate:xz,translateTo:bz};function Tz(r,o){const l=this;l.params.cssMode||l.$wrapperEl.transition(r),l.emit("setTransition",r,o)}function uw({swiper:r,runCallbacks:o,direction:l,step:h}){const{activeIndex:g,previousIndex:y}=r;let E=l;if(E||(g>y?E="next":g<y?E="prev":E="reset"),r.emit(`transition${h}`),o&&g!==y){if(E==="reset"){r.emit(`slideResetTransition${h}`);return}r.emit(`slideChangeTransition${h}`),E==="next"?r.emit(`slideNextTransition${h}`):r.emit(`slidePrevTransition${h}`)}}function Ez(r=!0,o){const l=this,{params:h}=l;h.cssMode||(h.autoHeight&&l.updateAutoHeight(),uw({swiper:l,runCallbacks:r,direction:o,step:"Start"}))}function Sz(r=!0,o){const l=this,{params:h}=l;l.animating=!1,!h.cssMode&&(l.setTransition(0),uw({swiper:l,runCallbacks:r,direction:o,step:"End"}))}var Cz={setTransition:Tz,transitionStart:Ez,transitionEnd:Sz};function Az(r=0,o=this.params.speed,l=!0,h,g){if(typeof r!="number"&&typeof r!="string")throw new Error(`The 'index' argument cannot have type other than 'number' or 'string'. [${typeof r}] given.`);if(typeof r=="string"){const Xe=parseInt(r,10);if(!isFinite(Xe))throw new Error(`The passed-in 'index' (string) couldn't be converted to 'number'. [${r}] given.`);r=Xe}const y=this;let E=r;E<0&&(E=0);const{params:s,snapGrid:C,slidesGrid:k,previousIndex:M,activeIndex:D,rtlTranslate:R,wrapperEl:U,enabled:ge}=y;if(y.animating&&s.preventInteractionOnTransition||!ge&&!h&&!g)return!1;const Ee=Math.min(y.params.slidesPerGroupSkip,E);let be=Ee+Math.floor((E-Ee)/y.params.slidesPerGroup);be>=C.length&&(be=C.length-1),(D||s.initialSlide||0)===(M||0)&&l&&y.emit("beforeSlideChangeStart");const we=-C[be];if(y.updateProgress(we),s.normalizeSlideIndex)for(let Xe=0;Xe<k.length;Xe+=1){const Ue=-Math.floor(we*100),st=Math.floor(k[Xe]*100),ut=Math.floor(k[Xe+1]*100);typeof k[Xe+1]!="undefined"?Ue>=st&&Ue<ut-(ut-st)/2?E=Xe:Ue>=st&&Ue<ut&&(E=Xe+1):Ue>=st&&(E=Xe)}if(y.initialized&&E!==D&&(!y.allowSlideNext&&we<y.translate&&we<y.minTranslate()||!y.allowSlidePrev&&we>y.translate&&we>y.maxTranslate()&&(D||0)!==E))return!1;let De;if(E>D?De="next":E<D?De="prev":De="reset",R&&-we===y.translate||!R&&we===y.translate)return y.updateActiveIndex(E),s.autoHeight&&y.updateAutoHeight(),y.updateSlidesClasses(),s.effect!=="slide"&&y.setTranslate(we),De!=="reset"&&(y.transitionStart(l,De),y.transitionEnd(l,De)),!1;if(s.cssMode){const Xe=y.isHorizontal(),Ue=R?we:-we;if(o===0){const st=y.virtual&&y.params.virtual.enabled;st&&(y.wrapperEl.style.scrollSnapType="none",y._immediateVirtual=!0),U[Xe?"scrollLeft":"scrollTop"]=Ue,st&&requestAnimationFrame(()=>{y.wrapperEl.style.scrollSnapType="",y._swiperImmediateVirtual=!1})}else{if(!y.support.smoothScroll)return lw({swiper:y,targetPosition:Ue,side:Xe?"left":"top"}),!0;U.scrollTo({[Xe?"left":"top"]:Ue,behavior:"smooth"})}return!0}return y.setTransition(o),y.setTranslate(we),y.updateActiveIndex(E),y.updateSlidesClasses(),y.emit("beforeTransitionStart",o,h),y.transitionStart(l,De),o===0?y.transitionEnd(l,De):y.animating||(y.animating=!0,y.onSlideToWrapperTransitionEnd||(y.onSlideToWrapperTransitionEnd=function(Ue){!y||y.destroyed||Ue.target===this&&(y.$wrapperEl[0].removeEventListener("transitionend",y.onSlideToWrapperTransitionEnd),y.$wrapperEl[0].removeEventListener("webkitTransitionEnd",y.onSlideToWrapperTransitionEnd),y.onSlideToWrapperTransitionEnd=null,delete y.onSlideToWrapperTransitionEnd,y.transitionEnd(l,De))}),y.$wrapperEl[0].addEventListener("transitionend",y.onSlideToWrapperTransitionEnd),y.$wrapperEl[0].addEventListener("webkitTransitionEnd",y.onSlideToWrapperTransitionEnd)),!0}function Mz(r=0,o=this.params.speed,l=!0,h){const g=this;let y=r;return g.params.loop&&(y+=g.loopedSlides),g.slideTo(y,o,l,h)}function Iz(r=this.params.speed,o=!0,l){const h=this,{animating:g,enabled:y,params:E}=h;if(!y)return h;let s=E.slidesPerGroup;E.slidesPerView==="auto"&&E.slidesPerGroup===1&&E.slidesPerGroupAuto&&(s=Math.max(h.slidesPerViewDynamic("current",!0),1));const C=h.activeIndex<E.slidesPerGroupSkip?1:s;if(E.loop){if(g&&E.loopPreventsSlide)return!1;h.loopFix(),h._clientLeft=h.$wrapperEl[0].clientLeft}return E.rewind&&h.isEnd?h.slideTo(0,r,o,l):h.slideTo(h.activeIndex+C,r,o,l)}function kz(r=this.params.speed,o=!0,l){const h=this,{params:g,animating:y,snapGrid:E,slidesGrid:s,rtlTranslate:C,enabled:k}=h;if(!k)return h;if(g.loop){if(y&&g.loopPreventsSlide)return!1;h.loopFix(),h._clientLeft=h.$wrapperEl[0].clientLeft}const M=C?h.translate:-h.translate;function D(be){return be<0?-Math.floor(Math.abs(be)):Math.floor(be)}const R=D(M),U=E.map(be=>D(be));let ge=E[U.indexOf(R)-1];if(typeof ge=="undefined"&&g.cssMode){let be;E.forEach((we,De)=>{R>=we&&(be=De)}),typeof be!="undefined"&&(ge=E[be>0?be-1:be])}let Ee=0;return typeof ge!="undefined"&&(Ee=s.indexOf(ge),Ee<0&&(Ee=h.activeIndex-1),g.slidesPerView==="auto"&&g.slidesPerGroup===1&&g.slidesPerGroupAuto&&(Ee=Ee-h.slidesPerViewDynamic("previous",!0)+1,Ee=Math.max(Ee,0))),g.rewind&&h.isBeginning?h.slideTo(h.slides.length-1,r,o,l):h.slideTo(Ee,r,o,l)}function zz(r=this.params.speed,o=!0,l){const h=this;return h.slideTo(h.activeIndex,r,o,l)}function Pz(r=this.params.speed,o=!0,l,h=.5){const g=this;let y=g.activeIndex;const E=Math.min(g.params.slidesPerGroupSkip,y),s=E+Math.floor((y-E)/g.params.slidesPerGroup),C=g.rtlTranslate?g.translate:-g.translate;if(C>=g.snapGrid[s]){const k=g.snapGrid[s],M=g.snapGrid[s+1];C-k>(M-k)*h&&(y+=g.params.slidesPerGroup)}else{const k=g.snapGrid[s-1],M=g.snapGrid[s];C-k<=(M-k)*h&&(y-=g.params.slidesPerGroup)}return y=Math.max(y,0),y=Math.min(y,g.slidesGrid.length-1),g.slideTo(y,r,o,l)}function Dz(){const r=this,{params:o,$wrapperEl:l}=r,h=o.slidesPerView==="auto"?r.slidesPerViewDynamic():o.slidesPerView;let g=r.clickedIndex,y;if(o.loop){if(r.animating)return;y=parseInt(Rt(r.clickedSlide).attr("data-swiper-slide-index"),10),o.centeredSlides?g<r.loopedSlides-h/2||g>r.slides.length-r.loopedSlides+h/2?(r.loopFix(),g=l.children(`.${o.slideClass}[data-swiper-slide-index="${y}"]:not(.${o.slideDuplicateClass})`).eq(0).index(),Ug(()=>{r.slideTo(g)})):r.slideTo(g):g>r.slides.length-h?(r.loopFix(),g=l.children(`.${o.slideClass}[data-swiper-slide-index="${y}"]:not(.${o.slideDuplicateClass})`).eq(0).index(),Ug(()=>{r.slideTo(g)})):r.slideTo(g)}else r.slideTo(g)}var Lz={slideTo:Az,slideToLoop:Mz,slideNext:Iz,slidePrev:kz,slideReset:zz,slideToClosest:Pz,slideToClickedSlide:Dz};function Rz(){const r=this,o=jr(),{params:l,$wrapperEl:h}=r,g=h.children().length>0?Rt(h.children()[0].parentNode):h;g.children(`.${l.slideClass}.${l.slideDuplicateClass}`).remove();let y=g.children(`.${l.slideClass}`);if(l.loopFillGroupWithBlank){const C=l.slidesPerGroup-y.length%l.slidesPerGroup;if(C!==l.slidesPerGroup){for(let k=0;k<C;k+=1){const M=Rt(o.createElement("div")).addClass(`${l.slideClass} ${l.slideBlankClass}`);g.append(M)}y=g.children(`.${l.slideClass}`)}}l.slidesPerView==="auto"&&!l.loopedSlides&&(l.loopedSlides=y.length),r.loopedSlides=Math.ceil(parseFloat(l.loopedSlides||l.slidesPerView,10)),r.loopedSlides+=l.loopAdditionalSlides,r.loopedSlides>y.length&&(r.loopedSlides=y.length);const E=[],s=[];y.each((C,k)=>{const M=Rt(C);k<r.loopedSlides&&s.push(C),k<y.length&&k>=y.length-r.loopedSlides&&E.push(C),M.attr("data-swiper-slide-index",k)});for(let C=0;C<s.length;C+=1)g.append(Rt(s[C].cloneNode(!0)).addClass(l.slideDuplicateClass));for(let C=E.length-1;C>=0;C-=1)g.prepend(Rt(E[C].cloneNode(!0)).addClass(l.slideDuplicateClass))}function Oz(){const r=this;r.emit("beforeLoopFix");const{activeIndex:o,slides:l,loopedSlides:h,allowSlidePrev:g,allowSlideNext:y,snapGrid:E,rtlTranslate:s}=r;let C;r.allowSlidePrev=!0,r.allowSlideNext=!0;const M=-E[o]-r.getTranslate();o<h?(C=l.length-h*3+o,C+=h,r.slideTo(C,0,!1,!0)&&M!==0&&r.setTranslate((s?-r.translate:r.translate)-M)):o>=l.length-h&&(C=-l.length+o+h,C+=h,r.slideTo(C,0,!1,!0)&&M!==0&&r.setTranslate((s?-r.translate:r.translate)-M)),r.allowSlidePrev=g,r.allowSlideNext=y,r.emit("loopFix")}function Bz(){const r=this,{$wrapperEl:o,params:l,slides:h}=r;o.children(`.${l.slideClass}.${l.slideDuplicateClass},.${l.slideClass}.${l.slideBlankClass}`).remove(),h.removeAttr("data-swiper-slide-index")}var Fz={loopCreate:Rz,loopFix:Oz,loopDestroy:Bz};function Nz(r){const o=this;if(o.support.touch||!o.params.simulateTouch||o.params.watchOverflow&&o.isLocked||o.params.cssMode)return;const l=o.params.touchEventsTarget==="container"?o.el:o.wrapperEl;l.style.cursor="move",l.style.cursor=r?"-webkit-grabbing":"-webkit-grab",l.style.cursor=r?"-moz-grabbin":"-moz-grab",l.style.cursor=r?"grabbing":"grab"}function Uz(){const r=this;r.support.touch||r.params.watchOverflow&&r.isLocked||r.params.cssMode||(r[r.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="")}var jz={setGrabCursor:Nz,unsetGrabCursor:Uz};function Vz(r,o=this){function l(h){return!h||h===jr()||h===Un()?null:(h.assignedSlot&&(h=h.assignedSlot),h.closest(r)||l(h.getRootNode().host))}return l(o)}function $z(r){const o=this,l=jr(),h=Un(),g=o.touchEventsData,{params:y,touches:E,enabled:s}=o;if(!s||o.animating&&y.preventInteractionOnTransition)return;!o.animating&&y.cssMode&&y.loop&&o.loopFix();let C=r;C.originalEvent&&(C=C.originalEvent);let k=Rt(C.target);if(y.touchEventsTarget==="wrapper"&&!k.closest(o.wrapperEl).length||(g.isTouchEvent=C.type==="touchstart",!g.isTouchEvent&&"which"in C&&C.which===3)||!g.isTouchEvent&&"button"in C&&C.button>0||g.isTouched&&g.isMoved)return;!!y.noSwipingClass&&y.noSwipingClass!==""&&C.target&&C.target.shadowRoot&&r.path&&r.path[0]&&(k=Rt(r.path[0]));const D=y.noSwipingSelector?y.noSwipingSelector:`.${y.noSwipingClass}`,R=!!(C.target&&C.target.shadowRoot);if(y.noSwiping&&(R?Vz(D,C.target):k.closest(D)[0])){o.allowClick=!0;return}if(y.swipeHandler&&!k.closest(y.swipeHandler)[0])return;E.currentX=C.type==="touchstart"?C.targetTouches[0].pageX:C.pageX,E.currentY=C.type==="touchstart"?C.targetTouches[0].pageY:C.pageY;const U=E.currentX,ge=E.currentY,Ee=y.edgeSwipeDetection||y.iOSEdgeSwipeDetection,be=y.edgeSwipeThreshold||y.iOSEdgeSwipeThreshold;if(Ee&&(U<=be||U>=h.innerWidth-be))if(Ee==="prevent")r.preventDefault();else return;if(Object.assign(g,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),E.startX=U,E.startY=ge,g.touchStartTime=yh(),o.allowClick=!0,o.updateSize(),o.swipeDirection=void 0,y.threshold>0&&(g.allowThresholdMove=!1),C.type!=="touchstart"){let we=!0;k.is(g.focusableElements)&&(we=!1),l.activeElement&&Rt(l.activeElement).is(g.focusableElements)&&l.activeElement!==k[0]&&l.activeElement.blur();const De=we&&o.allowTouchMove&&y.touchStartPreventDefault;(y.touchStartForcePreventDefault||De)&&!k[0].isContentEditable&&C.preventDefault()}o.emit("touchStart",C)}function Gz(r){const o=jr(),l=this,h=l.touchEventsData,{params:g,touches:y,rtlTranslate:E,enabled:s}=l;if(!s)return;let C=r;if(C.originalEvent&&(C=C.originalEvent),!h.isTouched){h.startMoving&&h.isScrolling&&l.emit("touchMoveOpposite",C);return}if(h.isTouchEvent&&C.type!=="touchmove")return;const k=C.type==="touchmove"&&C.targetTouches&&(C.targetTouches[0]||C.changedTouches[0]),M=C.type==="touchmove"?k.pageX:C.pageX,D=C.type==="touchmove"?k.pageY:C.pageY;if(C.preventedByNestedSwiper){y.startX=M,y.startY=D;return}if(!l.allowTouchMove){l.allowClick=!1,h.isTouched&&(Object.assign(y,{startX:M,startY:D,currentX:M,currentY:D}),h.touchStartTime=yh());return}if(h.isTouchEvent&&g.touchReleaseOnEdges&&!g.loop){if(l.isVertical()){if(D<y.startY&&l.translate<=l.maxTranslate()||D>y.startY&&l.translate>=l.minTranslate()){h.isTouched=!1,h.isMoved=!1;return}}else if(M<y.startX&&l.translate<=l.maxTranslate()||M>y.startX&&l.translate>=l.minTranslate())return}if(h.isTouchEvent&&o.activeElement&&C.target===o.activeElement&&Rt(C.target).is(h.focusableElements)){h.isMoved=!0,l.allowClick=!1;return}if(h.allowTouchCallbacks&&l.emit("touchMove",C),C.targetTouches&&C.targetTouches.length>1)return;y.currentX=M,y.currentY=D;const R=y.currentX-y.startX,U=y.currentY-y.startY;if(l.params.threshold&&Math.sqrt(R**2+U**2)<l.params.threshold)return;if(typeof h.isScrolling=="undefined"){let we;l.isHorizontal()&&y.currentY===y.startY||l.isVertical()&&y.currentX===y.startX?h.isScrolling=!1:R*R+U*U>=25&&(we=Math.atan2(Math.abs(U),Math.abs(R))*180/Math.PI,h.isScrolling=l.isHorizontal()?we>g.touchAngle:90-we>g.touchAngle)}if(h.isScrolling&&l.emit("touchMoveOpposite",C),typeof h.startMoving=="undefined"&&(y.currentX!==y.startX||y.currentY!==y.startY)&&(h.startMoving=!0),h.isScrolling){h.isTouched=!1;return}if(!h.startMoving)return;l.allowClick=!1,!g.cssMode&&C.cancelable&&C.preventDefault(),g.touchMoveStopPropagation&&!g.nested&&C.stopPropagation(),h.isMoved||(g.loop&&!g.cssMode&&l.loopFix(),h.startTranslate=l.getTranslate(),l.setTransition(0),l.animating&&l.$wrapperEl.trigger("webkitTransitionEnd transitionend"),h.allowMomentumBounce=!1,g.grabCursor&&(l.allowSlideNext===!0||l.allowSlidePrev===!0)&&l.setGrabCursor(!0),l.emit("sliderFirstMove",C)),l.emit("sliderMove",C),h.isMoved=!0;let ge=l.isHorizontal()?R:U;y.diff=ge,ge*=g.touchRatio,E&&(ge=-ge),l.swipeDirection=ge>0?"prev":"next",h.currentTranslate=ge+h.startTranslate;let Ee=!0,be=g.resistanceRatio;if(g.touchReleaseOnEdges&&(be=0),ge>0&&h.currentTranslate>l.minTranslate()?(Ee=!1,g.resistance&&(h.currentTranslate=l.minTranslate()-1+(-l.minTranslate()+h.startTranslate+ge)**be)):ge<0&&h.currentTranslate<l.maxTranslate()&&(Ee=!1,g.resistance&&(h.currentTranslate=l.maxTranslate()+1-(l.maxTranslate()-h.startTranslate-ge)**be)),Ee&&(C.preventedByNestedSwiper=!0),!l.allowSlideNext&&l.swipeDirection==="next"&&h.currentTranslate<h.startTranslate&&(h.currentTranslate=h.startTranslate),!l.allowSlidePrev&&l.swipeDirection==="prev"&&h.currentTranslate>h.startTranslate&&(h.currentTranslate=h.startTranslate),!l.allowSlidePrev&&!l.allowSlideNext&&(h.currentTranslate=h.startTranslate),g.threshold>0)if(Math.abs(ge)>g.threshold||h.allowThresholdMove){if(!h.allowThresholdMove){h.allowThresholdMove=!0,y.startX=y.currentX,y.startY=y.currentY,h.currentTranslate=h.startTranslate,y.diff=l.isHorizontal()?y.currentX-y.startX:y.currentY-y.startY;return}}else{h.currentTranslate=h.startTranslate;return}!g.followFinger||g.cssMode||((g.freeMode&&g.freeMode.enabled&&l.freeMode||g.watchSlidesProgress)&&(l.updateActiveIndex(),l.updateSlidesClasses()),l.params.freeMode&&g.freeMode.enabled&&l.freeMode&&l.freeMode.onTouchMove(),l.updateProgress(h.currentTranslate),l.setTranslate(h.currentTranslate))}function qz(r){const o=this,l=o.touchEventsData,{params:h,touches:g,rtlTranslate:y,slidesGrid:E,enabled:s}=o;if(!s)return;let C=r;if(C.originalEvent&&(C=C.originalEvent),l.allowTouchCallbacks&&o.emit("touchEnd",C),l.allowTouchCallbacks=!1,!l.isTouched){l.isMoved&&h.grabCursor&&o.setGrabCursor(!1),l.isMoved=!1,l.startMoving=!1;return}h.grabCursor&&l.isMoved&&l.isTouched&&(o.allowSlideNext===!0||o.allowSlidePrev===!0)&&o.setGrabCursor(!1);const k=yh(),M=k-l.touchStartTime;if(o.allowClick){const be=C.path||C.composedPath&&C.composedPath();o.updateClickedSlide(be&&be[0]||C.target),o.emit("tap click",C),M<300&&k-l.lastClickTime<300&&o.emit("doubleTap doubleClick",C)}if(l.lastClickTime=yh(),Ug(()=>{o.destroyed||(o.allowClick=!0)}),!l.isTouched||!l.isMoved||!o.swipeDirection||g.diff===0||l.currentTranslate===l.startTranslate){l.isTouched=!1,l.isMoved=!1,l.startMoving=!1;return}l.isTouched=!1,l.isMoved=!1,l.startMoving=!1;let D;if(h.followFinger?D=y?o.translate:-o.translate:D=-l.currentTranslate,h.cssMode)return;if(o.params.freeMode&&h.freeMode.enabled){o.freeMode.onTouchEnd({currentPos:D});return}let R=0,U=o.slidesSizesGrid[0];for(let be=0;be<E.length;be+=be<h.slidesPerGroupSkip?1:h.slidesPerGroup){const we=be<h.slidesPerGroupSkip-1?1:h.slidesPerGroup;typeof E[be+we]!="undefined"?D>=E[be]&&D<E[be+we]&&(R=be,U=E[be+we]-E[be]):D>=E[be]&&(R=be,U=E[E.length-1]-E[E.length-2])}const ge=(D-E[R])/U,Ee=R<h.slidesPerGroupSkip-1?1:h.slidesPerGroup;if(M>h.longSwipesMs){if(!h.longSwipes){o.slideTo(o.activeIndex);return}o.swipeDirection==="next"&&(ge>=h.longSwipesRatio?o.slideTo(R+Ee):o.slideTo(R)),o.swipeDirection==="prev"&&(ge>1-h.longSwipesRatio?o.slideTo(R+Ee):o.slideTo(R))}else{if(!h.shortSwipes){o.slideTo(o.activeIndex);return}o.navigation&&(C.target===o.navigation.nextEl||C.target===o.navigation.prevEl)?C.target===o.navigation.nextEl?o.slideTo(R+Ee):o.slideTo(R):(o.swipeDirection==="next"&&o.slideTo(R+Ee),o.swipeDirection==="prev"&&o.slideTo(R))}}function bx(){const r=this,{params:o,el:l}=r;if(l&&l.offsetWidth===0)return;o.breakpoints&&r.setBreakpoint();const{allowSlideNext:h,allowSlidePrev:g,snapGrid:y}=r;r.allowSlideNext=!0,r.allowSlidePrev=!0,r.updateSize(),r.updateSlides(),r.updateSlidesClasses(),(o.slidesPerView==="auto"||o.slidesPerView>1)&&r.isEnd&&!r.isBeginning&&!r.params.centeredSlides?r.slideTo(r.slides.length-1,0,!1,!0):r.slideTo(r.activeIndex,0,!1,!0),r.autoplay&&r.autoplay.running&&r.autoplay.paused&&r.autoplay.run(),r.allowSlidePrev=g,r.allowSlideNext=h,r.params.watchOverflow&&y!==r.snapGrid&&r.checkOverflow()}function Zz(r){const o=this;!o.enabled||o.allowClick||(o.params.preventClicks&&r.preventDefault(),o.params.preventClicksPropagation&&o.animating&&(r.stopPropagation(),r.stopImmediatePropagation()))}function Wz(){const r=this,{wrapperEl:o,rtlTranslate:l,enabled:h}=r;if(!h)return;r.previousTranslate=r.translate,r.isHorizontal()?r.translate=-o.scrollLeft:r.translate=-o.scrollTop,r.translate===-0&&(r.translate=0),r.updateActiveIndex(),r.updateSlidesClasses();let g;const y=r.maxTranslate()-r.minTranslate();y===0?g=0:g=(r.translate-r.minTranslate())/y,g!==r.progress&&r.updateProgress(l?-r.translate:r.translate),r.emit("setTranslate",r.translate,!1)}let wx=!1;function Hz(){}const hw=(r,o)=>{const l=jr(),{params:h,touchEvents:g,el:y,wrapperEl:E,device:s,support:C}=r,k=!!h.nested,M=o==="on"?"addEventListener":"removeEventListener",D=o;if(!C.touch)y[M](g.start,r.onTouchStart,!1),l[M](g.move,r.onTouchMove,k),l[M](g.end,r.onTouchEnd,!1);else{const R=g.start==="touchstart"&&C.passiveListener&&h.passiveListeners?{passive:!0,capture:!1}:!1;y[M](g.start,r.onTouchStart,R),y[M](g.move,r.onTouchMove,C.passiveListener?{passive:!1,capture:k}:k),y[M](g.end,r.onTouchEnd,R),g.cancel&&y[M](g.cancel,r.onTouchEnd,R)}(h.preventClicks||h.preventClicksPropagation)&&y[M]("click",r.onClick,!0),h.cssMode&&E[M]("scroll",r.onScroll),h.updateOnWindowResize?r[D](s.ios||s.android?"resize orientationchange observerUpdate":"resize observerUpdate",bx,!0):r[D]("observerUpdate",bx,!0)};function Xz(){const r=this,o=jr(),{params:l,support:h}=r;r.onTouchStart=$z.bind(r),r.onTouchMove=Gz.bind(r),r.onTouchEnd=qz.bind(r),l.cssMode&&(r.onScroll=Wz.bind(r)),r.onClick=Zz.bind(r),h.touch&&!wx&&(o.addEventListener("touchstart",Hz),wx=!0),hw(r,"on")}function Kz(){hw(this,"off")}var Yz={attachEvents:Xz,detachEvents:Kz};const Tx=(r,o)=>r.grid&&o.grid&&o.grid.rows>1;function Jz(){const r=this,{activeIndex:o,initialized:l,loopedSlides:h=0,params:g,$el:y}=r,E=g.breakpoints;if(!E||E&&Object.keys(E).length===0)return;const s=r.getBreakpoint(E,r.params.breakpointsBase,r.el);if(!s||r.currentBreakpoint===s)return;const k=(s in E?E[s]:void 0)||r.originalParams,M=Tx(r,g),D=Tx(r,k),R=g.enabled;M&&!D?(y.removeClass(`${g.containerModifierClass}grid ${g.containerModifierClass}grid-column`),r.emitContainerClasses()):!M&&D&&(y.addClass(`${g.containerModifierClass}grid`),(k.grid.fill&&k.grid.fill==="column"||!k.grid.fill&&g.grid.fill==="column")&&y.addClass(`${g.containerModifierClass}grid-column`),r.emitContainerClasses());const U=k.direction&&k.direction!==g.direction,ge=g.loop&&(k.slidesPerView!==g.slidesPerView||U);U&&l&&r.changeDirection(),Rr(r.params,k);const Ee=r.params.enabled;Object.assign(r,{allowTouchMove:r.params.allowTouchMove,allowSlideNext:r.params.allowSlideNext,allowSlidePrev:r.params.allowSlidePrev}),R&&!Ee?r.disable():!R&&Ee&&r.enable(),r.currentBreakpoint=s,r.emit("_beforeBreakpoint",k),ge&&l&&(r.loopDestroy(),r.loopCreate(),r.updateSlides(),r.slideTo(o-h+r.loopedSlides,0,!1)),r.emit("breakpoint",k)}function Qz(r,o="window",l){if(!r||o==="container"&&!l)return;let h=!1;const g=Un(),y=o==="window"?g.innerHeight:l.clientHeight,E=Object.keys(r).map(s=>{if(typeof s=="string"&&s.indexOf("@")===0){const C=parseFloat(s.substr(1));return{value:y*C,point:s}}return{value:s,point:s}});E.sort((s,C)=>parseInt(s.value,10)-parseInt(C.value,10));for(let s=0;s<E.length;s+=1){const{point:C,value:k}=E[s];o==="window"?g.matchMedia(`(min-width: ${k}px)`).matches&&(h=C):k<=l.clientWidth&&(h=C)}return h||"max"}var eP={setBreakpoint:Jz,getBreakpoint:Qz};function tP(r,o){const l=[];return r.forEach(h=>{typeof h=="object"?Object.keys(h).forEach(g=>{h[g]&&l.push(o+g)}):typeof h=="string"&&l.push(o+h)}),l}function iP(){const r=this,{classNames:o,params:l,rtl:h,$el:g,device:y,support:E}=r,s=tP(["initialized",l.direction,{"pointer-events":!E.touch},{"free-mode":r.params.freeMode&&l.freeMode.enabled},{autoheight:l.autoHeight},{rtl:h},{grid:l.grid&&l.grid.rows>1},{"grid-column":l.grid&&l.grid.rows>1&&l.grid.fill==="column"},{android:y.android},{ios:y.ios},{"css-mode":l.cssMode},{centered:l.cssMode&&l.centeredSlides}],l.containerModifierClass);o.push(...s),g.addClass([...o].join(" ")),r.emitContainerClasses()}function nP(){const r=this,{$el:o,classNames:l}=r;o.removeClass(l.join(" ")),r.emitContainerClasses()}var rP={addClasses:iP,removeClasses:nP};function oP(r,o,l,h,g,y){const E=Un();let s;function C(){y&&y()}!Rt(r).parent("picture")[0]&&(!r.complete||!g)&&o?(s=new E.Image,s.onload=C,s.onerror=C,h&&(s.sizes=h),l&&(s.srcset=l),o&&(s.src=o)):C()}function sP(){const r=this;r.imagesToLoad=r.$el.find("img");function o(){typeof r=="undefined"||r===null||!r||r.destroyed||(r.imagesLoaded!==void 0&&(r.imagesLoaded+=1),r.imagesLoaded===r.imagesToLoad.length&&(r.params.updateOnImagesReady&&r.update(),r.emit("imagesReady")))}for(let l=0;l<r.imagesToLoad.length;l+=1){const h=r.imagesToLoad[l];r.loadImage(h,h.currentSrc||h.getAttribute("src"),h.srcset||h.getAttribute("srcset"),h.sizes||h.getAttribute("sizes"),!0,o)}}var aP={loadImage:oP,preloadImages:sP};function lP(){const r=this,{isLocked:o,params:l}=r,{slidesOffsetBefore:h}=l;if(h){const g=r.slides.length-1,y=r.slidesGrid[g]+r.slidesSizesGrid[g]+h*2;r.isLocked=r.size>y}else r.isLocked=r.snapGrid.length===1;l.allowSlideNext===!0&&(r.allowSlideNext=!r.isLocked),l.allowSlidePrev===!0&&(r.allowSlidePrev=!r.isLocked),o&&o!==r.isLocked&&(r.isEnd=!1),o!==r.isLocked&&r.emit(r.isLocked?"lock":"unlock")}var cP={checkOverflow:lP},Ex={init:!0,direction:"horizontal",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:0,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,preloadImages:!0,updateOnImagesReady:!0,loop:!1,loopAdditionalSlides:0,loopedSlides:null,loopFillGroupWithBlank:!1,loopPreventsSlide:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-invisible-blank",slideActiveClass:"swiper-slide-active",slideDuplicateActiveClass:"swiper-slide-duplicate-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",slideNextClass:"swiper-slide-next",slideDuplicateNextClass:"swiper-slide-duplicate-next",slidePrevClass:"swiper-slide-prev",slideDuplicatePrevClass:"swiper-slide-duplicate-prev",wrapperClass:"swiper-wrapper",runCallbacksOnInit:!0,_emitClasses:!1};function uP(r,o){return function(h={}){const g=Object.keys(h)[0],y=h[g];if(typeof y!="object"||y===null){Rr(o,h);return}if(["navigation","pagination","scrollbar"].indexOf(g)>=0&&r[g]===!0&&(r[g]={auto:!0}),!(g in r&&"enabled"in y)){Rr(o,h);return}r[g]===!0&&(r[g]={enabled:!0}),typeof r[g]=="object"&&!("enabled"in r[g])&&(r[g].enabled=!0),r[g]||(r[g]={enabled:!1}),Rr(o,h)}}const Jm={eventsEmitter:sz,update:gz,translate:wz,transition:Cz,slide:Lz,loop:Fz,grabCursor:jz,events:Yz,breakpoints:eP,checkOverflow:cP,classes:rP,images:aP},Qm={};class ur{constructor(...o){let l,h;if(o.length===1&&o[0].constructor&&Object.prototype.toString.call(o[0]).slice(8,-1)==="Object"?h=o[0]:[l,h]=o,h||(h={}),h=Rr({},h),l&&!h.el&&(h.el=l),h.el&&Rt(h.el).length>1){const s=[];return Rt(h.el).each(C=>{const k=Rr({},h,{el:C});s.push(new ur(k))}),s}const g=this;g.__swiper__=!0,g.support=cw(),g.device=tz({userAgent:h.userAgent}),g.browser=nz(),g.eventsListeners={},g.eventsAnyListeners=[],g.modules=[...g.__modules__],h.modules&&Array.isArray(h.modules)&&g.modules.push(...h.modules);const y={};g.modules.forEach(s=>{s({swiper:g,extendParams:uP(h,y),on:g.on.bind(g),once:g.once.bind(g),off:g.off.bind(g),emit:g.emit.bind(g)})});const E=Rr({},Ex,y);return g.params=Rr({},E,Qm,h),g.originalParams=Rr({},g.params),g.passedParams=Rr({},h),g.params&&g.params.on&&Object.keys(g.params.on).forEach(s=>{g.on(s,g.params.on[s])}),g.params&&g.params.onAny&&g.onAny(g.params.onAny),g.$=Rt,Object.assign(g,{enabled:g.params.enabled,el:l,classNames:[],slides:Rt(),slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return g.params.direction==="horizontal"},isVertical(){return g.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,allowSlideNext:g.params.allowSlideNext,allowSlidePrev:g.params.allowSlidePrev,touchEvents:function(){const C=["touchstart","touchmove","touchend","touchcancel"],k=["pointerdown","pointermove","pointerup"];return g.touchEventsTouch={start:C[0],move:C[1],end:C[2],cancel:C[3]},g.touchEventsDesktop={start:k[0],move:k[1],end:k[2]},g.support.touch||!g.params.simulateTouch?g.touchEventsTouch:g.touchEventsDesktop}(),touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:g.params.focusableElements,lastClickTime:yh(),clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,isTouchEvent:void 0,startMoving:void 0},allowClick:!0,allowTouchMove:g.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),g.emit("_swiper"),g.params.init&&g.init(),g}enable(){const o=this;o.enabled||(o.enabled=!0,o.params.grabCursor&&o.setGrabCursor(),o.emit("enable"))}disable(){const o=this;!o.enabled||(o.enabled=!1,o.params.grabCursor&&o.unsetGrabCursor(),o.emit("disable"))}setProgress(o,l){const h=this;o=Math.min(Math.max(o,0),1);const g=h.minTranslate(),E=(h.maxTranslate()-g)*o+g;h.translateTo(E,typeof l=="undefined"?0:l),h.updateActiveIndex(),h.updateSlidesClasses()}emitContainerClasses(){const o=this;if(!o.params._emitClasses||!o.el)return;const l=o.el.className.split(" ").filter(h=>h.indexOf("swiper")===0||h.indexOf(o.params.containerModifierClass)===0);o.emit("_containerClasses",l.join(" "))}getSlideClasses(o){const l=this;return o.className.split(" ").filter(h=>h.indexOf("swiper-slide")===0||h.indexOf(l.params.slideClass)===0).join(" ")}emitSlidesClasses(){const o=this;if(!o.params._emitClasses||!o.el)return;const l=[];o.slides.each(h=>{const g=o.getSlideClasses(h);l.push({slideEl:h,classNames:g}),o.emit("_slideClass",h,g)}),o.emit("_slideClasses",l)}slidesPerViewDynamic(o="current",l=!1){const h=this,{params:g,slides:y,slidesGrid:E,slidesSizesGrid:s,size:C,activeIndex:k}=h;let M=1;if(g.centeredSlides){let D=y[k].swiperSlideSize,R;for(let U=k+1;U<y.length;U+=1)y[U]&&!R&&(D+=y[U].swiperSlideSize,M+=1,D>C&&(R=!0));for(let U=k-1;U>=0;U-=1)y[U]&&!R&&(D+=y[U].swiperSlideSize,M+=1,D>C&&(R=!0))}else if(o==="current")for(let D=k+1;D<y.length;D+=1)(l?E[D]+s[D]-E[k]<C:E[D]-E[k]<C)&&(M+=1);else for(let D=k-1;D>=0;D-=1)E[k]-E[D]<C&&(M+=1);return M}update(){const o=this;if(!o||o.destroyed)return;const{snapGrid:l,params:h}=o;h.breakpoints&&o.setBreakpoint(),o.updateSize(),o.updateSlides(),o.updateProgress(),o.updateSlidesClasses();function g(){const E=o.rtlTranslate?o.translate*-1:o.translate,s=Math.min(Math.max(E,o.maxTranslate()),o.minTranslate());o.setTranslate(s),o.updateActiveIndex(),o.updateSlidesClasses()}let y;o.params.freeMode&&o.params.freeMode.enabled?(g(),o.params.autoHeight&&o.updateAutoHeight()):((o.params.slidesPerView==="auto"||o.params.slidesPerView>1)&&o.isEnd&&!o.params.centeredSlides?y=o.slideTo(o.slides.length-1,0,!1,!0):y=o.slideTo(o.activeIndex,0,!1,!0),y||g()),h.watchOverflow&&l!==o.snapGrid&&o.checkOverflow(),o.emit("update")}changeDirection(o,l=!0){const h=this,g=h.params.direction;return o||(o=g==="horizontal"?"vertical":"horizontal"),o===g||o!=="horizontal"&&o!=="vertical"||(h.$el.removeClass(`${h.params.containerModifierClass}${g}`).addClass(`${h.params.containerModifierClass}${o}`),h.emitContainerClasses(),h.params.direction=o,h.slides.each(y=>{o==="vertical"?y.style.width="":y.style.height=""}),h.emit("changeDirection"),l&&h.update()),h}mount(o){const l=this;if(l.mounted)return!0;const h=Rt(o||l.params.el);if(o=h[0],!o)return!1;o.swiper=l;const g=()=>`.${(l.params.wrapperClass||"").trim().split(" ").join(".")}`;let E=(()=>{if(o&&o.shadowRoot&&o.shadowRoot.querySelector){const s=Rt(o.shadowRoot.querySelector(g()));return s.children=C=>h.children(C),s}return h.children(g())})();if(E.length===0&&l.params.createElements){const C=jr().createElement("div");E=Rt(C),C.className=l.params.wrapperClass,h.append(C),h.children(`.${l.params.slideClass}`).each(k=>{E.append(k)})}return Object.assign(l,{$el:h,el:o,$wrapperEl:E,wrapperEl:E[0],mounted:!0,rtl:o.dir.toLowerCase()==="rtl"||h.css("direction")==="rtl",rtlTranslate:l.params.direction==="horizontal"&&(o.dir.toLowerCase()==="rtl"||h.css("direction")==="rtl"),wrongRTL:E.css("display")==="-webkit-box"}),!0}init(o){const l=this;return l.initialized||l.mount(o)===!1||(l.emit("beforeInit"),l.params.breakpoints&&l.setBreakpoint(),l.addClasses(),l.params.loop&&l.loopCreate(),l.updateSize(),l.updateSlides(),l.params.watchOverflow&&l.checkOverflow(),l.params.grabCursor&&l.enabled&&l.setGrabCursor(),l.params.preloadImages&&l.preloadImages(),l.params.loop?l.slideTo(l.params.initialSlide+l.loopedSlides,0,l.params.runCallbacksOnInit,!1,!0):l.slideTo(l.params.initialSlide,0,l.params.runCallbacksOnInit,!1,!0),l.attachEvents(),l.initialized=!0,l.emit("init"),l.emit("afterInit")),l}destroy(o=!0,l=!0){const h=this,{params:g,$el:y,$wrapperEl:E,slides:s}=h;return typeof h.params=="undefined"||h.destroyed||(h.emit("beforeDestroy"),h.initialized=!1,h.detachEvents(),g.loop&&h.loopDestroy(),l&&(h.removeClasses(),y.removeAttr("style"),E.removeAttr("style"),s&&s.length&&s.removeClass([g.slideVisibleClass,g.slideActiveClass,g.slideNextClass,g.slidePrevClass].join(" ")).removeAttr("style").removeAttr("data-swiper-slide-index")),h.emit("destroy"),Object.keys(h.eventsListeners).forEach(C=>{h.off(C)}),o!==!1&&(h.$el[0].swiper=null,X3(h)),h.destroyed=!0),null}static extendDefaults(o){Rr(Qm,o)}static get extendedDefaults(){return Qm}static get defaults(){return Ex}static installModule(o){ur.prototype.__modules__||(ur.prototype.__modules__=[]);const l=ur.prototype.__modules__;typeof o=="function"&&l.indexOf(o)<0&&l.push(o)}static use(o){return Array.isArray(o)?(o.forEach(l=>ur.installModule(l)),ur):(ur.installModule(o),ur)}}Object.keys(Jm).forEach(r=>{Object.keys(Jm[r]).forEach(o=>{ur.prototype[o]=Jm[r][o]})});ur.use([rz,oz]);function nl(r){return typeof r=="object"&&r!==null&&r.constructor&&Object.prototype.toString.call(r).slice(8,-1)==="Object"}function ra(r,o){const l=["__proto__","constructor","prototype"];Object.keys(o).filter(h=>l.indexOf(h)<0).forEach(h=>{typeof r[h]=="undefined"?r[h]=o[h]:nl(o[h])&&nl(r[h])&&Object.keys(o[h]).length>0?o[h].__swiper__?r[h]=o[h]:ra(r[h],o[h]):r[h]=o[h]})}function dw(r={}){return r.navigation&&typeof r.navigation.nextEl=="undefined"&&typeof r.navigation.prevEl=="undefined"}function pw(r={}){return r.pagination&&typeof r.pagination.el=="undefined"}function fw(r={}){return r.scrollbar&&typeof r.scrollbar.el=="undefined"}function mw(r=""){const o=r.split(" ").map(h=>h.trim()).filter(h=>!!h),l=[];return o.forEach(h=>{l.indexOf(h)<0&&l.push(h)}),l.join(" ")}const gw=["modules","init","_direction","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","_spaceBetween","_slidesPerView","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_preloadImages","updateOnImagesReady","_loop","_loopAdditionalSlides","_loopedSlides","_loopFillGroupWithBlank","loopPreventsSlide","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideBlankClass","slideActiveClass","slideDuplicateActiveClass","slideVisibleClass","slideDuplicateClass","slideNextClass","slideDuplicateNextClass","slidePrevClass","slideDuplicatePrevClass","wrapperClass","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","lazy","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom"];function Sx(r={}){const o={on:{}},l={};ra(o,ur.defaults),ra(o,ur.extendedDefaults),o._emitClasses=!0,o.init=!1;const h={},g=gw.map(E=>E.replace(/_/,"")),y=Object.assign({},r);return Object.keys(y).forEach(E=>{typeof r[E]!="undefined"&&(g.indexOf(E)>=0?nl(r[E])?(o[E]={},l[E]={},ra(o[E],r[E]),ra(l[E],r[E])):(o[E]=r[E],l[E]=r[E]):E.search(/on[A-Z]/)===0&&typeof r[E]=="function"?o.on[`${E[2].toLowerCase()}${E.substr(3)}`]=r[E]:h[E]=r[E])}),["navigation","pagination","scrollbar"].forEach(E=>{o[E]===!0&&(o[E]={}),o[E]===!1&&delete o[E]}),{params:o,passedParams:l,rest:h}}function hP(r){return new ur(r)}function dP({el:r,nextEl:o,prevEl:l,paginationEl:h,scrollbarEl:g,swiper:y},E){dw(E)&&o&&l&&(y.params.navigation.nextEl=o,y.originalParams.navigation.nextEl=o,y.params.navigation.prevEl=l,y.originalParams.navigation.prevEl=l),pw(E)&&h&&(y.params.pagination.el=h,y.originalParams.pagination.el=h),fw(E)&&g&&(y.params.scrollbar.el=g,y.originalParams.scrollbar.el=g),y.init(r)}function _w(r,o){let l=o.slidesPerView;if(o.breakpoints){const g=ur.prototype.getBreakpoint(o.breakpoints),y=g in o.breakpoints?o.breakpoints[g]:void 0;y&&y.slidesPerView&&(l=y.slidesPerView)}let h=Math.ceil(parseFloat(o.loopedSlides||l,10));return h+=o.loopAdditionalSlides,h>r.length&&(h=r.length),h}function pP(r,o,l){const h=o.map((C,k)=>(C.props||(C.props={}),C.props.swiperRef=r,C.props["data-swiper-slide-index"]=k,C));function g(C,k,M){return C.props||(C.props={}),Er(C.type,iv(Dm({},C.props),{key:`${C.key}-duplicate-${k}-${M}`,class:`${C.props.className||""} ${l.slideDuplicateClass} ${C.props.class||""}`}),C.children)}if(l.loopFillGroupWithBlank){const C=l.slidesPerGroup-h.length%l.slidesPerGroup;if(C!==l.slidesPerGroup)for(let k=0;k<C;k+=1){const M=Er("div",{class:`${l.slideClass} ${l.slideBlankClass}`});h.push(M)}}l.slidesPerView==="auto"&&!l.loopedSlides&&(l.loopedSlides=h.length);const y=_w(h,l),E=[],s=[];return h.forEach((C,k)=>{k<y&&s.push(g(C,k,"prepend")),k<h.length&&k>=h.length-y&&E.push(g(C,k,"append"))}),r.value&&(r.value.loopedSlides=y),[...E,...h,...s]}function fP(r,o,l,h){const g=[];if(!o)return g;const y=k=>{g.indexOf(k)<0&&g.push(k)},E=h.map(k=>k.props&&k.props.key),s=l.map(k=>k.props&&k.props.key);return E.join("")!==s.join("")&&g.push("children"),h.length!==l.length&&g.push("children"),gw.filter(k=>k[0]==="_").map(k=>k.replace(/_/,"")).forEach(k=>{if(k in r&&k in o)if(nl(r[k])&&nl(o[k])){const M=Object.keys(r[k]),D=Object.keys(o[k]);M.length!==D.length?y(k):(M.forEach(R=>{r[k][R]!==o[k][R]&&y(k)}),D.forEach(R=>{r[k][R]!==o[k][R]&&y(k)}))}else r[k]!==o[k]&&y(k)}),g}function eg(r={},o,l){const h=[],g={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]},y=(E,s)=>{!Array.isArray(E)||E.forEach(C=>{const k=typeof C.type=="symbol";s==="default"&&(s="container-end"),k&&C.children?y(C.children,"default"):C.type&&(C.type.name==="SwiperSlide"||C.type.name==="AsyncComponentWrapper")?h.push(C):g[s]&&g[s].push(C)})};return Object.keys(r).forEach(E=>{const s=r[E]();y(s,E)}),l.value=o.value,o.value=h,{slides:h,slots:g}}function mP({swiper:r,slides:o,passedParams:l,changedParams:h,nextEl:g,prevEl:y,paginationEl:E,scrollbarEl:s}){const C=h.filter(st=>st!=="children"&&st!=="direction"),{params:k,pagination:M,navigation:D,scrollbar:R,virtual:U,thumbs:ge}=r;let Ee,be,we,De,Xe;h.includes("thumbs")&&l.thumbs&&l.thumbs.swiper&&k.thumbs&&!k.thumbs.swiper&&(Ee=!0),h.includes("controller")&&l.controller&&l.controller.control&&k.controller&&!k.controller.control&&(be=!0),h.includes("pagination")&&l.pagination&&(l.pagination.el||E)&&(k.pagination||k.pagination===!1)&&M&&!M.el&&(we=!0),h.includes("scrollbar")&&l.scrollbar&&(l.scrollbar.el||s)&&(k.scrollbar||k.scrollbar===!1)&&R&&!R.el&&(De=!0),h.includes("navigation")&&l.navigation&&(l.navigation.prevEl||y)&&(l.navigation.nextEl||g)&&(k.navigation||k.navigation===!1)&&D&&!D.prevEl&&!D.nextEl&&(Xe=!0);const Ue=st=>{!r[st]||(r[st].destroy(),st==="navigation"?(k[st].prevEl=void 0,k[st].nextEl=void 0,r[st].prevEl=void 0,r[st].nextEl=void 0):(k[st].el=void 0,r[st].el=void 0))};C.forEach(st=>{if(nl(k[st])&&nl(l[st]))ra(k[st],l[st]);else{const ut=l[st];(ut===!0||ut===!1)&&(st==="navigation"||st==="pagination"||st==="scrollbar")?ut===!1&&Ue(st):k[st]=l[st]}}),h.includes("children")&&U&&k.virtual.enabled?(U.slides=o,U.update(!0)):h.includes("children")&&r.lazy&&r.params.lazy.enabled&&r.lazy.load(),Ee&&ge.init()&&ge.update(!0),be&&(r.controller.control=k.controller.control),we&&(E&&(k.pagination.el=E),M.init(),M.render(),M.update()),De&&(s&&(k.scrollbar.el=s),R.init(),R.updateSize(),R.setTranslate()),Xe&&(g&&(k.navigation.nextEl=g),y&&(k.navigation.prevEl=y),D.init(),D.update()),h.includes("allowSlideNext")&&(r.allowSlideNext=l.allowSlideNext),h.includes("allowSlidePrev")&&(r.allowSlidePrev=l.allowSlidePrev),h.includes("direction")&&r.changeDirection(l.direction,!1),r.update()}function gP(r){!r||r.destroyed||!r.params.virtual||r.params.virtual&&!r.params.virtual.enabled||(r.updateSlides(),r.updateProgress(),r.updateSlidesClasses(),r.lazy&&r.params.lazy.enabled&&r.lazy.load(),r.parallax&&r.params.parallax&&r.params.parallax.enabled&&r.parallax.setTranslate())}function _P(r,o,l){if(!l)return null;const h=r.value.isHorizontal()?{[r.value.rtlTranslate?"right":"left"]:`${l.offset}px`}:{top:`${l.offset}px`};return o.filter((g,y)=>y>=l.from&&y<=l.to).map(g=>(g.props||(g.props={}),g.props.style||(g.props.style={}),g.props.swiperRef=r,g.props.style=h,Er(g.type,Dm({},g.props),g.children)))}const m5={name:"Swiper",props:{tag:{type:String,default:"div"},wrapperTag:{type:String,default:"div"},modules:{type:Array,default:void 0},init:{type:Boolean,default:void 0},direction:{type:String,default:void 0},touchEventsTarget:{type:String,default:void 0},initialSlide:{type:Number,default:void 0},speed:{type:Number,default:void 0},cssMode:{type:Boolean,default:void 0},updateOnWindowResize:{type:Boolean,default:void 0},resizeObserver:{type:Boolean,default:void 0},nested:{type:Boolean,default:void 0},focusableElements:{type:String,default:void 0},width:{type:Number,default:void 0},height:{type:Number,default:void 0},preventInteractionOnTransition:{type:Boolean,default:void 0},userAgent:{type:String,default:void 0},url:{type:String,default:void 0},edgeSwipeDetection:{type:[Boolean,String],default:void 0},edgeSwipeThreshold:{type:Number,default:void 0},autoHeight:{type:Boolean,default:void 0},setWrapperSize:{type:Boolean,default:void 0},virtualTranslate:{type:Boolean,default:void 0},effect:{type:String,default:void 0},breakpoints:{type:Object,default:void 0},spaceBetween:{type:Number,default:void 0},slidesPerView:{type:[Number,String],default:void 0},slidesPerGroup:{type:Number,default:void 0},slidesPerGroupSkip:{type:Number,default:void 0},slidesPerGroupAuto:{type:Boolean,default:void 0},centeredSlides:{type:Boolean,default:void 0},centeredSlidesBounds:{type:Boolean,default:void 0},slidesOffsetBefore:{type:Number,default:void 0},slidesOffsetAfter:{type:Number,default:void 0},normalizeSlideIndex:{type:Boolean,default:void 0},centerInsufficientSlides:{type:Boolean,default:void 0},watchOverflow:{type:Boolean,default:void 0},roundLengths:{type:Boolean,default:void 0},touchRatio:{type:Number,default:void 0},touchAngle:{type:Number,default:void 0},simulateTouch:{type:Boolean,default:void 0},shortSwipes:{type:Boolean,default:void 0},longSwipes:{type:Boolean,default:void 0},longSwipesRatio:{type:Number,default:void 0},longSwipesMs:{type:Number,default:void 0},followFinger:{type:Boolean,default:void 0},allowTouchMove:{type:Boolean,default:void 0},threshold:{type:Number,default:void 0},touchMoveStopPropagation:{type:Boolean,default:void 0},touchStartPreventDefault:{type:Boolean,default:void 0},touchStartForcePreventDefault:{type:Boolean,default:void 0},touchReleaseOnEdges:{type:Boolean,default:void 0},uniqueNavElements:{type:Boolean,default:void 0},resistance:{type:Boolean,default:void 0},resistanceRatio:{type:Number,default:void 0},watchSlidesProgress:{type:Boolean,default:void 0},grabCursor:{type:Boolean,default:void 0},preventClicks:{type:Boolean,default:void 0},preventClicksPropagation:{type:Boolean,default:void 0},slideToClickedSlide:{type:Boolean,default:void 0},preloadImages:{type:Boolean,default:void 0},updateOnImagesReady:{type:Boolean,default:void 0},loop:{type:Boolean,default:void 0},loopAdditionalSlides:{type:Number,default:void 0},loopedSlides:{type:Number,default:void 0},loopFillGroupWithBlank:{type:Boolean,default:void 0},loopPreventsSlide:{type:Boolean,default:void 0},rewind:{type:Boolean,default:void 0},allowSlidePrev:{type:Boolean,default:void 0},allowSlideNext:{type:Boolean,default:void 0},swipeHandler:{type:Boolean,default:void 0},noSwiping:{type:Boolean,default:void 0},noSwipingClass:{type:String,default:void 0},noSwipingSelector:{type:String,default:void 0},passiveListeners:{type:Boolean,default:void 0},containerModifierClass:{type:String,default:void 0},slideClass:{type:String,default:void 0},slideBlankClass:{type:String,default:void 0},slideActiveClass:{type:String,default:void 0},slideDuplicateActiveClass:{type:String,default:void 0},slideVisibleClass:{type:String,default:void 0},slideDuplicateClass:{type:String,default:void 0},slideNextClass:{type:String,default:void 0},slideDuplicateNextClass:{type:String,default:void 0},slidePrevClass:{type:String,default:void 0},slideDuplicatePrevClass:{type:String,default:void 0},wrapperClass:{type:String,default:void 0},runCallbacksOnInit:{type:Boolean,default:void 0},observer:{type:Boolean,default:void 0},observeParents:{type:Boolean,default:void 0},observeSlideChildren:{type:Boolean,default:void 0},a11y:{type:[Boolean,Object],default:void 0},autoplay:{type:[Boolean,Object],default:void 0},controller:{type:Object,default:void 0},coverflowEffect:{type:Object,default:void 0},cubeEffect:{type:Object,default:void 0},fadeEffect:{type:Object,default:void 0},flipEffect:{type:Object,default:void 0},creativeEffect:{type:Object,default:void 0},cardsEffect:{type:Object,default:void 0},hashNavigation:{type:[Boolean,Object],default:void 0},history:{type:[Boolean,Object],default:void 0},keyboard:{type:[Boolean,Object],default:void 0},lazy:{type:[Boolean,Object],default:void 0},mousewheel:{type:[Boolean,Object],default:void 0},navigation:{type:[Boolean,Object],default:void 0},pagination:{type:[Boolean,Object],default:void 0},parallax:{type:[Boolean,Object],default:void 0},scrollbar:{type:[Boolean,Object],default:void 0},thumbs:{type:Object,default:void 0},virtual:{type:[Boolean,Object],default:void 0},zoom:{type:[Boolean,Object],default:void 0},grid:{type:[Object],default:void 0},freeMode:{type:[Boolean,Object],default:void 0}},emits:["_beforeBreakpoint","_containerClasses","_slideClass","_slideClasses","_swiper","activeIndexChange","afterInit","autoplay","autoplayStart","autoplayStop","beforeDestroy","beforeInit","beforeLoopFix","beforeResize","beforeSlideChangeStart","beforeTransitionStart","breakpoint","changeDirection","click","disable","doubleTap","doubleClick","destroy","enable","fromEdge","hashChange","hashSet","imagesReady","init","keyPress","lazyImageLoad","lazyImageReady","lock","loopFix","momentumBounce","navigationHide","navigationShow","observerUpdate","orientationchange","paginationHide","paginationRender","paginationShow","paginationUpdate","progress","reachBeginning","reachEnd","realIndexChange","resize","scroll","scrollbarDragEnd","scrollbarDragMove","scrollbarDragStart","setTransition","setTranslate","slideChange","slideChangeTransitionEnd","slideChangeTransitionStart","slideNextTransitionEnd","slideNextTransitionStart","slidePrevTransitionEnd","slidePrevTransitionStart","slideResetTransitionStart","slideResetTransitionEnd","sliderMove","sliderFirstMove","slidesLengthChange","slidesGridLengthChange","snapGridLengthChange","snapIndexChange","swiper","tap","toEdge","touchEnd","touchMove","touchMoveOpposite","touchStart","transitionEnd","transitionStart","unlock","update","zoomChange"],setup(r,{slots:o,emit:l}){const{tag:h,wrapperTag:g}=r,y=wn("swiper"),E=wn(null),s=wn(!1),C=wn(!1),k=wn(null),M=wn(null),D=wn(null),R={value:[]},U={value:[]},ge=wn(null),Ee=wn(null),be=wn(null),we=wn(null),{params:De,passedParams:Xe}=Sx(r);eg(o,R,U),D.value=Xe,U.value=R.value;const Ue=()=>{eg(o,R,U),s.value=!0};if(De.onAny=(ut,...lt)=>{l(ut,...lt)},Object.assign(De.on,{_beforeBreakpoint:Ue,_containerClasses(ut,lt){y.value=lt}}),M.value=hP(De),M.value.loopCreate=()=>{},M.value.loopDestroy=()=>{},De.loop&&(M.value.loopedSlides=_w(R.value,De)),M.value.virtual&&M.value.params.virtual.enabled){M.value.virtual.slides=R.value;const ut={cache:!1,slides:R.value,renderExternal:lt=>{E.value=lt},renderExternalUpdate:!1};ra(M.value.params.virtual,ut),ra(M.value.originalParams.virtual,ut)}g_(()=>{!C.value&&M.value&&(M.value.emitSlidesClasses(),C.value=!0);const{passedParams:ut}=Sx(r),lt=fP(ut,D.value,R.value,U.value);D.value=ut,(lt.length||s.value)&&M.value&&!M.value.destroyed&&mP({swiper:M.value,slides:R.value,passedParams:ut,changedParams:lt,nextEl:ge.value,prevEl:Ee.value,scrollbarEl:we.value,paginationEl:be.value}),s.value=!1}),wo(E,()=>{ph(()=>{gP(M.value)})}),Oc(()=>{!k.value||(dP({el:k.value,nextEl:ge.value,prevEl:Ee.value,paginationEl:be.value,scrollbarEl:we.value,swiper:M.value},De),l("swiper",M.value))}),bh(()=>{M.value&&!M.value.destroyed&&M.value.destroy(!0,!1)});function st(ut){return De.virtual?_P(M,ut,E.value):!De.loop||M.value&&M.value.destroyed?(ut.forEach(lt=>{lt.props||(lt.props={}),lt.props.swiperRef=M}),ut):pP(M,ut,De)}return()=>{const{slides:ut,slots:lt}=eg(o,R,U);return Er(h,{ref:k,class:mw(y.value)},[lt["container-start"],dw(r)&&[Er("div",{ref:Ee,class:"swiper-button-prev"}),Er("div",{ref:ge,class:"swiper-button-next"})],fw(r)&&Er("div",{ref:we,class:"swiper-scrollbar"}),pw(r)&&Er("div",{ref:be,class:"swiper-pagination"}),Er(g,{class:"swiper-wrapper"},[lt["wrapper-start"],st(ut),lt["wrapper-end"]]),lt["container-end"]])}}},g5={name:"SwiperSlide",props:{tag:{type:String,default:"div"},swiperRef:{type:Object,required:!1},zoom:{type:Boolean,default:void 0},virtualIndex:{type:[String,Number],default:void 0}},setup(r,{slots:o}){let l=!1;const{swiperRef:h}=r,g=wn(null),y=wn("swiper-slide");function E(C,k,M){k===g.value&&(y.value=M)}Oc(()=>{!h.value||(h.value.on("_slideClass",E),l=!0)}),eb(()=>{l||!h||!h.value||(h.value.on("_slideClass",E),l=!0)}),g_(()=>{!g.value||!h||!h.value||h.value.destroyed&&y.value!=="swiper-slide"&&(y.value="swiper-slide")}),bh(()=>{!h||!h.value||h.value.off("_slideClass",E)});const s=hr(()=>({isActive:y.value.indexOf("swiper-slide-active")>=0||y.value.indexOf("swiper-slide-duplicate-active")>=0,isVisible:y.value.indexOf("swiper-slide-visible")>=0,isDuplicate:y.value.indexOf("swiper-slide-duplicate")>=0,isPrev:y.value.indexOf("swiper-slide-prev")>=0||y.value.indexOf("swiper-slide-duplicate-prev")>=0,isNext:y.value.indexOf("swiper-slide-next")>=0||y.value.indexOf("swiper-slide-duplicate-next")>=0}));return()=>Er(r.tag,{class:mw(`${y.value}`),ref:g,"data-swiper-slide-index":r.virtualIndex},r.zoom?Er("div",{class:"swiper-zoom-container","data-swiper-zoom":typeof r.zoom=="number"?r.zoom:void 0},o.default&&o.default(s.value)):o.default&&o.default(s.value))}};var yw={exports:{}},vw={exports:{}};(function(){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o={rotl:function(l,h){return l<<h|l>>>32-h},rotr:function(l,h){return l<<32-h|l>>>h},endian:function(l){if(l.constructor==Number)return o.rotl(l,8)&16711935|o.rotl(l,24)&4278255360;for(var h=0;h<l.length;h++)l[h]=o.endian(l[h]);return l},randomBytes:function(l){for(var h=[];l>0;l--)h.push(Math.floor(Math.random()*256));return h},bytesToWords:function(l){for(var h=[],g=0,y=0;g<l.length;g++,y+=8)h[y>>>5]|=l[g]<<24-y%32;return h},wordsToBytes:function(l){for(var h=[],g=0;g<l.length*32;g+=8)h.push(l[g>>>5]>>>24-g%32&255);return h},bytesToHex:function(l){for(var h=[],g=0;g<l.length;g++)h.push((l[g]>>>4).toString(16)),h.push((l[g]&15).toString(16));return h.join("")},hexToBytes:function(l){for(var h=[],g=0;g<l.length;g+=2)h.push(parseInt(l.substr(g,2),16));return h},bytesToBase64:function(l){for(var h=[],g=0;g<l.length;g+=3)for(var y=l[g]<<16|l[g+1]<<8|l[g+2],E=0;E<4;E++)g*8+E*6<=l.length*8?h.push(r.charAt(y>>>6*(3-E)&63)):h.push("=");return h.join("")},base64ToBytes:function(l){l=l.replace(/[^A-Z0-9+\/]/ig,"");for(var h=[],g=0,y=0;g<l.length;y=++g%4)y!=0&&h.push((r.indexOf(l.charAt(g-1))&Math.pow(2,-2*y+8)-1)<<y*2|r.indexOf(l.charAt(g))>>>6-y*2);return h}};vw.exports=o})();var jg={utf8:{stringToBytes:function(r){return jg.bin.stringToBytes(unescape(encodeURIComponent(r)))},bytesToString:function(r){return decodeURIComponent(escape(jg.bin.bytesToString(r)))}},bin:{stringToBytes:function(r){for(var o=[],l=0;l<r.length;l++)o.push(r.charCodeAt(l)&255);return o},bytesToString:function(r){for(var o=[],l=0;l<r.length;l++)o.push(String.fromCharCode(r[l]));return o.join("")}}},Cx=jg;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var yP=function(r){return r!=null&&(xw(r)||vP(r)||!!r._isBuffer)};function xw(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function vP(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&xw(r.slice(0,0))}(function(){var r=vw.exports,o=Cx.utf8,l=yP,h=Cx.bin,g=function(y,E){y.constructor==String?E&&E.encoding==="binary"?y=h.stringToBytes(y):y=o.stringToBytes(y):l(y)?y=Array.prototype.slice.call(y,0):!Array.isArray(y)&&y.constructor!==Uint8Array&&(y=y.toString());for(var s=r.bytesToWords(y),C=y.length*8,k=1732584193,M=-271733879,D=-1732584194,R=271733878,U=0;U<s.length;U++)s[U]=(s[U]<<8|s[U]>>>24)&16711935|(s[U]<<24|s[U]>>>8)&4278255360;s[C>>>5]|=128<<C%32,s[(C+64>>>9<<4)+14]=C;for(var ge=g._ff,Ee=g._gg,be=g._hh,we=g._ii,U=0;U<s.length;U+=16){var De=k,Xe=M,Ue=D,st=R;k=ge(k,M,D,R,s[U+0],7,-680876936),R=ge(R,k,M,D,s[U+1],12,-389564586),D=ge(D,R,k,M,s[U+2],17,606105819),M=ge(M,D,R,k,s[U+3],22,-1044525330),k=ge(k,M,D,R,s[U+4],7,-176418897),R=ge(R,k,M,D,s[U+5],12,1200080426),D=ge(D,R,k,M,s[U+6],17,-1473231341),M=ge(M,D,R,k,s[U+7],22,-45705983),k=ge(k,M,D,R,s[U+8],7,1770035416),R=ge(R,k,M,D,s[U+9],12,-1958414417),D=ge(D,R,k,M,s[U+10],17,-42063),M=ge(M,D,R,k,s[U+11],22,-1990404162),k=ge(k,M,D,R,s[U+12],7,1804603682),R=ge(R,k,M,D,s[U+13],12,-40341101),D=ge(D,R,k,M,s[U+14],17,-1502002290),M=ge(M,D,R,k,s[U+15],22,1236535329),k=Ee(k,M,D,R,s[U+1],5,-165796510),R=Ee(R,k,M,D,s[U+6],9,-1069501632),D=Ee(D,R,k,M,s[U+11],14,643717713),M=Ee(M,D,R,k,s[U+0],20,-373897302),k=Ee(k,M,D,R,s[U+5],5,-701558691),R=Ee(R,k,M,D,s[U+10],9,38016083),D=Ee(D,R,k,M,s[U+15],14,-660478335),M=Ee(M,D,R,k,s[U+4],20,-405537848),k=Ee(k,M,D,R,s[U+9],5,568446438),R=Ee(R,k,M,D,s[U+14],9,-1019803690),D=Ee(D,R,k,M,s[U+3],14,-187363961),M=Ee(M,D,R,k,s[U+8],20,1163531501),k=Ee(k,M,D,R,s[U+13],5,-1444681467),R=Ee(R,k,M,D,s[U+2],9,-51403784),D=Ee(D,R,k,M,s[U+7],14,1735328473),M=Ee(M,D,R,k,s[U+12],20,-1926607734),k=be(k,M,D,R,s[U+5],4,-378558),R=be(R,k,M,D,s[U+8],11,-2022574463),D=be(D,R,k,M,s[U+11],16,1839030562),M=be(M,D,R,k,s[U+14],23,-35309556),k=be(k,M,D,R,s[U+1],4,-1530992060),R=be(R,k,M,D,s[U+4],11,1272893353),D=be(D,R,k,M,s[U+7],16,-155497632),M=be(M,D,R,k,s[U+10],23,-1094730640),k=be(k,M,D,R,s[U+13],4,681279174),R=be(R,k,M,D,s[U+0],11,-358537222),D=be(D,R,k,M,s[U+3],16,-722521979),M=be(M,D,R,k,s[U+6],23,76029189),k=be(k,M,D,R,s[U+9],4,-640364487),R=be(R,k,M,D,s[U+12],11,-421815835),D=be(D,R,k,M,s[U+15],16,530742520),M=be(M,D,R,k,s[U+2],23,-995338651),k=we(k,M,D,R,s[U+0],6,-198630844),R=we(R,k,M,D,s[U+7],10,1126891415),D=we(D,R,k,M,s[U+14],15,-1416354905),M=we(M,D,R,k,s[U+5],21,-57434055),k=we(k,M,D,R,s[U+12],6,1700485571),R=we(R,k,M,D,s[U+3],10,-1894986606),D=we(D,R,k,M,s[U+10],15,-1051523),M=we(M,D,R,k,s[U+1],21,-2054922799),k=we(k,M,D,R,s[U+8],6,1873313359),R=we(R,k,M,D,s[U+15],10,-30611744),D=we(D,R,k,M,s[U+6],15,-1560198380),M=we(M,D,R,k,s[U+13],21,1309151649),k=we(k,M,D,R,s[U+4],6,-145523070),R=we(R,k,M,D,s[U+11],10,-1120210379),D=we(D,R,k,M,s[U+2],15,718787259),M=we(M,D,R,k,s[U+9],21,-343485551),k=k+De>>>0,M=M+Xe>>>0,D=D+Ue>>>0,R=R+st>>>0}return r.endian([k,M,D,R])};g._ff=function(y,E,s,C,k,M,D){var R=y+(E&s|~E&C)+(k>>>0)+D;return(R<<M|R>>>32-M)+E},g._gg=function(y,E,s,C,k,M,D){var R=y+(E&C|s&~C)+(k>>>0)+D;return(R<<M|R>>>32-M)+E},g._hh=function(y,E,s,C,k,M,D){var R=y+(E^s^C)+(k>>>0)+D;return(R<<M|R>>>32-M)+E},g._ii=function(y,E,s,C,k,M,D){var R=y+(s^(E|~C))+(k>>>0)+D;return(R<<M|R>>>32-M)+E},g._blocksize=16,g._digestsize=16,yw.exports=function(y,E){if(y==null)throw new Error("Illegal argument "+y);var s=r.wordsToBytes(g(y,E));return E&&E.asBytes?s:E&&E.asString?h.bytesToString(s):r.bytesToHex(s)}})();var _5=yw.exports;function bw(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let Nc=bw();function xP(r){Nc=r}const bP=/[&<>"']/,wP=/[&<>"']/g,TP=/[<>"']|&(?!#?\w+;)/,EP=/[<>"']|&(?!#?\w+;)/g,SP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ax=r=>SP[r];function Bn(r,o){if(o){if(bP.test(r))return r.replace(wP,Ax)}else if(TP.test(r))return r.replace(EP,Ax);return r}const CP=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function ww(r){return r.replace(CP,(o,l)=>(l=l.toLowerCase(),l==="colon"?":":l.charAt(0)==="#"?l.charAt(1)==="x"?String.fromCharCode(parseInt(l.substring(2),16)):String.fromCharCode(+l.substring(1)):""))}const AP=/(^|[^\[])\^/g;function qi(r,o){r=r.source||r,o=o||"";const l={replace:(h,g)=>(g=g.source||g,g=g.replace(AP,"$1"),r=r.replace(h,g),l),getRegex:()=>new RegExp(r,o)};return l}const MP=/[^\w:]/g,IP=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Mx(r,o,l){if(r){let h;try{h=decodeURIComponent(ww(l)).replace(MP,"").toLowerCase()}catch{return null}if(h.indexOf("javascript:")===0||h.indexOf("vbscript:")===0||h.indexOf("data:")===0)return null}o&&!IP.test(l)&&(l=DP(o,l));try{l=encodeURI(l).replace(/%25/g,"%")}catch{return null}return l}const sp={},kP=/^[^:]+:\/*[^/]*$/,zP=/^([^:]+:)[\s\S]*$/,PP=/^([^:]+:\/*[^/]*)[\s\S]*$/;function DP(r,o){sp[" "+r]||(kP.test(r)?sp[" "+r]=r+"/":sp[" "+r]=yp(r,"/",!0)),r=sp[" "+r];const l=r.indexOf(":")===-1;return o.substring(0,2)==="//"?l?o:r.replace(zP,"$1")+o:o.charAt(0)==="/"?l?o:r.replace(PP,"$1")+o:r+o}const zp={exec:function(){}};function Co(r){let o=1,l,h;for(;o<arguments.length;o++){l=arguments[o];for(h in l)Object.prototype.hasOwnProperty.call(l,h)&&(r[h]=l[h])}return r}function Ix(r,o){const l=r.replace(/\|/g,(y,E,s)=>{let C=!1,k=E;for(;--k>=0&&s[k]==="\\";)C=!C;return C?"|":" |"}),h=l.split(/ \|/);let g=0;if(h[0].trim()||h.shift(),h.length>0&&!h[h.length-1].trim()&&h.pop(),h.length>o)h.splice(o);else for(;h.length<o;)h.push("");for(;g<h.length;g++)h[g]=h[g].trim().replace(/\\\|/g,"|");return h}function yp(r,o,l){const h=r.length;if(h===0)return"";let g=0;for(;g<h;){const y=r.charAt(h-g-1);if(y===o&&!l)g++;else if(y!==o&&l)g++;else break}return r.substr(0,h-g)}function LP(r,o){if(r.indexOf(o[1])===-1)return-1;const l=r.length;let h=0,g=0;for(;g<l;g++)if(r[g]==="\\")g++;else if(r[g]===o[0])h++;else if(r[g]===o[1]&&(h--,h<0))return g;return-1}function Tw(r){r&&r.sanitize&&!r.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function kx(r,o){if(o<1)return"";let l="";for(;o>1;)o&1&&(l+=r),o>>=1,r+=r;return l+r}function zx(r,o,l,h){const g=o.href,y=o.title?Bn(o.title):null,E=r[1].replace(/\\([\[\]])/g,"$1");if(r[0].charAt(0)!=="!"){h.state.inLink=!0;const s={type:"link",raw:l,href:g,title:y,text:E,tokens:h.inlineTokens(E,[])};return h.state.inLink=!1,s}else return{type:"image",raw:l,href:g,title:y,text:Bn(E)}}function RP(r,o){const l=r.match(/^(\s+)(?:```)/);if(l===null)return o;const h=l[1];return o.split(`
`).map(g=>{const y=g.match(/^\s+/);if(y===null)return g;const[E]=y;return E.length>=h.length?g.slice(h.length):g}).join(`
`)}class R_{constructor(o){this.options=o||Nc}space(o){const l=this.rules.block.newline.exec(o);if(l&&l[0].length>0)return{type:"space",raw:l[0]}}code(o){const l=this.rules.block.code.exec(o);if(l){const h=l[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:l[0],codeBlockStyle:"indented",text:this.options.pedantic?h:yp(h,`
`)}}}fences(o){const l=this.rules.block.fences.exec(o);if(l){const h=l[0],g=RP(h,l[3]||"");return{type:"code",raw:h,lang:l[2]?l[2].trim():l[2],text:g}}}heading(o){const l=this.rules.block.heading.exec(o);if(l){let h=l[2].trim();if(/#$/.test(h)){const y=yp(h,"#");(this.options.pedantic||!y||/ $/.test(y))&&(h=y.trim())}const g={type:"heading",raw:l[0],depth:l[1].length,text:h,tokens:[]};return this.lexer.inline(g.text,g.tokens),g}}hr(o){const l=this.rules.block.hr.exec(o);if(l)return{type:"hr",raw:l[0]}}blockquote(o){const l=this.rules.block.blockquote.exec(o);if(l){const h=l[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:l[0],tokens:this.lexer.blockTokens(h,[]),text:h}}}list(o){let l=this.rules.block.list.exec(o);if(l){let h,g,y,E,s,C,k,M,D,R,U,ge,Ee=l[1].trim();const be=Ee.length>1,we={type:"list",raw:"",ordered:be,start:be?+Ee.slice(0,-1):"",loose:!1,items:[]};Ee=be?`\\d{1,9}\\${Ee.slice(-1)}`:`\\${Ee}`,this.options.pedantic&&(Ee=be?Ee:"[*+-]");const De=new RegExp(`^( {0,3}${Ee})((?: [^\\n]*)?(?:\\n|$))`);for(;o&&(ge=!1,!(!(l=De.exec(o))||this.rules.block.hr.test(o)));){if(h=l[0],o=o.substring(h.length),M=l[2].split(`
`,1)[0],D=o.split(`
`,1)[0],this.options.pedantic?(E=2,U=M.trimLeft()):(E=l[2].search(/[^ ]/),E=E>4?1:E,U=M.slice(E),E+=l[1].length),C=!1,!M&&/^ *$/.test(D)&&(h+=D+`
`,o=o.substring(D.length+1),ge=!0),!ge){const Ue=new RegExp(`^ {0,${Math.min(3,E-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(;o&&(R=o.split(`
`,1)[0],M=R,this.options.pedantic&&(M=M.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!Ue.test(M));){if(M.search(/[^ ]/)>=E||!M.trim())U+=`
`+M.slice(E);else if(!C)U+=`
`+M;else break;!C&&!M.trim()&&(C=!0),h+=R+`
`,o=o.substring(R.length+1)}}we.loose||(k?we.loose=!0:/\n *\n *$/.test(h)&&(k=!0)),this.options.gfm&&(g=/^\[[ xX]\] /.exec(U),g&&(y=g[0]!=="[ ] ",U=U.replace(/^\[[ xX]\] +/,""))),we.items.push({type:"list_item",raw:h,task:!!g,checked:y,loose:!1,text:U}),we.raw+=h}we.items[we.items.length-1].raw=h.trimRight(),we.items[we.items.length-1].text=U.trimRight(),we.raw=we.raw.trimRight();const Xe=we.items.length;for(s=0;s<Xe;s++){this.lexer.state.top=!1,we.items[s].tokens=this.lexer.blockTokens(we.items[s].text,[]);const Ue=we.items[s].tokens.filter(ut=>ut.type==="space"),st=Ue.every(ut=>{const lt=ut.raw.split("");let It=0;for(const Ft of lt)if(Ft===`
`&&(It+=1),It>1)return!0;return!1});!we.loose&&Ue.length&&st&&(we.loose=!0,we.items[s].loose=!0)}return we}}html(o){const l=this.rules.block.html.exec(o);if(l){const h={type:"html",raw:l[0],pre:!this.options.sanitizer&&(l[1]==="pre"||l[1]==="script"||l[1]==="style"),text:l[0]};return this.options.sanitize&&(h.type="paragraph",h.text=this.options.sanitizer?this.options.sanitizer(l[0]):Bn(l[0]),h.tokens=[],this.lexer.inline(h.text,h.tokens)),h}}def(o){const l=this.rules.block.def.exec(o);if(l){l[3]&&(l[3]=l[3].substring(1,l[3].length-1));const h=l[1].toLowerCase().replace(/\s+/g," ");return{type:"def",tag:h,raw:l[0],href:l[2],title:l[3]}}}table(o){const l=this.rules.block.table.exec(o);if(l){const h={type:"table",header:Ix(l[1]).map(g=>({text:g})),align:l[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:l[3]&&l[3].trim()?l[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(h.header.length===h.align.length){h.raw=l[0];let g=h.align.length,y,E,s,C;for(y=0;y<g;y++)/^ *-+: *$/.test(h.align[y])?h.align[y]="right":/^ *:-+: *$/.test(h.align[y])?h.align[y]="center":/^ *:-+ *$/.test(h.align[y])?h.align[y]="left":h.align[y]=null;for(g=h.rows.length,y=0;y<g;y++)h.rows[y]=Ix(h.rows[y],h.header.length).map(k=>({text:k}));for(g=h.header.length,E=0;E<g;E++)h.header[E].tokens=[],this.lexer.inlineTokens(h.header[E].text,h.header[E].tokens);for(g=h.rows.length,E=0;E<g;E++)for(C=h.rows[E],s=0;s<C.length;s++)C[s].tokens=[],this.lexer.inlineTokens(C[s].text,C[s].tokens);return h}}}lheading(o){const l=this.rules.block.lheading.exec(o);if(l){const h={type:"heading",raw:l[0],depth:l[2].charAt(0)==="="?1:2,text:l[1],tokens:[]};return this.lexer.inline(h.text,h.tokens),h}}paragraph(o){const l=this.rules.block.paragraph.exec(o);if(l){const h={type:"paragraph",raw:l[0],text:l[1].charAt(l[1].length-1)===`
`?l[1].slice(0,-1):l[1],tokens:[]};return this.lexer.inline(h.text,h.tokens),h}}text(o){const l=this.rules.block.text.exec(o);if(l){const h={type:"text",raw:l[0],text:l[0],tokens:[]};return this.lexer.inline(h.text,h.tokens),h}}escape(o){const l=this.rules.inline.escape.exec(o);if(l)return{type:"escape",raw:l[0],text:Bn(l[1])}}tag(o){const l=this.rules.inline.tag.exec(o);if(l)return!this.lexer.state.inLink&&/^<a /i.test(l[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(l[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(l[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(l[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:l[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(l[0]):Bn(l[0]):l[0]}}link(o){const l=this.rules.inline.link.exec(o);if(l){const h=l[2].trim();if(!this.options.pedantic&&/^</.test(h)){if(!/>$/.test(h))return;const E=yp(h.slice(0,-1),"\\");if((h.length-E.length)%2===0)return}else{const E=LP(l[2],"()");if(E>-1){const C=(l[0].indexOf("!")===0?5:4)+l[1].length+E;l[2]=l[2].substring(0,E),l[0]=l[0].substring(0,C).trim(),l[3]=""}}let g=l[2],y="";if(this.options.pedantic){const E=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(g);E&&(g=E[1],y=E[3])}else y=l[3]?l[3].slice(1,-1):"";return g=g.trim(),/^</.test(g)&&(this.options.pedantic&&!/>$/.test(h)?g=g.slice(1):g=g.slice(1,-1)),zx(l,{href:g&&g.replace(this.rules.inline._escapes,"$1"),title:y&&y.replace(this.rules.inline._escapes,"$1")},l[0],this.lexer)}}reflink(o,l){let h;if((h=this.rules.inline.reflink.exec(o))||(h=this.rules.inline.nolink.exec(o))){let g=(h[2]||h[1]).replace(/\s+/g," ");if(g=l[g.toLowerCase()],!g||!g.href){const y=h[0].charAt(0);return{type:"text",raw:y,text:y}}return zx(h,g,h[0],this.lexer)}}emStrong(o,l,h=""){let g=this.rules.inline.emStrong.lDelim.exec(o);if(!g||g[3]&&h.match(/[\p{L}\p{N}]/u))return;const y=g[1]||g[2]||"";if(!y||y&&(h===""||this.rules.inline.punctuation.exec(h))){const E=g[0].length-1;let s,C,k=E,M=0;const D=g[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(D.lastIndex=0,l=l.slice(-1*o.length+E);(g=D.exec(l))!=null;){if(s=g[1]||g[2]||g[3]||g[4]||g[5]||g[6],!s)continue;if(C=s.length,g[3]||g[4]){k+=C;continue}else if((g[5]||g[6])&&E%3&&!((E+C)%3)){M+=C;continue}if(k-=C,k>0)continue;if(C=Math.min(C,C+k+M),Math.min(E,C)%2){const U=o.slice(1,E+g.index+C);return{type:"em",raw:o.slice(0,E+g.index+C+1),text:U,tokens:this.lexer.inlineTokens(U,[])}}const R=o.slice(2,E+g.index+C-1);return{type:"strong",raw:o.slice(0,E+g.index+C+1),text:R,tokens:this.lexer.inlineTokens(R,[])}}}}codespan(o){const l=this.rules.inline.code.exec(o);if(l){let h=l[2].replace(/\n/g," ");const g=/[^ ]/.test(h),y=/^ /.test(h)&&/ $/.test(h);return g&&y&&(h=h.substring(1,h.length-1)),h=Bn(h,!0),{type:"codespan",raw:l[0],text:h}}}br(o){const l=this.rules.inline.br.exec(o);if(l)return{type:"br",raw:l[0]}}del(o){const l=this.rules.inline.del.exec(o);if(l)return{type:"del",raw:l[0],text:l[2],tokens:this.lexer.inlineTokens(l[2],[])}}autolink(o,l){const h=this.rules.inline.autolink.exec(o);if(h){let g,y;return h[2]==="@"?(g=Bn(this.options.mangle?l(h[1]):h[1]),y="mailto:"+g):(g=Bn(h[1]),y=g),{type:"link",raw:h[0],text:g,href:y,tokens:[{type:"text",raw:g,text:g}]}}}url(o,l){let h;if(h=this.rules.inline.url.exec(o)){let g,y;if(h[2]==="@")g=Bn(this.options.mangle?l(h[0]):h[0]),y="mailto:"+g;else{let E;do E=h[0],h[0]=this.rules.inline._backpedal.exec(h[0])[0];while(E!==h[0]);g=Bn(h[0]),h[1]==="www."?y="http://"+g:y=g}return{type:"link",raw:h[0],text:g,href:y,tokens:[{type:"text",raw:g,text:g}]}}}inlineText(o,l){const h=this.rules.inline.text.exec(o);if(h){let g;return this.lexer.state.inRawBlock?g=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(h[0]):Bn(h[0]):h[0]:g=Bn(this.options.smartypants?l(h[0]):h[0]),{type:"text",raw:h[0],text:g}}}}const Vt={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:zp,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};Vt._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;Vt._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;Vt.def=qi(Vt.def).replace("label",Vt._label).replace("title",Vt._title).getRegex();Vt.bullet=/(?:[*+-]|\d{1,9}[.)])/;Vt.listItemStart=qi(/^( *)(bull) */).replace("bull",Vt.bullet).getRegex();Vt.list=qi(Vt.list).replace(/bull/g,Vt.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Vt.def.source+")").getRegex();Vt._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";Vt._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;Vt.html=qi(Vt.html,"i").replace("comment",Vt._comment).replace("tag",Vt._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();Vt.paragraph=qi(Vt._paragraph).replace("hr",Vt.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Vt._tag).getRegex();Vt.blockquote=qi(Vt.blockquote).replace("paragraph",Vt.paragraph).getRegex();Vt.normal=Co({},Vt);Vt.gfm=Co({},Vt.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});Vt.gfm.table=qi(Vt.gfm.table).replace("hr",Vt.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Vt._tag).getRegex();Vt.gfm.paragraph=qi(Vt._paragraph).replace("hr",Vt.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Vt.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Vt._tag).getRegex();Vt.pedantic=Co({},Vt.normal,{html:qi(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Vt._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:zp,paragraph:qi(Vt.normal._paragraph).replace("hr",Vt.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Vt.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const kt={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:zp,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:zp,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};kt._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";kt.punctuation=qi(kt.punctuation).replace(/punctuation/g,kt._punctuation).getRegex();kt.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;kt.escapedEmSt=/\\\*|\\_/g;kt._comment=qi(Vt._comment).replace("(?:-->|$)","-->").getRegex();kt.emStrong.lDelim=qi(kt.emStrong.lDelim).replace(/punct/g,kt._punctuation).getRegex();kt.emStrong.rDelimAst=qi(kt.emStrong.rDelimAst,"g").replace(/punct/g,kt._punctuation).getRegex();kt.emStrong.rDelimUnd=qi(kt.emStrong.rDelimUnd,"g").replace(/punct/g,kt._punctuation).getRegex();kt._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;kt._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;kt._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;kt.autolink=qi(kt.autolink).replace("scheme",kt._scheme).replace("email",kt._email).getRegex();kt._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;kt.tag=qi(kt.tag).replace("comment",kt._comment).replace("attribute",kt._attribute).getRegex();kt._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;kt._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;kt._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;kt.link=qi(kt.link).replace("label",kt._label).replace("href",kt._href).replace("title",kt._title).getRegex();kt.reflink=qi(kt.reflink).replace("label",kt._label).replace("ref",Vt._label).getRegex();kt.nolink=qi(kt.nolink).replace("ref",Vt._label).getRegex();kt.reflinkSearch=qi(kt.reflinkSearch,"g").replace("reflink",kt.reflink).replace("nolink",kt.nolink).getRegex();kt.normal=Co({},kt);kt.pedantic=Co({},kt.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:qi(/^!?\[(label)\]\((.*?)\)/).replace("label",kt._label).getRegex(),reflink:qi(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",kt._label).getRegex()});kt.gfm=Co({},kt.normal,{escape:qi(kt.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});kt.gfm.url=qi(kt.gfm.url,"i").replace("email",kt.gfm._extended_email).getRegex();kt.breaks=Co({},kt.gfm,{br:qi(kt.br).replace("{2,}","*").getRegex(),text:qi(kt.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function OP(r){return r.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function Px(r){let o="",l,h;const g=r.length;for(l=0;l<g;l++)h=r.charCodeAt(l),Math.random()>.5&&(h="x"+h.toString(16)),o+="&#"+h+";";return o}class gs{constructor(o){this.tokens=[],this.tokens.links=Object.create(null),this.options=o||Nc,this.options.tokenizer=this.options.tokenizer||new R_,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const l={block:Vt.normal,inline:kt.normal};this.options.pedantic?(l.block=Vt.pedantic,l.inline=kt.pedantic):this.options.gfm&&(l.block=Vt.gfm,this.options.breaks?l.inline=kt.breaks:l.inline=kt.gfm),this.tokenizer.rules=l}static get rules(){return{block:Vt,inline:kt}}static lex(o,l){return new gs(l).lex(o)}static lexInline(o,l){return new gs(l).inlineTokens(o)}lex(o){o=o.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(o,this.tokens);let l;for(;l=this.inlineQueue.shift();)this.inlineTokens(l.src,l.tokens);return this.tokens}blockTokens(o,l=[]){this.options.pedantic&&(o=o.replace(/^ +$/gm,""));let h,g,y,E;for(;o;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(s=>(h=s.call({lexer:this},o,l))?(o=o.substring(h.raw.length),l.push(h),!0):!1))){if(h=this.tokenizer.space(o)){o=o.substring(h.raw.length),h.raw.length===1&&l.length>0?l[l.length-1].raw+=`
`:l.push(h);continue}if(h=this.tokenizer.code(o)){o=o.substring(h.raw.length),g=l[l.length-1],g&&(g.type==="paragraph"||g.type==="text")?(g.raw+=`
`+h.raw,g.text+=`
`+h.text,this.inlineQueue[this.inlineQueue.length-1].src=g.text):l.push(h);continue}if(h=this.tokenizer.fences(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.heading(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.hr(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.blockquote(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.list(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.html(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.def(o)){o=o.substring(h.raw.length),g=l[l.length-1],g&&(g.type==="paragraph"||g.type==="text")?(g.raw+=`
`+h.raw,g.text+=`
`+h.raw,this.inlineQueue[this.inlineQueue.length-1].src=g.text):this.tokens.links[h.tag]||(this.tokens.links[h.tag]={href:h.href,title:h.title});continue}if(h=this.tokenizer.table(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.lheading(o)){o=o.substring(h.raw.length),l.push(h);continue}if(y=o,this.options.extensions&&this.options.extensions.startBlock){let s=1/0;const C=o.slice(1);let k;this.options.extensions.startBlock.forEach(function(M){k=M.call({lexer:this},C),typeof k=="number"&&k>=0&&(s=Math.min(s,k))}),s<1/0&&s>=0&&(y=o.substring(0,s+1))}if(this.state.top&&(h=this.tokenizer.paragraph(y))){g=l[l.length-1],E&&g.type==="paragraph"?(g.raw+=`
`+h.raw,g.text+=`
`+h.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=g.text):l.push(h),E=y.length!==o.length,o=o.substring(h.raw.length);continue}if(h=this.tokenizer.text(o)){o=o.substring(h.raw.length),g=l[l.length-1],g&&g.type==="text"?(g.raw+=`
`+h.raw,g.text+=`
`+h.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=g.text):l.push(h);continue}if(o){const s="Infinite loop on byte: "+o.charCodeAt(0);if(this.options.silent){console.error(s);break}else throw new Error(s)}}return this.state.top=!0,l}inline(o,l){this.inlineQueue.push({src:o,tokens:l})}inlineTokens(o,l=[]){let h,g,y,E=o,s,C,k;if(this.tokens.links){const M=Object.keys(this.tokens.links);if(M.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(E))!=null;)M.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(E=E.slice(0,s.index)+"["+kx("a",s[0].length-2)+"]"+E.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.blockSkip.exec(E))!=null;)E=E.slice(0,s.index)+"["+kx("a",s[0].length-2)+"]"+E.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(s=this.tokenizer.rules.inline.escapedEmSt.exec(E))!=null;)E=E.slice(0,s.index)+"++"+E.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;o;)if(C||(k=""),C=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(M=>(h=M.call({lexer:this},o,l))?(o=o.substring(h.raw.length),l.push(h),!0):!1))){if(h=this.tokenizer.escape(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.tag(o)){o=o.substring(h.raw.length),g=l[l.length-1],g&&h.type==="text"&&g.type==="text"?(g.raw+=h.raw,g.text+=h.text):l.push(h);continue}if(h=this.tokenizer.link(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.reflink(o,this.tokens.links)){o=o.substring(h.raw.length),g=l[l.length-1],g&&h.type==="text"&&g.type==="text"?(g.raw+=h.raw,g.text+=h.text):l.push(h);continue}if(h=this.tokenizer.emStrong(o,E,k)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.codespan(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.br(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.del(o)){o=o.substring(h.raw.length),l.push(h);continue}if(h=this.tokenizer.autolink(o,Px)){o=o.substring(h.raw.length),l.push(h);continue}if(!this.state.inLink&&(h=this.tokenizer.url(o,Px))){o=o.substring(h.raw.length),l.push(h);continue}if(y=o,this.options.extensions&&this.options.extensions.startInline){let M=1/0;const D=o.slice(1);let R;this.options.extensions.startInline.forEach(function(U){R=U.call({lexer:this},D),typeof R=="number"&&R>=0&&(M=Math.min(M,R))}),M<1/0&&M>=0&&(y=o.substring(0,M+1))}if(h=this.tokenizer.inlineText(y,OP)){o=o.substring(h.raw.length),h.raw.slice(-1)!=="_"&&(k=h.raw.slice(-1)),C=!0,g=l[l.length-1],g&&g.type==="text"?(g.raw+=h.raw,g.text+=h.text):l.push(h);continue}if(o){const M="Infinite loop on byte: "+o.charCodeAt(0);if(this.options.silent){console.error(M);break}else throw new Error(M)}}return l}}class O_{constructor(o){this.options=o||Nc}code(o,l,h){const g=(l||"").match(/\S*/)[0];if(this.options.highlight){const y=this.options.highlight(o,g);y!=null&&y!==o&&(h=!0,o=y)}return o=o.replace(/\n$/,"")+`
`,g?'<pre><code class="'+this.options.langPrefix+Bn(g,!0)+'">'+(h?o:Bn(o,!0))+`</code></pre>
`:"<pre><code>"+(h?o:Bn(o,!0))+`</code></pre>
`}blockquote(o){return`<blockquote>
`+o+`</blockquote>
`}html(o){return o}heading(o,l,h,g){return this.options.headerIds?"<h"+l+' id="'+this.options.headerPrefix+g.slug(h)+'">'+o+"</h"+l+`>
`:"<h"+l+">"+o+"</h"+l+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(o,l,h){const g=l?"ol":"ul",y=l&&h!==1?' start="'+h+'"':"";return"<"+g+y+`>
`+o+"</"+g+`>
`}listitem(o){return"<li>"+o+`</li>
`}checkbox(o){return"<input "+(o?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(o){return"<p>"+o+`</p>
`}table(o,l){return l&&(l="<tbody>"+l+"</tbody>"),`<table>
<thead>
`+o+`</thead>
`+l+`</table>
`}tablerow(o){return`<tr>
`+o+`</tr>
`}tablecell(o,l){const h=l.header?"th":"td";return(l.align?"<"+h+' align="'+l.align+'">':"<"+h+">")+o+"</"+h+`>
`}strong(o){return"<strong>"+o+"</strong>"}em(o){return"<em>"+o+"</em>"}codespan(o){return"<code>"+o+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(o){return"<del>"+o+"</del>"}link(o,l,h){if(o=Mx(this.options.sanitize,this.options.baseUrl,o),o===null)return h;let g='<a href="'+Bn(o)+'"';return l&&(g+=' title="'+l+'"'),g+=">"+h+"</a>",g}image(o,l,h){if(o=Mx(this.options.sanitize,this.options.baseUrl,o),o===null)return h;let g='<img src="'+o+'" alt="'+h+'"';return l&&(g+=' title="'+l+'"'),g+=this.options.xhtml?"/>":">",g}text(o){return o}}class Ew{strong(o){return o}em(o){return o}codespan(o){return o}del(o){return o}html(o){return o}text(o){return o}link(o,l,h){return""+h}image(o,l,h){return""+h}br(){return""}}class Sw{constructor(){this.seen={}}serialize(o){return o.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(o,l){let h=o,g=0;if(this.seen.hasOwnProperty(h)){g=this.seen[o];do g++,h=o+"-"+g;while(this.seen.hasOwnProperty(h))}return l||(this.seen[o]=g,this.seen[h]=0),h}slug(o,l={}){const h=this.serialize(o);return this.getNextSafeSlug(h,l.dryrun)}}class _s{constructor(o){this.options=o||Nc,this.options.renderer=this.options.renderer||new O_,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Ew,this.slugger=new Sw}static parse(o,l){return new _s(l).parse(o)}static parseInline(o,l){return new _s(l).parseInline(o)}parse(o,l=!0){let h="",g,y,E,s,C,k,M,D,R,U,ge,Ee,be,we,De,Xe,Ue,st,ut;const lt=o.length;for(g=0;g<lt;g++){if(U=o[g],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[U.type]&&(ut=this.options.extensions.renderers[U.type].call({parser:this},U),ut!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(U.type))){h+=ut||"";continue}switch(U.type){case"space":continue;case"hr":{h+=this.renderer.hr();continue}case"heading":{h+=this.renderer.heading(this.parseInline(U.tokens),U.depth,ww(this.parseInline(U.tokens,this.textRenderer)),this.slugger);continue}case"code":{h+=this.renderer.code(U.text,U.lang,U.escaped);continue}case"table":{for(D="",M="",s=U.header.length,y=0;y<s;y++)M+=this.renderer.tablecell(this.parseInline(U.header[y].tokens),{header:!0,align:U.align[y]});for(D+=this.renderer.tablerow(M),R="",s=U.rows.length,y=0;y<s;y++){for(k=U.rows[y],M="",C=k.length,E=0;E<C;E++)M+=this.renderer.tablecell(this.parseInline(k[E].tokens),{header:!1,align:U.align[E]});R+=this.renderer.tablerow(M)}h+=this.renderer.table(D,R);continue}case"blockquote":{R=this.parse(U.tokens),h+=this.renderer.blockquote(R);continue}case"list":{for(ge=U.ordered,Ee=U.start,be=U.loose,s=U.items.length,R="",y=0;y<s;y++)De=U.items[y],Xe=De.checked,Ue=De.task,we="",De.task&&(st=this.renderer.checkbox(Xe),be?De.tokens.length>0&&De.tokens[0].type==="paragraph"?(De.tokens[0].text=st+" "+De.tokens[0].text,De.tokens[0].tokens&&De.tokens[0].tokens.length>0&&De.tokens[0].tokens[0].type==="text"&&(De.tokens[0].tokens[0].text=st+" "+De.tokens[0].tokens[0].text)):De.tokens.unshift({type:"text",text:st}):we+=st),we+=this.parse(De.tokens,be),R+=this.renderer.listitem(we,Ue,Xe);h+=this.renderer.list(R,ge,Ee);continue}case"html":{h+=this.renderer.html(U.text);continue}case"paragraph":{h+=this.renderer.paragraph(this.parseInline(U.tokens));continue}case"text":{for(R=U.tokens?this.parseInline(U.tokens):U.text;g+1<lt&&o[g+1].type==="text";)U=o[++g],R+=`
`+(U.tokens?this.parseInline(U.tokens):U.text);h+=l?this.renderer.paragraph(R):R;continue}default:{const It='Token with "'+U.type+'" type was not found.';if(this.options.silent){console.error(It);return}else throw new Error(It)}}}return h}parseInline(o,l){l=l||this.renderer;let h="",g,y,E;const s=o.length;for(g=0;g<s;g++){if(y=o[g],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[y.type]&&(E=this.options.extensions.renderers[y.type].call({parser:this},y),E!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(y.type))){h+=E||"";continue}switch(y.type){case"escape":{h+=l.text(y.text);break}case"html":{h+=l.html(y.text);break}case"link":{h+=l.link(y.href,y.title,this.parseInline(y.tokens,l));break}case"image":{h+=l.image(y.href,y.title,y.text);break}case"strong":{h+=l.strong(this.parseInline(y.tokens,l));break}case"em":{h+=l.em(this.parseInline(y.tokens,l));break}case"codespan":{h+=l.codespan(y.text);break}case"br":{h+=l.br();break}case"del":{h+=l.del(this.parseInline(y.tokens,l));break}case"text":{h+=l.text(y.text);break}default:{const C='Token with "'+y.type+'" type was not found.';if(this.options.silent){console.error(C);return}else throw new Error(C)}}}return h}}function ci(r,o,l){if(typeof r=="undefined"||r===null)throw new Error("marked(): input parameter is undefined or null");if(typeof r!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected");if(typeof o=="function"&&(l=o,o=null),o=Co({},ci.defaults,o||{}),Tw(o),l){const h=o.highlight;let g;try{g=gs.lex(r,o)}catch(s){return l(s)}const y=function(s){let C;if(!s)try{o.walkTokens&&ci.walkTokens(g,o.walkTokens),C=_s.parse(g,o)}catch(k){s=k}return o.highlight=h,s?l(s):l(null,C)};if(!h||h.length<3||(delete o.highlight,!g.length))return y();let E=0;ci.walkTokens(g,function(s){s.type==="code"&&(E++,setTimeout(()=>{h(s.text,s.lang,function(C,k){if(C)return y(C);k!=null&&k!==s.text&&(s.text=k,s.escaped=!0),E--,E===0&&y()})},0))}),E===0&&y();return}try{const h=gs.lex(r,o);return o.walkTokens&&ci.walkTokens(h,o.walkTokens),_s.parse(h,o)}catch(h){if(h.message+=`
Please report this to https://github.com/markedjs/marked.`,o.silent)return"<p>An error occurred:</p><pre>"+Bn(h.message+"",!0)+"</pre>";throw h}}ci.options=ci.setOptions=function(r){return Co(ci.defaults,r),xP(ci.defaults),ci};ci.getDefaults=bw;ci.defaults=Nc;ci.use=function(...r){const o=Co({},...r),l=ci.defaults.extensions||{renderers:{},childTokens:{}};let h;r.forEach(g=>{if(g.extensions&&(h=!0,g.extensions.forEach(y=>{if(!y.name)throw new Error("extension name required");if(y.renderer){const E=l.renderers?l.renderers[y.name]:null;E?l.renderers[y.name]=function(...s){let C=y.renderer.apply(this,s);return C===!1&&(C=E.apply(this,s)),C}:l.renderers[y.name]=y.renderer}if(y.tokenizer){if(!y.level||y.level!=="block"&&y.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");l[y.level]?l[y.level].unshift(y.tokenizer):l[y.level]=[y.tokenizer],y.start&&(y.level==="block"?l.startBlock?l.startBlock.push(y.start):l.startBlock=[y.start]:y.level==="inline"&&(l.startInline?l.startInline.push(y.start):l.startInline=[y.start]))}y.childTokens&&(l.childTokens[y.name]=y.childTokens)})),g.renderer){const y=ci.defaults.renderer||new O_;for(const E in g.renderer){const s=y[E];y[E]=(...C)=>{let k=g.renderer[E].apply(y,C);return k===!1&&(k=s.apply(y,C)),k}}o.renderer=y}if(g.tokenizer){const y=ci.defaults.tokenizer||new R_;for(const E in g.tokenizer){const s=y[E];y[E]=(...C)=>{let k=g.tokenizer[E].apply(y,C);return k===!1&&(k=s.apply(y,C)),k}}o.tokenizer=y}if(g.walkTokens){const y=ci.defaults.walkTokens;o.walkTokens=function(E){g.walkTokens.call(this,E),y&&y.call(this,E)}}h&&(o.extensions=l),ci.setOptions(o)})};ci.walkTokens=function(r,o){for(const l of r)switch(o.call(ci,l),l.type){case"table":{for(const h of l.header)ci.walkTokens(h.tokens,o);for(const h of l.rows)for(const g of h)ci.walkTokens(g.tokens,o);break}case"list":{ci.walkTokens(l.items,o);break}default:ci.defaults.extensions&&ci.defaults.extensions.childTokens&&ci.defaults.extensions.childTokens[l.type]?ci.defaults.extensions.childTokens[l.type].forEach(function(h){ci.walkTokens(l[h],o)}):l.tokens&&ci.walkTokens(l.tokens,o)}};ci.parseInline=function(r,o){if(typeof r=="undefined"||r===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof r!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected");o=Co({},ci.defaults,o||{}),Tw(o);try{const l=gs.lexInline(r,o);return o.walkTokens&&ci.walkTokens(l,o.walkTokens),_s.parseInline(l,o)}catch(l){if(l.message+=`
Please report this to https://github.com/markedjs/marked.`,o.silent)return"<p>An error occurred:</p><pre>"+Bn(l.message+"",!0)+"</pre>";throw l}};ci.Parser=_s;ci.parser=_s.parse;ci.Renderer=O_;ci.TextRenderer=Ew;ci.Lexer=gs;ci.lexer=gs.lex;ci.Tokenizer=R_;ci.Slugger=Sw;ci.parse=ci;_s.parse;gs.lex;/*! @license DOMPurify 2.3.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.6/LICENSE */function BP(r){if(Array.isArray(r)){for(var o=0,l=Array(r.length);o<r.length;o++)l[o]=r[o];return l}else return Array.from(r)}var FP=Object.hasOwnProperty,Dx=Object.setPrototypeOf,NP=Object.isFrozen,UP=Object.getPrototypeOf,jP=Object.getOwnPropertyDescriptor,dr=Object.freeze,Jo=Object.seal,VP=Object.create,Cw=typeof Reflect!="undefined"&&Reflect,Pp=Cw.apply,Vg=Cw.construct;Pp||(Pp=function(o,l,h){return o.apply(l,h)});dr||(dr=function(o){return o});Jo||(Jo=function(o){return o});Vg||(Vg=function(o,l){return new(Function.prototype.bind.apply(o,[null].concat(BP(l))))});var $P=Eo(Array.prototype.forEach),Lx=Eo(Array.prototype.pop),qu=Eo(Array.prototype.push),vp=Eo(String.prototype.toLowerCase),Rx=Eo(String.prototype.match),Ys=Eo(String.prototype.replace),GP=Eo(String.prototype.indexOf),qP=Eo(String.prototype.trim),wr=Eo(RegExp.prototype.test),tg=ZP(TypeError);function Eo(r){return function(o){for(var l=arguments.length,h=Array(l>1?l-1:0),g=1;g<l;g++)h[g-1]=arguments[g];return Pp(r,o,h)}}function ZP(r){return function(){for(var o=arguments.length,l=Array(o),h=0;h<o;h++)l[h]=arguments[h];return Vg(r,l)}}function xi(r,o){Dx&&Dx(r,null);for(var l=o.length;l--;){var h=o[l];if(typeof h=="string"){var g=vp(h);g!==h&&(NP(o)||(o[l]=g),h=g)}r[h]=!0}return r}function Xa(r){var o=VP(null),l=void 0;for(l in r)Pp(FP,r,[l])&&(o[l]=r[l]);return o}function ap(r,o){for(;r!==null;){var l=jP(r,o);if(l){if(l.get)return Eo(l.get);if(typeof l.value=="function")return Eo(l.value)}r=UP(r)}function h(g){return console.warn("fallback value for",g),null}return h}var Ox=dr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ig=dr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ng=dr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),WP=dr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),rg=dr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),HP=dr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Bx=dr(["#text"]),Fx=dr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),og=dr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Nx=dr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),lp=dr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),XP=Jo(/\{\{[\s\S]*|[\s\S]*\}\}/gm),KP=Jo(/<%[\s\S]*|[\s\S]*%>/gm),YP=Jo(/^data-[\-\w.\u00B7-\uFFFF]/),JP=Jo(/^aria-[\-\w]+$/),QP=Jo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),eD=Jo(/^(?:\w+script|data):/i),tD=Jo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),iD=Jo(/^html$/i),Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r};function Wo(r){if(Array.isArray(r)){for(var o=0,l=Array(r.length);o<r.length;o++)l[o]=r[o];return l}else return Array.from(r)}var nD=function(){return typeof window=="undefined"?null:window},rD=function(o,l){if((typeof o=="undefined"?"undefined":Yu(o))!=="object"||typeof o.createPolicy!="function")return null;var h=null,g="data-tt-policy-suffix";l.currentScript&&l.currentScript.hasAttribute(g)&&(h=l.currentScript.getAttribute(g));var y="dompurify"+(h?"#"+h:"");try{return o.createPolicy(y,{createHTML:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+y+" could not be created."),null}};function Aw(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nD(),o=function(Y){return Aw(Y)};if(o.version="2.3.6",o.removed=[],!r||!r.document||r.document.nodeType!==9)return o.isSupported=!1,o;var l=r.document,h=r.document,g=r.DocumentFragment,y=r.HTMLTemplateElement,E=r.Node,s=r.Element,C=r.NodeFilter,k=r.NamedNodeMap,M=k===void 0?r.NamedNodeMap||r.MozNamedAttrMap:k,D=r.HTMLFormElement,R=r.DOMParser,U=r.trustedTypes,ge=s.prototype,Ee=ap(ge,"cloneNode"),be=ap(ge,"nextSibling"),we=ap(ge,"childNodes"),De=ap(ge,"parentNode");if(typeof y=="function"){var Xe=h.createElement("template");Xe.content&&Xe.content.ownerDocument&&(h=Xe.content.ownerDocument)}var Ue=rD(U,l),st=Ue?Ue.createHTML(""):"",ut=h,lt=ut.implementation,It=ut.createNodeIterator,Ft=ut.createDocumentFragment,Ct=ut.getElementsByTagName,Tt=l.importNode,ot={};try{ot=Xa(h).documentMode?h.documentMode:{}}catch{}var Nt={};o.isSupported=typeof De=="function"&&lt&&typeof lt.createHTMLDocument!="undefined"&&ot!==9;var Ai=XP,Zi=KP,ri=YP,qt=JP,ei=eD,Si=tD,Qi=QP,Et=null,en=xi({},[].concat(Wo(Ox),Wo(ig),Wo(ng),Wo(rg),Wo(Bx))),ti=null,Dn=xi({},[].concat(Wo(Fx),Wo(og),Wo(Nx),Wo(lp))),Be=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),yt=null,rt=null,At=!0,ui=!0,pi=!1,Le=!1,We=!1,te=!1,ae=!1,Ce=!1,Ie=!1,Ve=!1,Ke=!0,ht=!0,Ne=!1,tt={},Ze=null,Mt=xi({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),wt=null,dt=xi({},["audio","video","img","source","image","track"]),Lt=null,Zt=xi({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),hi="http://www.w3.org/1998/Math/MathML",Wt="http://www.w3.org/2000/svg",oi="http://www.w3.org/1999/xhtml",Ki=oi,Cn=!1,fn=void 0,Hn=["application/xhtml+xml","text/html"],An="text/html",Ni=void 0,Yt=null,Mn=h.createElement("form"),ro=function(Y){return Y instanceof RegExp||Y instanceof Function},Xn=function(Y){Yt&&Yt===Y||((!Y||(typeof Y=="undefined"?"undefined":Yu(Y))!=="object")&&(Y={}),Y=Xa(Y),Et="ALLOWED_TAGS"in Y?xi({},Y.ALLOWED_TAGS):en,ti="ALLOWED_ATTR"in Y?xi({},Y.ALLOWED_ATTR):Dn,Lt="ADD_URI_SAFE_ATTR"in Y?xi(Xa(Zt),Y.ADD_URI_SAFE_ATTR):Zt,wt="ADD_DATA_URI_TAGS"in Y?xi(Xa(dt),Y.ADD_DATA_URI_TAGS):dt,Ze="FORBID_CONTENTS"in Y?xi({},Y.FORBID_CONTENTS):Mt,yt="FORBID_TAGS"in Y?xi({},Y.FORBID_TAGS):{},rt="FORBID_ATTR"in Y?xi({},Y.FORBID_ATTR):{},tt="USE_PROFILES"in Y?Y.USE_PROFILES:!1,At=Y.ALLOW_ARIA_ATTR!==!1,ui=Y.ALLOW_DATA_ATTR!==!1,pi=Y.ALLOW_UNKNOWN_PROTOCOLS||!1,Le=Y.SAFE_FOR_TEMPLATES||!1,We=Y.WHOLE_DOCUMENT||!1,Ce=Y.RETURN_DOM||!1,Ie=Y.RETURN_DOM_FRAGMENT||!1,Ve=Y.RETURN_TRUSTED_TYPE||!1,ae=Y.FORCE_BODY||!1,Ke=Y.SANITIZE_DOM!==!1,ht=Y.KEEP_CONTENT!==!1,Ne=Y.IN_PLACE||!1,Qi=Y.ALLOWED_URI_REGEXP||Qi,Ki=Y.NAMESPACE||oi,Y.CUSTOM_ELEMENT_HANDLING&&ro(Y.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Be.tagNameCheck=Y.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Y.CUSTOM_ELEMENT_HANDLING&&ro(Y.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Be.attributeNameCheck=Y.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Y.CUSTOM_ELEMENT_HANDLING&&typeof Y.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Be.allowCustomizedBuiltInElements=Y.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),fn=Hn.indexOf(Y.PARSER_MEDIA_TYPE)===-1?fn=An:fn=Y.PARSER_MEDIA_TYPE,Ni=fn==="application/xhtml+xml"?function(fe){return fe}:vp,Le&&(ui=!1),Ie&&(Ce=!0),tt&&(Et=xi({},[].concat(Wo(Bx))),ti=[],tt.html===!0&&(xi(Et,Ox),xi(ti,Fx)),tt.svg===!0&&(xi(Et,ig),xi(ti,og),xi(ti,lp)),tt.svgFilters===!0&&(xi(Et,ng),xi(ti,og),xi(ti,lp)),tt.mathMl===!0&&(xi(Et,rg),xi(ti,Nx),xi(ti,lp))),Y.ADD_TAGS&&(Et===en&&(Et=Xa(Et)),xi(Et,Y.ADD_TAGS)),Y.ADD_ATTR&&(ti===Dn&&(ti=Xa(ti)),xi(ti,Y.ADD_ATTR)),Y.ADD_URI_SAFE_ATTR&&xi(Lt,Y.ADD_URI_SAFE_ATTR),Y.FORBID_CONTENTS&&(Ze===Mt&&(Ze=Xa(Ze)),xi(Ze,Y.FORBID_CONTENTS)),ht&&(Et["#text"]=!0),We&&xi(Et,["html","head","body"]),Et.table&&(xi(Et,["tbody"]),delete yt.tbody),dr&&dr(Y),Yt=Y)},oo=xi({},["mi","mo","mn","ms","mtext"]),Vr=xi({},["foreignobject","desc","title","annotation-xml"]),Kn=xi({},ig);xi(Kn,ng),xi(Kn,WP);var jn=xi({},rg);xi(jn,HP);var $r=function(Y){var fe=De(Y);(!fe||!fe.tagName)&&(fe={namespaceURI:oi,tagName:"template"});var Te=vp(Y.tagName),it=vp(fe.tagName);if(Y.namespaceURI===Wt)return fe.namespaceURI===oi?Te==="svg":fe.namespaceURI===hi?Te==="svg"&&(it==="annotation-xml"||oo[it]):Boolean(Kn[Te]);if(Y.namespaceURI===hi)return fe.namespaceURI===oi?Te==="math":fe.namespaceURI===Wt?Te==="math"&&Vr[it]:Boolean(jn[Te]);if(Y.namespaceURI===oi){if(fe.namespaceURI===Wt&&!Vr[it]||fe.namespaceURI===hi&&!oo[it])return!1;var mt=xi({},["title","style","font","a","script"]);return!jn[Te]&&(mt[Te]||!Kn[Te])}return!1},un=function(Y){qu(o.removed,{element:Y});try{Y.parentNode.removeChild(Y)}catch{try{Y.outerHTML=st}catch{Y.remove()}}},so=function(Y,fe){try{qu(o.removed,{attribute:fe.getAttributeNode(Y),from:fe})}catch{qu(o.removed,{attribute:null,from:fe})}if(fe.removeAttribute(Y),Y==="is"&&!ti[Y])if(Ce||Ie)try{un(fe)}catch{}else try{fe.setAttribute(Y,"")}catch{}},Ln=function(Y){var fe=void 0,Te=void 0;if(ae)Y="<remove></remove>"+Y;else{var it=Rx(Y,/^[\r\n\t ]+/);Te=it&&it[0]}fn==="application/xhtml+xml"&&(Y='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Y+"</body></html>");var mt=Ue?Ue.createHTML(Y):Y;if(Ki===oi)try{fe=new R().parseFromString(mt,fn)}catch{}if(!fe||!fe.documentElement){fe=lt.createDocument(Ki,"template",null);try{fe.documentElement.innerHTML=Cn?"":mt}catch{}}var gt=fe.body||fe.documentElement;return Y&&Te&&gt.insertBefore(h.createTextNode(Te),gt.childNodes[0]||null),Ki===oi?Ct.call(fe,We?"html":"body")[0]:We?fe.documentElement:gt},J=function(Y){return It.call(Y.ownerDocument||Y,Y,C.SHOW_ELEMENT|C.SHOW_COMMENT|C.SHOW_TEXT,null,!1)},B=function(Y){return Y instanceof D&&(typeof Y.nodeName!="string"||typeof Y.textContent!="string"||typeof Y.removeChild!="function"||!(Y.attributes instanceof M)||typeof Y.removeAttribute!="function"||typeof Y.setAttribute!="function"||typeof Y.namespaceURI!="string"||typeof Y.insertBefore!="function")},V=function(Y){return(typeof E=="undefined"?"undefined":Yu(E))==="object"?Y instanceof E:Y&&(typeof Y=="undefined"?"undefined":Yu(Y))==="object"&&typeof Y.nodeType=="number"&&typeof Y.nodeName=="string"},K=function(Y,fe,Te){!Nt[Y]||$P(Nt[Y],function(it){it.call(o,fe,Te,Yt)})},ee=function(Y){var fe=void 0;if(K("beforeSanitizeElements",Y,null),B(Y)||Rx(Y.nodeName,/[\u0080-\uFFFF]/))return un(Y),!0;var Te=Ni(Y.nodeName);if(K("uponSanitizeElement",Y,{tagName:Te,allowedTags:Et}),!V(Y.firstElementChild)&&(!V(Y.content)||!V(Y.content.firstElementChild))&&wr(/<[/\w]/g,Y.innerHTML)&&wr(/<[/\w]/g,Y.textContent)||Te==="select"&&wr(/<template/i,Y.innerHTML))return un(Y),!0;if(!Et[Te]||yt[Te]){if(!yt[Te]&&ye(Te)&&(Be.tagNameCheck instanceof RegExp&&wr(Be.tagNameCheck,Te)||Be.tagNameCheck instanceof Function&&Be.tagNameCheck(Te)))return!1;if(ht&&!Ze[Te]){var it=De(Y)||Y.parentNode,mt=we(Y)||Y.childNodes;if(mt&&it)for(var gt=mt.length,vt=gt-1;vt>=0;--vt)it.insertBefore(Ee(mt[vt],!0),be(Y))}return un(Y),!0}return Y instanceof s&&!$r(Y)||(Te==="noscript"||Te==="noembed")&&wr(/<\/no(script|embed)/i,Y.innerHTML)?(un(Y),!0):(Le&&Y.nodeType===3&&(fe=Y.textContent,fe=Ys(fe,Ai," "),fe=Ys(fe,Zi," "),Y.textContent!==fe&&(qu(o.removed,{element:Y.cloneNode()}),Y.textContent=fe)),K("afterSanitizeElements",Y,null),!1)},he=function(Y,fe,Te){if(Ke&&(fe==="id"||fe==="name")&&(Te in h||Te in Mn))return!1;if(!(ui&&!rt[fe]&&wr(ri,fe))){if(!(At&&wr(qt,fe))){if(!ti[fe]||rt[fe]){if(!(ye(Y)&&(Be.tagNameCheck instanceof RegExp&&wr(Be.tagNameCheck,Y)||Be.tagNameCheck instanceof Function&&Be.tagNameCheck(Y))&&(Be.attributeNameCheck instanceof RegExp&&wr(Be.attributeNameCheck,fe)||Be.attributeNameCheck instanceof Function&&Be.attributeNameCheck(fe))||fe==="is"&&Be.allowCustomizedBuiltInElements&&(Be.tagNameCheck instanceof RegExp&&wr(Be.tagNameCheck,Te)||Be.tagNameCheck instanceof Function&&Be.tagNameCheck(Te))))return!1}else if(!Lt[fe]){if(!wr(Qi,Ys(Te,Si,""))){if(!((fe==="src"||fe==="xlink:href"||fe==="href")&&Y!=="script"&&GP(Te,"data:")===0&&wt[Y])){if(!(pi&&!wr(ei,Ys(Te,Si,"")))){if(Te)return!1}}}}}}return!0},ye=function(Y){return Y.indexOf("-")>0},ve=function(Y){var fe=void 0,Te=void 0,it=void 0,mt=void 0;K("beforeSanitizeAttributes",Y,null);var gt=Y.attributes;if(!!gt){var vt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ti};for(mt=gt.length;mt--;){fe=gt[mt];var $t=fe,Ht=$t.name,Pi=$t.namespaceURI;if(Te=qP(fe.value),it=Ni(Ht),vt.attrName=it,vt.attrValue=Te,vt.keepAttr=!0,vt.forceKeepAttr=void 0,K("uponSanitizeAttribute",Y,vt),Te=vt.attrValue,!vt.forceKeepAttr&&(so(Ht,Y),!!vt.keepAttr)){if(wr(/\/>/i,Te)){so(Ht,Y);continue}Le&&(Te=Ys(Te,Ai," "),Te=Ys(Te,Zi," "));var Mi=Ni(Y.nodeName);if(!!he(Mi,it,Te))try{Pi?Y.setAttributeNS(Pi,Ht,Te):Y.setAttribute(Ht,Te),Lx(o.removed)}catch{}}}K("afterSanitizeAttributes",Y,null)}},pe=function ue(Y){var fe=void 0,Te=J(Y);for(K("beforeSanitizeShadowDOM",Y,null);fe=Te.nextNode();)K("uponSanitizeShadowNode",fe,null),!ee(fe)&&(fe.content instanceof g&&ue(fe.content),ve(fe));K("afterSanitizeShadowDOM",Y,null)};return o.sanitize=function(ue,Y){var fe=void 0,Te=void 0,it=void 0,mt=void 0,gt=void 0;if(Cn=!ue,Cn&&(ue="<!-->"),typeof ue!="string"&&!V(ue)){if(typeof ue.toString!="function")throw tg("toString is not a function");if(ue=ue.toString(),typeof ue!="string")throw tg("dirty is not a string, aborting")}if(!o.isSupported){if(Yu(r.toStaticHTML)==="object"||typeof r.toStaticHTML=="function"){if(typeof ue=="string")return r.toStaticHTML(ue);if(V(ue))return r.toStaticHTML(ue.outerHTML)}return ue}if(te||Xn(Y),o.removed=[],typeof ue=="string"&&(Ne=!1),Ne){if(ue.nodeName){var vt=Ni(ue.nodeName);if(!Et[vt]||yt[vt])throw tg("root node is forbidden and cannot be sanitized in-place")}}else if(ue instanceof E)fe=Ln("<!---->"),Te=fe.ownerDocument.importNode(ue,!0),Te.nodeType===1&&Te.nodeName==="BODY"||Te.nodeName==="HTML"?fe=Te:fe.appendChild(Te);else{if(!Ce&&!Le&&!We&&ue.indexOf("<")===-1)return Ue&&Ve?Ue.createHTML(ue):ue;if(fe=Ln(ue),!fe)return Ce?null:Ve?st:""}fe&&ae&&un(fe.firstChild);for(var $t=J(Ne?ue:fe);it=$t.nextNode();)it.nodeType===3&&it===mt||ee(it)||(it.content instanceof g&&pe(it.content),ve(it),mt=it);if(mt=null,Ne)return ue;if(Ce){if(Ie)for(gt=Ft.call(fe.ownerDocument);fe.firstChild;)gt.appendChild(fe.firstChild);else gt=fe;return ti.shadowroot&&(gt=Tt.call(l,gt,!0)),gt}var Ht=We?fe.outerHTML:fe.innerHTML;return We&&Et["!doctype"]&&fe.ownerDocument&&fe.ownerDocument.doctype&&fe.ownerDocument.doctype.name&&wr(iD,fe.ownerDocument.doctype.name)&&(Ht="<!DOCTYPE "+fe.ownerDocument.doctype.name+`>
`+Ht),Le&&(Ht=Ys(Ht,Ai," "),Ht=Ys(Ht,Zi," ")),Ue&&Ve?Ue.createHTML(Ht):Ht},o.setConfig=function(ue){Xn(ue),te=!0},o.clearConfig=function(){Yt=null,te=!1},o.isValidAttribute=function(ue,Y,fe){Yt||Xn({});var Te=Ni(ue),it=Ni(Y);return he(Te,it,fe)},o.addHook=function(ue,Y){typeof Y=="function"&&(Nt[ue]=Nt[ue]||[],qu(Nt[ue],Y))},o.removeHook=function(ue){Nt[ue]&&Lx(Nt[ue])},o.removeHooks=function(ue){Nt[ue]&&(Nt[ue]=[])},o.removeAllHooks=function(){Nt={}},o}var y5=Aw(),vs=function(r){try{return!!r()}catch{return!0}},ll=!vs(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Ux=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Mw(r){var o={exports:{}};return r(o,o.exports),o.exports}var cp=function(r){return r&&r.Math==Math&&r},Tn=cp(typeof globalThis=="object"&&globalThis)||cp(typeof window=="object"&&window)||cp(typeof self=="object"&&self)||cp(typeof Ux=="object"&&Ux)||function(){return this}()||Function("return this")(),Fr=function(r){return typeof r=="object"?r!==null:typeof r=="function"},$g=Tn.document,oD=Fr($g)&&Fr($g.createElement),Iw=function(r){return oD?$g.createElement(r):{}},kw=!ll&&!vs(function(){return Object.defineProperty(Iw("div"),"a",{get:function(){return 7}}).a!=7}),zc=function(r){if(!Fr(r))throw TypeError(String(r)+" is not an object");return r},nf=function(r,o){if(!Fr(r))return r;var l,h;if(o&&typeof(l=r.toString)=="function"&&!Fr(h=l.call(r))||typeof(l=r.valueOf)=="function"&&!Fr(h=l.call(r))||!o&&typeof(l=r.toString)=="function"&&!Fr(h=l.call(r)))return h;throw TypeError("Can't convert object to primitive value")},jx=Object.defineProperty,Uc={f:ll?jx:function(r,o,l){if(zc(r),o=nf(o,!0),zc(l),kw)try{return jx(r,o,l)}catch{}if("get"in l||"set"in l)throw TypeError("Accessors not supported");return"value"in l&&(r[o]=l.value),r}},sD=Uc.f,Gg=Function.prototype,aD=Gg.toString,lD=/^\s*function ([^ (]*)/;function jc(r,o){o===void 0&&(o={});var l=o.insertAt;if(r&&typeof document!="undefined"){var h=document.head||document.getElementsByTagName("head")[0],g=document.createElement("style");g.type="text/css",l==="top"&&h.firstChild?h.insertBefore(g,h.firstChild):h.appendChild(g),g.styleSheet?g.styleSheet.cssText=r:g.appendChild(document.createTextNode(r))}}ll&&!("name"in Gg)&&sD(Gg,"name",{configurable:!0,get:function(){try{return aD.call(this).match(lD)[1]}catch{return""}}});jc(".vel-fade-enter-active,.vel-fade-leave-active{-webkit-transition:all .3s ease;transition:all .3s ease}.vel-fade-enter-from,.vel-fade-leave-to{opacity:0}.vel-img-swiper{position:relative;display:block}.vel-modal{z-index:9998;position:fixed;top:0;left:0;right:0;bottom:0;margin:0;background:rgba(0,0,0,.5)}.vel-img-wrapper{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:0;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50% -50%);transform:translate(-50% -50%);-webkit-transition:.3s ease-in-out;transition:.3s ease-in-out;will-change:transform opacity}.vel-img{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;max-width:80vw;max-height:80vh;display:block;position:relative;-webkit-transition:-webkit-transform .3s ease-in-out;transition:-webkit-transform .3s ease-in-out;transition:transform .3s ease-in-out;transition:transform .3s ease-in-out, -webkit-transform .3s ease-in-out;-webkit-box-shadow:0 5px 20px 2px rgba(0,0,0,.7);box-shadow:0 5px 20px 2px rgba(0,0,0,.7);background-color:rgba(0,0,0,.7)}@media (max-width:750px){.vel-img{max-width:85vw;max-height:95vh}}.vel-btns-wrapper .btn__close,.vel-btns-wrapper .btn__next,.vel-btns-wrapper .btn__prev{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);cursor:pointer;opacity:.6;font-size:32px;color:#fff;-webkit-transition:.15s linear;transition:.15s linear;-webkit-tap-highlight-color:transparent;outline:none}.vel-btns-wrapper .btn__close:hover,.vel-btns-wrapper .btn__next:hover,.vel-btns-wrapper .btn__prev:hover{opacity:1}.vel-btns-wrapper .btn__close.disable,.vel-btns-wrapper .btn__close.disable:hover,.vel-btns-wrapper .btn__next.disable,.vel-btns-wrapper .btn__next.disable:hover,.vel-btns-wrapper .btn__prev.disable,.vel-btns-wrapper .btn__prev.disable:hover{cursor:default;opacity:.2}.vel-btns-wrapper .btn__next{right:12px}.vel-btns-wrapper .btn__prev{left:12px}.vel-btns-wrapper .btn__close{top:24px;right:10px}@media (max-width:750px){.vel-btns-wrapper .btn__next,.vel-btns-wrapper .btn__prev{font-size:20px}.vel-btns-wrapper .btn__close{font-size:24px}.vel-btns-wrapper .btn__next{right:4px}.vel-btns-wrapper .btn__prev{left:4px}}.vel-modal.is-rtl .vel-btns-wrapper .btn__next{left:12px;right:auto}.vel-modal.is-rtl .vel-btns-wrapper .btn__prev{right:12px;left:auto}@media (max-width:750px){.vel-modal.is-rtl .vel-btns-wrapper .btn__next{left:4px;right:auto}.vel-modal.is-rtl .vel-btns-wrapper .btn__prev{right:4px;left:auto}}.vel-modal.is-rtl .vel-img-title{direction:rtl}");jc('.vel-loading{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.vel-loading .ring{display:inline-block;width:64px;height:64px}.vel-loading .ring:after{content:" ";display:block;width:46px;height:46px;margin:1px;border-radius:50%;border-color:hsla(0,0%,100%,.7) transparent;border-style:solid;border-width:5px;-webkit-animation:ring 1.2s linear infinite;animation:ring 1.2s linear infinite}@-webkit-keyframes ring{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes ring{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}');jc(".vel-on-error{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.vel-on-error .icon{font-size:80px;color:#aaa}");jc(".vel-img-title{overflow:hidden;position:absolute;left:50%;bottom:60px;-webkit-transform:translate(-50%);transform:translate(-50%);max-width:80%;font-size:12px;line-height:1;text-align:center;text-overflow:ellipsis;color:#ccc;opacity:.8;white-space:nowrap;cursor:default;-webkit-transition:opacity .15s;transition:opacity .15s}.vel-img-title:hover{opacity:1}");jc(".vel-icon{width:1em;height:1em;vertical-align:-.15em;fill:currentColor;overflow:hidden}");jc(".vel-toolbar{position:absolute;overflow:hidden;bottom:8px;left:50%;-webkit-transform:translate(-50%);transform:translate(-50%);opacity:.9;display:-webkit-box;display:-ms-flexbox;display:flex;border-radius:4px;padding:0}.vel-toolbar,.vel-toolbar .toolbar-btn{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:#2d2d2d}.vel-toolbar .toolbar-btn{-ms-flex-negative:0;flex-shrink:0;cursor:pointer;padding:6px 10px;font-size:20px;color:#fff;-webkit-tap-highlight-color:transparent;outline:none}.vel-toolbar .toolbar-btn:active,.vel-toolbar .toolbar-btn:hover{background-color:#3d3d3d}");var cD=/#|\.prototype\./,Eh=function(r,o){var l=hD[uD(r)];return l==pD||l!=dD&&(typeof o=="function"?vs(o):!!o)},uD=Eh.normalize=function(r){return String(r).replace(cD,".").toLowerCase()},hD=Eh.data={},dD=Eh.NATIVE="N",pD=Eh.POLYFILL="P",zw=Eh,B_=function(r,o){return{enumerable:!(1&r),configurable:!(2&r),writable:!(4&r),value:o}},Pc=ll?function(r,o,l){return Uc.f(r,o,B_(1,l))}:function(r,o,l){return r[o]=l,r},fD={}.hasOwnProperty,no=function(r,o){return fD.call(r,o)},F_=function(r,o){try{Pc(Tn,r,o)}catch{Tn[r]=o}return o},rl=Tn["__core-js_shared__"]||F_("__core-js_shared__",{}),mD=Function.toString;typeof rl.inspectSource!="function"&&(rl.inspectSource=function(r){return mD.call(r)});var Dp,oh,Lp,Pw=rl.inspectSource,Vx=Tn.WeakMap,gD=typeof Vx=="function"&&/native code/.test(Pw(Vx)),Dw=Mw(function(r){(r.exports=function(o,l){return rl[o]||(rl[o]=l!==void 0?l:{})})("versions",[]).push({version:"3.9.1",mode:"global",copyright:"\xA9 2021 Denis Pushkarev (zloirock.ru)"})}),_D=0,yD=Math.random(),Lw=function(r){return"Symbol("+String(r===void 0?"":r)+")_"+(++_D+yD).toString(36)},$x=Dw("keys"),Rw=function(r){return $x[r]||($x[r]=Lw(r))},N_={},vD=Tn.WeakMap;if(gD){var gc=rl.state||(rl.state=new vD),xD=gc.get,bD=gc.has,wD=gc.set;Dp=function(r,o){return o.facade=r,wD.call(gc,r,o),o},oh=function(r){return xD.call(gc,r)||{}},Lp=function(r){return bD.call(gc,r)}}else{var Zu=Rw("state");N_[Zu]=!0,Dp=function(r,o){return o.facade=r,Pc(r,Zu,o),o},oh=function(r){return no(r,Zu)?r[Zu]:{}},Lp=function(r){return no(r,Zu)}}var sg,Gx={set:Dp,get:oh,has:Lp,enforce:function(r){return Lp(r)?oh(r):Dp(r,{})},getterFor:function(r){return function(o){var l;if(!Fr(o)||(l=oh(o)).type!==r)throw TypeError("Incompatible receiver, "+r+" required");return l}}},U_=Mw(function(r){var o=Gx.get,l=Gx.enforce,h=String(String).split("String");(r.exports=function(g,y,E,s){var C,k=!!s&&!!s.unsafe,M=!!s&&!!s.enumerable,D=!!s&&!!s.noTargetGet;typeof E=="function"&&(typeof y!="string"||no(E,"name")||Pc(E,"name",y),(C=l(E)).source||(C.source=h.join(typeof y=="string"?y:""))),g!==Tn?(k?!D&&g[y]&&(M=!0):delete g[y],M?g[y]=E:Pc(g,y,E)):M?g[y]=E:F_(y,E)})(Function.prototype,"toString",function(){return typeof this=="function"&&o(this).source||Pw(this)})}),TD={}.toString,fs=function(r){return TD.call(r).slice(8,-1)},qx=Object.setPrototypeOf||("__proto__"in{}?function(){var r,o=!1,l={};try{(r=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(l,[]),o=l instanceof Array}catch{}return function(h,g){return zc(h),function(y){if(!Fr(y)&&y!==null)throw TypeError("Can't set "+String(y)+" as a prototype")}(g),o?r.call(h,g):h.__proto__=g,h}}():void 0),ED=function(r,o,l){var h,g;return qx&&typeof(h=o.constructor)=="function"&&h!==l&&Fr(g=h.prototype)&&g!==l.prototype&&qx(r,g),r},SD="".split,Ow=vs(function(){return!Object("z").propertyIsEnumerable(0)})?function(r){return fs(r)=="String"?SD.call(r,""):Object(r)}:Object,j_=function(r){if(r==null)throw TypeError("Can't call method on "+r);return r},rf=function(r){return Ow(j_(r))},CD=Math.ceil,AD=Math.floor,Bw=function(r){return isNaN(r=+r)?0:(r>0?AD:CD)(r)},MD=Math.min,of=function(r){return r>0?MD(Bw(r),9007199254740991):0},ID=Math.max,kD=Math.min,qg=function(r,o){var l=Bw(r);return l<0?ID(l+o,0):kD(l,o)},Zx=function(r){return function(o,l,h){var g,y=rf(o),E=of(y.length),s=qg(h,E);if(r&&l!=l){for(;E>s;)if((g=y[s++])!=g)return!0}else for(;E>s;s++)if((r||s in y)&&y[s]===l)return r||s||0;return!r&&-1}},zD={includes:Zx(!0),indexOf:Zx(!1)}.indexOf,Fw=function(r,o){var l,h=rf(r),g=0,y=[];for(l in h)!no(N_,l)&&no(h,l)&&y.push(l);for(;o.length>g;)no(h,l=o[g++])&&(~zD(y,l)||y.push(l));return y},Rp=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],PD=Object.keys||function(r){return Fw(r,Rp)},DD=ll?Object.defineProperties:function(r,o){zc(r);for(var l,h=PD(o),g=h.length,y=0;g>y;)Uc.f(r,l=h[y++],o[l]);return r},ag=Tn,Wx=function(r){return typeof r=="function"?r:void 0},V_=function(r,o){return arguments.length<2?Wx(ag[r])||Wx(Tn[r]):ag[r]&&ag[r][o]||Tn[r]&&Tn[r][o]},LD=V_("document","documentElement"),Nw=Rw("IE_PROTO"),lg=function(){},Hx=function(r){return"<script>"+r+"<\/script>"},xp=function(){try{sg=document.domain&&new ActiveXObject("htmlfile")}catch{}var r,o;xp=sg?function(h){h.write(Hx("")),h.close();var g=h.parentWindow.Object;return h=null,g}(sg):((o=Iw("iframe")).style.display="none",LD.appendChild(o),o.src=String("javascript:"),(r=o.contentWindow.document).open(),r.write(Hx("document.F=Object")),r.close(),r.F);for(var l=Rp.length;l--;)delete xp.prototype[Rp[l]];return xp()};N_[Nw]=!0;var RD=Object.create||function(r,o){var l;return r!==null?(lg.prototype=zc(r),l=new lg,lg.prototype=null,l[Nw]=r):l=xp(),o===void 0?l:DD(l,o)},OD=Rp.concat("length","prototype"),Uw={f:Object.getOwnPropertyNames||function(r){return Fw(r,OD)}},Xx={}.propertyIsEnumerable,Kx=Object.getOwnPropertyDescriptor,BD={f:Kx&&!Xx.call({1:2},1)?function(r){var o=Kx(this,r);return!!o&&o.enumerable}:Xx},Yx=Object.getOwnPropertyDescriptor,$_={f:ll?Yx:function(r,o){if(r=rf(r),o=nf(o,!0),kw)try{return Yx(r,o)}catch{}if(no(r,o))return B_(!BD.f.call(r,o),r[o])}},Op=`[	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]`,FD=RegExp("^"+Op+Op+"*"),ND=RegExp(Op+Op+"*$"),cg=function(r){return function(o){var l=String(j_(o));return 1&r&&(l=l.replace(FD,"")),2&r&&(l=l.replace(ND,"")),l}},UD={start:cg(1),end:cg(2),trim:cg(3)},jD=Uw.f,VD=$_.f,$D=Uc.f,GD=UD.trim,ea=Tn.Number,bp=ea.prototype,qD=fs(RD(bp))=="Number",Jx=function(r){var o,l,h,g,y,E,s,C,k=nf(r,!1);if(typeof k=="string"&&k.length>2){if((o=(k=GD(k)).charCodeAt(0))===43||o===45){if((l=k.charCodeAt(2))===88||l===120)return NaN}else if(o===48){switch(k.charCodeAt(1)){case 66:case 98:h=2,g=49;break;case 79:case 111:h=8,g=55;break;default:return+k}for(E=(y=k.slice(2)).length,s=0;s<E;s++)if((C=y.charCodeAt(s))<48||C>g)return NaN;return parseInt(y,h)}}return+k};if(zw("Number",!ea(" 0o1")||!ea("0b1")||ea("+0x1"))){for(var up,Ka=function(r){var o=arguments.length<1?0:r,l=this;return l instanceof Ka&&(qD?vs(function(){bp.valueOf.call(l)}):fs(l)!="Number")?ED(new ea(Jx(o)),l,Ka):Jx(o)},Qx=ll?jD(ea):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),ug=0;Qx.length>ug;ug++)no(ea,up=Qx[ug])&&!no(Ka,up)&&$D(Ka,up,VD(ea,up));Ka.prototype=bp,bp.constructor=Ka,U_(Tn,"Number",Ka)}var _c,Bp,ZD={f:Object.getOwnPropertySymbols},WD=V_("Reflect","ownKeys")||function(r){var o=Uw.f(zc(r)),l=ZD.f;return l?o.concat(l(r)):o},HD=function(r,o){for(var l=WD(o),h=Uc.f,g=$_.f,y=0;y<l.length;y++){var E=l[y];no(r,E)||h(r,E,g(o,E))}},XD=$_.f,sf=function(r,o){var l,h,g,y,E,s=r.target,C=r.global,k=r.stat;if(l=C?Tn:k?Tn[s]||F_(s,{}):(Tn[s]||{}).prototype)for(h in o){if(y=o[h],g=r.noTargetGet?(E=XD(l,h))&&E.value:l[h],!zw(C?h:s+(k?".":"#")+h,r.forced)&&g!==void 0){if(typeof y==typeof g)continue;HD(y,g)}(r.sham||g&&g.sham)&&Pc(y,"sham",!0),U_(l,h,y,r)}},KD=function(r,o,l){if(function(h){if(typeof h!="function")throw TypeError(String(h)+" is not a function")}(r),o===void 0)return r;switch(l){case 0:return function(){return r.call(o)};case 1:return function(h){return r.call(o,h)};case 2:return function(h,g){return r.call(o,h,g)};case 3:return function(h,g,y){return r.call(o,h,g,y)}}return function(){return r.apply(o,arguments)}},jw=function(r){return Object(j_(r))},vh=Array.isArray||function(r){return fs(r)=="Array"},YD=fs(Tn.process)=="process",hg=V_("navigator","userAgent")||"",e1=Tn.process,t1=e1&&e1.versions,i1=t1&&t1.v8;i1?Bp=(_c=i1.split("."))[0]+_c[1]:hg&&(!(_c=hg.match(/Edge\/(\d+)/))||_c[1]>=74)&&(_c=hg.match(/Chrome\/(\d+)/))&&(Bp=_c[1]);var sh=Bp&&+Bp,Zg=!!Object.getOwnPropertySymbols&&!vs(function(){return!Symbol.sham&&(YD?sh===38:sh>37&&sh<41)}),JD=Zg&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Wu=Dw("wks"),ah=Tn.Symbol,QD=JD?ah:ah&&ah.withoutSetter||Lw,Vc=function(r){return no(Wu,r)&&(Zg||typeof Wu[r]=="string")||(Zg&&no(ah,r)?Wu[r]=ah[r]:Wu[r]=QD("Symbol."+r)),Wu[r]},eL=Vc("species"),Vw=function(r,o){var l;return vh(r)&&(typeof(l=r.constructor)!="function"||l!==Array&&!vh(l.prototype)?Fr(l)&&(l=l[eL])===null&&(l=void 0):l=void 0),new(l===void 0?Array:l)(o===0?0:o)},n1=[].push,Js=function(r){var o=r==1,l=r==2,h=r==3,g=r==4,y=r==6,E=r==7,s=r==5||y;return function(C,k,M,D){for(var R,U,ge=jw(C),Ee=Ow(ge),be=KD(k,M,3),we=of(Ee.length),De=0,Xe=D||Vw,Ue=o?Xe(C,we):l||E?Xe(C,0):void 0;we>De;De++)if((s||De in Ee)&&(U=be(R=Ee[De],De,ge),r))if(o)Ue[De]=U;else if(U)switch(r){case 3:return!0;case 5:return R;case 6:return De;case 2:n1.call(Ue,R)}else switch(r){case 4:return!1;case 7:n1.call(Ue,R)}return y?-1:h||g?g:Ue}},G_={forEach:Js(0),map:Js(1),filter:Js(2),some:Js(3),every:Js(4),find:Js(5),findIndex:Js(6),filterOut:Js(7)},tL=Vc("species"),af=function(r){return sh>=51||!vs(function(){var o=[];return(o.constructor={})[tL]=function(){return{foo:1}},o[r](Boolean).foo!==1})},iL=G_.filter;sf({target:"Array",proto:!0,forced:!af("filter")},{filter:function(r){return iL(this,r,arguments.length>1?arguments[1]:void 0)}});var nL=G_.map;sf({target:"Array",proto:!0,forced:!af("map")},{map:function(r){return nL(this,r,arguments.length>1?arguments[1]:void 0)}});var Wg=function(r,o,l){var h=nf(o);h in r?Uc.f(r,h,B_(0,l)):r[h]=l},$w=Vc("isConcatSpreadable"),rL=sh>=51||!vs(function(){var r=[];return r[$w]=!1,r.concat()[0]!==r}),oL=af("concat"),sL=function(r){if(!Fr(r))return!1;var o=r[$w];return o!==void 0?!!o:vh(r)};sf({target:"Array",proto:!0,forced:!rL||!oL},{concat:function(r){var o,l,h,g,y,E=jw(this),s=Vw(E,0),C=0;for(o=-1,h=arguments.length;o<h;o++)if(sL(y=o===-1?E:arguments[o])){if(C+(g=of(y.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(l=0;l<g;l++,C++)l in y&&Wg(s,C,y[l])}else{if(C>=9007199254740991)throw TypeError("Maximum allowed index exceeded");Wg(s,C++,y)}return s.length=C,s}});var aL,r1,lL=G_.forEach,dg=!!(r1=[].forEach)&&vs(function(){r1.call(null,aL||function(){throw 1},1)})?[].forEach:function(r){return lL(this,r,arguments.length>1?arguments[1]:void 0)};for(var cL in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var o1=Tn[cL],hp=o1&&o1.prototype;if(hp&&hp.forEach!==dg)try{Pc(hp,"forEach",dg)}catch{hp.forEach=dg}}var Gw={};Gw[Vc("toStringTag")]="z";var q_=String(Gw)==="[object z]",uL=Vc("toStringTag"),hL=fs(function(){return arguments}())=="Arguments",dL=q_?fs:function(r){var o,l,h;return r===void 0?"Undefined":r===null?"Null":typeof(l=function(g,y){try{return g[y]}catch{}}(o=Object(r),uL))=="string"?l:hL?fs(o):(h=fs(o))=="Object"&&typeof o.callee=="function"?"Arguments":h},pL=q_?{}.toString:function(){return"[object "+dL(this)+"]"};q_||U_(Object.prototype,"toString",pL,{unsafe:!0}),function(){if(typeof window!="undefined"){var r=window,o='<svg><symbol id="icon-rotate-right" viewBox="0 0 1024 1024"><path d="M275.199914 450.496179v20.031994c0.384-38.079988 12.543996-67.423979 36.479989-87.967973 22.431993-20.351994 49.215985-30.55999 80.319975-30.55999 32.06399 0 59.295981 10.175997 81.759974 30.55999 22.815993 20.543994 34.591989 49.887984 35.359989 87.967973v123.935961c-0.768 37.887988-12.543996 67.135979-35.359989 87.679973-22.431993 20.351994-49.695984 30.75199-81.759974 31.10399a120.255962 120.255962 0 0 1-72.991978-24.895992c-21.503993-15.839995-35.359989-38.751988-41.567987-68.735979h60.831981c9.247997 23.007993 27.167992 34.495989 53.759983 34.49599 37.535988-0.384 56.863982-21.407993 57.983982-63.071981v-38.751988c-28.095991 8.863997-54.303983 13.119996-78.623975 12.735996a91.263971 91.263971 0 0 1-68.447979-27.711991c-18.847994-18.303994-28.095991-47.231985-27.711991-86.847973z m62.55998 24.863992c7.103998 24.799992 25.215992 37.343988 54.271983 37.663989 27.103992-0.288 44.703986-11.327996 52.831984-33.11999 3.135999-8.383997 2.655999-29.599991-1.28-38.559988-8.607997-19.615994-25.791992-29.695991-51.551984-30.20799-28.383991 0.576-46.303986 12.639996-53.759983 36.159988a58.719982 58.719982 0 0 0-0.512 28.063991z m390.335878 115.711964v-116.895963c-1.12-41.311987-20.447994-62.335981-57.983981-63.07198-37.727988 0.768-56.959982 21.791993-57.695982 63.07198v116.895963c0.768 41.663987 19.999994 62.68798 57.695982 63.071981 37.535988-0.384 56.863982-21.407993 57.983981-63.071981z m-174.815945 3.391999v-123.935961c0.384-38.079988 12.543996-67.423979 36.479989-87.967973 22.431993-20.351994 49.215985-30.55999 80.319975-30.55999 32.06399 0 59.295981 10.175997 81.759974 30.55999 22.815993 20.543994 34.591989 49.887984 35.359989 87.967973v123.935961c-0.768 37.887988-12.543996 67.135979-35.359989 87.679973-22.431993 20.351994-49.695984 30.75199-81.759974 31.10399-31.10399-0.384-57.887982-10.751997-80.319975-31.10399-23.935993-20.543994-36.127989-49.791984-36.479989-87.679973z m282.559912-479.07185A509.887841 509.887841 0 0 0 511.99984 0.00032C229.215928 0.00032 0 229.216248 0 512.00016s229.215928 511.99984 511.99984 511.99984 511.99984-229.215928 511.99984-511.99984c0-3.743999-0.032-7.455998-0.128-11.167997-1.631999-11.295996-8.159997-27.103992-31.87199-27.103991-27.487991 0-31.67999 21.247993-32.03199 32.06399l0.032 4.127999a30.62399 30.62399 0 0 0 0.16 2.079999H959.9997c0 247.423923-200.575937 447.99986-447.99986 447.99986S63.99998 759.424083 63.99998 512.00016 264.575917 64.0003 511.99984 64.0003a446.079861 446.079861 0 0 1 277.439913 96.22397l-94.91197 91.679971c-25.439992 24.607992-17.439995 44.991986 17.887994 45.599986l188.031942 3.295999a64.31998 64.31998 0 0 0 65.055979-62.84798l3.295999-188.127942C969.407697 15.040315 949.311703 5.792318 923.871711 30.368311l-87.999972 85.023973z" fill="" ></path></symbol><symbol id="icon-rotate-left" viewBox="0 0 1024 1024"><path d="M275.199914 450.496179v20.031994c0.384-38.079988 12.543996-67.423979 36.479989-87.967973 22.431993-20.351994 49.215985-30.55999 80.319975-30.55999 32.06399 0 59.295981 10.175997 81.759974 30.55999 22.815993 20.543994 34.591989 49.887984 35.359989 87.967973v123.935961c-0.768 37.887988-12.543996 67.135979-35.359989 87.679973-22.431993 20.351994-49.695984 30.75199-81.759974 31.10399a120.255962 120.255962 0 0 1-72.991978-24.895992c-21.503993-15.839995-35.359989-38.751988-41.567987-68.735979h60.831981c9.247997 23.007993 27.167992 34.495989 53.759983 34.49599 37.535988-0.384 56.863982-21.407993 57.983982-63.071981v-38.751988c-28.095991 8.863997-54.303983 13.119996-78.623975 12.735996a91.263971 91.263971 0 0 1-68.447979-27.711991c-18.847994-18.303994-28.095991-47.231985-27.711991-86.847973z m62.55998 24.863992c7.103998 24.799992 25.215992 37.343988 54.271983 37.663989 27.103992-0.288 44.703986-11.327996 52.831984-33.11999 3.135999-8.383997 2.655999-29.599991-1.28-38.559988-8.607997-19.615994-25.791992-29.695991-51.551984-30.20799-28.383991 0.576-46.303986 12.639996-53.759983 36.159988a58.719982 58.719982 0 0 0-0.512 28.063991z m390.335878 115.711964v-116.895963c-1.12-41.311987-20.447994-62.335981-57.983981-63.07198-37.727988 0.768-56.959982 21.791993-57.695982 63.07198v116.895963c0.768 41.663987 19.999994 62.68798 57.695982 63.071981 37.535988-0.384 56.863982-21.407993 57.983981-63.071981z m-174.815945 3.391999v-123.935961c0.384-38.079988 12.543996-67.423979 36.479989-87.967973 22.431993-20.351994 49.215985-30.55999 80.319975-30.55999 32.06399 0 59.295981 10.175997 81.759974 30.55999 22.815993 20.543994 34.591989 49.887984 35.359989 87.967973v123.935961c-0.768 37.887988-12.543996 67.135979-35.359989 87.679973-22.431993 20.351994-49.695984 30.75199-81.759974 31.10399-31.10399-0.384-57.887982-10.751997-80.319975-31.10399-23.935993-20.543994-36.127989-49.791984-36.479989-87.679973zM188.159941 115.392284A509.887841 509.887841 0 0 1 511.99984 0.00032c282.783912 0 511.99984 229.215928 511.99984 511.99984s-229.215928 511.99984-511.99984 511.99984S0 794.784072 0 512.00016c0-3.743999 0.032-7.455998 0.128-11.167997 1.631999-11.295996 8.159997-27.103992 31.87199-27.103991 27.487991 0 31.67999 21.247993 32.03199 32.06399L63.99998 509.920161a30.62399 30.62399 0 0 1-0.16 2.079999H63.99998c0 247.423923 200.575937 447.99986 447.99986 447.99986s447.99986-200.575937 447.99986-447.99986S759.423763 64.0003 511.99984 64.0003a446.079861 446.079861 0 0 0-277.439913 96.22397l94.91197 91.679971c25.439992 24.607992 17.439995 44.991986-17.887994 45.599986L123.551961 300.800226a64.31998 64.31998 0 0 1-65.055979-62.84798l-3.295999-188.127942C54.591983 15.040315 74.687977 5.792318 100.127969 30.368311l87.999972 85.023973z" fill="" ></path></symbol><symbol id="icon-resize" viewBox="0 0 1024 1024"><path d="M456.036919 791.8108 270.553461 791.8108 460.818829 601.572038l-39.593763-39.567157L231.314785 751.915162l0.873903-183.953615c0-15.465227-12.515035-27.981285-27.981285-27.981285s-27.981285 12.515035-27.981285 27.981285l0 251.829516c0 8.3072 3.415796 14.975063 8.826016 19.564591 5.082762 5.192256 12.132318 8.416693 19.947308 8.416693l251.036453 0c15.46625 0 27.981285-12.514012 27.981285-27.981285C484.018204 804.325835 471.504192 791.8108 456.036919 791.8108zM838.945819 184.644347c-5.082762-5.191232-12.132318-8.416693-19.947308-8.416693L567.961034 176.227654c-15.46625 0-27.981285 12.515035-27.981285 27.981285 0 15.46625 12.514012 27.981285 27.981285 27.981285l185.483458 0L563.206754 422.427962l39.567157 39.567157 189.910281-189.910281-0.873903 183.953615c0 15.46625 12.514012 27.981285 27.981285 27.981285s27.981285-12.514012 27.981285-27.981285L847.772858 204.208938C847.771835 195.902762 844.356039 189.234899 838.945819 184.644347zM847.771835 64.303538 176.227142 64.303538c-61.809741 0-111.924115 50.115398-111.924115 111.924115l0 671.544693c0 61.809741 50.114374 111.924115 111.924115 111.924115l671.544693 0c61.809741 0 111.924115-50.114374 111.924115-111.924115l0-671.544693C959.69595 114.418936 909.581576 64.303538 847.771835 64.303538zM903.733381 847.772346c0 30.878265-25.056676 55.962569-55.962569 55.962569L176.227142 903.734916c-30.90487 0-55.962569-25.084305-55.962569-55.962569l0-671.544693c0-30.9325 25.056676-55.962569 55.962569-55.962569l671.544693 0c30.90487 0 55.962569 25.03007 55.962569 55.962569L903.734404 847.772346z"  ></path></symbol><symbol id="icon-img-broken" viewBox="0 0 1024 1024"><path d="M810.666667 128H213.333333c-46.933333 0-85.333333 38.4-85.333333 85.333333v597.333334c0 46.933333 38.4 85.333333 85.333333 85.333333h597.333334c46.933333 0 85.333333-38.4 85.333333-85.333333V213.333333c0-46.933333-38.4-85.333333-85.333333-85.333333z m0 682.666667H213.333333v-195.413334l42.24 42.24 170.666667-170.666666 170.666667 170.666666 170.666666-170.24L810.666667 530.346667V810.666667z m0-401.493334l-43.093334-43.093333-170.666666 171.093333-170.666667-170.666666-170.666667 170.666666-42.24-42.666666V213.333333h597.333334v195.84z"  ></path></symbol><symbol id="icon-prev" viewBox="0 0 1024 1024"><path d="M784.652701 955.6957 346.601985 517.644983c-2.822492-2.822492-2.822492-7.902977 0-11.289967l439.179713-439.179713c6.77398-6.77398 10.725469-16.370452 10.725469-25.966924L796.507166 36.692393c0-20.32194-16.370452-36.692393-36.692393-36.692393l-4.515987 0c-9.596472 0-19.192944 3.951488-25.966924 10.725469L250.072767 489.420066c-12.418964 12.418964-12.418964 32.740904 0 45.159868l477.565601 477.565601c7.338479 7.338479 17.499449 11.854465 28.224917 11.854465l0 0c22.015436 0 40.079383-18.063947 40.079383-40.079383l0 0C796.507166 973.759647 791.99118 963.598677 784.652701 955.6957z"  ></path></symbol><symbol id="icon-next" viewBox="0 0 1024 1024"><path d="M246.121279 955.6957l438.050717-438.050717c2.822492-2.822492 2.822492-7.902977 0-11.289967L244.992282 67.175303c-6.77398-6.77398-10.725469-16.370452-10.725469-25.966924L234.266814 36.692393C234.266814 16.370452 250.637266 0 270.959206 0l4.515987 0c9.596472 0 19.192944 3.951488 25.966924 10.725469l478.694598 478.694598c12.418964 12.418964 12.418964 32.740904 0 45.159868l-477.565601 477.565601c-7.338479 7.338479-17.499449 11.854465-28.224917 11.854465l0 0c-22.015436 0-40.079383-18.063947-40.079383-40.079383l0 0C234.266814 973.759647 238.7828 963.598677 246.121279 955.6957z"  ></path></symbol><symbol id="icon-zoomin" viewBox="0 0 1024 1024"><path d="M725.504 652.864c46.4-61.44 71.744-136.448 71.744-218.752C797.248 230.464 632.768 64 430.656 64S64 230.464 64 434.112C64 639.36 228.48 805.76 430.656 805.76c86.656 0 164.48-30.144 227.52-81.088L889.984 960 960 891.264l-234.496-238.4z m-294.848 67.456c-155.776 0-282.624-128.896-282.624-286.208s126.848-286.208 282.624-286.208 282.624 128.896 282.624 286.208-126.912 286.208-282.624 286.208z"  ></path><path d="M235.712 369.92h390.72v127.104H235.712z"  ></path><path d="M367.488 238.144h127.104v390.72H367.488z"  ></path></symbol><symbol id="icon-close" viewBox="0 0 1024 1024"><path d="M570.24 512l259.2 259.2-58.88 58.24L512 570.24l-261.12 261.12-58.24-58.24L453.76 512 194.56 252.8l58.24-58.24L512 453.76l261.12-261.12 58.24 58.24z"  ></path></symbol><symbol id="icon-zoomout" viewBox="0 0 1024 1024"><path d="M725.504 652.864c46.4-61.44 71.744-136.448 71.744-218.752C797.248 230.464 632.768 64 430.656 64S64 230.464 64 434.112C64 639.36 228.48 805.76 430.656 805.76c86.656 0 164.48-30.144 227.52-81.088L889.984 960 960 891.264l-234.496-238.4z m-294.848 67.456c-155.776 0-282.624-128.896-282.624-286.208s126.848-286.208 282.624-286.208 282.624 128.896 282.624 286.208-126.912 286.208-282.624 286.208z"  ></path><path d="M235.712 369.92h390.72v127.104H235.712z"  ></path></symbol></svg>';(function(l){document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(l,0):document.addEventListener("DOMContentLoaded",function C(){document.removeEventListener("DOMContentLoaded",C,!1),l()},!1):document.attachEvent&&(g=l,y=r.document,E=!1,(s=function(){try{y.documentElement.doScroll("left")}catch{return void setTimeout(s,50)}h()})(),y.onreadystatechange=function(){y.readyState=="complete"&&(y.onreadystatechange=null,h())});function h(){E||(E=!0,g())}var g,y,E,s})(function(){var l,h,g,y,E,s;(l=document.createElement("div")).innerHTML=o,o=null,(h=l.getElementsByTagName("svg")[0])&&(h.setAttribute("aria-hidden","true"),h.style.position="absolute",h.style.width=0,h.style.height=0,h.style.overflow="hidden",g=h,(y=document.body).firstChild?(E=g,(s=y.firstChild).parentNode.insertBefore(E,s)):y.appendChild(g))})}}();var vo=xh({name:"SvgIcon",props:{type:{type:String,default:""}},setup:function(r){return function(){return Bt("svg",{class:"".concat("vel","-icon icon"),"aria-hidden":"true"},[Bt("use",{"xlink:href":"#icon-".concat(r.type)},null)])}}}),fL=af("slice"),mL=Vc("species"),gL=[].slice,_L=Math.max;sf({target:"Array",proto:!0,forced:!fL},{slice:function(r,o){var l,h,g,y=rf(this),E=of(y.length),s=qg(r,E),C=qg(o===void 0?E:o,E);if(vh(y)&&(typeof(l=y.constructor)!="function"||l!==Array&&!vh(l.prototype)?Fr(l)&&(l=l[mL])===null&&(l=void 0):l=void 0,l===Array||l===void 0))return gL.call(y,s,C);for(h=new(l===void 0?Array:l)(_L(C-s,0)),g=0;s<C;s++,g++)s in y&&Wg(h,g,y[s]);return h.length=g,h}});var lf=typeof window!="undefined",bc=function(){},qw=!1;if(lf)try{var s1={};Object.defineProperty(s1,"passive",{get:function(){qw=!0}}),window.addEventListener("test-passive",bc,s1)}catch{}var a1=function(r,o,l){var h=arguments.length>3&&arguments[3]!==void 0&&arguments[3];lf&&r.addEventListener(o,l,!!qw&&{capture:!1,passive:h})},l1=function(r,o,l){lf&&r.removeEventListener(o,l)},yL=function(r){r.preventDefault()},vL=Object.prototype.toString,Z_=function(r){return function(o){return vL.call(o).slice(8,-1)===r}};function c1(r){return Z_("Array")(r)}var Zw=function(r){return!!r&&Z_("String")(r)};function xL(r){return r!=null}var bL=xh({name:"Toolbar",props:{zoomIn:{type:Function,default:bc},zoomOut:{type:Function,default:bc},rotateLeft:{type:Function,default:bc},rotateRight:{type:Function,default:bc},resize:{type:Function,default:bc}},setup:function(r){return function(){return Bt("div",{class:"".concat("vel","-toolbar")},[Bt("div",{class:"toolbar-btn toolbar-btn__zoomin",onClick:r.zoomIn},[Bt(vo,{type:"zoomin"},null)]),Bt("div",{class:"toolbar-btn toolbar-btn__zoomout",onClick:r.zoomOut},[Bt(vo,{type:"zoomout"},null)]),Bt("div",{class:"toolbar-btn toolbar-btn__resize",onClick:r.resize},[Bt(vo,{type:"resize"},null)]),Bt("div",{class:"toolbar-btn toolbar-btn__rotate",onClick:r.rotateLeft},[Bt(vo,{type:"rotate-left"},null)]),Bt("div",{class:"toolbar-btn toolbar-btn__rotate",onClick:r.rotateRight},[Bt(vo,{type:"rotate-right"},null)])])}}}),wL=function(){return Bt("div",{class:"".concat("vel","-loading")},[Bt("div",{class:"ring"},null)])},TL=function(){return Bt("div",{class:"".concat("vel","-on-error")},[Bt("div",{class:"ring"},null),Bt(vo,{type:"img-broken"},null)])},EL=function(r,o){var l=o.slots;return Bt("div",{class:"".concat("vel","-img-title")},[l.default?l.default():""])},lh=lf?window:global,u1=Date.now();function SL(r){var o=Date.now(),l=Math.max(0,16-(o-u1)),h=setTimeout(r,l);return u1=o+l,h}function pg(r){return(lh.requestAnimationFrame||SL).call(lh,r)}function h1(r){(lh.cancelAnimationFrame||lh.clearTimeout).call(lh,r)}function d1(r,o){var l=r.clientX-o.clientX,h=r.clientY-o.clientY;return Math.sqrt(l*l+h*h)}function fg(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!mh(r)}function CL(r){return function(o){return!!o&&Z_("Object")(o)}(r)&&Zw(r.src)}var Hg=xh({name:"VueEasyLightbox",props:{imgs:{type:[Array,String],default:function(){return""}},visible:{type:Boolean,default:!1},index:{type:Number,default:0},scrollDisabled:{type:Boolean,default:!1},escDisabled:{type:Boolean,default:!1},moveDisabled:{type:Boolean,default:!1},titleDisabled:{type:Boolean,default:!1},teleport:{type:[String,Object],default:null},swipeTolerance:{type:Number,default:50},loop:{type:Boolean,default:!1},rtl:{type:Boolean,default:!1}},emits:["hide","on-error","on-prev","on-next","on-prev-click","on-next-click","on-index-change"],setup:function(r,o){var l=o.emit,h=o.slots,g=function(){var Le=wn(),We=bo({width:0,height:0,maxScale:1});return{imgRef:Le,imgState:We,setImgSize:function(){if(Le.value){var te=Le.value,ae=te.width,Ce=te.height,Ie=te.naturalWidth;We.maxScale=Ie/ae,We.width=ae,We.height=Ce}}}}(),y=g.imgRef,E=g.imgState,s=g.setImgSize,C=wn(0),k=wn(""),M=bo({scale:1,rotateDeg:0,top:0,left:0,initX:0,initY:0,lastX:0,lastY:0,touches:[]}),D=bo({loadError:!1,loading:!1,dragging:!1,gesturing:!1}),R=hr(function(){return c1(r.imgs)?r.imgs.map(function(Le){return typeof Le=="string"?{src:Le}:CL(Le)?Le:void 0}).filter(xL):Zw(r.imgs)?[{src:r.imgs}]:[]}),U=hr(function(){var Le;return(Le=R.value[C.value])===null||Le===void 0?void 0:Le.src}),ge=hr(function(){var Le;return(Le=R.value[C.value])===null||Le===void 0?void 0:Le.title}),Ee=hr(function(){return{cursor:D.loadError?"default":r.moveDisabled?D.dragging?"grabbing":"grab":"move",top:"calc(50% + ".concat(M.top,"px)"),left:"calc(50% + ".concat(M.left,"px)"),transition:D.dragging||D.gesturing?"none":"",transform:"translate(-50%, -50%) scale(".concat(M.scale,") rotate(").concat(M.rotateDeg,"deg)")}}),be=function(){l("hide")},we=function(){M.scale=1,M.rotateDeg=0,M.top=0,M.left=0,D.loadError=!1,D.dragging=!1,D.loading=!0},De=function(Le,We){var te=C.value;we(),C.value=Le,R.value[C.value]===R.value[Le]&&ph(function(){D.loading=!1}),r.visible&&te!==Le&&(We&&(c1(We)?We.forEach(function(ae){l(ae,te,Le)}):l(We,te,Le)),l("on-index-change",te,Le))},Xe=function(){var Le=C.value,We=r.loop?(Le+1)%R.value.length:Le+1;!r.loop&&We>R.value.length-1||De(We,["on-next","on-next-click"])},Ue=function(){var Le=C.value,We=Le-1;if(Le===0){if(!r.loop)return;We=R.value.length-1}De(We,["on-prev","on-prev-click"])},st=function(){var Le=M.scale+.2;Le<3*E.maxScale&&(M.scale=Le)},ut=function(){var Le=M.scale-.2;Le>.1&&(M.scale=Le)},lt=function(){M.rotateDeg-=90},It=function(){M.rotateDeg+=90},Ft=function(){M.scale=1,M.top=0,M.left=0},Ct=function(){var Le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return!r.moveDisabled&&Le===0},Tt=function(Le,We,te){var ae,Ce=!1;return{onMouseDown:function(Ie){Le.initX=Le.lastX=Ie.clientX,Le.initY=Le.lastY=Ie.clientY,We.dragging=!0,Ce=!1,Ie.stopPropagation()},onMouseUp:function(Ie){te(Ie.button)&&h1(ae),We.dragging=!1,Ce=!1},onMouseMove:function(Ie){if(We.dragging)if(te(Ie.button)){if(Ce)return;Ce=!0,ae=pg(function(){var Ve=Le.top,Ke=Le.left,ht=Le.lastY,Ne=Le.lastX;Le.top=Ve-ht+Ie.clientY,Le.left=Ke-Ne+Ie.clientX,Le.lastX=Ie.clientX,Le.lastY=Ie.clientY,Ce=!1})}else Le.lastX=Ie.clientX,Le.lastY=Ie.clientY;Ie.stopPropagation()}}}(M,D,Ct),ot=Tt.onMouseDown,Nt=Tt.onMouseMove,Ai=Tt.onMouseUp,Zi=function(Le,We,te,ae){var Ce,Ie=!1;return{onTouchStart:function(Ve){var Ke=Ve.touches;Ke.length>1?(te.gesturing=!0,We.touches=Ke):(We.initX=We.lastX=Ke[0].clientX,We.initY=We.lastY=Ke[0].clientY,te.dragging=!0),Ve.stopPropagation()},onTouchMove:function(Ve){if(!Ie){var Ke=Ve.touches,ht=We.lastX,Ne=We.lastY,tt=We.left,Ze=We.top,Mt=We.scale;if(!te.gesturing&&te.dragging){if(!Ke[0])return;var wt=Ke[0],dt=wt.clientX,Lt=wt.clientY;ae()?Ce=pg(function(){We.lastX=dt,We.lastY=Lt,We.top=Ze-Ne+Lt,We.left=tt-ht+dt,Ie=!1}):(We.lastX=dt,We.lastY=Lt)}else te.gesturing&&We.touches.length>1&&Ke.length>1&&(Ce=pg(function(){var Zt=(d1(We.touches[0],We.touches[1])-d1(Ke[0],Ke[1]))/Le.width;We.touches=Ke;var hi=Mt-1.3*Zt;hi>.5&&hi<1.5*Le.maxScale&&(We.scale=hi),Ie=!1}))}},onTouchEnd:function(){h1(Ce),te.dragging=!1,te.gesturing=!1,Ie=!1}}}(E,M,D,Ct),ri=Zi.onTouchStart,qt=Zi.onTouchMove,ei=Zi.onTouchEnd,Si=function(Le){var We=Le;r.visible&&(!r.escDisabled&&We.key==="Escape"&&r.visible&&be(),We.key==="ArrowLeft"&&(r.rtl?Xe():Ue()),We.key==="ArrowRight"&&(r.rtl?Ue():Xe()))},Qi=function(){s()},Et=function(){D.loading=!1},en=function(Le){D.loading=!1,D.loadError=!0,l("on-error",Le)},ti=function(){r.visible&&s()};wo(function(){return r.index},function(Le){Le<0||Le>=R.value.length||De(Le)}),wo(function(){return D.dragging},function(Le,We){var te=!Le&&We;if(!Ct()&&te){var ae=M.lastX-M.initX,Ce=M.lastY-M.initY,Ie=r.swipeTolerance;Math.abs(ae)>Math.abs(Ce)&&(ae<-1*Ie?Xe():ae>Ie&&Ue())}}),wo(function(){return r.visible},function(Le){if(Le){we();var We=R.value.length;if(We===0)return C.value=0,D.loading=!1,void ph(function(){return D.loadError=!0});C.value=r.index>=We?We-1:r.index<0?0:r.index,r.scrollDisabled&&Dn()}else r.scrollDisabled&&Be()});var Dn=function(){document&&(k.value=document.body.style.overflowY,document.body.style.overflowY="hidden")},Be=function(){document&&(document.body.style.overflowY=k.value)};Oc(function(){a1(document,"keydown",Si),a1(window,"resize",ti)}),bh(function(){l1(document,"keydown",Si),l1(window,"resize",ti)});var yt=function(){return D.loading?h.loading?h.loading({key:"loading"}):Bt(wL,{key:"img-loading"},null):D.loadError?h.onerror?h.onerror({key:"onerror"}):Bt(TL,{key:"img-on-error"},null):Bt("div",{class:"".concat("vel","-img-wrapper"),style:Ee.value,key:"img-wrapper"},[Bt("img",{ref:y,draggable:"false",class:"".concat("vel","-img"),src:U.value,onMousedown:ot,onMouseup:Ai,onMousemove:Nt,onTouchstart:ri,onTouchmove:qt,onTouchend:ei,onLoad:Qi,onDragstart:function(Le){Le.preventDefault()}},null)])},rt=function(){if(h["prev-btn"])return h["prev-btn"]({prev:Ue});if(!(R.value.length<=1)){var Le=!r.loop&&C.value<=0;return Bt("div",{class:"btn__prev ".concat(Le?"disable":""),onClick:Ue},[r.rtl?Bt(vo,{type:"next"},null):Bt(vo,{type:"prev"},null)])}},At=function(){if(h["next-btn"])return h["next-btn"]({next:Xe});if(!(R.value.length<=1)){var Le=!r.loop&&C.value>=R.value.length-1;return Bt("div",{class:"btn__next ".concat(Le?"disable":""),onClick:Xe},[r.rtl?Bt(vo,{type:"prev"},null):Bt(vo,{type:"next"},null)])}},ui=function(){if(ge.value&&!r.titleDisabled&&!D.loading&&!D.loadError)return h.title?h.title():Bt(EL,null,{default:function(){return[ge.value]}})},pi=function(){var Le;if(r.visible)return Bt("div",{onTouchmove:yL,class:["".concat("vel","-modal"),r.rtl?"is-rtl":""],onClick:$C(be,["self"])},[Bt(ih,{name:"".concat("vel","-fade"),mode:"out-in"},fg(Le=yt())?Le:{default:function(){return[Le]}}),Bt("img",{style:"display:none;",src:U.value,onError:en,onLoad:Et},null),Bt("div",{class:"".concat("vel","-btns-wrapper")},[rt(),At(),ui(),h["close-btn"]?h["close-btn"]({close:be}):Bt("div",{class:"btn__close",onClick:be},[Bt(vo,{type:"close"},null)]),h.toolbar?h.toolbar({toolbarMethods:{zoomIn:st,zoomOut:ut,rotate:lt,rotateLeft:lt,rotateRight:It,resize:Ft},zoomIn:st,zoomOut:ut,rotate:lt,rotateLeft:lt,rotateRight:It,resize:Ft}):Bt(bL,{zoomIn:st,zoomOut:ut,resize:Ft,rotateLeft:lt,rotateRight:It},null)])])};return function(){var Le,We;return r.teleport?Bt(tC,{to:r.teleport},{default:function(){return[Bt(ih,{name:"".concat("vel","-fade")},fg(We=pi())?We:{default:function(){return[We]}})]}}):Bt(ih,{name:"".concat("vel","-fade")},fg(Le=pi())?Le:{default:function(){return[Le]}})}}}),AL=Hg;AL.install=function(r){r.component(Hg.name,Hg)};function ML(r){return zE()?(PE(r),!0):!1}const Sh=typeof window!="undefined",IL=r=>typeof r=="string",ch=()=>{};function Ww(r,o){function l(...h){r(()=>o.apply(this,h),{fn:o,thisArg:this,args:h})}return l}function kL(r,o={}){let l,h;return y=>{const E=ps(r),s=ps(o.maxWait);if(l&&clearTimeout(l),E<=0||s!==void 0&&s<=0)return h&&(clearTimeout(h),h=null),y();s&&!h&&(h=setTimeout(()=>{l&&clearTimeout(l),h=null,y()},s)),l=setTimeout(()=>{h&&clearTimeout(h),h=null,y()},E)}}function zL(r,o=!0,l=!0){let h=0,g,y=!l;const E=()=>{g&&(clearTimeout(g),g=void 0)};return C=>{const k=ps(r),M=Date.now()-h;if(E(),k<=0)return h=Date.now(),C();M>k&&(h=Date.now(),y?y=!1:C()),o&&(g=setTimeout(()=>{h=Date.now(),l||(y=!0),E(),C()},k)),!l&&!g&&(g=setTimeout(()=>y=!0,k))}}function PL(r,o=200,l={}){return Ww(kL(o,l),r)}function DL(r,o=200,l=!0,h=!0){return Ww(zL(o,l,h),r)}const LL=Sh?window:void 0;Sh&&window.document;Sh&&window.navigator;Sh&&window.location;function RL(...r){let o,l,h,g;if(IL(r[0])?([l,h,g]=r,o=LL):[o,l,h,g]=r,!o)return ch;let y=ch;const E=wo(()=>ps(o),C=>{y(),!!C&&(C.addEventListener(l,h,g),y=()=>{C.removeEventListener(l,h,g),y=ch})},{immediate:!0,flush:"post"}),s=()=>{E(),y()};return ML(s),s}const Xg=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Kg="__vueuse_ssr_handlers__";Xg[Kg]=Xg[Kg]||{};Xg[Kg];function v5(r,o={}){const{throttle:l=0,idle:h=200,onStop:g=ch,onScroll:y=ch,offset:E={left:0,right:0,top:0,bottom:0},eventListenerOptions:s={capture:!1,passive:!0}}=o,C=wn(0),k=wn(0),M=wn(!1),D=bo({left:!0,right:!1,top:!0,bottom:!1}),R=bo({left:!1,right:!1,top:!1,bottom:!1});if(r){const U=PL(Ee=>{M.value=!1,R.left=!1,R.right=!1,R.top=!1,R.bottom=!1,g(Ee)},l+h),ge=Ee=>{const be=Ee.target===document?Ee.target.documentElement:Ee.target,we=be.scrollLeft;R.left=we<C.value,R.right=we>C.value,D.left=we<=0+(E.left||0),D.right=we+be.clientWidth>=be.scrollWidth-(E.right||0),C.value=we;const De=be.scrollTop;R.top=De<k.value,R.bottom=De>k.value,D.top=De<=0+(E.top||0),D.bottom=De+be.clientHeight>=be.scrollHeight-(E.bottom||0),k.value=De,M.value=!0,U(Ee),y(Ee)};RL(r,"scroll",l?DL(ge,l):ge,s)}return{x:C,y:k,isScrolling:M,arrivedState:D,directions:R}}var p1,f1;Sh&&(window==null?void 0:window.navigator)&&((p1=window==null?void 0:window.navigator)==null?void 0:p1.platform)&&/iP(ad|hone|od)/.test((f1=window==null?void 0:window.navigator)==null?void 0:f1.platform);var OL=Object.defineProperty,m1=Object.getOwnPropertySymbols,BL=Object.prototype.hasOwnProperty,FL=Object.prototype.propertyIsEnumerable,g1=(r,o,l)=>o in r?OL(r,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[o]=l,NL=(r,o)=>{for(var l in o||(o={}))BL.call(o,l)&&g1(r,l,o[l]);if(m1)for(var l of m1(o))FL.call(o,l)&&g1(r,l,o[l]);return r};const UL={top:0,left:0,bottom:0,right:0,height:0,width:0};NL({text:""},UL);/*!
 /**
  * vuex-router-sync v6.0.0-rc.1
  * (c) 2021 Evan You
  * @license MIT
  */function x5(r,o,l){const h=(l||{}).moduleName||"route";r.registerModule(h,{namespaced:!0,state:Yg(o.currentRoute.value),mutations:{ROUTE_CHANGED(C,k){r.state[h]=Yg(k.to,k.from)}}});let g=!1,y;const E=r.watch(C=>C[h],C=>{const{fullPath:k}=C;k!==y&&(y!=null&&(g=!0,o.push(C)),y=k)},{flush:"sync"}),s=o.afterEach((C,k)=>{if(g){g=!1;return}y=C.fullPath,r.commit(h+"/ROUTE_CHANGED",{to:C,from:k})});return function(){s(),E(),r.unregisterModule(h)}}function Yg(r,o){const l={name:r.name,path:r.path,hash:r.hash,query:r.query,params:r.params,fullPath:r.fullPath,meta:r.meta};return o&&(l.from=Yg(o)),Object.freeze(l)}export{QL as $,$L as A,wo as B,__ as C,pp as D,l3 as E,Or as F,Ko as G,d5 as H,l5 as I,JL as J,h5 as K,_5 as L,$C as M,y5 as N,ci as O,WL as P,i5 as Q,AL as R,m5 as S,ph as T,g5 as U,v5 as V,t5 as W,e5 as X,s5 as Y,o5 as Z,x5 as _,n5 as a,wn as b,pb as c,Oc as d,HL as e,KL as f,Bt as g,oC as h,XL as i,mb as j,hr as k,YL as l,ps as m,qL as n,hb as o,GL as p,a5 as q,ZL as r,e_ as s,VL as t,r5 as u,f5 as v,yS as w,p5 as x,u5 as y,c5 as z};
//# sourceMappingURL=vendor.3d735b57.js.map
