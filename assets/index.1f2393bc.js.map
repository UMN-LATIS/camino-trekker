{"version":3,"file":"index.1f2393bc.js","sources":["../../vite/modulepreload-polyfill","../../plugin-vue:export-helper","../../src/utils/pipe.js","../../src/config.js","../../src/common/api.service.js","../../src/pages/HomePage.vue","../../src/utils/capitalize.js","../../src/utils/getAllRoutes.js","../../src/utils/getAllStopPoints.js","../../src/utils/getBoundingBox.js","../../src/utils/getStagesFromStopWhere.js","../../src/utils/getStagesFromTourWhere.js","../../src/utils/getFullTourRoute.js","../../src/common/hooks.js","../../src/assets/umn-logo.svg","../../src/components/ProgressIndicator/ProgressIndicator.vue","../../src/components/Map/Map.vue","../../src/components/MapPolyline/toGeoJson.js","../../src/components/MapPolyline/MapPolyline.vue","../../src/components/MapMarker/useMapMarker.js","../../src/components/MapMarker/MapMarker.vue","../../src/components/MapPopup/MapPopup.vue","../../src/components/Button/Button.vue","../../src/components/TourMap/getPointsForStop.js","../../src/components/TourMap/getCenterOfBoundingBox.js","../../src/components/TourMap/TourMap.vue","../../src/components/MapSheet/MapSheet.vue","../../src/components/MenuSheet/MenuSheet.vue","../../src/components/StopListSheet/StopListSheet.vue","../../src/components/BottomNav/BottomNav.vue","../../src/components/TourStopSkeleton/TourStopSkeleton.vue","../../src/components/Gravatar/Gravatar.vue","../../src/components/Stage/stages/PureLanguageSelect.vue","../../src/components/Stage/stages/LanguageSelect.vue","../../src/components/Markdown/Markdown.vue","../../src/components/Stage/stages/Guide.vue","../../src/components/Stage/stages/Separator.vue","../../src/components/Stage/stages/Navigation.vue","../../src/components/Stage/stages/Gallery.vue","../../src/components/Stage/stages/AR.vue","../../src/components/Stage/Stage.vue","../../src/components/TourStop/TourStop.vue","../../src/components/TourStopSwiper/TourStopSwiper.vue","../../src/components/TuckOnScroll/TuckOnScroll.vue","../../src/pages/TourPage.vue","../../src/router.js","../../src/store/index.js","../../src/main.js"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","\nexport default (sfc, props) => {\n  const target = sfc.__vccOpts || sfc;\n  for (const [key, val] of props) {\n    target[key] = val;\n  }\n  return target;\n}\n","export default (...fns) =>\n  (initialValue) =>\n    fns.reduce((acc, fn) => fn(acc), initialValue);\n","// vite uses import.meta.env for env variables\n// must be prefixed with VITE to be included in client side app build\nconst env = import.meta.env;\n\nexport default {\n  apiBaseUrl: env.VITE_API_HOST,\n  imageStorageBase: `${env.VITE_API_HOST}/storage`,\n  baseDir: env.VITE_BASE_DIR,\n  mapBox: {\n    accessToken: env.VITE_MAPBOX_ACCESS_TOKEN,\n  },\n};\n","import pipe from \"../utils/pipe\";\nimport axios from \"axios\";\nimport config from \"../config\";\n\nconst middlewares = [];\nexport const toursService = {\n  get(tourId) {\n    return axios(`${config.apiBaseUrl}/api/tour/${tourId}`)\n      .then(pipe(...middlewares))\n      .then((response) => response.data)\n      .catch(console.error);\n  },\n  applyMiddlewares(response) {\n    return pipe(...middlewares)(response);\n  },\n  list() {\n    return axios(`${config.apiBaseUrl}/api/tours`)\n      .then(pipe(...middlewares))\n      .then((res) => res.data)\n      .catch(console.error);\n  },\n  use(middleware) {\n    middlewares.push(middleware);\n  },\n};\n\nfunction replaceObjectKeys([oldKeyName, newKeyName], obj) {\n  const ObjAsString = JSON.stringify(obj);\n  const newObjAsString = ObjAsString.replace(\n    new RegExp(`\"${oldKeyName}\":`, \"g\"),\n    `\"${newKeyName}\":`\n  );\n  return JSON.parse(newObjAsString);\n}\n\nfunction convertEnglishToEn(response) {\n  const newData = replaceObjectKeys([\"English\", \"en\"], response.data);\n  return { ...response, data: newData };\n}\n\ntoursService.use(convertEnglishToEn);\n","<script setup>\nimport { onMounted, ref } from \"vue\";\nimport { toursService } from \"../common/api.service.js\";\n\nconst tours = ref([]);\n\nonMounted(async () => {\n  tours.value = await toursService.list();\n});\n</script>\n\n<template>\n  <div class=\"home-page container\">\n    <h1>Camino</h1>\n    <ul v-if=\"tours.length\">\n      <li v-for=\"tour in tours\" :key=\"tour.id\">\n        <router-link :to=\"`/tours/${tour.id}/stops/0`\">\n          {{ tour.title }}\n        </router-link>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<style></style>\n","export default (str) => str.charAt(0).toUpperCase() + str.slice(1);\n","const isNavigationStage = (stage) => stage.type === \"navigation\";\nconst getNavStagesAtStop = (stop) =>\n  stop.stop_content.stages.filter(isNavigationStage);\nconst getRoutesFromNavStages = (navStages) =>\n  navStages.flatMap((navStage) => navStage.route);\n\nexport default (tour) => {\n  // just a single point for stop 0\n  // const startingRoute = [tour.start_location];\n  const stopRoutes = tour.stops.map((stop) => {\n    const navStages = getNavStagesAtStop(stop);\n    const routes = getRoutesFromNavStages(navStages);\n    return routes;\n  });\n  // return [startingRoute, ...stopRoutes];\n  return stopRoutes;\n};\n","/**\n * returns a list of all tour stops\n * @param {Object} tour\n * @returns {LngLat[]} all tour stops\n */\nimport { getStagesFromTourWhere } from \"./index.js\";\n\nexport default (tour) => {\n  const startingPoint = tour.start_location;\n  const targetPoints = getStagesFromTourWhere(\"type\", \"navigation\", tour).map(\n    (stage) => stage.targetPoint\n  );\n  return [startingPoint, ...targetPoints];\n};\n","/**\n * @typedef {[number,number]} LngLatTuple\n * @typedef {[LngLatTuple, LngLatTuple]} BoundingBox\n */\n\nconst compareUsing = (fn) => (acc, x) => fn(acc, x);\nconst prop = (key) => (obj) => obj[key];\n\n/**\n * returns bounding box corner points which contain\n * a given route\n *\n * @param {LngLat[]} listOfLngLats - list of positions\n * @returns {LngLat[][]} - SW and NE corner points of the\n *  bounding box: [[minLng, minLat], [maxLng, maxLat]]\n */\nexport default (listOfLngLats) => {\n  if (!Array.isArray(listOfLngLats)) {\n    throw Error(\n      `listOfLngLats is not an array ${JSON.stringify(listOfLngLats)}`\n    );\n  }\n  const minLng = listOfLngLats\n    .map(prop(\"lng\"))\n    .reduce(compareUsing(Math.min), +Infinity);\n  const minLat = listOfLngLats\n    .map(prop(\"lat\"))\n    .reduce(compareUsing(Math.min), +Infinity);\n  const maxLng = listOfLngLats\n    .map(prop(\"lng\"))\n    .reduce(compareUsing(Math.max), -Infinity);\n  const maxLat = listOfLngLats\n    .map(prop(\"lat\"))\n    .reduce(compareUsing(Math.max), -Infinity);\n  return [\n    [minLng, minLat],\n    [maxLng, maxLat],\n  ];\n};\n","export default (stageKey, stageValue, stop) => {\n  return stop.stop_content.stages.filter(\n    (stage) => stage[stageKey] === stageValue\n  );\n};\n","import getStagesFromStopWhere from \"./getStagesFromStopWhere.js\";\n\nexport default (stageKey, stageValue, tour) =>\n  tour.stops.flatMap((stop) =>\n    getStagesFromStopWhere(stageKey, stageValue, stop)\n  );\n","/// <reference path=\"../types.js\" />;\n\nimport { getStagesFromTourWhere } from \"./index.js\";\n\n/**\n * gets all route points from a given tour, including\n * start_location\n * @param {Object} - tour object from api\n * @returns {LngLat[]} - array of route points from every\n * stage\n */\nexport default (tour) => {\n  const navStages = getStagesFromTourWhere(\"type\", \"navigation\", tour);\n  const routePoints = navStages.flatMap((stage) => stage.route);\n  return [tour.start_location, ...routePoints];\n};\n","import { computed } from \"vue\";\nimport { useStore } from \"vuex\";\nimport getFullTourRoute from \"../utils/getFullTourRoute.js\";\nimport config from \"../config.js\";\n\nexport const useTour = () => {\n  const store = useStore();\n  return {\n    tour: computed(() => store.state.tour),\n  };\n};\n\nexport const useStopIndex = () => {\n  const store = useStore();\n  return {\n    stopIndex: computed(() => store.getters.stopIndex),\n  };\n};\n\nexport const useLocale = () => {\n  const store = useStore();\n  return {\n    locale: computed(() => store.state.locale),\n    setLocale: (newLocale) => store.dispatch(\"setLocale\", newLocale),\n  };\n};\n\nexport const useMapBoxAccessToken = () => {\n  return {\n    accessToken: computed(() => config.mapBox.accessToken),\n  };\n};\n\nexport const useFullTourRoute = () =>\n  computed(() => {\n    const { tour } = useTour();\n    return {\n      fullTourRoute: getFullTourRoute(tour.value),\n    };\n  });\n\nexport const useTourLocales = () => {\n  const { tour } = useTour();\n  return {\n    tourLocales: computed(() => tour.value.tour_content.languages),\n  };\n};\n","export default \"__VITE_ASSET__b8420373__\"","<template>\n  <ol class=\"progress-indicator\">\n    <li\n      v-for=\"(_, index) in items\"\n      :key=\"index\"\n      class=\"item\"\n      :class=\"{\n        'item--is-active': isActive(index),\n      }\"\n    >\n      <span class=\"item__dot material-icons\">circle</span>\n      <span class=\"item__index\">{{ index === 0 ? \"Start\" : index + 1 }}</span>\n    </li>\n  </ol>\n</template>\n<script setup>\nimport { computed } from \"vue\";\nimport range from \"lodash/range\";\n\nconst props = defineProps({\n  total: {\n    type: Number,\n    required: true,\n  },\n  active: {\n    type: Number,\n    required: true,\n  },\n});\n\nconst items = computed(() => range(props.total));\nconst isActive = (index) => index === props.active;\n</script>\n\n<style scoped>\n.progress-indicator {\n  list-style: none;\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  margin: 0;\n  padding: 0;\n}\n\n.item {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.item__dot {\n  font-size: 0.5rem;\n  color: hsla(0, 0%, 0%, 0.25);\n}\n.item__index {\n  display: none;\n}\n\n.item--is-active .item__index {\n  color: hsla(0, 0%, 0%, 1);\n  font-size: 0.75rem;\n  display: inline-flex;\n}\n.item--is-active .item__dot {\n  display: none;\n}\n</style>\n","<template>\n  <div ref=\"mapContainerRef\" class=\"map-container\">\n    <slot />\n  </div>\n</template>\n\n<script setup>\nimport { ref, watch, onMounted, onUnmounted, toRefs, provide } from \"vue\";\nimport \"mapbox-gl/dist/mapbox-gl.css\";\nimport {\n  Map,\n  FullscreenControl,\n  GeolocateControl,\n  ScaleControl,\n} from \"mapbox-gl\";\nimport { arrayOf, number, string, shape } from \"vue-types\";\n\nconst props = defineProps({\n  center: shape({\n    lng: number().isRequired,\n    lat: number().isRequired,\n  }).isRequired,\n  zoom: number().isRequired,\n  bounds: arrayOf(arrayOf(number())),\n  mapStyle: string().def(\"streets\"),\n  accessToken: string().isRequired,\n});\n\nconst mapContainerRef = ref(null);\nconst mapRef = ref(null);\nconst {\n  center: centerRef,\n  zoom: zoomRef,\n  bounds: boundsRef,\n  mapStyle: mapStyleRef,\n} = toRefs(props);\n\nconst MAP_STYLES = {\n  streets: \"mapbox://styles/mapbox/streets-v11\",\n  outdoors: \"mapbox://styles/mapbox/outdoors-v11\",\n  light: \"mapbox://styles/mapbox/light-v10\",\n  dark: \"mapbox://styles/mapbox/dark-v10\",\n  // satellite: \"mapbox://styles/mapbox/satellite-v9\",\n  satellite: \"mapbox://styles/mapbox/satellite-streets-v11\",\n  \"navigation-day\": \"mapbox://styles/mapbox/navigation-day-v1\",\n  \"navigation-night\": \"mapbox://styles/mapbox/navigation-night-v1\",\n};\n\n// satellite gets a bit too pixelated up close\nconst getMaxZoomForStyle = (mapStyle) => (mapStyle === \"satellite\" ? 18 : 22);\n\nfunction setupMap() {\n  mapRef.value = new Map({\n    container: mapContainerRef.value,\n    style: MAP_STYLES[props.mapStyle],\n    center: [centerRef.value.lng, centerRef.value.lat],\n    zoom: zoomRef.value,\n    accessToken: props.accessToken,\n    maxZoom: getMaxZoomForStyle(props.mapStyle),\n  });\n\n  mapRef.value\n    .addControl(new FullscreenControl())\n    .addControl(new GeolocateControl())\n    .addControl(new ScaleControl({ unit: \"imperial\" }));\n\n  if (props.bounds) {\n    mapRef.value.fitBounds(boundsRef.value, { padding: 64 });\n  }\n}\n\n// watch style changes\nwatch(mapStyleRef, () => {\n  const mapStyle = mapStyleRef.value;\n  mapRef.value.setStyle(MAP_STYLES[mapStyle]);\n  mapRef.value.setMaxZoom(getMaxZoomForStyle(mapStyle));\n});\n\n// watch map bounds changes\nwatch(boundsRef, () => {\n  mapRef.value.fitBounds(boundsRef.value, { padding: 64 });\n});\n\nonMounted(() => {\n  setupMap();\n});\n\nonUnmounted(() => {\n  // probably need to do some cleanup here?\n});\n\nprovide(\"map\", mapRef);\n</script>\n\n<style scoped>\n.map-container {\n  width: 100%;\n  height: 100%;\n}\n</style>\n","const lngLatToArray = ({ lng, lat }) => [lng, lat];\n\n/**\n * Creates a GeoJSON linestring given an array of lng, lat positions\n *\n * @param {Object[]} positions - array of longitude and latitude positions of\n * the linestring\n * @param {number} positions[].lng - longitude\n * @param {number} positions[].lat - latitude\n *\n * @returns {GeoJSON} geojson formatted feature with linestring geometry\n * using positions as coordinates\n */\nexport const toGeoJsonLineString = (positions) => ({\n  type: \"Feature\",\n  properties: {},\n  geometry: {\n    type: \"LineString\",\n    coordinates: positions.map(lngLatToArray),\n  },\n});\n\n/**\n * Creates a GeoJSON point feature given a lng, lat position.\n *\n * @param {Object} position\n * @param {number} position.lng - longitude\n * @param {number} position.lat - latitude\n *\n * @returns {GeoJSON} geojson formatted feature with point geometry\n */\nexport const toGeoJsonPoint = (lngLat) => ({\n  type: \"Feature\",\n  properties: {},\n  geometry: {\n    type: \"Point\",\n    coordinates: lngLatToArray(lngLat),\n  },\n});\n\n// export const tourRoutesToGeoJson = (tour) => {\n//   const navStages = getStagesFromTourWhere(\"type\", \"navigation\", tour);\n//   const allRoutes = navStages.map((stage) => stage.route);\n//   return {\n//     type: \"FeatureCollection\",\n//     features: allRoutes.map(toGeoJsonLineString),\n//   };\n// };\n\n// export const tourStopsToGeoJson = (tour) => {\n//   const navStages = getStagesFromTourWhere(\"type\", \"navigation\", tour);\n//   const allTargetPoints = navStages.map((stage) => stage.targetPoint);\n//   const startPoint = tour.start_location;\n//   return {\n//     type: \"FeatureCollection\",\n//     features: [startPoint, ...allTargetPoints].map(toGeoJsonPoint),\n//   };\n// };\n","<template><slot></slot></template>\n<script setup>\nimport { arrayOf, number, shape, string } from \"vue-types\";\nimport { watch, inject, toRefs } from \"vue\";\nimport { toGeoJsonLineString } from \"./toGeoJson\";\n\nconst props = defineProps({\n  positions: arrayOf(\n    shape({\n      lng: number().isRequired,\n      lat: number().isRequired,\n    })\n  ),\n  // unique ID for this data source\n  id: string().isRequired,\n  color: string(),\n});\n\nconst mapRef = inject(\"map\", null);\nconst { color: colorRef } = toRefs(props);\n\nfunction addDataLayer({ id, positions, color }) {\n  const map = mapRef.value;\n\n  if (!map) return;\n  if (!id) {\n    throw Error(`addDataLayer is missing id '${id}'`);\n  }\n  if (!Array.isArray(positions)) {\n    throw Error(`addDataLayer is missing positions '${positions}'`);\n  }\n\n  // remove existing data layer and source if it exists\n  if (map.getLayer(id)) map.removeLayer(id);\n  if (map.getSource(id)) map.removeSource(id);\n\n  mapRef.value\n    .addSource(id, {\n      type: \"geojson\",\n      data: toGeoJsonLineString(positions),\n    })\n    .addLayer({\n      id,\n      source: id,\n      type: \"line\",\n      layout: {\n        \"line-join\": \"round\",\n        \"line-cap\": \"round\",\n      },\n      paint: {\n        \"line-color\": color || \"#0472f8\",\n        \"line-width\": 6,\n      },\n    });\n}\n\nwatch(mapRef, () => {\n  if (!mapRef.value) return;\n  // wait for map to load before adding data\n  mapRef.value.on(\"load\", () => addDataLayer(props));\n  // redraw if map style changes\n  mapRef.value.on(\"style.load\", () => addDataLayer(props));\n});\n\n// update line color if props change\nwatch(colorRef, () => {\n  const updateLineColor = () =>\n    mapRef.value.setPaintProperty(props.id, \"line-color\", colorRef.value);\n  if (mapRef.value.isStyleLoaded()) {\n    return updateLineColor();\n  }\n  mapRef.value.on(\"style.load\", updateLineColor);\n});\n</script>\n","import { watch, ref, unref } from \"vue\";\nimport { Marker } from \"mapbox-gl\";\n\nexport default (mapRef, props) => {\n  const marker = ref(null);\n\n  watch([mapRef, props], () => {\n    const map = unref(mapRef);\n\n    // if no map yet, nothing to do\n    if (!map) return;\n\n    // remove old marker if it exists\n    const oldMarker = unref(marker);\n    if (oldMarker) oldMarker.remove();\n\n    marker.value = new Marker({ color: props.color })\n      .setLngLat([props.lng, props.lat])\n      .addTo(map);\n  });\n\n  return { marker };\n};\n","<template><slot></slot></template>\n<script setup>\nimport { number, string } from \"vue-types\";\nimport { inject, provide } from \"vue\";\nimport useMapMarker from \"./useMapMarker\";\n\nconst props = defineProps({\n  lng: number().isRequired,\n  lat: number().isRequired,\n  color: string(),\n});\n\nconst map = inject(\"map\");\n\nconst { marker } = useMapMarker(map, props);\nprovide(\"marker\", marker);\n</script>\n","<template>\n  <div ref=\"popupRef\" class=\"map-popup\">\n    <slot></slot>\n  </div>\n</template>\n<script setup>\nimport { inject, watch, ref } from \"vue\";\nimport { Popup } from \"mapbox-gl\";\n\nconst markerRef = inject(\"marker\");\nconst popupRef = ref(null);\n\n// use ref to get the content of the slot\n// and then put it in the popup using setDOMContent\nwatch([markerRef, popupRef], () => {\n  if (!markerRef.value || !popupRef.value) return;\n  const popup = new Popup().setDOMContent(popupRef.value);\n  markerRef.value.setPopup(popup);\n});\n</script>\n\n<style>\n/* the actual popup container */\n.map-popup {\n  font-size: 0.8rem;\n  font-family: Poppins, sans-serif;\n}\n.map-popup h1,\n.map-popup h2,\n.map-popup h3 {\n  font-size: 1rem;\n  text-transform: uppercase;\n  margin: 0;\n  font-weight: 600;\n}\n.map-popup p {\n  margin: 0;\n}\n.mapboxgl-popup-content {\n  padding: 1.25rem 1rem 1rem;\n  background: hsla(0, 0%, 100%, 0.75);\n}\n.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip {\n  border-top-color: hsla(0, 0%, 100%, 0.75);\n}\n\n.mapboxgl-popup-anchor-top .mapboxgl-popup-tip {\n  border-bottom-color: hsla(0, 0%, 100%, 0.75);\n}\n\n.mapboxgl-popup-anchor-left .mapboxgl-popup-tip {\n  border-right-color: hsla(0, 0%, 100%, 0.75);\n}\n\n.mapboxgl-popup-anchor-right .mapboxgl-popup-tip {\n  border-left-color: hsla(0, 0%, 100%, 0.75);\n}\n\n.mapboxgl-popup {\n  /* TODO: make this happen with autoprefixer */\n  -webkit-backdrop-filter: blur(0.5rem);\n  backdrop-filter: blur(0.25rem);\n}\n</style>\n","<template>\n  <button class=\"button\" :class=\"classMap\">\n    <span v-if=\"!!icon\" class=\"material-icons\">{{ icon }}</span>\n    <slot>Button Text</slot>\n  </button>\n</template>\n<script setup>\nimport { computed } from \"vue\";\n\nconst props = defineProps({\n  icon: {\n    type: String,\n    default: null,\n  },\n  variant: {\n    type: String,\n    validator(str) {\n      return [\"primary\", \"secondary\", \"inverse\"].includes(str);\n    },\n    default: \"secondary\",\n  },\n  iconPosition: {\n    type: String,\n    default: \"before\",\n  },\n});\n\nconst classMap = computed(() => ({\n  \"button--primary\": props.variant === \"primary\",\n  \"button--icon-position-end\": props.iconPosition === \"end\",\n  \"button--inverse\": props.variant === \"inverse\",\n}));\n</script>\n<style scoped>\n.button {\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  gap: 0.25rem;\n  padding: 0.75rem 1.25rem;\n  border: 0.125rem solid var(--black);\n  border-radius: 0.25rem;\n  font-size: 1rem;\n  font-weight: 500;\n  color: var(--black);\n  background-color: transparent;\n  transition: all ease 0.1s;\n}\n\n.button--icon-position-end {\n  flex-direction: row-reverse;\n}\n\n.material-icons {\n  font-size: 1.25rem;\n}\n\n.button:hover {\n  background: hsla(0, 0%, 0%, 0.1);\n}\n\n.button--primary {\n  color: var(--gray-lighter);\n  border-color: var(--black);\n  background: var(--black);\n}\n.button--primary:hover {\n  outline: 0.25rem solid var(--black);\n  border-color: var(--white);\n  color: var(--white);\n  background: var(--black);\n}\n\n.button--inverse {\n  border-color: var(--white);\n  color: var(--white);\n}\n\n.button--inverse:hover {\n  border-color: var(--black);\n  background: var(--white);\n  color: var(--black);\n  outline: 0.25rem solid var(--white);\n}\n</style>\n","/**\n * list of LngLat stop points for a given stop index\n * includes:\n *  - previous stop target (if there is one)\n *  - stop target at given stop index\n *  - all route points at given stop index\n * @param {} index\n * @param {*} allStopPoints - collection of LngLat points\n * @param {*} allStopRoutes - collection of routes (each a collection of LngLat points) for a given stop\n * @returns list of LngLat points\n */\nexport default function getPointsForStop(\n  index = 0,\n  allStopPoints,\n  allStopRoutes\n) {\n  const prevStopTarget = index > 0 ? allStopPoints[index - 1] : null;\n  const currentStopRoute = allStopRoutes[index];\n  const currentStopTarget = allStopPoints[index];\n\n  // the list of points we want to create a bounding box around.\n  return [prevStopTarget, ...currentStopRoute, currentStopTarget].filter(\n    Boolean\n  ); // remove any null values\n}\n","/**\n *  gets the center point of a bounding box\n * @param {number[][]} bounds - SW and NE corner of bounding box\n * @returns {LngLat} longitude and latitude of center\n */\nexport default function getCenterOfBoundingBox(bounds) {\n  const [[minLng, minLat], [maxLng, maxLat]] = bounds;\n  return {\n    lng: (minLng + maxLng) / 2,\n    lat: (minLat + maxLat) / 2,\n  };\n}\n","<template>\n  <div\n    class=\"tour-map\"\n    :class=\"`tour-map--${initialMapStyle}`\"\n    @pointerdown=\"(evt) => evt.stopPropagation()\"\n  >\n    <div v-if=\"showMapStyleControl\" class=\"button-bar\">\n      <Button\n        v-for=\"styleChoice in mapStyleChoices\"\n        :key=\"styleChoice\"\n        class=\"button-bar__button\"\n        :class=\"{\n          'button-bar__button--is-active': styleChoice === mapStyleRef,\n        }\"\n        @click=\"setMapStyle(styleChoice)\"\n      >\n        {{ capitalize(styleChoice) }}\n      </Button>\n    </div>\n    <Map\n      v-if=\"centerRef\"\n      class=\"map-sheet__map-container\"\n      :center=\"centerRef\"\n      :zoom=\"zoomRef\"\n      :bounds=\"boundsRef\"\n      :mapStyle=\"mapStyleRef\"\n      :accessToken=\"accessToken\"\n    >\n      <MapPolyline\n        v-for=\"(route, i) in allStopRoutesRef\"\n        :id=\"`route-${i}`\"\n        :key=\"i\"\n        :positions=\"route\"\n        :color=\"getStopColor(i)\"\n      />\n      <MapMarker\n        v-for=\"(stopPoint, i) in allStopPointsRef\"\n        :key=\"i\"\n        :lng=\"stopPoint.lng\"\n        :lat=\"stopPoint.lat\"\n        :color=\"getStopColor(i)\"\n      >\n        <MapPopup>\n          <p class=\"map-popup__stop-number-container\">\n            <span class=\"map-popup__stop-number\">\n              {{ allStopLabelsRef[i].number }}\n            </span>\n          </p>\n          <h2 class=\"map-popup__stop-title\">\n            {{ allStopLabelsRef[i].title }}\n          </h2>\n          <p class=\"map-popup__link-container\">\n            <router-link :to=\"allStopLabelsRef[i].href\" class=\"map-popup__link\">\n              <span class=\"material-icons\">arrow_forward</span>\n              <span class=\"sr-only\">Go to Stop</span>\n            </router-link>\n          </p>\n        </MapPopup>\n      </MapMarker>\n    </Map>\n  </div>\n</template>\n<script setup>\nimport { ref, computed, watch, toRefs } from \"vue\";\nimport { string, oneOf, bool, number } from \"vue-types\";\nimport Map from \"../Map/Map.vue\";\nimport MapPolyline from \"../MapPolyline/MapPolyline.vue\";\nimport MapMarker from \"../MapMarker/MapMarker.vue\";\nimport MapPopup from \"../MapPopup/MapPopup.vue\";\nimport Button from \"../Button/Button.vue\";\nimport capitalize from \"../../utils/capitalize.js\";\nimport getFullTourRoute from \"../../utils/getFullTourRoute.js\";\nimport getAllStopPoints from \"../../utils/getAllStopPoints.js\";\nimport getBoundingBox from \"../../utils/getBoundingBox\";\nimport getPointsForStop from \"./getPointsForStop\";\nimport getCenterOfBoundingBox from \"./getCenterOfBoundingBox\";\nimport getAllRoutes from \"../../utils/getAllRoutes\";\nimport {\n  useTour,\n  useLocale,\n  useMapBoxAccessToken,\n} from \"../../common/hooks.js\";\n\nconst props = defineProps({\n  type: oneOf([\"tour\", \"stop\"]),\n  stopIndex: number().isRequired,\n  initialMapStyle: string().def(\"light\"),\n  showMapStyleControl: bool().def(true),\n});\n\nfunction createAllStopLabels({ tour, locale }) {\n  return tour.stops.map((stop, index) => ({\n    title: stop.stop_content.title[locale],\n    href: `/tours/${stop.tour_id}/stops/${index}`,\n    number: index + 1,\n  }));\n}\n\nfunction getStopColor(index) {\n  if (index < stopIndex.value) return \"#7EEAFC\";\n  if (index === stopIndex.value) return \"#0A84FF\";\n  return \"#999\";\n}\n\nfunction setMapStyle(updatedStyle) {\n  mapStyleRef.value = updatedStyle;\n}\n\nconst { tour } = useTour();\nconst { stopIndex } = toRefs(props);\nconst { locale } = useLocale();\nconst { accessToken } = useMapBoxAccessToken();\nconst boundsRef = ref(null);\nconst centerRef = ref(null);\nconst zoomRef = ref(10);\nconst mapStyleChoices = [\"dark\", \"satellite\", \"streets\", \"light\"].sort();\nconst mapStyleRef = ref(props.initialMapStyle);\nconst fullTourRouteRef = computed(() => getFullTourRoute(tour.value));\nconst allStopRoutesRef = computed(() => getAllRoutes(tour.value));\nconst allStopPointsRef = computed(() => getAllStopPoints(tour.value));\nconst startPointRef = computed(() => tour.value.start_location);\nconst allStopLabelsRef = computed(() =>\n  createAllStopLabels({\n    tour: tour.value,\n    locale: locale.value,\n  })\n);\n\nif (props.type === \"tour\") {\n  boundsRef.value = getBoundingBox(fullTourRouteRef.value);\n  centerRef.value = startPointRef.value;\n}\nif (props.type === \"stop\") {\n  const stopPoints = getPointsForStop(\n    stopIndex.value,\n    allStopPointsRef.value,\n    allStopRoutesRef.value\n  );\n  boundsRef.value = getBoundingBox(stopPoints);\n  centerRef.value = getCenterOfBoundingBox(boundsRef.value);\n  zoomRef.value = 16;\n}\n\n// update bounds when stop changes\n// if stop map\nwatch(stopIndex, () => {\n  if (props.type !== \"stop\") return;\n\n  const stopPoints = getPointsForStop(\n    stopIndex.value,\n    allStopPointsRef.value,\n    allStopRoutesRef.value\n  );\n  boundsRef.value = getBoundingBox(stopPoints);\n  centerRef.value = getCenterOfBoundingBox(boundsRef.value);\n});\n</script>\n<style scoped>\n.tour-map {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n.button-bar {\n  display: flex;\n  justify-content: flex-end;\n}\n.button-bar__button {\n  border: 0;\n  outline: 0;\n  border-radius: 0;\n  padding: 0.5rem 1rem;\n  font-weight: normal;\n  font-size: 0.8rem;\n  color: var(--gray-dark);\n  letter-spacing: 0.02rem;\n}\n\n.button-bar__button:hover {\n  outline: 0;\n}\n\n.button-bar__button:hover {\n  background: none;\n  color: var(--black);\n}\n.button-bar__button--is-active {\n  color: var(--black);\n}\n\n.map-popup__link-container {\n  text-align: right;\n  margin-top: 0.5rem;\n}\n.map-popup__link {\n  display: inline-flex;\n  border: none;\n  color: var(--black);\n  padding: 0.25rem 0.5rem;\n  text-decoration: none;\n  align-items: center;\n  border-radius: 0.25rem;\n  text-transform: uppercase;\n  line-height: 1;\n}\n\n.map-popup__link:hover {\n  background: var(--black);\n  color: var(--white);\n}\n.map-popup__link .material-icons {\n  font-size: 1.25rem;\n}\n\n.map-popup__stop-number {\n  display: inline-flex;\n  border: 2px solid var(--black);\n  color: var(--black);\n  font-size: 1rem;\n  line-height: 1;\n  padding: 0.25rem 0.5rem;\n  border-radius: 0.25rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n  width: 2rem;\n  height: 2rem;\n  justify-content: center;\n  align-items: center;\n}\n.map-popup__stop-number-container {\n  text-align: left;\n}\n\n.tour-map--dark .button-bar__button {\n  color: var(--gray-dark);\n}\n.tour-map--dark .button-bar__button--is-active {\n  color: var(--gray-light);\n}\n.map-sheet__map-container {\n  border-radius: 0.5rem;\n  border: 1px solid var(--gray-light);\n}\n</style>\n","<template>\n  <Sheet\n    class=\"map-sheet\"\n    title=\"Map\"\n    :is-open=\"isOpen\"\n    @close=\"$emit('close')\"\n  >\n    <TourMap initialMapStyle=\"streets\" type=\"tour\" :stopIndex=\"stopIndex\" />\n  </Sheet>\n</template>\n<script setup>\nimport { useStopIndex } from \"../../common/hooks\";\nimport Sheet from \"../Sheet/Sheet.vue\";\nimport TourMap from \"../TourMap/TourMap.vue\";\n\ndefineProps({\n  isOpen: {\n    type: Boolean,\n    default: false,\n  },\n});\n\ndefineEmits([\"close\"]);\n\nconst { stopIndex } = useStopIndex();\n</script>\n\n<style>\n.map-sheet .sheet__header {\n  border-bottom: 0;\n  margin-bottom: 0;\n}\n</style>\n","<template>\n  <Sheet\n    class=\"menu-sheet\"\n    title=\"Menu\"\n    :is-open=\"isOpen\"\n    @close=\"$emit('close')\"\n  >\n    <ol class=\"menu-sheet__list\">\n      <router-link v-for=\"(item, i) in menuItems\" :key=\"i\" :to=\"item.href\">\n        <li class=\"menu-sheet__list-item\">\n          <span v-if=\"!!item.icon\" class=\"material-icons\">{{ item.icon }}</span>\n          <span>{{ item.text }}</span>\n        </li>\n      </router-link>\n    </ol>\n  </Sheet>\n</template>\n<script setup>\nimport Sheet from \"../Sheet/Sheet.vue\";\ndefineProps({\n  isOpen: {\n    type: Boolean,\n    default: false,\n  },\n});\n\ndefineEmits([\"close\"]);\n\nconst menuItems = [\n  {\n    icon: \"home\",\n    text: \"Home\",\n    href: \"/\",\n  },\n  {\n    icon: \"settings\",\n    text: \"Settings\",\n    href: \"/settings\",\n  },\n  {\n    icon: \"help_outline\",\n    text: \"Help\",\n    href: \"/help\",\n  },\n];\n</script>\n<style scoped>\n.menu-sheet a {\n  color: var(--gray-dark);\n  text-decoration: none;\n}\n\n.menu-sheet__list {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n.menu-sheet__list-item {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 1rem;\n  font-size: 1.25rem;\n  border-radius: 0.5rem;\n  transition: all ease 0.2s;\n}\n\n.menu-sheet__list-item:hover,\n.menu-sheet__list-item:focus {\n  color: var(--gray-light);\n}\n.menu-sheet__list-item:active {\n  color: var(--black);\n  background: var(--gray-light);\n}\n</style>\n","<template>\n  <Sheet class=\"stoplist-sheet\" title=\"Tour Stops\" @close=\"$emit('close')\">\n    <ol class=\"stoplist\">\n      <router-link\n        v-for=\"(stop, index) in stops\"\n        :key=\"stop.id\"\n        :to=\"`/tours/${stop.tour_id}/stops/${index}`\"\n        @click=\"$emit('close')\"\n      >\n        <li\n          class=\"stoplist__item\"\n          :class=\"{ 'stoplist__item--is-active': index === stopIndex }\"\n        >\n          <div class=\"stoplist__number\">\n            {{ index + 1 }}\n          </div>\n          {{ getStopTitle(stop) }}\n        </li>\n      </router-link>\n    </ol>\n  </Sheet>\n</template>\n<script setup>\nimport { computed } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useStopIndex, useLocale } from \"../../common/hooks\";\nimport Sheet from \"../Sheet/Sheet.vue\";\n\ndefineEmits([\"close\"]);\n\nconst store = useStore();\n// const stopIndex = computed(() => store.getters.stopIndex);\nconst { stopIndex } = useStopIndex();\nconst { locale } = useLocale();\nconst stops = computed(() => store.getters.allStops);\nconst getStopTitle = (stop) => stop.stop_content.title[locale.value];\n</script>\n<style scoped>\n.stoplist {\n  list-style: none;\n  padding: 0;\n}\n\n.stoplist a {\n  color: var(--black);\n  text-decoration: none;\n}\n\n.stoplist__item {\n  --text-color: var(--black);\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 0.5rem;\n  margin: 0.5rem 0;\n  font-size: 1.25rem;\n  border-radius: 0.5rem;\n  transition: all ease 0.2s;\n}\n\n.stoplist__item:hover:not(.stoplist__item--is-active),\n.stoplist__item:focus:not(.stoplist__item--is-active) {\n  color: var(--black);\n  background: var(--white);\n}\n\n.stoplist__item:active,\n.stoplist__item--is-active {\n  color: var(--gray-light);\n  background: var(--black);\n}\n\n.stoplist__item:active .stoplist__number,\n.stoplist__item--is-active .stoplist__number {\n  border-color: var(--gray-light);\n}\n\n.stoplist__number {\n  font-size: 0.875rem;\n  line-height: 1;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 600;\n  min-width: 2rem;\n  min-height: 2rem;\n  border: 0.125rem solid var(--black);\n  border-radius: 0.5rem;\n}\n</style>\n","<template>\n  <div class=\"bottom-nav\">\n    <nav class=\"bottom-nav__navbar\">\n      <button class=\"bottom-nav__button\" @click=\"setActiveSheet(SHEETS.MENU)\">\n        <span class=\"material-icons\">menu</span>\n        <span class=\"sr-only\">Menu</span>\n      </button>\n      <button\n        class=\"bottom-nav__progress-button\"\n        @click=\"setActiveSheet(SHEETS.STOPLIST)\"\n      >\n        <ProgressIndicator :total=\"totalStopsRef\" :active=\"stopIndexRef\" />\n        <span class=\"sr-only\">Open Tour Stops</span>\n      </button>\n      <button class=\"bottom-nav__button\" @click=\"setActiveSheet(SHEETS.MAP)\">\n        <span class=\"material-icons\">map</span>\n        <span class=\"sr-only\">Map</span>\n      </button>\n    </nav>\n    <div>\n      <MenuSheet\n        :is-open=\"isActiveSheet(SHEETS.MENU)\"\n        @close=\"handleSheetClose()\"\n      />\n      <StopListSheet\n        :is-open=\"isActiveSheet(SHEETS.STOPLIST)\"\n        @close=\"handleSheetClose()\"\n      />\n      <MapSheet\n        :is-open=\"isActiveSheet(SHEETS.MAP)\"\n        @close=\"handleSheetClose()\"\n      />\n    </div>\n  </div>\n</template>\n<script setup>\nimport { ref, computed } from \"vue\";\nimport { useStore } from \"vuex\";\nimport ProgressIndicator from \"../ProgressIndicator/ProgressIndicator.vue\";\nimport MapSheet from \"../MapSheet/MapSheet.vue\";\nimport MenuSheet from \"../MenuSheet/MenuSheet.vue\";\nimport StopListSheet from \"../StopListSheet/StopListSheet.vue\";\n\nconst SHEETS = {\n  MENU: \"MENU\",\n  STOPLIST: \"STOPLIST\",\n  MAP: \"MAP\",\n};\n\nconst activeSheet = ref(null);\nconst store = useStore();\n\nconst stopIndexRef = computed(() => store.getters.stopIndex);\nconst totalStopsRef = computed(() => store.getters.totalStops);\n\nconst setActiveSheet = (sheetKey) => {\n  activeSheet.value = SHEETS[sheetKey];\n};\n\nconst handleSheetClose = () => (activeSheet.value = null);\n\nconst isActiveSheet = (sheetKey) => {\n  return activeSheet.value === sheetKey;\n};\n</script>\n<style scoped>\n.bottom-nav__navbar {\n  background: hsla(0, 0%, 100%, 0.5);\n  border-top: 2px solid hsla(0, 0%, 0%, 0.05);\n  /* TODO: make this happen with autoprefixer */\n  -webkit-backdrop-filter: blur(0.5rem);\n  backdrop-filter: blur(0.5rem);\n  display: grid;\n  grid-template-columns: min-content minmax(0, 1fr) min-content;\n  gap: 1rem;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  padding: 0.5rem 1.25rem;\n  z-index: 100;\n}\n.bottom-nav__button {\n  background: transparent;\n  border: 0;\n  color: var(--black);\n  width: 3rem;\n  height: 3rem;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  transition: all ease 0.1s;\n}\n.bottom-nav__button:hover,\n.bottom-nav__progress-button:hover {\n  background: hsla(0, 0%, 0%, 0.1);\n  color: var(--black);\n}\nbutton:active {\n  background: var(--white);\n  color: var(--black);\n}\n.bottom-nav__progress-button {\n  display: flex;\n  background: transparent;\n  flex: 1;\n  align-self: stretch;\n  justify-content: center;\n  align-items: center;\n  border-radius: 0.5rem;\n  border: 0;\n}\n</style>\n","<template>\n  <div class=\"tour-stop\">\n    <StopHeader\n      :title=\"stopIndex === 0 ? tour.title : stop.stop_content.title[locale]\"\n      :subtitle=\"`${tour.geocoded.city}, ${tour.geocoded.state}`\"\n      :stopNumber=\"stopIndex + 1\"\n      :imageSrc=\"headerImageSrc\"\n      :imageAlt=\"headerImageAlt\"\n    />\n    <div class=\"tour-stop__stages container\">\n      <div class=\"skeleton-block skeleton--small\"></div>\n      <div class=\"skeleton-block skeleton-block--medium\"></div>\n      <div class=\"skeleton-block skeleton-block--large\"></div>\n    </div>\n  </div>\n</template>\n<script setup>\nimport { computed } from \"vue\";\nimport StopHeader from \"../StopHeader/StopHeader.vue\";\nimport { number, object, string } from \"vue-types\";\nimport config from \"../../config\";\n\nconst props = defineProps({\n  tour: object().isRequired,\n  locale: string().isRequired,\n  stopIndex: number().def(0),\n});\n\nconst stop = computed(() => props.tour.stops[props.stopIndex]);\nconst headerImageSrc = computed(() => {\n  const image = stop.value?.stop_content?.header_image;\n  if (!image) return null;\n  return `${config.apiBaseUrl}${image.src}`;\n});\n\nconst headerImageAlt = computed(() => {\n  const image = stop.value?.stop_content?.header_image;\n  if (!image) return null;\n  return image.alt;\n});\n</script>\n<style scoped>\n.tour-stop {\n  position: relative;\n}\n.tour-stop__stages {\n  background: var(--white);\n  border-radius: 2rem 2rem 0 0;\n  padding-bottom: 12rem;\n}\n.tour-stop__prev-button {\n  position: fixed;\n  bottom: 5rem;\n  left: 2rem;\n}\n.tour-stop__next-button {\n  position: fixed;\n  bottom: 5rem;\n  right: 2rem;\n}\n\n.skeleton-block {\n  height: 1.25rem;\n  width: 100%;\n  margin: 1rem 0;\n  background: var(--gray-light);\n  background: var(--gray-lighter)\n    linear-gradient(\n      90deg,\n      var(--gray-lighter) 0,\n      #fafafa 2rem,\n      var(--gray-lighter) 4rem\n    );\n  background-size: 10rem;\n  background-position: 0 0;\n  background-repeat: no-repeat;\n  animation: shine-lines 1.6s infinite linear;\n  border-radius: 0.5rem;\n}\n\n.skeleton-block--medium {\n  height: 5rem;\n}\n\n.skeleton-block--large {\n  height: 8rem;\n}\n\n@keyframes shine-lines {\n  0% {\n    background-position: -100%;\n  }\n  40%,\n  100% {\n    background-position: 200%;\n  }\n}\n</style>\n","<template>\n  <div\n    class=\"gravatar\"\n    :class=\"{\n      'gravatar--small': variant === 'small',\n      'gravatar--large': variant === 'large',\n    }\"\n  >\n    {{ name.charAt(0) }}\n    <img\n      v-if=\"email\"\n      :src=\"`https://www.gravatar.com/avatar/${emailHash}?s=${size}`\"\n      :alt=\"name\"\n    />\n  </div>\n</template>\n<script setup>\nimport { computed } from \"vue\";\nimport md5 from \"md5\";\n\nconst props = defineProps({\n  email: {\n    type: String,\n    default: null,\n  },\n  name: {\n    type: String,\n    required: true,\n  },\n  size: {\n    type: Number,\n    default: 200,\n  },\n  variant: {\n    type: String,\n    default: \"medium\",\n  },\n});\n\n// see: https://en.gravatar.com/site/implement/hash/\nconst toHash = (str) => md5(str.trim().toLowerCase());\nconst emailHash = computed(() => toHash(props.email));\n</script>\n<style scoped>\n.gravatar {\n  --size: 3rem;\n  height: var(--size);\n  width: var(--size);\n  border-radius: 50%;\n  overflow: hidden;\n}\n\n.gravatar--small {\n  --size: 2rem;\n}\n.gravatar--large {\n  --size: 4rem;\n}\n\n.gravatar img {\n  max-width: 100%;\n}\n</style>\n","<template>\n  <div class=\"language-stage\">\n    <form\n      v-if=\"locales.length > 1\"\n      class=\"lanugage-stage__form\"\n      @submit.prevent=\"onSubmit(selectedLocale)\"\n    >\n      <h3>Language</h3>\n      <label\n        v-for=\"(localeChoice, index) in locales\"\n        :key=\"index\"\n        class=\"input-group\"\n      >\n        <input\n          name=\"locale\"\n          type=\"radio\"\n          :value=\"localeChoice\"\n          :checked=\"selectedLocale === localeChoice\"\n          @change=\"handleChange(localeChoice)\"\n        />\n        {{ locale }}\n      </label>\n      <Button class=\"save-button\" type=\"submit\" variant=\"primary\">Save</Button>\n    </form>\n  </div>\n</template>\n\n<script setup>\nimport { ref } from \"vue\";\nimport { arrayOf, string } from \"vue-types\";\nimport Button from \"../../Button/Button.vue\";\n\nconst props = defineProps({\n  locale: {\n    type: String,\n    required: true,\n  },\n  locales: arrayOf(string()),\n});\n\nconst selectedLocale = ref(props.locale);\nconst handleChange = (locale) => {\n  selectedLocale.value = locale;\n};\n\nconst emit = defineEmits([\"setLocale\"]);\nconst onSubmit = (selected) => emit(\"setLocale\", selected);\n</script>\n<style scoped>\n.input-group {\n  display: block;\n  padding: 0.5rem 0;\n}\n\n.save-button {\n  margin: 1rem 0;\n}\n</style>\n","<template>\n  <PureLanguageSelect\n    :locale=\"locale\"\n    :locales=\"tourLocales\"\n    @setLocale=\"setLocale\"\n  />\n</template>\n\n<script setup>\nimport PureLanguageSelect from \"./PureLanguageSelect.vue\";\nimport { useLocale, useTourLocales } from \"../../../common/hooks\";\n\nconst { locale, setLocale } = useLocale();\nconst { tourLocales } = useTourLocales();\n</script>\n<style scoped>\n.input-group {\n  display: block;\n  padding: 0.5rem 0;\n}\n\n.save-button {\n  margin: 1rem 0;\n}\n</style>\n","<template>\n  <!-- eslint-disable vue/no-v-html -->\n  <div class=\"markdown\" v-html=\"cleanHtml\"></div>\n</template>\n\n<script setup>\nimport { marked } from \"marked\";\nimport DOMPurify from \"dompurify\";\nimport pipe from \"../../utils/pipe\";\nimport { computed } from \"vue\";\nimport { string } from \"vue-types\";\n\nconst props = defineProps({\n  content: string().def(\"\"),\n});\n\n// parse markdown, THEN sanitize the resulting HTML\nconst toCleanHtml = pipe(marked.parse, DOMPurify.sanitize);\nconst cleanHtml = computed(() => toCleanHtml(props.content));\n</script>\n\n<style scoped></style>\n","<template>\n  <div class=\"guide-stage\">\n    <Markdown :content=\"markdown\" />\n  </div>\n</template>\n\n<script setup>\nimport { computed } from \"vue\";\nimport { shape } from \"vue-types\";\nimport Markdown from \"../../Markdown/Markdown.vue\";\n\nconst props = defineProps({\n  stage: shape({\n    // I18n object like: { en: 'hello', es: 'hola'}\n    text: Object,\n  }).loose,\n  locale: {\n    type: String,\n    default: \"en\",\n  },\n});\nconst markdown = computed(() => props.stage.text[props.locale]);\n</script>\n\n<style scoped>\n.stage-type {\n  font-size: 0.8rem;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 1px;\n}\n</style>\n","<template>\n  <h3 class=\"separator-stage\">{{ text }}</h3>\n</template>\n<script setup>\nimport { computed } from \"vue\";\nimport { object, shape, string } from \"vue-types\";\n\nconst props = defineProps({\n  stage: shape({\n    text: object().def({\n      en: \"\",\n    }),\n  }).loose,\n  locale: string().isRequired,\n});\n\nconst text = computed(() => props.stage.text[props.locale]);\n</script>\n<style scoped>\n.separator-stage {\n  padding-top: 1rem;\n  margin-top: 1rem;\n  margin-bottom: 1rem;\n}\n</style>\n","<template>\n  <div class=\"navigation-stage\">\n    <Markdown :content=\"markdown\" />\n    <Button v-if=\"hasShowMapToggle\" icon=\"map\" @click=\"toggleShowMap\">\n      Show Map\n    </Button>\n    <div v-if=\"showMap\" class=\"navigation-stage__tour-map-wrapper\">\n      <TourMap initialMapStyle=\"satellite\" type=\"stop\" :stopIndex=\"stopIndex\" />\n    </div>\n  </div>\n</template>\n<script setup>\nimport { computed, ref } from \"vue\";\nimport { bool, shape, string } from \"vue-types\";\nimport { useStopIndex } from \"../../../common/hooks\";\nimport Markdown from \"../../Markdown/Markdown.vue\";\nimport Button from \"../../Button/Button.vue\";\nimport TourMap from \"../../TourMap/TourMap.vue\";\n\nconst props = defineProps({\n  stage: shape({\n    // I18n object like: { en: 'hello', es: 'hola'}\n    text: Object,\n  }).loose,\n  locale: string().isRequired,\n  hasShowMapToggle: bool().def(true),\n});\n\nconst markdown = computed(() => props.stage.text[props.locale]);\nconst { stopIndex } = useStopIndex();\n\n// if no toggle, show map by default\n// if toggle, hide map\nconst showMap = ref(!props.hasShowMapToggle);\n\nconst toggleShowMap = () => (showMap.value = !showMap.value);\n</script>\n<style>\n.navigation-stage__tour-map-wrapper {\n  height: 50vh;\n}\n</style>\n","<template>\n  <div class=\"gallery-stage\">\n    <div class=\"gallery-stage__thumbnails\">\n      <figure\n        v-for=\"(image, i) in images\"\n        :key=\"i\"\n        class=\"gallery__figure\"\n        @click=\"handleThumbnailClick(i)\"\n      >\n        <div class=\"gallery-stage__figure-image-wrap\">\n          <img :src=\"image.src\" :alt=\"image.alt\" loading=\"lazy\" />\n        </div>\n        <figcaption v-if=\"image.title\" class=\"gallery-stage__figure-figcaption\">\n          {{ image.title }}\n        </figcaption>\n      </figure>\n\n      <!-- all props & events -->\n      <VueEasyLightbox\n        scrollDisabled\n        escDisabled\n        moveDisabled\n        loop\n        :visible=\"lightboxVisible\"\n        :imgs=\"images\"\n        :index=\"onStageIndex\"\n        teleport=\"body\"\n        @hide=\"handleHide\"\n      ></VueEasyLightbox>\n    </div>\n  </div>\n</template>\n<script setup>\nimport { ref, computed } from \"vue\";\nimport config from \"../../../config\";\nimport VueEasyLightbox from \"vue-easy-lightbox\";\n\nconst props = defineProps({\n  stage: {\n    type: Object,\n    required: true,\n  },\n  locale: {\n    type: String,\n    default: \"en\",\n  },\n});\n\nconst onStageIndex = ref(0);\nconst images = computed(() =>\n  props.stage.images.map((img) => ({\n    src: `${config.imageStorageBase}/${img.src}`,\n    alt: img.text[props.locale],\n    title: img.text[props.locale],\n  }))\n);\nconst lightboxVisible = ref(false);\nconst handleThumbnailClick = (index) => {\n  onStageIndex.value = index;\n  lightboxVisible.value = true;\n};\n\nconst handleHide = () => {\n  lightboxVisible.value = false;\n};\n</script>\n<style scoped>\n.gallery-stage {\n  margin: 1rem 0;\n  position: relative;\n}\n\nimg {\n  display: block;\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\nfigure {\n  margin: 0;\n  padding: 0;\n}\n.gallery-stage__thumbnails {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(10rem, 1fr));\n  gap: 1rem;\n}\n.gallery-stage__figure-image-wrap {\n  flex: 1;\n  overflow: hidden;\n}\n.gallery__figure {\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  border-radius: 0.5rem;\n  border: 1px solid var(--gray-light);\n  overflow: hidden;\n}\n.gallery__figure img {\n  transition: all ease 0.5s;\n}\n\n.gallery-stage__figure-figcaption {\n  display: block;\n  font-size: 0.75rem;\n  padding: 1rem;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: hsla(0, 0%, 0%, 0.5);\n  color: var(--white);\n}\n\n.gallery__figure:before {\n  content: \"\";\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: hsla(0, 0%, 0%, 0.1);\n  opacity: 0%;\n  transition: all ease 0.5s;\n  z-index: 5;\n}\n.gallery__figure:hover img {\n  transform: scale(101%, 101%);\n}\n\n.gallery__figure:hover:before {\n  opacity: 100%;\n}\n</style>\n<style>\n.vel-modal {\n  background: hsla(0, 0%, 0%, 0.8);\n  /* TODO: make this happen with autoprefixer */\n  -webkit-backdrop-filter: blur(0.5rem);\n  backdrop-filter: blur(0.5rem);\n}\n.vel-btns-wrapper .disable {\n  color: transparent;\n}\n.vel-img-title {\n  white-space: normal;\n  font-size: 1rem;\n  overflow: initial;\n  width: 80vw;\n  max-width: 50rem;\n}\n</style>\n","<template>\n  <div class=\"ar-stage\">\n    <Button icon=\"travel_explore\" @click=\"toggleShowAr\">Look Around</Button>\n\n    <iframe\n      v-if=\"isShowingAR\"\n      class=\"ar-iframe\"\n      :src=\"src\"\n      frameborder=\"0\"\n      width=\"100%\"\n      height=\"100%\"\n    >\n      Loading AR...\n    </iframe>\n  </div>\n</template>\n\n<script setup>\nimport { computed, ref } from \"vue\";\nimport { bool, object, string } from \"vue-types\";\nimport Button from \"../../Button/Button.vue\";\nimport { useStopIndex, useTour } from \"../../../common/hooks.js\";\nimport config from \"../../../config.js\";\n\nconst props = defineProps({\n  stage: object().isRequired,\n  simulateLocation: bool().def(false),\n  locale: string().def(\"en\"),\n});\n\nconst { tour } = useTour();\nconst { stopIndex } = useStopIndex();\n\nconst isShowingAR = ref(false);\nfunction toggleShowAr() {\n  console.log(\"toggleShowAr\");\n  isShowingAR.value = !isShowingAR.value;\n}\n\nconst src = computed(() => {\n  // TODO: change this to use 2 letter locales\n  return `${config.apiBaseUrl}/ar/${tour.value.id}/${stopIndex.value}/English/${props.simulateLocation}`;\n});\n</script>\n<style scope>\n.ar-iframe {\n  border: 1px solid #ddd;\n  min-height: 70vh;\n  margin: 1rem 0;\n}\n</style>\n","<template>\n  <component :is=\"componentName\" v-if=\"componentName\" :stage=\"stage\" />\n  <div v-else class=\"stage-unknown\">\n    <h3>{{ stage.type }}</h3>\n    <pre>{{ stage }}</pre>\n  </div>\n</template>\n<script setup>\nimport { computed } from \"vue\";\nimport LanguageSelect from \"./stages/LanguageSelect.vue\";\nimport Guide from \"./stages/Guide.vue\";\nimport Separator from \"./stages/Separator.vue\";\nimport Navigation from \"./stages/Navigation.vue\";\nimport Gallery from \"./stages/Gallery.vue\";\nimport AR from \"./stages/AR.vue\";\n\nconst componentLookup = {\n  language: LanguageSelect,\n  guide: Guide,\n  separator: Separator,\n  navigation: Navigation,\n  gallery: Gallery,\n  ar: AR,\n};\n\nconst props = defineProps({\n  stage: {\n    type: Object,\n    required: true,\n  },\n});\n\nconst componentName = computed(() => componentLookup[props.stage.type]);\n</script>\n\n<style scoped>\n.stage-unknown {\n  background: #ffeff1;\n  border-left: 0.25rem solid var(--system-red);\n  padding: 1rem;\n}\n</style>\n","<template>\n  <div class=\"tour-stop\">\n    <StopHeader\n      :title=\"isFirstStop ? tour.title : stop.stop_content.title[locale]\"\n      :subtitle=\"`${tour.geocoded.city}, ${tour.geocoded.state}`\"\n      :stopNumber=\"stopIndex + 1\"\n      :imageSrc=\"headerImageSrc\"\n      :imageAlt=\"headerImageAlt\"\n    >\n      <TourAuthor v-if=\"isFirstStop && tour.author\" :author=\"tour.author\" />\n    </StopHeader>\n    <div class=\"tour-stop__stages container\">\n      <h2 v-if=\"isFirstStop\">Start</h2>\n      <section v-for=\"stage in stages\" :key=\"`${stop.id}-${stage.id}`\">\n        <Stage :stage=\"stage\" :locale=\"locale\" />\n      </section>\n      <Button\n        v-if=\"!isLastStop\"\n        icon=\"arrow_forward\"\n        iconPosition=\"end\"\n        variant=\"primary\"\n        @click=\"$router.push(`/tours/${tour.id}/stops/${stopIndex + 1}`)\"\n      >\n        Continue\n      </Button>\n    </div>\n  </div>\n</template>\n<script setup>\nimport Button from \"../Button/Button.vue\";\nimport StopHeader from \"../StopHeader/StopHeader.vue\";\nimport TourAuthor from \"../TourAuthor/TourAuthor.vue\";\nimport Stage from \"../Stage/Stage.vue\";\nimport { computed } from \"vue\";\nimport { useTour, useLocale } from \"../../common/hooks\";\nimport { bool, number, object } from \"vue-types\";\nimport config from \"../../config\";\n\nconst props = defineProps({\n  stopIndex: number().def(0),\n  stop: object().isRequired,\n  isLastStop: bool().def(false),\n});\n\nconst { tour } = useTour();\nconst { locale } = useLocale();\n\nconst isFirstStop = computed(() => props.stopIndex === 0);\nconst stages = computed(() => props.stop?.stop_content?.stages) || [];\nconst headerImageSrc = computed(() => {\n  const image = props.stop?.stop_content?.header_image;\n  if (!image) return null;\n  return `${config.apiBaseUrl}${image.src}`;\n});\n\nconst headerImageAlt = computed(() => {\n  const image = props.stop?.stop_content?.header_image;\n  if (!image) return null;\n  return image.alt;\n});\n</script>\n<style scoped>\n.tour-stop {\n  position: relative;\n}\n.tour-stop__stages {\n  background: var(--white);\n  border-radius: 2rem 2rem 0 0;\n  padding-bottom: 5rem;\n}\n</style>\n","<template>\n  <Swiper\n    :slides-per-view=\"1\"\n    :space-between=\"16\"\n    :initialSlide=\"stopIndex\"\n    @swiper=\"onSwiper\"\n    @slideChangeTransitionEnd=\"onSlideChange\"\n  >\n    <SwiperSlide\n      v-for=\"(stop, index) in tour.stops\"\n      :key=\"index\"\n      :autoHeight=\"true\"\n    >\n      <TourStop v-if=\"stopIndex === index\" :stop=\"stop\" :stopIndex=\"index\" />\n      <TourStopSkeleton\n        v-else\n        :tour=\"tour\"\n        :stopIndex=\"index\"\n        :locale=\"locale\"\n      />\n    </SwiperSlide>\n  </Swiper>\n</template>\n<script setup>\nimport { Swiper, SwiperSlide } from \"swiper/vue\";\nimport { useRouter } from \"vue-router\";\nimport { number, object, string } from \"vue-types\";\nimport { nextTick, ref, watch } from \"vue\";\nimport TourStopSkeleton from \"../TourStopSkeleton/TourStopSkeleton.vue\";\nimport TourStop from \"../TourStop/TourStop.vue\";\nimport \"swiper/css\";\n\nconst props = defineProps({\n  tour: object().isRequired,\n  stopIndex: number().def(0),\n  locale: string().isRequired,\n});\n\nconst swiperRef = ref(null);\nconst router = useRouter();\n\nfunction onSwiper(swiper) {\n  swiperRef.value = swiper;\n}\n\nfunction onSlideChange(event) {\n  // update route\n  nextTick(() => {\n    router.push(`/tours/${props.tour.id}/stops/${event.activeIndex}`);\n  });\n}\n\n/**\n * If the stopIndex is updated via the bottomNav, the correct tourStop will\n * load, but Swiper will be sitting on the old active slide, which is now\n * skeleton. So, we need to tell Swiper to slideTo the updated stopIndex..\n * which we do with the watch on stopIndex.\n */\nwatch(\n  () => props.stopIndex,\n  () => {\n    if (!swiperRef.value) return;\n    swiperRef.value.slideTo(props.stopIndex, 0);\n  }\n);\n</script>\n","<template>\n  <div\n    class=\"tuck-on-scroll\"\n    :class=\"{\n      'tuck-on-scroll--is-tucked': isTucked,\n    }\"\n  >\n    <slot></slot>\n  </div>\n</template>\n<script setup>\nimport { ref } from \"vue\";\nimport { useScroll } from \"@vueuse/core\";\nconst { directions } = useScroll(window, {\n  onScroll: handleScroll,\n  throttle: 300,\n});\nconst isTucked = ref(false);\n\nfunction handleScroll() {\n  if (directions.bottom) isTucked.value = true;\n  if (directions.top) isTucked.value = false;\n}\n</script>\n<style scoped>\n.tuck-on-scroll {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 10;\n  transition: transform 0.3s ease-in-out;\n}\n.tuck-on-scroll--is-tucked {\n  transform: translateY(-100%);\n}\n</style>\n","<template>\n  <div class=\"tour-page\">\n    <TuckOnScroll>\n      <AppHeader class=\"tour-page__app-header\" />\n    </TuckOnScroll>\n    <div v-if=\"isLoading\" class=\"loading\">Loading...</div>\n    <div v-if=\"!isLoading\">\n      <TourStopSwiper :tour=\"tour\" :stopIndex=\"stopIndex\" :locale=\"locale\" />\n      <BottomNav />\n    </div>\n  </div>\n</template>\n<script setup>\nimport { onMounted, computed } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useStopIndex, useTour, useLocale } from \"../common/hooks\";\n\nimport AppHeader from \"../components/AppHeader/AppHeader.vue\";\nimport BottomNav from \"../components/BottomNav/BottomNav.vue\";\nimport TourStopSwiper from \"../components/TourStopSwiper/TourStopSwiper.vue\";\nimport TuckOnScroll from \"../components/TuckOnScroll/TuckOnScroll.vue\";\n\nconst store = useStore();\nconst { stopIndex } = useStopIndex();\nconst { tour } = useTour();\nconst { locale } = useLocale();\nconst isLoading = computed(() => store.state.isLoading);\n\nonMounted(() => {\n  store.dispatch(\"fetchTour\", store.state.route.params.tourId);\n});\n</script>\n<style scoped>\n.tour-page {\n  background: var(--black);\n  height: 100%;\n}\n\n.tour-page__stages {\n  background: var(--white);\n  border-radius: 2rem 2rem 0 0;\n  padding-bottom: 10rem;\n}\n\n.tour-page__fab-next {\n  position: fixed;\n  bottom: 6rem;\n  right: 2rem;\n}\n.swiper-slide {\n  min-height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n</style>\n","import { createRouter, createWebHistory } from \"vue-router\";\nimport HomePage from \"./pages/HomePage.vue\";\nimport TourPage from \"./pages/TourPage.vue\";\nimport SettingsPage from \"./pages/SettingsPage.vue\";\nimport HelpPage from \"./pages/HelpPage.vue\";\nimport config from \"./config\";\n\nconst routes = [\n  { path: \"/\", component: HomePage },\n  {\n    path: \"/tours/:tourId/stops/:stopIndex\",\n    component: TourPage,\n  },\n  {\n    path: \"/settings\",\n    component: SettingsPage,\n  },\n  {\n    path: \"/help\",\n    component: HelpPage,\n  },\n];\n\nconst router = createRouter({\n  history: createWebHistory(config.baseDir),\n  routes,\n  scrollBehavior(to, from, savedPosition) {\n    if (savedPosition) {\n      return savedPosition;\n    } else {\n      return { top: 0 };\n    }\n  },\n});\n\nexport default router;\n","import { createStore, createLogger } from \"vuex\";\nimport { toursService } from \"../common/api.service.js\";\n\nconst toInt = (str) => Number.parseInt(str, 10);\n\nexport const initialState = {\n  tour: null,\n  isLoading: true,\n  locale: \"en\",\n  errors: [],\n};\n\nexport const getters = {\n  allStops(state) {\n    const { tour } = state;\n    if (!tour) return [];\n    return tour.stops;\n  },\n  totalStops(state) {\n    if (!state.tour) return 0;\n    return state.tour.stops.length;\n  },\n  stopIndex(state) {\n    return toInt(state.route.params.stopIndex || 0);\n  },\n  tourId(state) {\n    return toInt(state.route.params.tourId);\n  },\n  isFirstStop(_, getters) {\n    return getters.stopIndex === 0;\n  },\n  isLastStop(_, getters) {\n    return getters.stopIndex === getters.totalStops - 1;\n  },\n  currentStop(_, getters) {\n    return getters.allStops?.[getters.stopIndex] || null;\n  },\n  nextStop(state, getters) {\n    if (getters.isLastStop) return null;\n    return state.getters.allStops[getters.stopIndex + 1];\n  },\n  previousStop(state, getters) {\n    if (getters.isFirstStop) return null;\n    return state.getters.allStops[getters.stopIndex - 1];\n  },\n};\n\nexport const mutations = {\n  fetchTourStarted(state) {\n    state.isLoading = true;\n  },\n  fetchTourSucceeded(state, tour) {\n    state.isLoading = false;\n    state.tour = tour;\n  },\n  fetchTourFailed(state, error) {\n    state.isLoading = false;\n    state.errors.push(error);\n  },\n  setLocale(state, locale) {\n    state.locale = locale;\n  },\n};\n\nexport const actions = {\n  fetchTour({ commit }, tourId) {\n    commit(\"fetchTourStarted\");\n    toursService\n      .get(tourId)\n      .then((tour) => {\n        commit(\"fetchTourSucceeded\", tour);\n      })\n      .catch((err) => {\n        console.error(err);\n        commit(\"fetchTourFailed\", err);\n      });\n  },\n  setLocale({ commit }, locale) {\n    commit(\"setLocale\", locale);\n  },\n};\n\nexport const storeConfig = {\n  state: () => initialState,\n  getters,\n  mutations,\n  actions,\n  plugins: [createLogger()],\n};\n\nexport const store = createStore(storeConfig);\n\nexport default store;\n","import { createApp } from \"vue\";\nimport App from \"./App.vue\";\nimport router from \"./router.js\";\nimport store from \"./store/index.js\";\nimport { sync } from \"vuex-router-sync\";\nimport \"./globalStyles.js\";\n\n// keep vuex and vue-router in sync\nsync(store, router);\n\nconst app = createApp(App);\n\napp.use(router).use(store).mount(\"#app\");\n"],"names":["range","Map","FullscreenControl","GeolocateControl","ScaleControl","Marker","Popup","DOMPurify","Navigation","AR","HomePage"],"mappings":"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"}